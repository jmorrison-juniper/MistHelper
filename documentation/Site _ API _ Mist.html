
<!-- saved from url=(0042)https://api.mist.com/api/v1/docs/Site#wlan -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Site | API | Mist</title>
<style>
/* modified from https://gist.github.com/andyferra/2554919 */
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url("../../images/modules/styleguide/para.png") no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 0; }

hr {
  background: transparent url("../../images/modules/pulls/dirty-shade.png") repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0; }

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }

ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

ul :last-child, ol :last-child {
  margin-bottom: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
    border-collapse: collapse;
  padding: 0; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      text-align: left;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      text-align: left;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }
</style>
</head>
<body>

<h2 id="site">Site</h2>
<p>A site represents a project, a deployment. For MSP, it can be as small as a coffee shop or a five-star 600-room hotel. A
site contains a set of Maps, Wlans, Policies, Zones.</p>
<h1 id="wlan">Wlan</h1>
<h2 id="wireless-lan-definition">Wireless LAN definition</h2>
<p>Wlans are the wireless networks created under a site.</p>
<h3 id="base-uri">Base URI</h3>
<pre><code>/api/v1/sites/:site_id/wlans
</code></pre>
<h3 id="example">Example</h3>
<pre><code>{
    "ssid": "corporate",
    "enabled": true,
    "auth": {
        "type": "psk",

        // type is psk
        "psk": "foryoureyesonly",
        "enable_mac_auth": false,
        "multi_psk_only": false,
        "pairwise": [ "wpa1-ccmp", "wpa2-tkip", "wpa1-tkip", "wpa2-ccmp", "wpa3" ],
        "wep_as_secondary_auth": false,

        // type = wep
        "keys": [ "1234567890", null, "0987654321", null ],
        "key_idx": 1

        // type = eap
        "eap_reauth": false

        // type = open
        "owe": "enabled",  // disabled (default) / enabled (transitional) / required

        // whether to enable Private WLAN
        "private_wlan": true,

        // sae anti-clogging token threshold
        "anticlog_threshold": 16,  // default: 16, range: 16-32
    },

    "dynamic_psk": {
        // dynamic_psk allows PSK to be selected at runtime depending on context (wlan/site/user/...)
        // thus following configurations are assumed (currently)
        // - PSK will come from RADIUS server if source is radius
        //   - AP sends client MAC as username ans password (i.e. `enable_mac_auth` is assumed)
        //   - AP sends BSSID:SSID as Caller-Station-ID
        //   - `auth_servers` is required
        // - PSK will come from cloud WLC if source is cloud_psks
        //   - default_psk will be used if cloud WLC is not available
        // - `multi_psk_only` and `psk` is ignored
        // - `pairwise` can only be wpa2-ccmp (for now, wpa3 support on the roadmap)
        "enabled": true

        "source": "radius",  // radius (default), cloud_psks
        "default_vlan_id": 999,
        "default_psk": "foryoureyesonly",  // 8-63 characters

        // optional, when 11r is enabled, we'll try to use the cached PMK, this can be disabled
        "force_lookup": false,  // default is false (meaning auto)
    },

    "roam_mode": "none",

    // radius-related
    "auth_servers_nas_id": "5c5b350e0101-nas",
    "auth_servers_nas_ip": "15.3.1.5",
    "auth_servers_timeout": 5,
    "auth_servers_retries": 3,
    "auth_server_selection": "ordered",
    "auth_servers": [
        {
            "host": "1.2.3.4",
            "port": 1812,
            "secret": "testing123"
        },
        {
            "host": "radius.internal",
            "port": 1812,
            "secret": "testing123"
        },
        {
            "host": "radius2",
            "port": 1812,
            "secret": "testing123",
            "keywrap_enabled": true, // enable keywrap algorithm. Default is false
            "keywrap_format": "hex", // key format: hex or ascii
            “keywrap_kek”: “1122334455", // Key encryption key
            “keywrap_mack” “1122334455", // Message Authentication Code Key
        },
    ],
    "acct_servers": [
        {
            "host": "1.2.3.4",
            "port": 1812,
            "secret": "testing123"
        },
        {
            "host": "radius2",
            "port": 1812,
            "secret": "testing123",
            "keywrap_enabled": true, // enable keywrap algorithm. Default is false
            "keywrap_format": "hex", // key format: hex or ascii
            “keywrap_kek”: “1122334455", // Key encryption key
            “keywrap_mack” “1122334455", // Message Authentication Code Key
        },
    ],
    "acct_interim_interval": 0,
    "dynamic_vlan": {
        "enabled": true,
        "type": "airespace-interface-name",
        "vlans": {
            "131": "default",
            "322": "fast,video"
        }
        "default_vlan_id": 999
        "local_vlan_ids": []
    },
    "dns_server_rewrite": {
        "enabled": true,
        "radius_groups": {
            "contractor": "172.1.1.1",
            "guest": "8.8.8.8"
        }
    },
    "coa_servers": [
        {
            "enabled": false,
            "ip": "1.2.3.4",
            "port": 3799,
            "secret": "testing456",
            "disable_event_timestamp_check": false
        }
    ],
    "radsec": {
        // this schema applies to
        //    /api/v1/orgs/:org_id/wlans
        //    /api/v1/sites/:site_id/wlans
        //    /api/v1/sites/:site_id/devices/:device_id

        "enabled": true,

        // either specify the list of radsec servers
        "server_name": "radsec.abc.com",
        "servers": [
            {
                "host": "1.1.1.1",
                "port": 1812
            },
            {
                "host": "radsec",
                "port": 1812
            }
        ],
        "idle_timeout": 60,

        // or use mxedge(s) as radsecproxy
        "use_mxedge": true,
        "coa_enabled": true,  // default is false
        "mxcluster_ids": ["572586b7-f97b-a22b-526c-8b97a3f609c4"], // to use mxclusters.radsec.proxy_hosts
        "use_site_mxedge": false,  // else, to use radsec.proxy_hosts; default is false
        "proxy_hosts": ["mxedge1.local"], // default is site.mxedge.radsec.proxy_hosts which must be a superset of all wlans[*].radsec.proxy_hosts
        // when radsec.proxy_hosts are not used, tunnel peers (org or site mxedges) are used irrespective of use_site_mxedge
    },
    "mist_nac": {
        // when enabled
        // - auth_servers ignored
        // - acct_servers ignored
        // - auth_servers_* ignored
        // - coa_servers ignored
        // - radsec ignored
        // - coa_enabled is assumed
        "enabled": true,
    },
    "airwatch": {
        "enabled": true,
        "console_url": "https://hs1.airwatchportals.com",
        "api_key": "aHhlbGxvYXNkZmFzZGZhc2Rmc2RmCg==",
        "username": "user1",
        "password": "test123"
    },
    "cisco_cwa": {
        "enabled": false,

        "allowed_subnets": [
            "63.5.3.0/24"
        ],
        "blocked_subnets": [
            "192.168.0.0/16",
            "172.16.0.0/12"
        ],
        "allowed_hostnames": [
            "snapchat.com",
            "ibm.com"
        ]
    },

    // band is deprecated and kept for backward compability. Use bands instead.
    "band": "24",
    // for a tri-band AP
    "bands": ["24", "5", "6"],
    "band_steer": true,
    "band_steer_force_band5": true,

    "rateset": {
        "24": {
            "min_rssi": 0,
            "template": "default"
            "legacy": [ "1", "2b", "5.5", "11", "6", "9", "12", "18", "24", "36", "48", "54" ],
            "ht": "00ff00ff00ff",
        },
        "5": {
            "min_rssi": -70,
            "template": "custom",
            "legacy": [ "6", "9", "12", "18", "24b", "36", "48", "54" ],
            "ht": "00ff00ff00ff",
            "vht": "03ff03ff03ff01ff",
            "he": "0fff0fff0fff0fff",
            "eht": "3fff0fff0fff03ff",
        }
    },
    // no-legacy (no 11b, copied from Cisco):
    //    2.4: 6(B), 9, 12, 18, 24, 36, 48, 54 + HT + VHT
    //    5:   6(B), 9, 12(B), 18, 24(B), 36, 48, 54 + HT + VHT

    // compatible (all, like before, default setting that Broadcom/Atheros used):
    //    2.4: 1(B), 2(B), 5.5(B), 6, 9, 11(B), 12, 18, 24, 36, 48, 54 + HT + VHT
    //    5:   6(B), 9, 12(B), 18, 24(B), 36, 48, 54 + HT + VHT

    // high-density (no 11b, no low rates):
    //    2.4: 24(B), 36, 48, 54 + HT/MCS3-7,11-15,19-23,27-31 + VHT/MCS3-9
    //    5:   24(B), 36, 48, 54 + HT/MCS3-7,11-15,19-23,27-31 + VHT/MCS3-9

    // for disable ht or vht rates (boolean)
    "disable_ht_vht_rates": true, 

    // for model supporting 11AX only
    "disable_11ax": false,

    // for Wi-Fi 7
    "disable_11be": true,  // default is false

    // if interface is all / eth0 / eth1 / eth2 / eth3, vlan can be specified
    "interface": "all",
    "vlan_enabled": false,
    "vlan_id": 3,

    // vlan pooling allows AP to place client on different VLAN using a deterministic algorithm
    "vlan_pooling": false,
    "vlan_ids": [3, 4, 5],

    // data tunnel - L2TP/IPSec tunnel
    "interface": "wxtunnel",
    "wxtunnel_id": "7dae216d-7c98-a51b-e068-dd7d477b7216",
    "wxtunnel_remote_id": "wifiguest"

    // data tunnel - Mist Tunnel
    "interface": "mxtunnel",
    "mxtunnel_ids": [ "08cd7499-5841-51c8-e663-fb16b6f3b45e" ],
    // disable the WLAN if
    "disable_when_mxtunnel_down": false,  // default is false
    // when different mxcluster is on different subnet, we'd want to disconnect clients (so they'll reconnect and get new IPs)
    "reconnect_clients_when_roaming_mxcluster": false,  // default is false

    // data tunnel = Mist Tunnel over Site MXEdges
    "interface": "site_mxedge",
    "mxtunnel_names": [ "default" ],

    // whether to hide SSID
    "hide_ssid": false,

    // other advanced options
    "dtim": 2,
    "disable_wmm": false,
    "disable_uapsd": false,
    "use_eapol_v1": false,
    "legacy_overds": false,
    "hostname_ie": false,
    // enable AP-AP keycaching via multicast
    "enable_local_keycaching": true,  // default is false
    "max_num_clients": 0,  // 0 (default is unlimited), 1-128

    // filters
    "isolation": false,
    "l2_isolation": false,
    "arp_filter": true
    "limit_bcast": false,
    "allow_mdns": false,
    "allow_ssdp": false,
    "allow_ipv6_ndp": true,
    "no_static_ip": false,
    "no_static_dns": false,
    "limit_probe_response": false,

    // by default, we'd inspect all DHCP packets and drop those unrelated to the wireless client itself
    // in the case where client is a wireless bridge (DHCP packets for other MACs will need to be forwarded), wireless_bridging can be enabled
    "enable_wireless_bridging": false,
    // if the client bridge is doing DHCP on behalf of other devices (L2-NAT), enable dhcp_tracking will cut down DHCP response packets to be forwarded to wireless
    "enable_wireless_bridging_dhcp_tracking": false,

    // when any of the following is true, this WLAN will be disabled
    // - cannot get IP
    // - cannot obtain default gateway
    // - cannot reach default gateway
    "disable_when_gateway_unreachable": false,  // default is false

    // access control,
    "block_blacklist_clients": false,

    // apply_to
    "apply_to": "site",
    "wxtag_ids": [],
    "ap_ids": [],

    // bandwidth limiting
    "wlan_limit_up_enabled": true,
    "wlan_limit_up": 10240,
    "wlan_limit_down_enabled": true,
    "wlan_limit_down": 20480,
    "client_limit_up_enabled": true,
    "client_limit_up": 512,
    "client_limit_down_enabled": true,
    "client_limit_down": 1024,

    "schedule": {
        "enabled": true,
        "hours": {
            "mon": "09:00-17:00",
            "fri": "09:00-17:00"
        }
    },

    "qos": {
        "overwrite": true,
        // same access class for all traffic
        "class": "best_effort"
    },

    "app_limit": {
        "enabled": true,
        "apps": {
            "netflix": 60,
            "dropbox": 300
        },
        "wxtag_ids": {
            "f99862d9-2726-931f-7559-3dfdf5d070d3": 30
        }
    },

    "app_qos": {
        "enabled": true,
        "apps": {
            "skype-business-voice": {
                // all optional
                "dscp": 46, // a reasonable default will be used if omitted
            },
            "skype-business-video": {
                // all optional
                "dscp": 32,
                "src_subnet": "10.2.0.0/16", // subnet filter is not required but helps AP to only inspect certain traffic (thus reducing AP load)
                "dst_subnet": "10.2.0.0/16"
            }
        },
        "others": [
            {
                "protocol": "udp",
                "src_subnet": "10.2.0.0/16",
                "dst_subnet": "10.2.0.0/16",
                "port_ranges": "80,1024-65535",
                "dscp": 32
            }
        ]
    },

    // bonjour support is draft/experimental/subject to change
    "bonjour": {
        "enabled": true,
        "services": {
            "airprint": {
                "scope": "same_map",  // same_ap, same_map, same_site (default)
            },
            "airplay": {
                "scope": "same_ap",

                // optional 
                "radius_groups": ["teachers"]
            }
        },
        "additional_vlan_ids": [80],
        // to prevent wireless clients to discover bonjour devices on the same WLAN
        "disable_local": false
    },

    “hotspot20”: {
         “enabled”: true,
         “operators”: ["google", "att"],
         “venue_name”: ”some_name”,
         "domain_name": ["mist.com"],
         "rcoi": ["5A03BA0000"],
         "nai_realms":[
          {
            "id":"mistsys.com",
            "eap_type":"tls"
          }
        ]
    },

    // whether to inject option 82 when forwarding DHCP packets
    "inject_dhcp_option_82": {
        "enabled": true,
        "circuit_id": "{{SSID}}:{{AP_MAC}}",
    },

    "max_idletime": 1800,

    "sle_excluded": false,

    "disable_v1_roam_notify": true,
    "disable_v2_roam_notify": false,

    // portal - none / password / multi
    "portal": {
        "enabled": true,
        "bypass_when_cloud_down": false,
        "auth": "multi",
        "passphrase_enabled": true,
        "passphrase_expire": none,
        "password": "let me in",
        "forward": true,
        "forward_url": "http://abc.com/promotions",
        "expire": 1440,
        "privacy": false,

        "facebook_enabled": true,
        "facebook_client_id": ...,
        "facebook_client_secret": .....,
        "facebook_email_domains": [],
        "facebook_expire": none,

        "google_enabled": true,
        "google_email_domains": ["mydomain.edu", "mydomain.org"],
        "google_expire": none,

        "amazon_enabled": false,
        "amazon_client_id": ...,
        "amazon_client_secret": .....,
        "amazon_email_domains": [],
        "amazon_expire": none,

        "microsoft_enabled": false,
        "microsoft_client_id": ....,
        "microsoft_client_secret": .....,
        "microsoft_email_domains": [],
        "microsoft_expire": none,

        "azure_enabled": true,
        "azure_tenant_id": .....,
        "azure_client_id": ....,
        "azure_client_secret": .....,
        "azure_expire": none,

        "sponsor_enabled": false,
        "sponsor_email_domains": ["reserved.net", "reserved.org"],
        "sponsors": {"sponsor1@company.com": "FirstName1 LastName1", "sponsor2@company.com": "FirstName2 LastName2"}
        "sponsor_link_validity_duration": 30,
        "sponsor_notify_all": false,
        "sponsor_expire": none,
        "predefined_sponsors_enabled": true, // will show sponsor emails as dropdown list
        "predefined_sponsors_hide_email": false, // if enabled, hides sponsor's email from list
        "sponsor_auto_approve": false,  // automatically approve guest, sponsor will receive an email and can reject the access
        "sponsor_status_notify": false, // if enabled, guest will get email about sponsor's action (approve/deny)

        "sms_enabled": true,
        "sms_provider": "twilio",
        "sms_expire": none,
        "twilio_sid":  "AC72ec6ba0ec5af30e6731c5e47abcdefgh",
        "twilio_auth_token": "af9dac44c344a875ab5d31cb7abcdefg",
        "twilio_phone_number": "+18548888888",
        "broadnet_user_id": "juniper",
        "broadnet_password": "password",
        "broadnet_sid": "string", //default is 'MIST'
        "clickatell_api_key": "string",
        "puzzel_service_id": "string",
        "puzzel_username": "string",
        "puzzel_password": "string",
        "gupshup_userid": "string",
        "gupshup_password": "string",
        "telstra_client_id": "string",
        "telstra_client_secret": "string",
        "smsglobal_api_key": "string",
        "smsglobal_api_secret": "string",

        "email_enabled": false,
        "cross_site": false,
    },
    "portal_template_url": "https://......",
    "portal_image": "https://url/to/image.png",
    "thumbnail": "https://url/to/image.png",

    // portal - external
    "portal": {
        "enabled": true,
        "auth": "external",
        "external_portal_url": "http://myportal.abc.com"
    },
    "portal_api_secret": "EIfPMOykI3lMlDdNPub2WcbqT6dNOtWwmYHAd6bY"

    // portal - sso
    "portal": {
        "enabled": true,
        "auth": "sso",
        "sso_issuer": "https://app.onelogin.com/saml/metadata/138130"
        "sso_idp_cert": "-----BEGIN CERTIFICATE-----\nMIIFZjCCA06gAwIBAgIIP61/1qm/uDowDQYJKoZIhvcNAQELBQE\n-----END CERTIFICATE-----",
        "sso_idp_sign_algo": "sha256",
        "sso_idp_sso_url": "https://yourorg.onelogin.com/trust/saml2/http-post/sso/138130",
        "sso_nameid_format": "email",
        // optional
        "sso_forced_role": "desired",  // ignore any Role attributes and use this instead
        "sso_default_role": "guest" // use this role if Role attribute not returned (when sso_forced_role is not defined)
    },
    "portal_sso_url": "https://portal.mist.com/saml/be22bba7-8e22-e1cf-5185-b880816fe2cf/login"

    // portal - none / multi / external
    "portal_allowed_subnets": [
        "63.5.3.0/24"
    ],
    "portal_allowed_hostnames": [
        "snapchat.com",
        "ibm.com"
    ],
    "portal_denied_hostnames": [
        "msg.snapchat.com"
    ]
}
</code></pre>
<p><em>N.B</em> portal_template will be forked out of wlan objects soon. To fetch portal_template, please query
portal_template_url. To update portal_template, use <a href="https://api.mist.com/api/v1/docs/Site#wlan-portal-template">Wlan Portal Template</a>.</p>
<h3 id="parameters">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>the name of the SSID</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>if this wlan is enabled, default is True</td>
</tr>
<tr>
<td><code>auth</code></td>
<td><code>object</code></td>
<td>authentication/security policies</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>open / psk / wep / eap / eap192 / psk-tkip / psk-wpa2-tkip, default is open</td>
</tr>
<tr>
<td><code>pairwise</code></td>
<td><code>list</code></td>
<td>when type=psk / eap, one of more of wpa2-ccmp / wpa1-tkip / wpa1-ccmp / wpa2-tkip, default is [“wpa2-ccmp”]</td>
</tr>
<tr>
<td><code>psk</code></td>
<td><code>string</code></td>
<td>when type=psk, 8-64 characters, or 64 hex characters</td>
</tr>
<tr>
<td><code>wep_as_secondary_auth</code></td>
<td><code>boolean</code></td>
<td>enable WEP as secondary auth</td>
</tr>
<tr>
<td><code>keys</code></td>
<td><code>list</code></td>
<td>when type=wep, four 10-character or 26-character hex string, null can be used. All keys, if provided, have to be in the same length</td>
</tr>
<tr>
<td><code>key_idx</code></td>
<td><code>int</code></td>
<td>when type=wep, 1 to 4, default is 1</td>
</tr>
<tr>
<td><code>multi_psk_only</code></td>
<td><code>boolean</code></td>
<td>whether to only use multi_psk, default is false</td>
</tr>
<tr>
<td><code>private_wlan</code></td>
<td><code>boolean</code></td>
<td>whether private wlan is enabled. only applicable to multi_psk mode</td>
</tr>
<tr>
<td><code>enable_mac_auth</code></td>
<td><code>boolean</code></td>
<td>whether to enable MAC Auth, uses the same auth_servers, default is false</td>
</tr>
<tr>
<td><code>eap_reauth</code></td>
<td><code>boolean</code></td>
<td>whether to trigger EAP reauth when the session ends, default is false</td>
</tr>
<tr>
<td><code>roam_mode</code></td>
<td><code>string</code></td>
<td>none (default) / OKC / 11r</td>
</tr>
<tr>
<td><code>apply_to</code></td>
<td><code>string</code></td>
<td>site / wxtags / aps</td>
</tr>
<tr>
<td><code>wxtag_ids</code></td>
<td><code>list</code></td>
<td>list of wxtag_ids</td>
</tr>
<tr>
<td><code>ap_ids</code></td>
<td><code>list</code></td>
<td>list of device ids</td>
</tr>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>which radio the wlan should apply to, both (default) / 24 / 5</td>
</tr>
<tr>
<td><code>bands</code></td>
<td><code>list</code></td>
<td>list of radios that the wlan should apply to. one of more of 24 / 5 / 6. Default is 24 and 5 if not specified.</td>
</tr>
<tr>
<td><code>band_steer</code></td>
<td><code>boolean</code></td>
<td>whether to enable band_steering, this works only when band==both, default is false</td>
</tr>
<tr>
<td><code>band_steer_force_band5</code></td>
<td><code>boolean</code></td>
<td>force dual-band capable client to connect to 5G, default is false</td>
</tr>
<tr>
<td><code>isolation</code></td>
<td><code>boolean</code></td>
<td>whether to stop clients to talk to each other, default is false</td>
</tr>
<tr>
<td><code>l2_isolation</code></td>
<td><code>boolean</code></td>
<td>if isolation is enabled, whether to deny clients to talk to L2 on the LAN, default is false</td>
</tr>
<tr>
<td><code>arp_filter</code></td>
<td><code>boolean</code></td>
<td>whether to enable smart arp filter, default is false</td>
</tr>
<tr>
<td><code>limit_bcast</code></td>
<td><code>boolean</code></td>
<td>whether to limit broadcast packets going to wireless (i.e. only allow certain bcast packets to go through), default is false</td>
</tr>
<tr>
<td><code>allow_mdns</code></td>
<td><code>boolean</code></td>
<td>only applicable when limit_bcast==true, which allows mDNS / Bonjour packets to go through, default is false</td>
</tr>
<tr>
<td><code>allow_ssdp</code></td>
<td><code>boolean</code></td>
<td>only applicable when limit_bcast==true, which allows SSDP, default is false</td>
</tr>
<tr>
<td><code>allow_ipv6_ndp</code></td>
<td><code>boolean</code></td>
<td>only applicable when limit_bcast==true, which allows or disallows ipv6 Neighbor Discovery packets to go through, default is true</td>
</tr>
<tr>
<td><code>no_static_ip</code></td>
<td><code>boolean</code></td>
<td>whether to only allow client that we’ve learned from DHCP exchange to talk, default is false</td>
</tr>
<tr>
<td><code>no_static_dns</code></td>
<td><code>boolean</code></td>
<td>whether to only allow client to use DNS that we’ve learned from DHCP response, default is false</td>
</tr>
<tr>
<td><code>enable_wireless_bridging</code></td>
<td><code>boolean</code></td>
<td>whether to enable wireless bridging, which allows more broadcast packets to go through</td>
</tr>
<tr>
<td><code>limit_probe_response</code></td>
<td><code>boolean</code></td>
<td>limit probe response base on some heuristic rules</td>
</tr>
<tr>
<td><code>block_blacklist_clients</code></td>
<td><code>boolean</code></td>
<td>whether to block the clients in the blacklist (up to first 256 macs)</td>
</tr>
<tr>
<td><code>vlan_enabled</code></td>
<td><code>boolean</code></td>
<td>if vlan tagging is enabled, default is false</td>
</tr>
<tr>
<td><code>vlan_id</code></td>
<td><code>int</code></td>
<td>1-4094</td>
</tr>
<tr>
<td><code>vlan_pooling</code></td>
<td><code>boolean</code></td>
<td>vlan pooling allows AP to place client on different VLAN using a deterministic algorithm, default is false</td>
</tr>
<tr>
<td><code>vlan_ids</code></td>
<td><code>list</code></td>
<td>list of VLAN ids</td>
</tr>
<tr>
<td><code>hide_ssid</code></td>
<td><code>boolean</code></td>
<td>whether to hide SSID in beacon, default is false</td>
</tr>
<tr>
<td><code>schedule</code></td>
<td><code>object</code></td>
<td>WLAN operating schedule, default is disabled</td>
</tr>
<tr>
<td><code>hours</code></td>
<td><code>object</code></td>
<td>time ranges, the key is mon / tue / wed / thu / fri / sat / sun, the value is time range in “HH:MM-HH:MM” (24-hour format), the minimum resolution is 30 minute</td>
</tr>
<tr>
<td><code>max_idletime</code></td>
<td><code>int</code></td>
<td>max idle time in seconds, default is 1800. valid range is 60-86400</td>
</tr>
<tr>
<td><code>sle_excluded</code></td>
<td><code>boolean</code></td>
<td>whether to exclude this WLAN from SLE metrics, default is false</td>
</tr>
<tr>
<td><code>disable_v1_roam_notify</code></td>
<td><code>boolean</code></td>
<td>disable sending v1 roam notification messages</td>
</tr>
<tr>
<td><code>disable_v2_roam_notify</code></td>
<td><code>boolean</code></td>
<td>disable sending v2 roam notification messages</td>
</tr>
</tbody>
</table>
<p>NOTE: specifically, <code>enable_wireless_bridging</code> allows forwarding of DHCP response to client not associated with the AP</p>
<h4 id="radius">RADIUS</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>auth_servers_nas_id</code></td>
<td><code>string</code></td>
<td>optional, up to 48 bytes, will be dynamically generated if not provided. used only for authentication servers</td>
</tr>
<tr>
<td><code>auth_servers_nas_ip</code></td>
<td><code>string</code></td>
<td>optional, NAS-IP-ADDRESS to use</td>
</tr>
<tr>
<td><code>auth_servers_timeout</code></td>
<td><code>int</code></td>
<td>radius auth session timeout, default is 5. Following fast timers are set if “fast_dot1x_timers” knob is enabled. ‘quite-period’ and ‘transmit-period’ are set to half the value of auth_servers_timeout. ‘supplicant-timeout’ is also set when setting auth_servers_timeout and is set to default value of 10.</td>
</tr>
<tr>
<td><code>auth_servers_retries</code></td>
<td><code>int</code></td>
<td>radius auth session retries, default is 2. Following fast timers are set if “fast_dot1x_timers” knob is enabled. ‘retries’ are set to value of auth_servers_retries. ‘max-requests’ is also set when setting auth_servers_retries and is set to default value to 3.</td>
</tr>
<tr>
<td><code>fast_dot1x_timers</code></td>
<td><code>boolean</code></td>
<td>if set to true, sets default fast-timers with values calculated from ‘auth_servers_timeout’ and ‘auth_server_retries’.</td>
</tr>
<tr>
<td><code>acct_immediate_update</code></td>
<td><code>boolean</code></td>
<td>if set to true, it will enable coa-immediate-update and address-change-immediate-update on the access profile.</td>
</tr>
<tr>
<td><code>auth_server_selection</code></td>
<td><code>string</code></td>
<td>ordered (default) / unordered. When ordered, AP will prefer and go back to the first server if possible</td>
</tr>
<tr>
<td><code>auth_servers</code></td>
<td><code>list</code></td>
<td>list of RADIUS authentication servers, at least one is needed if auth type == eap, order matters where the first one is treated as primary</td>
</tr>
<tr>
<td><code>host</code></td>
<td><code>string</code></td>
<td>ip / hostname of RADIUS server</td>
</tr>
<tr>
<td><code>port</code></td>
<td><code>int</code></td>
<td>port of RADIUS server, default is 1812 for auth server and 1813 for acct server</td>
</tr>
<tr>
<td><code>secret</code></td>
<td><code>string</code></td>
<td>secret of RADIUS server</td>
</tr>
<tr>
<td><code>acct_servers</code></td>
<td><code>list</code></td>
<td>list of RADIUS accounting servers, optional, order matters where the first one is treated as primary</td>
</tr>
<tr>
<td><code>acct_interim_interval</code></td>
<td><code>int</code></td>
<td>how frequently should interim accounting be reported, 60-65535. default is 0 (use one specified in Access-Accept request from RADIUS Server). Very frequent messages can affect the performance of the radius server, 600 and up is recommended when enabled</td>
</tr>
<tr>
<td><code>coa_servers</code></td>
<td><code>list</code></td>
<td>list of COA (change of authorization) servers, optional</td>
</tr>
<tr>
<td><code>disable_event_timestamp_check</code></td>
<td><code>boolean</code></td>
<td>whether to disable Event-Timestamp Check, which is used to replay-protection, default is false (i.e. for better security)</td>
</tr>
<tr>
<td><code>dynamic_vlan</code></td>
<td><code>object</code></td>
<td>for 802.1x</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether to enable dynamic vlan, default is false</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>standard (using Tunnel-Private-Group-ID, widely supported), airespace-interface-name (Airespace/Cisco)</td>
</tr>
<tr>
<td><code>vlans</code></td>
<td><code>object</code></td>
<td>map between vlan_id (as string) to airespace interface names (comma-separated) or null for stndard mapping</td>
</tr>
<tr>
<td><code>default_vlan_id</code></td>
<td><code>int</code></td>
<td>vlan_id to use when there’s no match from RADIUS, default is 999</td>
</tr>
<tr>
<td><code>default_vlan_ids</code></td>
<td><code>list</code></td>
<td>vlan_ids to use when there’s no match from RADIUS, default is [“999”]</td>
</tr>
<tr>
<td><code>local_vlan_ids</code></td>
<td><code>list</code></td>
<td>vlan_ids to be locally bridged</td>
</tr>
<tr>
<td><code>radsec</code></td>
<td><code>object</code></td>
<td>RadSec related, once enabled, auth_servers / acct_servers / coa_servers will be ignored</td>
</tr>
<tr>
<td><code>server_name</code></td>
<td><code>string</code></td>
<td>name of the server to verify (against the cacerts in Org Setting)</td>
</tr>
<tr>
<td><code>use_mxedge</code></td>
<td><code>string</code></td>
<td>mxedge can be used as radsecproxy, see <a href="https://api.mist.com/api/v1/docs/Org#mist-edge-cluster">Mist Edge Cluster</a> and <a href="https://api.mist.com/api/v1/docs/Site#site-setting">Site Setting</a></td>
</tr>
<tr>
<td><code>dns_server_rewrite</code></td>
<td><code>object</code></td>
<td>for radius_group-based DNS server (rewrite DNS request depending on the Group RADIUS server returns)</td>
</tr>
<tr>
<td><code>radius_groups</code></td>
<td><code>object</code></td>
<td>map between radius_group and the desired DNS server (IPv4 only)</td>
</tr>
<tr>
<td><code>dynamic_psk</code></td>
<td><code>object</code></td>
<td>for dynamic PSK where we get per-user PSK from Radius / Cloud WLC</td>
</tr>
<tr>
<td><code>default_psk</code></td>
<td><code>string</code></td>
<td>default PSK to use if cloud WLC is not available, 8-63 characters</td>
</tr>
</tbody>
</table>
<h4 id="airwatch">AirWatch</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>airwatch</code></td>
<td><code>object</code></td>
<td>Airwatch related</td>
</tr>
<tr>
<td><code>console_url</code></td>
<td><code>string</code></td>
<td>console URL</td>
</tr>
<tr>
<td><code>api_key</code></td>
<td><code>string</code></td>
<td>API Key</td>
</tr>
<tr>
<td><code>username</code></td>
<td><code>string</code></td>
<td>username</td>
</tr>
<tr>
<td><code>password</code></td>
<td><code>string</code></td>
<td>password</td>
</tr>
</tbody>
</table>
<h4 id="cisco-cwa">Cisco CWA</h4>
<p>Cisco CWA (central web authentication) required RADIUS with COA in order to work.
See <a href="https://www.cisco.com/c/en/us/support/docs/security/identity-services-engine/115732-central-web-auth-00.html">CWA</a>
for more details.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>cisco_cwa</code></td>
<td><code>object</code></td>
<td>Cisco CWA Related</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether to enable CWA,</td>
</tr>
<tr>
<td><code>allowed_subnets</code></td>
<td><code>list</code></td>
<td>list of CIDRs</td>
</tr>
<tr>
<td><code>blocked_subnets</code></td>
<td><code>list</code></td>
<td>list of blocked CIDRs</td>
</tr>
<tr>
<td><code>allowed_hostnames</code></td>
<td><code>list</code></td>
<td>list of hostnames without http(s):// (matched by substring)</td>
</tr>
</tbody>
</table>
<h4 id="qos">QoS</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>overwrite</code></td>
<td><code>boolean</code></td>
<td>whether to overwrite QoS</td>
</tr>
<tr>
<td><code>class</code></td>
<td><code>string</code></td>
<td>background / best_effort (default) / video / voice</td>
</tr>
</tbody>
</table>
<h4 id="bonjour">Bonjour</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>bonjour</code></td>
<td><code>object</code></td>
<td>bonjour-related</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether to enable bonjour for this WLAN, default is false. Once enabled, <code>limit_bcast</code> is assumed true, <code>allow_mdns</code> is assumed false</td>
</tr>
<tr>
<td><code>services</code></td>
<td><code>object</code></td>
<td>what services are allowed</td>
</tr>
<tr>
<td><code>scope</code></td>
<td><code>string</code></td>
<td>how bonjour services should be discovered for the same WLAN, same_site (default) / same_map / same_ap</td>
</tr>
<tr>
<td><code>disable_local</code></td>
<td><code>boolean</code></td>
<td>whether to prevent wireless clients to discover bonjour devices on the same WLAN, default is false</td>
</tr>
<tr>
<td><code>radius_groups</code></td>
<td><code>list</code></td>
<td>optional, if the service is further restricted for certain RADIUS groups</td>
</tr>
<tr>
<td><code>additional_vlan_ids</code></td>
<td><code>list</code></td>
<td>additional VLAN IDs (on the LAN side or from other WLANs) should we be forwarding bonjour queries/responses</td>
</tr>
</tbody>
</table>
<p>Note: bonjour settings supercedes <code>allow_mdns</code></p>
<h4 id="data-tunnel">Data Tunnel</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>interface</code></td>
<td><code>string</code></td>
<td>where this WLAN will be connected to. all (all external ports, default) / eth0 / eth1 / eth2 / eth3 / wxtunnel / mxtunnel / site_mxedge</td>
</tr>
<tr>
<td><code>wxtunnel_id</code></td>
<td><code>string</code></td>
<td>when interface=wxtunnel, id of the WXLAN Tunnel</td>
</tr>
<tr>
<td><code>wxtunnel_remote_id</code></td>
<td><code>string</code></td>
<td>when interface=wxtunnel, remote tunnel identifier</td>
</tr>
<tr>
<td><code>mxtunnel_id</code></td>
<td><code>string</code></td>
<td>(deprecated, use <code>mxtunnel_ids</code> instead) when interface=mxtunnel, id of the Mist Tunnel</td>
</tr>
<tr>
<td><code>mxtunnel_ids</code></td>
<td><code>list</code></td>
<td>when interface=mxtunnel, ids of the Mist Tunnels</td>
</tr>
<tr>
<td><code>mxtunnel_name</code></td>
<td><code>string</code></td>
<td>when interface=site_medge, name of the mxtunnel that in <code>mxtunnels</code> under Site Setting, default is <code>default</code></td>
</tr>
<tr>
<td><code>mxtunnel</code></td>
<td><code>object</code></td>
<td>when interface=site_medge, the definition of the Mist Tunnels (key is the name)</td>
</tr>
</tbody>
</table>
<h4 id="others">Others</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dtim</code></td>
<td><code>int</code></td>
<td>dtim, default is 2</td>
</tr>
<tr>
<td><code>disable_wmm</code></td>
<td><code>boolean</code></td>
<td>whether to disable WMM, default is false</td>
</tr>
<tr>
<td><code>disable_uapsd</code></td>
<td><code>boolean</code></td>
<td>whether to disable U-APSD, default is false</td>
</tr>
<tr>
<td><code>use_eapol_v1</code></td>
<td><code>boolean</code></td>
<td>if auth.type==’eap’ or ‘psk’, should only be set for legacy client, such as pre-2004, 802.11b devices</td>
</tr>
<tr>
<td><code>legacy_overds</code></td>
<td><code>boolean</code></td>
<td>legacy devices requires the Over-DS (for Fast BSS Transition) bit set (while our chip doesn’t support it). Warning! Enabling this will cause problem for iOS devices.</td>
</tr>
<tr>
<td><code>hostname_ie</code></td>
<td><code>boolean</code></td>
<td>include hostname inside IE in AP beacons / probe responses, default is false</td>
</tr>
<tr>
<td><code>enable_local_keycaching</code></td>
<td><code>boolean</code></td>
<td>enable AP-AP keycaching via multicast, default is false</td>
</tr>
</tbody>
</table>
<h4 id="date-rates">Date Rates</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>rateset</code></td>
<td><code>object</code></td>
<td>rateset (data rates to support)</td>
</tr>
<tr>
<td><code>min_rssi</code></td>
<td><code>int</code></td>
<td>Minimum RSSI for client to connect, 0 means not enforcing</td>
</tr>
<tr>
<td><code>template</code></td>
<td><code>string</code></td>
<td>no-legacy (basically no 11b and only supports 6 or 12 and up for 11a/g) / compatible (allow more, the default for now) / high-density (only 11n and 11ac) / custom / legacy-only (disable HT/VHT IEs)</td>
</tr>
<tr>
<td><code>legacy</code></td>
<td><code>list</code></td>
<td>list of supported rates (IE=1) and extended supported rates (IE=50) for custom template, append ‘b’ at the end to indicate a rate being basic/mandatory. If template=custom is configured and legacy does not define at least one basic rate, it will use no-legacy default values</td>
</tr>
<tr>
<td><code>ht</code></td>
<td><code>string</code></td>
<td>MCS bitmasks for 4 streams (16-bit for each stream, MCS0 is least significant bit), e.g. <code>00ff 00f0 001f</code> limits HT rates to MCS 0-7 for 1 stream, MCS 4-7 for 2 stream (i.e. MCS 12-15), MCS 1-5 for 3 stream (i.e. MCS 16-20)</td>
</tr>
<tr>
<td><code>vht</code></td>
<td><code>string</code></td>
<td>MCS bitmasks for 4 streams (16-bit for each stream, MCS0 is least significant bit), e.g. <code>03ff 01ff 00ff</code> limits VHT rates to MCS 0-9 for 1 stream, MCS 0-8 for 2 streams, and MCS 0-7 for 3 streams.</td>
</tr>
<tr>
<td><code>he</code></td>
<td><code>string</code></td>
<td>HE MCS bitmasks for 4 streams (16-bit for each stream, MCS0 is least significant bit)</td>
</tr>
<tr>
<td><code>eht</code></td>
<td><code>string</code></td>
<td>EHT MCS bitmasks for 4 streams (16-bit for each stream, MCS0 is least significant bit)</td>
</tr>
<tr>
<td><code>disable_11be</code></td>
<td><code>boolean</code></td>
<td>disable Wi-Fi 7 EHT IEs, default is false</td>
</tr>
<tr>
<td><code>disable_11ax</code></td>
<td><code>boolean</code></td>
<td>some old WLAN drivers may not be compatible , default is false</td>
</tr>
<tr>
<td><code>disable_ht_vht_rates</code></td>
<td><code>object</code></td>
<td>disable ht or vht rates</td>
</tr>
</tbody>
</table>
<h4 id="rate-limit">Rate Limit</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>wlan_limit_up_enabled</code></td>
<td><code>boolean</code></td>
<td>if uplink limiting for whole wlan is enabled, default is false</td>
</tr>
<tr>
<td><code>wlan_limit_up</code></td>
<td><code>int</code></td>
<td>kbps</td>
</tr>
<tr>
<td><code>wlan_limit_down_enabled</code></td>
<td><code>boolean</code></td>
<td>if downlink limiting for whole wlan is enabled, default is false</td>
</tr>
<tr>
<td><code>wlan_limit_down</code></td>
<td><code>int</code></td>
<td>kbps</td>
</tr>
<tr>
<td><code>client_limit_up_enabled</code></td>
<td><code>boolean</code></td>
<td>if uplink limiting per-client is enabled, default is false</td>
</tr>
<tr>
<td><code>client_limit_up</code></td>
<td><code>int</code></td>
<td>kbps</td>
</tr>
<tr>
<td><code>client_limit_down_enabled</code></td>
<td><code>boolean</code></td>
<td>if downlink limiting per-client is enabled, default is false</td>
</tr>
<tr>
<td><code>client_limit_down</code></td>
<td><code>int</code></td>
<td>kbps</td>
</tr>
<tr>
<td><code>app_limit</code></td>
<td><code>object</code></td>
<td>bandwidth limiting for apps (applies to up/down)</td>
</tr>
<tr>
<td><code>apps</code></td>
<td><code>object</code></td>
<td>map from app key to bandwidth in kbps. app key defined in <a href="https://api.mist.com/api/v1/docs/Site#get-application-list">Get Application List</a></td>
</tr>
<tr>
<td><code>wxtag_ids</code></td>
<td><code>object</code></td>
<td>map from wxtag_id of Hostname Wxlan Tags to bandwidth in kbps</td>
</tr>
</tbody>
</table>
<h4 id="hotspot-20">Hotspot 2.0</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>hotspot20</code></td>
<td><code>object</code></td>
<td>hotspot 2.0</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether to enable hotspot 2.0 config</td>
</tr>
<tr>
<td><code>operators</code></td>
<td><code>list</code></td>
<td>list of operators to support, options: att, google, tmobile, charter, boingo, hughes_systique, single_digits, global_reach</td>
</tr>
<tr>
<td><code>venue_name</code></td>
<td><code>string</code></td>
<td>venue name, default is site name</td>
</tr>
<tr>
<td><code>domain_name</code></td>
<td><code>list</code></td>
<td>list of domain names to overwrite default template, optional</td>
</tr>
<tr>
<td><code>rcoi</code></td>
<td><code>list</code></td>
<td>list of roaming consortium to overwrite default template, optional</td>
</tr>
<tr>
<td><code>nai_realms</code></td>
<td><code>list</code></td>
<td>list of NAI Realm to overwrite default template, optional, eap_type options: tls, aka, ttls</td>
</tr>
</tbody>
</table>
<h4 id="guest-portal">Guest Portal</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>portal</code></td>
<td><code>object</code></td>
<td>portal-related configurations</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether guest portal is enabled, default is false</td>
</tr>
<tr>
<td><code>auth</code></td>
<td><code>string</code></td>
<td>authentication scheme, none (default, supporting multi auth) / external (external portal) / sso</td>
</tr>
<tr>
<td><code>forward</code></td>
<td><code>boolean</code></td>
<td>whether to forward the user to another URL after authorized, default is false, this takes precedence</td>
</tr>
<tr>
<td><code>forward_url</code></td>
<td><code>string</code></td>
<td>the URL to forward the user to</td>
</tr>
<tr>
<td><code>external_portal_url</code></td>
<td><code>string</code></td>
<td>external portal URL (e.g. https://host/url) where we can append our query parameters to</td>
</tr>
<tr>
<td><code>privacy</code></td>
<td><code>boolean</code></td>
<td>if enabled, personal information will not be stored (email, name, fields*), default is false</td>
</tr>
<tr>
<td><code>password</code></td>
<td><code>string</code></td>
<td>passphrase</td>
</tr>
<tr>
<td><code>passphrase_expire</code></td>
<td><code>long</code></td>
<td>interval for which guest remains authorized using passphrase auth (in minutes), default is <code>none</code>, if not provided, uses <code>expire</code></td>
</tr>
<tr>
<td><code>sms_enabled</code></td>
<td><code>boolean</code></td>
<td>when auth=multi, whether sms is enabled</td>
</tr>
<tr>
<td><code>sms_expire</code></td>
<td><code>long</code></td>
<td>interval for which guest remains authorized using sms auth (in minutes), default is <code>none</code>, if not provided, uses <code>expire</code></td>
</tr>
<tr>
<td><code>passphrase_enabled</code></td>
<td><code>boolean</code></td>
<td>whether password is enabled</td>
</tr>
<tr>
<td><code>facebook_enabled</code></td>
<td><code>boolean</code></td>
<td>whether facebook is enabled as a login method</td>
</tr>
<tr>
<td><code>facebook_client_id</code></td>
<td><code>string</code></td>
<td>facebook OAuth2 app id. This is mandatory, if <code>facebook_enabled</code> is true</td>
</tr>
<tr>
<td><code>facebook_client_secret</code></td>
<td><code>string</code></td>
<td>facebook OAuth2 app secret. This is mandatory, if <code>facebook_enabled</code> is true</td>
</tr>
<tr>
<td><code>facebook_email_domains</code></td>
<td><code>list</code></td>
<td>Matches authenticated user email against provided domains. If null or [], all authenticated emails will be allowed.</td>
</tr>
<tr>
<td><code>facebook_expire</code></td>
<td><code>long</code></td>
<td>interval for which guest remains authorized using facebook auth (in minutes), default is <code>none</code>, if not provided, uses <code>expire</code></td>
</tr>
<tr>
<td><code>google_enabled</code></td>
<td><code>boolean</code></td>
<td>whether google is enabled as login method</td>
</tr>
<tr>
<td><code>google_email_domains</code></td>
<td><code>list</code></td>
<td>Matches authenticated user email against provided domains. If null or [], all authenticated emails will be allowed.</td>
</tr>
<tr>
<td><code>google_expire</code></td>
<td><code>long</code></td>
<td>interval for which guest remains authorized using google auth (in minutes), default is <code>none</code>, if not provided, uses <code>expire</code></td>
</tr>
<tr>
<td><code>amazon_enabled</code></td>
<td><code>boolean</code></td>
<td>whether amazon is enabled as a login method</td>
</tr>
<tr>
<td><code>amazon_client_id</code></td>
<td><code>string</code></td>
<td>amazon OAuth2 client id. This is optional. If not provided, it will use a default one.</td>
</tr>
<tr>
<td><code>amazon_client_secret</code></td>
<td><code>string</code></td>
<td>amazon OAuth2 client secret. If <code>amazon_client_id</code> was provided, provide a correspoinding value. Else leave blank.</td>
</tr>
<tr>
<td><code>amazon_email_domains</code></td>
<td><code>list</code></td>
<td>Matches authenticated user email against provided domains. If null or [], all authenticated emails will be allowed.</td>
</tr>
<tr>
<td><code>amazon_expire</code></td>
<td><code>long</code></td>
<td>interval for which guest remains authorized using amazon auth (in minutes), default is <code>none</code>, if not provided, uses <code>expire</code></td>
</tr>
<tr>
<td><code>microsoft_enabled</code></td>
<td><code>boolean</code></td>
<td>whether microsoft 365 is enabled as a login method</td>
</tr>
<tr>
<td><code>microsoft_client_id</code></td>
<td><code>string</code></td>
<td>microsoft 365 OAuth2 client id. This is optional. If not provided, it will use a default one.</td>
</tr>
<tr>
<td><code>microsoft_client_secret</code></td>
<td><code>string</code></td>
<td>microsoft 365 OAuth2 client secret. If <code>microsoft_client_id</code> was provided, provide a correspoinding value. Else leave blank.</td>
</tr>
<tr>
<td><code>microsoft_email_domains</code></td>
<td><code>list</code></td>
<td>Matches authenticated user email against provided domains. If null or [], all authenticated emails will be allowed.</td>
</tr>
<tr>
<td><code>microsoft_expire</code></td>
<td><code>long</code></td>
<td>interval for which guest remains authorized using microsoft auth (in minutes), default is <code>none</code>, if not provided, uses <code>expire</code></td>
</tr>
<tr>
<td><code>azure_enabled</code></td>
<td><code>boolean</code></td>
<td>whether <code>Azure Active Directory</code> is enabled as a login method</td>
</tr>
<tr>
<td><code>azure_tenant_id</code></td>
<td><code>string</code></td>
<td>azure active directory tenant id. This is mandatory if <code>azure_enabled</code> is true.</td>
</tr>
<tr>
<td><code>azure_client_id</code></td>
<td><code>string</code></td>
<td>azure active directory app client id.This is mandatory if <code>azure_enabled</code> is true.</td>
</tr>
<tr>
<td><code>azure_client_secret</code></td>
<td><code>string</code></td>
<td>azure active directory app client secret. This is mandatory if azure_enabled is true.</td>
</tr>
<tr>
<td><code>azure_expire</code></td>
<td><code>long</code></td>
<td>interval for which guest remains authorized using azure auth (in minutes), default is <code>none</code>, if not provided, uses <code>expire</code></td>
</tr>
<tr>
<td><code>sms_enabled</code></td>
<td><code>boolean</code></td>
<td>whether sms is enabled as a login method</td>
</tr>
<tr>
<td><code>email_enabled</code></td>
<td><code>boolean</code></td>
<td>whether email (access code verification) is enabled as a login method</td>
</tr>
<tr>
<td><code>email_expire</code></td>
<td><code>long</code></td>
<td>interval for which guest remains authorized using email auth (in minutes), default is <code>none</code>, if not provided, uses <code>expire</code></td>
</tr>
<tr>
<td><code>sms_provider</code></td>
<td><code>string</code></td>
<td>how the sms is routed. choices are <code>manual</code>, <code>twilio</code>,<code>broadnet</code>,<code>clickatell</code>, <code>puzzel</code>, <code>gupshup</code>, <code>telstra</code>, <code>smsglobal</code>. default is <code>manual</code>, where user has to select carrier.</td>
</tr>
<tr>
<td><code>twilio_sid</code></td>
<td><code>string</code></td>
<td>Account SID provided by Twilio</td>
</tr>
<tr>
<td><code>twilio_auth_token</code></td>
<td><code>string</code></td>
<td>Auth token account with twilio account</td>
</tr>
<tr>
<td><code>twilio_phone_number</code></td>
<td><code>string</code></td>
<td>Twilio phone number associated with the account. See example for accepted format.</td>
</tr>
<tr>
<td><code>broadnet_user_id</code></td>
<td><code>string</code></td>
<td>User name supplied by BroadNet</td>
</tr>
<tr>
<td><code>broadnet_password</code></td>
<td><code>string</code></td>
<td>Password supplied by BroadNet</td>
</tr>
<tr>
<td><code>broadnet_sid</code></td>
<td><code>string</code></td>
<td>Sender Id for BroadNet (default is ‘MIST’)</td>
</tr>
<tr>
<td><code>clickatell_api_key</code></td>
<td><code>string</code></td>
<td>API key provided by Clickatell</td>
</tr>
<tr>
<td><code>puzzel_service_id</code></td>
<td><code>string</code></td>
<td>Service ID provided by Puzzel</td>
</tr>
<tr>
<td><code>puzzel_username</code></td>
<td><code>string</code></td>
<td>Username provided by Puzzel</td>
</tr>
<tr>
<td><code>puzzel_password</code></td>
<td><code>string</code></td>
<td>Password provided by Puzzel</td>
</tr>
<tr>
<td><code>gupshup_userid</code></td>
<td><code>string</code></td>
<td>User id provided by Gupshup</td>
</tr>
<tr>
<td><code>gupshup_password</code></td>
<td><code>string</code></td>
<td>Password provided by Gupshup</td>
</tr>
<tr>
<td><code>telstra_client_id</code></td>
<td><code>string</code></td>
<td>Client ID provided by Telstra</td>
</tr>
<tr>
<td><code>telstra_client_secret</code></td>
<td><code>string</code></td>
<td>Client secret provided by Telstra</td>
</tr>
<tr>
<td><code>smsglobal_api_key</code></td>
<td><code>string</code></td>
<td>Api key provided by SMSGlobal</td>
</tr>
<tr>
<td><code>smsglobal_api_secret</code></td>
<td><code>string</code></td>
<td>Api secret provided by SMSGlobal</td>
</tr>
<tr>
<td><code>expire</code></td>
<td><code>long</code></td>
<td>how long to remain authorized, in minutes, default is 1440 (24 hours)</td>
</tr>
<tr>
<td><code>sponsor_enabled</code></td>
<td><code>boolean</code></td>
<td>whether sponsor is enabled</td>
</tr>
<tr>
<td><code>sponsor_email_domains</code></td>
<td><code>list</code></td>
<td>list of domain allowed for sponsor email. Required if <code>sponsor_enabled</code> is true and <code>sponsors</code> is empty.</td>
</tr>
<tr>
<td><code>sponsors</code></td>
<td><code>object</code></td>
<td>object of allowed sponsors email with name. Required if <code>sponsor_enabled</code> is true and <code>sponsor_email_domains</code> is empty.</td>
</tr>
<tr>
<td><code>sponsor_link_validity_duration</code></td>
<td><code>int</code></td>
<td>how long to remain valid sponsored guest request approve/deny link received in email, in minutes, default is 60 minutes, min is 5 minutes and max is 60 minutes.</td>
</tr>
<tr>
<td><code>sponsor_notify_all</code></td>
<td><code>boolean</code></td>
<td>whether to notify all sponsors that are mentioned in <code>sponsors</code> object. Both <code>sponsor_notify_all</code> and <code>predefined_sponsors_enabled</code> should be true in order to notify sponsors. If true, email sent to 10 sponsors in no particular order.</td>
</tr>
<tr>
<td><code>predefined_sponsors_enabled</code></td>
<td><code>boolean</code></td>
<td>whether to show list of sponsor emails mentioned in <code>sponsors</code> object as a dropdown. If both <code>sponsor_notify_all</code> and <code>predefined_sponsors_enabled</code> are false, behaviour is acc to <code>sponsor_email_domains</code></td>
</tr>
<tr>
<td><code>sponsor_auto_approve</code></td>
<td><code>boolean</code></td>
<td>whether to automatically approve guest and allow sponsor to revoke guest access, needs <code>predefined_sponsors_enabled</code> enabled and <code>sponsor_notify_all</code> disabled</td>
</tr>
<tr>
<td><code>predefined_sponsors_hide_email</code></td>
<td><code>boolean</code></td>
<td>whether to hide sponsor’s email from list of sponsors, default is <code>false</code></td>
</tr>
<tr>
<td><code>sponsor_status_notify</code></td>
<td><code>boolean</code></td>
<td>whether to notify guest about sponsor’s status via email</td>
</tr>
<tr>
<td><code>sponsor_expire</code></td>
<td><code>long</code></td>
<td>interval for which guest remains authorized using sponsor auth (in minutes), default is <code>none</code>, if not provided, uses <code>expire</code></td>
</tr>
<tr>
<td><code>portal_api_secret</code></td>
<td><code>string</code></td>
<td>api secret (auto-generated) that can be used to sign guest authorization requests</td>
</tr>
<tr>
<td><code>portal_image</code></td>
<td><code>string</code></td>
<td>Url of portal background image</td>
</tr>
<tr>
<td><code>thumbnail</code></td>
<td><code>string</code></td>
<td>Url of portal background image thumbnail</td>
</tr>
<tr>
<td><code>portal_allowed_subnets</code></td>
<td><code>list</code></td>
<td>list of CIDRs</td>
</tr>
<tr>
<td><code>portal_allowed_hostnames</code></td>
<td><code>list</code></td>
<td>list of hostnames without http(s):// (matched by substring)</td>
</tr>
<tr>
<td><code>portal_denied_hostnames</code></td>
<td><code>list</code></td>
<td>list of hostnames without http(s):// (matched by substring), this takes precedence over <code>portal_allowed_hostnames</code></td>
</tr>
<tr>
<td><code>bypass_when_cloud_down</code></td>
<td><code>boolean</code></td>
<td>whether to bypass the guest portal when cloud not reachable (and apply the default policies), default is false</td>
</tr>
<tr>
<td><code>sso_issuer</code></td>
<td><code>string</code></td>
<td>IDP issuer URL</td>
</tr>
<tr>
<td><code>sso_idp_cert</code></td>
<td><code>string</code></td>
<td>IDP Cert (used to verify the signed response)</td>
</tr>
<tr>
<td><code>sso_idp_sso_url</code></td>
<td><code>string</code></td>
<td>IDP Single-Sign-On URL</td>
</tr>
<tr>
<td><code>sso_idp_sign_algo</code></td>
<td><code>string</code></td>
<td>signing algorithm for SAML Assertion</td>
</tr>
<tr>
<td><code>sso_nameid_format</code></td>
<td><code>string</code></td>
<td>email (default) / unspecified</td>
</tr>
<tr>
<td><code>sso_default_role</code></td>
<td><code>string</code></td>
<td>default role to assign if there’s no match. By default, an assertion is treated as invalid when there’s no role matched</td>
</tr>
<tr>
<td><code>portal_sso_url</code></td>
<td><code>string</code></td>
<td>for SAML, this is used as the ACS URL</td>
</tr>
<tr>
<td><code>cross_site</code></td>
<td><code>boolean</code></td>
<td>whether to allow guest to roam between WLANs (with same <code>WLAN.ssid</code>, regardless of variables) of different sites of same org without reauthentication. default is false. (disable random_mac for seamless roaming)</td>
</tr>
</tbody>
</table>
<h2 id="wlan-portal-image-upload">Wlan Portal Image Upload</h2>
<p>Upload background image for Portal</p>
<pre><code>POST /api/v1/sites/:site_id/wlans/:wlan_id/portal_image
</code></pre>
<h3 id="request">Request</h3>
<p>A multi-part POST</p>
<pre><code>"json": a JSON string describing your upload
"file": a binary file
</code></pre>
<h2 id="wlan-portal-image-delete">Wlan Portal Image Delete</h2>
<p>Delete background image for Portal</p>
<pre><code>DELETE /api/v1/sites/:site_id/wlans/:wlan_id/portal_image
</code></pre>
<p>If image is not uploaded or is deleted, portal will use default image.</p>
<h2 id="wlan-portal-template">Wlan Portal Template</h2>
<p>Portal template will be separated from Wlan object and storage of portal_template object in Wlan object will soon be
deprecated</p>
<pre><code>PUT /api/v1/sites/:site_id/wlans/:wlan_id/portal_template
</code></pre>
<h3 id="request_1">Request</h3>
<pre><code>{
    "pageTitle": "Welcome",
    "message": "Please enjoy the complimentary Wifi",
    "authLabel": "Connect to WIFI with",
    "color": "#1074bc",
    "colorDark": "#0b5183",
    "colorLight": "#3589c6",
    "alignment": "left",

    "passphraseCancel": "Cancel",
    "passphraseLabel": "Passphrase",
    "passphraseError": "Invalid Passphrase",
    "passphraseMessage": "Enter the secret passphrase to access the WiFi network.",
    "passphraseSubmit": "Sign In",
    "passphraseTitle": "Sign in with Passphrase",

    "tos": true,
    "tosText": "terms of service",
    "tosAcceptLabel": "I accept the Terms of Service",
    "tosLink": "Terms of Service",
    "backLink": "Back to Sign In",
    "tosError": "Please review and accept terms of service",

    "optout": false,
    "optoutDefault": true,
    "optoutLabel": "Do not store"

    "email": true,
    "emailLabel": "Email",
    "emailError": "Please provide valid email",

    "emailCodeCancel": "I did not receive the code",
    "emailCodeFieldLabel": "Access Code",
    "emailCodeMessage": "Enter the access number that was sent to your email address.",
    "emailCodeSubmit": "Sign In",
    "emailCodeTitle": "Access Code",

    "name": true,
    "nameLabel": "Name",
    "nameError": "Please provide your name",

    "company": true,
    "companyLabel": "Company",
    "companyError": "Please provide company name",

    "field1": true,
    "field1Label": "Custom1",
    "field1Required": true,
    "field1Error": "Please provide field1",
    "field2": true,
    "field2Label": "Custom1",
    "field2Required": false,
    "field2Error": "Please provide field2",
    "field3": true,
    "field3Label": "Custom1",
    "field3Required": false,
    "field3Error": "Please provide field3",
    "field4": true,
    "field4Label": "Custom1",
    "field4Required": false,
    "field4Error": "Please provide field4",

    "requiredFieldLabel": "required",

    "signInLabel": "Sign In",

    "poweredBy": true,

    "authButtonAmazon": "Sign in with Amazon",
    "authButtonAzure": "Sign in with Azure",
    "authButtonEmail": "Sign in with Email",
    "authButtonMicrosoft": "Sign in with Microsoft",
    "authButtonPassphrase": "Sign in with Passphrase",
    "authButtonGoogle": "Sign in with Google",
    "authButtonFacebook" : "Sign in with Facebook",
    "authButtonSms": "Sign in with Text Message",

    "emailAccessDomainError": "Access is restricted by email domain",

    "smsNumberFieldLabel": "Mobile Number",
    "smsCarrierFieldLabel": "Mobile Carrier",
    "smsCarrierDefault": "Please Select",
    "smsCarrierError": "Please select a mobile carrier",
    "smsNumberSubmit": "Sign In",
    "smsNumberCancel": "Cancel",
    "smsNumberTitle": "Text Message Confirmation",
    "smsCodeMessage": "Enter the confirmation code",
    "smsCodeFieldLabel": "Confirmation Code",
    "smsCodeSubmit": "Sumbit Code",
    "smsCodeCancel": "Cancel",
    "smsCodeError": "Invalid Access Code",
    "smsCodeTitle": "Access Code",
    "smsCountryFieldLabel": "Country Code",
    "smsCountryFormat": "+1",
    "smsHaveAccessCode": "I have an access code",
    "smsValidityDuration": 5,
    "smsMessageFormat": "Code {{code}} expires in {{duration}} minutes.",
    "smsNumberError": "Invalid Mobile Number",
    "smsNumberFormat": "2125551212 (digits only)",
    "smsNumberMessage": "We will send an access code to your mobile number which you can use to "
                            "connect to the WiFi network. Message and data rates may apply.",
    "smsUsernameFormat": "username",
    "emailTitle": "Sign in with Email",
    "emailMessage": "We will email you an authentication code which you can use to connect to the WiFi network.",
    "accessCodeAlternateEmail": "Use alternate email address",
    "emailFieldLabel": "Enter your email address" ,
    "emailSubmit": "Send Access Code",
    "emailCancel": "Cancel",
    "emailCodeError": "Please provide valid alternate email",

    "authButtonSponsor": "Sign in as Guest",
    "sponsorEmailError": "Please provide valid sponsor email",
    "sponsorNameError": "Please provide sponsor name",
    "sponsorBackLink": "Go back and edit request form",
    "sponsorCancel": "Cancel",
    "sponsorEmail": "Sponsor Email",
    "sponsorName": "Sponsor Name",
    "sponsorInfoApproved": "Your request was approved by",
    "sponsorInfoDenied": "Your request was denied by",
    "sponsorInfoPending": "Your notification has been sent to",
    "sponsorsInfoApproved": "Your request was approved,
    'sponsorsInfoDenied': 'Your request was denied',
    'sponsorsInfoPending': 'Your notification has been sent to the sponsors',
    "sponsorNotePending": "Please wait for them to acknowledge.",
    "sponsorRequestAccess": "Request Wifi Access",
    "sponsorSelectEmail": "Select Sponsor",
    'sponsorsError': 'Please select a sponsor',
    "sponsorStatusApproved": "Your request was approved",
    "sponsorStatusDenied": "Your request was denied",
    "sponsorStatusPending": "Notification Sent",
    'sponsorAutoApproved': 'Your request was approved.',
    'sponsorAutoApprovedNote': "Your notification has been sent to",
    'sponsorsAutoApprovedNote': "Your notification has been sent to the sponsors.",
    "sponsorSubmit": "Notify Sponsor",


    // Email Customization
    "sponsorEmailTemplate": "&lt;html template to replace/override default sponsor email template&gt;",

    "privacyPolicy": false,
    "privacyPolicyText": "privacy notice content",
    "privacyPolicyAcceptLabel": "I accept the Privacy Notice",
    "privacyPolicyLink": "Privacy Notice",
    "privacyPolicyError": "Please review and accept privacy notice",
    "marketingPolicyOptIn": false,
    "marketingPolicyOptInText": "Marketing policy content",
    "marketingPolicyOptInLabel": "I wish to receive Marketing notifications",
    "marketingPolicyLink": "Marketing Policy"
}
</code></pre>
<h3 id="parameters_1">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pageTitle</code></td>
<td><code>string</code></td>
<td>“Welcome”</td>
</tr>
<tr>
<td><code>message</code></td>
<td><code>string</code></td>
<td>“Please enjoy the complimentary Wifi”</td>
</tr>
<tr>
<td><code>color</code></td>
<td><code>string</code></td>
<td>“#1074bc”</td>
</tr>
<tr>
<td><code>colorDark</code></td>
<td><code>string</code></td>
<td>“#0b5183”</td>
</tr>
<tr>
<td><code>colorLight</code></td>
<td><code>string</code></td>
<td>“#3589c6”</td>
</tr>
<tr>
<td><code>alignment</code></td>
<td><code>string</code></td>
<td>defines alignment on portal. “left” is default.</td>
</tr>
<tr>
<td><code>passphraseLabel</code></td>
<td><code>string</code></td>
<td>Passphrase</td>
</tr>
<tr>
<td><code>passphraseError</code></td>
<td><code>string</code></td>
<td>error message when invalid passphrase is provided</td>
</tr>
<tr>
<td><code>tos</code></td>
<td><code>boolean</code></td>
<td>default is true</td>
</tr>
<tr>
<td><code>tosText</code></td>
<td><code>string</code></td>
<td>text of the Terms of Service</td>
</tr>
<tr>
<td><code>tosAcceptLabel</code></td>
<td><code>string</code></td>
<td>prefix of the label of the link to go to /tos</td>
</tr>
<tr>
<td><code>tosLink</code></td>
<td><code>string</code></td>
<td>label of the link to go to /tos</td>
</tr>
<tr>
<td><code>tosError</code></td>
<td><code>string</code></td>
<td>error message when tos not accepted</td>
</tr>
<tr>
<td><code>backLink</code></td>
<td><code>string</code></td>
<td>label of the link to go back to /logon</td>
</tr>
<tr>
<td><code>signInLabel</code></td>
<td><code>string</code></td>
<td>label of the button to /signin</td>
</tr>
<tr>
<td><code>poweredBy</code></td>
<td><code>string</code></td>
<td>whether to show “Powered by Mist”, default is true</td>
</tr>
<tr>
<td><code>email</code></td>
<td><code>boolean</code></td>
<td>whether email field is required, default is false</td>
</tr>
<tr>
<td><code>emailLabel</code></td>
<td><code>string</code></td>
<td>label of email field</td>
</tr>
<tr>
<td><code>emailError</code></td>
<td><code>string</code></td>
<td>error message when email not provided</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>boolean</code></td>
<td>whether name field is required, default is false</td>
</tr>
<tr>
<td><code>nameLabel</code></td>
<td><code>string</code></td>
<td>label of name field</td>
</tr>
<tr>
<td><code>nameError</code></td>
<td><code>string</code></td>
<td>error message when name not provided</td>
</tr>
<tr>
<td><code>company</code></td>
<td><code>boolean</code></td>
<td>whether company field is required, default is false</td>
</tr>
<tr>
<td><code>companyLabel</code></td>
<td><code>string</code></td>
<td>label of company field</td>
</tr>
<tr>
<td><code>companyError</code></td>
<td><code>string</code></td>
<td>error message when company not provided</td>
</tr>
<tr>
<td><code>requiredFieldLabel</code></td>
<td><code>string</code></td>
<td>label to denote required field</td>
</tr>
<tr>
<td><code>field1</code></td>
<td><code>boolean</code></td>
<td>whether to ask field1</td>
</tr>
<tr>
<td><code>field1Label</code></td>
<td><code>string</code></td>
<td>label of field1</td>
</tr>
<tr>
<td><code>field1Required</code></td>
<td><code>boolean</code></td>
<td>whether field1 is required field</td>
</tr>
<tr>
<td><code>field1Error</code></td>
<td><code>string</code></td>
<td>error message when field1 not provided</td>
</tr>
<tr>
<td><code>field2</code></td>
<td><code>boolean</code></td>
<td>whether to ask field2</td>
</tr>
<tr>
<td><code>field2Label</code></td>
<td><code>string</code></td>
<td>label of field2</td>
</tr>
<tr>
<td><code>field2Required</code></td>
<td><code>boolean</code></td>
<td>whether field2 is required field</td>
</tr>
<tr>
<td><code>field2Error</code></td>
<td><code>string</code></td>
<td>error message when field2 not provided</td>
</tr>
<tr>
<td><code>field3</code></td>
<td><code>boolean</code></td>
<td>whether to ask field3</td>
</tr>
<tr>
<td><code>field3Label</code></td>
<td><code>string</code></td>
<td>label of field3</td>
</tr>
<tr>
<td><code>field3Required</code></td>
<td><code>boolean</code></td>
<td>whether field3 is required field</td>
</tr>
<tr>
<td><code>field3Error</code></td>
<td><code>string</code></td>
<td>error message when field3 not provided</td>
</tr>
<tr>
<td><code>field4</code></td>
<td><code>boolean</code></td>
<td>whether to ask field4</td>
</tr>
<tr>
<td><code>field4Label</code></td>
<td><code>string</code></td>
<td>label of field4</td>
</tr>
<tr>
<td><code>field4Required</code></td>
<td><code>boolean</code></td>
<td>whether field4 is required field</td>
</tr>
<tr>
<td><code>field4Error</code></td>
<td><code>string</code></td>
<td>error message when field4 not provided</td>
</tr>
<tr>
<td><code>optout</code></td>
<td><code>boolean</code></td>
<td>whether to display “Do Not Store My Personal Information”</td>
</tr>
<tr>
<td><code>optoutLabel</code></td>
<td><code>string</code></td>
<td>label for “Do Not Store My Personal Information”</td>
</tr>
<tr>
<td><code>authButtonPassphrase</code></td>
<td><code>string</code></td>
<td>label for passphrase auth button</td>
</tr>
<tr>
<td><code>passphraseTitle</code></td>
<td><code>string</code></td>
<td>Title for passphrase details page</td>
</tr>
<tr>
<td><code>passphraseMessage</code></td>
<td><code>string</code></td>
<td>“Login using passphrase”</td>
</tr>
<tr>
<td><code>passphraseSubmit</code></td>
<td><code>string</code></td>
<td>“Sign in”</td>
</tr>
<tr>
<td><code>passphraseCancel</code></td>
<td><code>string</code></td>
<td>“Cancel”</td>
</tr>
<tr>
<td><code>authButtonGoogle</code></td>
<td><code>string</code></td>
<td>label for Google auth button</td>
</tr>
<tr>
<td><code>authButtonFacebook</code></td>
<td><code>string</code></td>
<td>label for Facebook auth button</td>
</tr>
<tr>
<td><code>authButtonSms</code></td>
<td><code>string</code></td>
<td>label for SMS auth button</td>
</tr>
<tr>
<td><code>emailAccessDomainError</code></td>
<td><code>string</code></td>
<td>error message when a user has valid social login but doesn’t match specified email domains.</td>
</tr>
<tr>
<td><code>smsNumberFieldLabel</code></td>
<td><code>string</code></td>
<td>label for field to provide mobile number</td>
</tr>
<tr>
<td><code>smsCarrierFieldLabel</code></td>
<td><code>string</code></td>
<td>label for mobile carrier drop-down list</td>
</tr>
<tr>
<td><code>smsNumberSubmit</code></td>
<td><code>string</code></td>
<td>label for submit button for code generation</td>
</tr>
<tr>
<td><code>smsNumberCancel</code></td>
<td><code>string</code></td>
<td>label for canceling mobile details for SMS auth</td>
</tr>
<tr>
<td><code>smsNumberTitle</code></td>
<td><code>string</code></td>
<td>Title for phone number details</td>
</tr>
<tr>
<td><code>smsCodeMessage</code></td>
<td><code>string</code></td>
<td>“Enter the confirmation code”</td>
</tr>
<tr>
<td><code>smsCodeFieldLabel</code></td>
<td><code>string</code></td>
<td>“Confirmation Code”</td>
</tr>
<tr>
<td><code>smsCodeSubmit</code></td>
<td><code>string</code></td>
<td>Label for confirmation code submit button</td>
</tr>
<tr>
<td><code>smsCodeCancel</code></td>
<td><code>string</code></td>
<td>Label for cancel confirmation code submission</td>
</tr>
<tr>
<td><code>smsCodeError</code></td>
<td><code>string</code></td>
<td>error message when confirmation code is invalid</td>
</tr>
<tr>
<td><code>smsHaveAccessCode</code></td>
<td><code>string</code></td>
<td>Label for checkbox to specify that the user has access code</td>
</tr>
<tr>
<td><code>smsValidityDuration</code></td>
<td><code>int</code></td>
<td>how long confirmation code should be considered valid (in minutes)</td>
</tr>
<tr>
<td><code>smsMessageFormat</code></td>
<td><code>string</code></td>
<td>format of access code sms message. <code>{{code}}</code> and <code>{{duration}}</code> are place holders and should be retained as is.</td>
</tr>
<tr>
<td><code>sponsorEmail</code></td>
<td><code>string</code></td>
<td>label for Sponsor Email</td>
</tr>
<tr>
<td><code>sponsorName</code></td>
<td><code>string</code></td>
<td>label for Sponsor Name</td>
</tr>
<tr>
<td><code>sponsorRequestAccess</code></td>
<td><code>string</code></td>
<td>‘submit button label request Wifi Access and notify sponsor about guest request</td>
</tr>
<tr>
<td><code>sponsorSubmit</code></td>
<td><code>string</code></td>
<td>submit button label to notify sponsor about guest request</td>
</tr>
<tr>
<td><code>sponsorStatusDenied</code></td>
<td><code>string</code></td>
<td>text to display when sponsor denies request</td>
</tr>
<tr>
<td><code>sponsorStatusApproved</code></td>
<td><code>string</code></td>
<td>text to display if sponsor approves request</td>
</tr>
<tr>
<td><code>sponsorStatusPending</code></td>
<td><code>string</code></td>
<td>text to display if request is still pending</td>
</tr>
<tr>
<td><code>sponsorEmailError</code></td>
<td><code>string</code></td>
<td>“Please provide valid sponsor email”</td>
</tr>
<tr>
<td><code>sponsorNameError</code></td>
<td><code>string</code></td>
<td>“Please provide sponsor’s name”</td>
</tr>
<tr>
<td><code>sponsorBackLink</code></td>
<td><code>string</code></td>
<td>“Go back and edit request form”</td>
</tr>
<tr>
<td><code>sponsorCancel</code></td>
<td><code>string</code></td>
<td>“Cancel”</td>
</tr>
<tr>
<td><code>sponsorInfoApproved</code></td>
<td><code>string</code></td>
<td>“Your request was approved by”</td>
</tr>
<tr>
<td><code>sponsorInfoDenied</code></td>
<td><code>string</code></td>
<td>“Your request was denied by”</td>
</tr>
<tr>
<td><code>sponsorInfoPending</code></td>
<td><code>string</code></td>
<td>“Your notification has been sent to”</td>
</tr>
<tr>
<td><code>sponsorsInfoApproved</code></td>
<td><code>string</code></td>
<td>“Your request was approved”</td>
</tr>
<tr>
<td><code>sponsorsInfoDenied</code></td>
<td><code>string</code></td>
<td>“Your request was denied”</td>
</tr>
<tr>
<td><code>sponsorsInfoPending</code></td>
<td><code>string</code></td>
<td>“Your notification has been sent to the sponsors”</td>
</tr>
<tr>
<td><code>sponsorNotePending</code></td>
<td><code>string</code></td>
<td>“Please wait for them to acknowledge.”</td>
</tr>
<tr>
<td><code>sponsorSelectEmail</code></td>
<td><code>string</code></td>
<td>“Select Sponsor”</td>
</tr>
<tr>
<td><code>sponsorsError</code></td>
<td><code>string</code></td>
<td>“Please select a sponsor”</td>
</tr>
<tr>
<td><code>authButtonSponsor</code></td>
<td><code>string</code></td>
<td>label for Sponsor auth button</td>
</tr>
<tr>
<td><code>authButtonAmazon</code></td>
<td><code>string</code></td>
<td>label for Amazon auth button</td>
</tr>
<tr>
<td><code>authButtonAzure</code></td>
<td><code>string</code></td>
<td>label for Azure auth button</td>
</tr>
<tr>
<td><code>authButtonEmail</code></td>
<td><code>string</code></td>
<td>label for Email auth button</td>
</tr>
<tr>
<td><code>authButtonMicrosoft</code></td>
<td><code>string</code></td>
<td>label for Microsoft auth button</td>
</tr>
<tr>
<td><code>smsCarrierDefault</code></td>
<td><code>string</code></td>
<td>“Please Select”</td>
</tr>
<tr>
<td><code>smsCarrierError</code></td>
<td><code>string</code></td>
<td>“Please select a mobile carrier”</td>
</tr>
<tr>
<td><code>smsCodeTitle</code></td>
<td><code>string</code></td>
<td>“Access Code”</td>
</tr>
<tr>
<td><code>smsCountryFieldLabel</code></td>
<td><code>string</code></td>
<td>“Country Code”</td>
</tr>
<tr>
<td><code>smsCountryFormat</code></td>
<td><code>string</code></td>
<td>“+1”</td>
</tr>
<tr>
<td><code>smsNumberError</code></td>
<td><code>string</code></td>
<td>“Invalid Mobile Number”</td>
</tr>
<tr>
<td><code>smsNumberFormat</code></td>
<td><code>string</code></td>
<td>“2125551212 (digits only)”</td>
</tr>
<tr>
<td><code>smsNumberMessage</code></td>
<td><code>string</code></td>
<td>“We will send an access code to your mobile number which you can use to connect to the WiFi network. Message and data rates may apply.”</td>
</tr>
<tr>
<td><code>smsUsernameFormat</code></td>
<td><code>string</code></td>
<td>“username”</td>
</tr>
<tr>
<td><code>accessCodeAlternateEmail</code></td>
<td><code>string</code></td>
<td>“Use alternate email address”</td>
</tr>
<tr>
<td><code>emailMessage</code></td>
<td><code>string</code></td>
<td>“We will email you an authentication code which you can use to connect to the WiFi network.”</td>
</tr>
<tr>
<td><code>emailCodeError</code></td>
<td><code>string</code></td>
<td>“Please provide valid alternate email”</td>
</tr>
<tr>
<td><code>emailCancel</code></td>
<td><code>string</code></td>
<td>“Cancel”</td>
</tr>
<tr>
<td><code>emailFieldLabel</code></td>
<td><code>string</code></td>
<td>“Enter your email address”</td>
</tr>
<tr>
<td><code>emailTitle</code></td>
<td><code>string</code></td>
<td>“Sign in with Email”</td>
</tr>
<tr>
<td><code>emailSubmit</code></td>
<td><code>string</code></td>
<td>Label for confirmation code submit button using email auth</td>
</tr>
<tr>
<td><code>emailCodeCancel</code></td>
<td><code>string</code></td>
<td>Label for cancel confirmation code submission using email auth</td>
</tr>
<tr>
<td><code>emailCodeFieldLabel</code></td>
<td><code>string</code></td>
<td>“Confirmation Code”,</td>
</tr>
<tr>
<td><code>emailCodeMessage</code></td>
<td><code>string</code></td>
<td>“Enter the access number that was sent to your email address.”,</td>
</tr>
<tr>
<td><code>emailCodeSubmit</code></td>
<td><code>string</code></td>
<td>“Sign In”,</td>
</tr>
<tr>
<td><code>emailCodeTitle</code></td>
<td><code>string</code></td>
<td>“Access Code”,</td>
</tr>
</tbody>
</table>
<p><code>authLabel</code>|<code>string</code>|”Connect to WiFi with”
<code>sponsorEmailTemplate</code>|<code>string</code>|html template to replace/override default sponsor email template; See <a href="https://api.mist.com/api/v1/docs/Site#sponsor-email-template">Sponsor Email Template</a> for more details
<code>privacyPolicy</code>|<code>boolean</code>|default is false
<code>privacyPolicyText</code>|<code>string</code>|privacy notice text
<code>privacyPolicyAcceptLabel</code>|<code>string</code>|prefix of the label of the link to go to /privacy_notice,
<code>privacyPolicyLink</code>|<code>string</code>|label of the link to go to /privacy_notice,
<code>privacyPolicyError</code>|<code>string</code>|error message when privacy notice is not accepted”,
<code>marketingPolicyOptIn</code>|<code>boolean</code>| whether marketing policy optin is enabled,
<code>marketingPolicyOptInText</code>|<code>string</code>| marketing policy text,
<code>marketingPolicyOptInLabel</code>|<code>string</code>| label for marketing optin,
<code>marketingPolicyLink</code>|<code>string</code>| label of the link to go to /marketing_policy</p>
<h4 id="sponsor-email-template">Sponsor Email Template</h4>
<p>Sponsor Email Template supports following template variables:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>approve_url</code></td>
<td>Renders URL to approve the request; optionally <code>&amp;minutes=N</code> query param can be appended to change the Authorization period of the guest, where <code>N</code> is a valid integer denoting number of minutes a guest remains authorized</td>
</tr>
<tr>
<td><code>deny_url</code></td>
<td>Renders URL to reject the request</td>
</tr>
<tr>
<td><code>guest_email</code></td>
<td>Renders Email ID of the guest</td>
</tr>
<tr>
<td><code>guest_name</code></td>
<td>Renders Name of the guest</td>
</tr>
<tr>
<td><code>field1</code></td>
<td>Renders value of the Custom Field 1</td>
</tr>
<tr>
<td><code>field2</code></td>
<td>Renders value of the Custom Field 2</td>
</tr>
<tr>
<td><code>company</code></td>
<td>Renders value of the Company field</td>
</tr>
<tr>
<td><code>sponsor_link_validity_duration</code></td>
<td>Renders validity time of the request (i.e. Approve/Deny URL)</td>
</tr>
<tr>
<td><code>auth_expire_minutes</code></td>
<td>Renders Wlan-level configured Guest Authorization Expiration time period (in minutes), If not configured then default (1 day in minutes)</td>
</tr>
</tbody>
</table>
<h2 id="get-wlans-derived">Get Wlans Derived</h2>
<pre><code>GET /api/v1/sites/:site_id/wlans/derived?resolve=false&amp;wlan_id=:wlan_id
</code></pre>
<h3 id="request_2">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>resolve</code></td>
<td><code>boolean</code></td>
<td>whether to resolve SITE_VARS, default is false (as filter, optional)</td>
</tr>
<tr>
<td><code>wlan_id</code></td>
<td><code>string</code></td>
<td>filter by UUID of wlan</td>
</tr>
</tbody>
</table>
<h3 id="response">Response</h3>
<pre><code>[
    {
        "ssid": "Guest",
        "for_site": false,
        "template_id": "867860f2-dd82-3677-54a5-4d6b139c96ca",
        "template_name" "west coast",
        ...
    }
]
</code></pre>
<h3 id="response-definitions">Response Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>for_site</code></td>
<td><code>boolean</code></td>
<td>whether this is a site-level WLAN</td>
</tr>
<tr>
<td><code>template_id</code></td>
<td><code>string</code></td>
<td>the template id (if this is an org-level wlan with template_id)</td>
</tr>
<tr>
<td><code>template_name</code></td>
<td><code>string</code></td>
<td>name of the template</td>
</tr>
</tbody>
</table>
<h2 id="get-guests-derived">Get Guests Derived</h2>
<pre><code>GET /api/v1/sites/:site_id/guests/derived?cross_site=false
</code></pre>
<h3 id="request_3">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>cross_site</code></td>
<td><code>boolean</code></td>
<td>whether to get org level guests, default is false i.e get site level guests</td>
</tr>
</tbody>
</table>
<h3 id="response_1">Response</h3>
<pre><code>[
    {
        "ssid": "Guest",
        "auth_method": "passphrase",
        "wlan_id": "867860f2-dd82-3677-54a5-4d6b139c96ca"
        ...
    }
]
</code></pre>
<h2 id="to-crop-or-resize-a-image">To Crop Or Resize A Image</h2>
<pre><code>POST /api/v1/utils/resize_image
</code></pre>
<h3 id="request_4">Request</h3>
<p>A multi-part POST</p>
<pre><code>"json": a JSON string
"file": a binary file

// for the JSON payload
{
    "width": 300,
    "height": 200",
    "topleft": [ 10, 50 ],
    "bottomright: [100, 100 ]
}
</code></pre>
<h2 id="test-twilio-setup">Test Twilio Setup</h2>
<p>Allows validation of twilio setup</p>
<pre><code>POST /api/v1/utils/test_twilio
</code></pre>
<h3 id="request_5">Request</h3>
<pre><code>{
    "twilio_sid": "AC5f4366878d193fb4865ab151739999eb",
    "twilio_auth_token": "2135be04736a1a0a314bce432d61721a",
    "from": "+185051234567",
    "to": "+19999999999"
}
</code></pre>
<h3 id="parameters_2">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>twilio_sid</code></td>
<td><code>string</code></td>
<td>Twilio Account SID</td>
</tr>
<tr>
<td><code>twilio_auth_token</code></td>
<td><code>string</code></td>
<td>Auth Token associated with twilio account</td>
</tr>
<tr>
<td><code>from</code></td>
<td><code>string</code></td>
<td>One of the numbers you have in your Twilio account</td>
</tr>
<tr>
<td><code>to</code></td>
<td><code>string</code></td>
<td>Phone number of the recipient of SMS</td>
</tr>
</tbody>
</table>
<p>In case of success, a text message confirming successful setup should be received. In case of error, twilio error code
and message are returned.</p>
<h2 id="test-broadnet-setup">Test Broadnet Setup</h2>
<p>Allows validation of broadnet setup</p>
<pre><code>POST /api/v1/utils/test_broadnet
</code></pre>
<h3 id="request_6">Request</h3>
<pre><code>{
    "broadnet_user_id": "juniper",
    "broadnet_password": "sherlocked",
    "broadnet_sid": "MIST",
    "to": "+911122334455"
}
</code></pre>
<h3 id="parameters_3">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>broadnet_user_id</code></td>
<td><code>string</code></td>
<td>Broadnet account user id</td>
</tr>
<tr>
<td><code>broadnet_password</code></td>
<td><code>string</code></td>
<td>Broadnet account password</td>
</tr>
<tr>
<td><code>broadnet_sid</code></td>
<td><code>string</code></td>
<td>Sender Id, for the sms (default is ‘MIST’, if not provided)</td>
</tr>
<tr>
<td><code>to</code></td>
<td><code>string</code></td>
<td>Phone number of the recipient of SMS with country code</td>
</tr>
</tbody>
</table>
<p>In case of success, a text message confirming successful setup should be received. In case of error, broadnet error message are returned.</p>
<h2 id="test-clickatell-setup">Test Clickatell Setup</h2>
<p>Allows validation of Clickatell setup</p>
<pre><code>POST /api/v1/utils/test_clickatell
</code></pre>
<h3 id="request_7">Request</h3>
<pre><code>{
    "clickatell_api_key": "Hk-ZWX4ZStWR29yS1pMvBQ=+",
    "to": "+911122334455"
}
</code></pre>
<h3 id="parameters_4">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>clickatell_api_key</code></td>
<td><code>string</code></td>
<td>Api Key for clickatell account</td>
</tr>
<tr>
<td><code>to</code></td>
<td><code>string</code></td>
<td>Phone number of the recipient of SMS with country code</td>
</tr>
</tbody>
</table>
<p>In case of success, a text message confirming successful setup should be received. In case of error, clickatell error message are returned.</p>
<h2 id="test-puzzel-setup">Test Puzzel Setup</h2>
<p>Allows validation of puzzel setup</p>
<pre><code>POST /api/v1/utils/test_puzzel
</code></pre>
<h3 id="request_8">Request</h3>
<pre><code>{
    "puzzel_service_id": "2210",
    "puzzel_username": "puzzel",
    "puzzel_password": "sherlocked",
    "to": "+911122334455"
}
</code></pre>
<h3 id="parameters_5">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>puzzel_service_id</code></td>
<td><code>string</code></td>
<td>Puzzel account service id</td>
</tr>
<tr>
<td><code>puzzel_username</code></td>
<td><code>string</code></td>
<td>Puzzel account username</td>
</tr>
<tr>
<td><code>puzzel_password</code></td>
<td><code>string</code></td>
<td>Puzzel account password</td>
</tr>
<tr>
<td><code>to</code></td>
<td><code>string</code></td>
<td>Phone number of the recipient of SMS with country code</td>
</tr>
</tbody>
</table>
<p>In case of success, a text message confirming successful setup should be received. In case of error, puzzel error message are returned.</p>
<h2 id="test-gupshup-setup">Test Gupshup Setup</h2>
<p>Allows validation of gupshup setup</p>
<pre><code>POST /api/v1/utils/test_gupshup
</code></pre>
<h3 id="request_9">Request</h3>
<pre><code>{
    "gupshup_userid": "juniper",
    "gupshup_password": "sherlocked",
    "to": "+911122334455"
}
</code></pre>
<h3 id="parameters_6">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>gupshup_userid</code></td>
<td><code>string</code></td>
<td>Gupshup account user id</td>
</tr>
<tr>
<td><code>gupshup_password</code></td>
<td><code>string</code></td>
<td>Gupshup account password</td>
</tr>
<tr>
<td><code>to</code></td>
<td><code>string</code></td>
<td>Phone number of the recipient of SMS with country code</td>
</tr>
</tbody>
</table>
<p>In case of success, a text message confirming successful setup should be received. In case of error, gupshup error message are returned.</p>
<h2 id="test-telstra-setup">Test Telstra Setup</h2>
<p>Allows validation of Telstra sms gateway credentials</p>
<pre><code>POST /api/v1/utils/test_telstra
</code></pre>
<h3 id="request_10">Request</h3>
<pre><code>{
    "telstra_client_id": "123456",
    "telstra_client_secret": "abcdef",
    "to": "+911122334455"
}
</code></pre>
<h3 id="parameters_7">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>telstra_client_id</code></td>
<td><code>string</code></td>
<td>Telstra client id</td>
</tr>
<tr>
<td><code>telstra_client_secret</code></td>
<td><code>string</code></td>
<td>Telstra client secret</td>
</tr>
<tr>
<td><code>to</code></td>
<td><code>string</code></td>
<td>Phone number of the recipient of SMS with country code</td>
</tr>
</tbody>
</table>
<p>In case of success, a text message confirming successful setup should be received. In case of error, telstra error message are returned.</p>
<h2 id="test-smsglobal-setup">Test SMSGlobal Setup</h2>
<p>Allows validation of SMSGlobal sms gateway credentials</p>
<pre><code>POST /api/v1/utils/test_smsglobal
</code></pre>
<h3 id="request_11">Request</h3>
<pre><code>{
    "smsglobal_api_key": "123456",
    "smsglobal_api_secret": "abcdef",
    "to": "+911122334455"
}
</code></pre>
<h3 id="parameters_8">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>smsglobal_api_key</code></td>
<td><code>string</code></td>
<td>SMSGlobal api key</td>
</tr>
<tr>
<td><code>smsglobal_api_secret</code></td>
<td><code>string</code></td>
<td>SMSGlobal api secret</td>
</tr>
<tr>
<td><code>to</code></td>
<td><code>string</code></td>
<td>Phone number of the recipient of SMS with country code</td>
</tr>
</tbody>
</table>
<p>In case of success, a text message confirming successful setup should be received. In case of error, smsglobal error message are returned.</p>
<h1 id="map">Map</h1>
<h2 id="map-definition">Map definition</h2>
<p>Maps may represent multiple floor one on top of another or just a collections of maps where the user decide to put into
a single site.</p>
<h3 id="base-uri_1">Base URI</h3>
<pre><code>/api/v1/sites/:site_id/maps
</code></pre>
<p>For a map with type==’image’, use multi-part POST to insert a map as well as the image. To update attributes without
updating image, PUT without the image. GET will contain an ‘url’ attribute with an URL to the image</p>
<h3 id="example_1">Example</h3>
<pre><code>// for image map
{
    "name": "Mist Office",
    "type": "image",
    "ppm": 40.94,
    "width": 1250,
    "height": 1500,
    "origin_x": 35,
    "origin_y": 60,
    "orientation": 30,
    "locked": false,
    "wayfinding": {
        "snap_to_path": true,
        "micello": {
            "account_key": "adasdf",
            "map_id": "c660f81dd250c",
            "default_level_id": 5
        }
    },
    "wayfinding_path": {
        "coordinate": "actual",
        "nodes": [
            {
                "name": "N1",
                "position": {
                    "x": 746,
                    "y": 104
                },
                "edges": {
                    "N2": "1"
                }
            },
            {
                "name": "N2",
                "position": {
                    "x": 740,
                    "y": 318
                },
                "edges": {
                    "N1": "1",
                }
            }
        ]
    },
    "wall_path": {
        "coordinate": "actual",
        "nodes": [
            {
                "name": "N1",
                "position": {
                    "x": 746,
                    "y": 104
                },
                "edges": {
                    "N2": "1"
                }
            },
            {
                "name": "N2",
                "position": {
                    "x": 740,
                    "y": 318
                },
                "edges": {
                    "N1": "1",
                }
            }
        ]
    },
    "sitesurvey_path": [
        {
            "coordinate": "actual",
            "nodes": [
                {
                    "name": "W0",
                    "position": {
                        "x": 372,
                        "y": 192
                    },
                    "edges": {
                        "W1": 1
                    }
                },
                {
                    "name": "W1",
                    "position": {
                        "x": 485,
                        "y": 205
                    },
                    "edges": {
                        "W2": 1
                    }
                },
                {
                    "name": "W2",
                    "position": {
                        "x": 400,
                        "y": 295
                    },
                    "edges": {
                        "W0": 1
                    }
                },
            ],
            "name": "Default",
            "id": "cbdb7f0b-3be0-4872-88f9-58790b509c23-j68kows8"
        }
    ],
    "flags": {
        "assetHoldTime": 5,
        "storeTime": 10
    },
    "url": "https://url/to/image.png",
    "thumbnail_url": "https://url/to/image.png"
}

// for google map
{
    "name": "Oakridge Mall",
    "type": "google",
    "view": "roadmap",
    "origin_x": -122.033010,
    "origin_y": 37.295080,
    "latlng_tl": { "lat": 37.295057, "lng": -122.033095 },
    "latlng_br": { "lat": 37.295285, "lng": -122.032789 }
}
</code></pre>
<h3 id="parameters_9">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>The name of the map</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>image / google, default is image</td>
</tr>
<tr>
<td><code>ppm</code></td>
<td><code>float</code></td>
<td>when type=image, pixels per meter</td>
</tr>
<tr>
<td><code>width</code></td>
<td><code>int</code></td>
<td>when type=image, width of the image map</td>
</tr>
<tr>
<td><code>height</code></td>
<td><code>int</code></td>
<td>when type=image, height of the image map</td>
</tr>
<tr>
<td><code>url</code></td>
<td><code>string</code></td>
<td>when type=image, the url</td>
</tr>
<tr>
<td><code>thumbnail_url</code></td>
<td><code>string</code></td>
<td>when type=image, the url for the thumbnail image / preview</td>
</tr>
<tr>
<td><code>view</code></td>
<td><code>string</code></td>
<td>when type=google. roadmap / satellite / hybrid / terrain</td>
</tr>
<tr>
<td><code>origin_x</code></td>
<td><code>int</code></td>
<td>the user-annotated x origin, pixels</td>
</tr>
<tr>
<td><code>origin_y</code></td>
<td><code>int</code></td>
<td>the user-annotated y origin, pixels</td>
</tr>
<tr>
<td><code>orientation</code></td>
<td><code>int</code></td>
<td>orientation of the map, 0 means up is north, 90 means up is west. default is 0</td>
</tr>
<tr>
<td><code>latlng_tl</code></td>
<td><code>latlng</code></td>
<td>when type=google, latitude / longitude of the top-left corner</td>
</tr>
<tr>
<td><code>latlng_br</code></td>
<td><code>latlng</code></td>
<td>when type=google, latitude / longitude of the bottom-right corner</td>
</tr>
<tr>
<td><code>wayfinding</code></td>
<td><code>object</code></td>
<td>properties related to wayfinding</td>
</tr>
<tr>
<td><code>wayfinding_path</code></td>
<td><code>object</code></td>
<td>a JSON blob for wayfinding (using Dijkstra’s algorithm)</td>
</tr>
<tr>
<td><code>wall_path</code></td>
<td><code>object</code></td>
<td>a JSON blob for wall definition (same format as wayfinding_path)</td>
</tr>
<tr>
<td><code>sitesurvey_path</code></td>
<td><code>list</code></td>
<td>a list of JSON blob for site survey path (same format as wayfinding_path)</td>
</tr>
<tr>
<td><code>locked</code></td>
<td><code>boolean</code></td>
<td>whether this map is considered locked down</td>
</tr>
<tr>
<td><code>flags</code></td>
<td><code>list</code></td>
<td>name/val pair objects for location engine to use</td>
</tr>
</tbody>
</table>
<h2 id="add-an-image-map">Add an image map</h2>
<p>Add image map is a multipart POST which has an file (Image) and an optional json parameter</p>
<pre><code>POST /api/v1/sites/:site_id/maps/:map_id/image
</code></pre>
<h3 id="request_12">Request</h3>
<pre><code>"json": a JSON string describing your upload
"file": a binary file
</code></pre>
<h2 id="delete-an-image-map">Delete an image map</h2>
<p>Delete image added to the map</p>
<pre><code>DELETE /api/v1/sites/:site_id/maps/:map_id/image
</code></pre>
<h2 id="map-import">Map Import</h2>
<p>Import data from files is a multipart POST which has a file, a json, and an optional csv, to create floorplan and place
matching ap automatically if supported, name ap if not exists</p>
<pre><code>POST /api/v1/sites/:site_id/maps/import
</code></pre>
<h3 id="request_13">Request</h3>
<p>A multi-part POST</p>
<pre><code>"json": a JSON string, includes vendor options: ekahau, ibwave, import_all_floorplans: optional, false by default,
import_height: optional, default: true, import_orientation: optional, default: true
"file": a binary file, option: .esx file (ekahau)
"csv": a csv file for ap name mapping, optional
// for the JSON payload
{
    "vendor_name": "ekahau",
    "import_all_floorplans": true  // optional
    "import_height": true, // optional
    "import_orientation": false // optional
}
</code></pre>
<h3 id="device-import-csv-file-format">Device Import CSV File Format</h3>
<pre><code>Vendor AP name,Mist AP Mac
US Office AP-2 - 5c:5b:35:00:00:02,5c5b35000002
</code></pre>
<h3 id="response_2">Response</h3>
<pre><code>{
    "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
    "aps": [
        {
            "mac": "5c5b35000001",
            // placed 
            "action": "placed" 
            "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5"
            // named and placed
            "action": "named-placed"
            // if we ignore it (did nothing with it)
            "action": "ignored",
            "reason": "not found on current site",
            // floorplan id, height, orientation for ignored ap
            "floorplan_id": "cbdb7f0b-3be0-4872-88f9-58790b509c23-j68kows8"
            "orientation": 45,
            "height": 3
        }
    ],
    "floorplans": [
        {
            // whatever ID vendor has
            "id": "cbdb7f0b-3be0-4872-88f9-58790b509c23-j68kows8",
            "name": "map1",
            "action": "imported",
            "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5"
        }
    ],
    "summary": {
        "num_ap_assigned": 1,
        "num_map_assigned": 1
    }
}
</code></pre>
<h2 id="import-micello-info">Import Micello Info</h2>
<p>This imports the vendor map meta data into the Map JSON. This is required by the SDK and App in order to access/render
the vendor Map properly.</p>
<pre><code>POST /api/v1/sites/:site_id/maps/:map_id/wayfinding/import
</code></pre>
<h3 id="request_14">Request</h3>
<pre><code>{
    "vendor_name": "micello",
    "account_key": "adasdf",
    "map_id": "c660f81dd250c",
    "default_level_id": 5
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vendor_name</code></td>
<td><code>string</code></td>
<td>the vendor ‘micello’</td>
</tr>
<tr>
<td><code>account_key</code></td>
<td><code>string</code></td>
<td>the account key that has access to the map</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>micello map id</td>
</tr>
<tr>
<td><code>default_level_id</code></td>
<td><code>int</code></td>
<td>micello floor/level id</td>
</tr>
</tbody>
</table>
<h2 id="import-jibestream-info">Import Jibestream Info</h2>
<p>This imports the vendor map meta data into the Map JSON. This is required by the SDK and App in order to access/render
the vendor Map properly.</p>
<pre><code>POST /api/v1/sites/:site_id/maps/:map_id/wayfinding/import
</code></pre>
<h3 id="request_15">Request</h3>
<pre><code>{
    "vendor_name": "jibestream",
    "venue_id": 123,
    "map_id": "123",
    "ppm": 4.479186910505666,
    "client_id": "199d6770-0f6f-407a-9bd5-fc33c7840194",
    "client_secret": "/9Nog3yDzcYj0bY91XJZQLCt+m9DXaIVhx+Ghk3ddd",
    "customer_id": 123,
    "endpoint_url": "https://api.jibestream.com",
    "mmpp": 223.2548049411735
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vendor_name</code></td>
<td><code>string</code></td>
<td>the vendor ‘jibestream’</td>
</tr>
<tr>
<td><code>venue_id</code></td>
<td><code>int</code></td>
<td>the venue or organization id</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>the jibestream map id</td>
</tr>
<tr>
<td><code>ppm</code></td>
<td><code>float</code></td>
<td>pixel per meter, same as the map JSON value.</td>
</tr>
<tr>
<td><code>client_id</code></td>
<td><code>int</code></td>
<td>the client id</td>
</tr>
<tr>
<td><code>client_secret</code></td>
<td><code>string</code></td>
<td>the client secret</td>
</tr>
<tr>
<td><code>customer_id</code></td>
<td><code>string</code></td>
<td>the jibestream customer record id</td>
</tr>
<tr>
<td><code>endpoint_url_url</code></td>
<td><code>string</code></td>
<td>the map contents endpoint host</td>
</tr>
<tr>
<td><code>mmpp</code></td>
<td><code>float</code></td>
<td>millimeter per pixel</td>
</tr>
</tbody>
</table>
<h2 id="replace-map-image">Replace Map Image</h2>
<p>This works like an PUT where the image will be replaced. If <code>transform</code> is provided, all the locations of the objects on
the map (AP, Zone, Vbeacon, Beacon) will be transformed as well (relative to the new Map)</p>
<pre><code>POST /api/v1/sites/:site_id/maps/:map_id/replace
</code></pre>
<h3 id="request_16">Request</h3>
<pre><code>"json": a JSON string of
{
    // for a 600x400 src image, 400x200 new image
    // this means the new image is positioned at (200, 150) with the same scale, no rotation
    "transform": {
        "x": 200,
        "y": 150,
        "scale": 1.0,
        "rotate": 0
    }
}
"file": a binary file
</code></pre>
<h3 id="parameters_10">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>transform</code></td>
<td><code>object</code></td>
<td>The name of the map, optional</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>float</code></td>
<td>where the (0, 0) of the new image is relative to the original map, default is 0</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>float</code></td>
<td>where the (0, 0) of the new image is relative to the original map, default is 0</td>
</tr>
<tr>
<td><code>scale</code></td>
<td><code>float</code></td>
<td>whether to scale the replacing image, default is 1</td>
</tr>
<tr>
<td><code>rotation</code></td>
<td><code>int</code></td>
<td>whether to rotate the replacing image, default is 0, in degrees</td>
</tr>
</tbody>
</table>
<h2 id="bulk-assign-aps-to-a-map">Bulk Assign APs to a Map</h2>
<pre><code>POST /api/v1/sites/:site_id/maps/:map_id/set_map
</code></pre>
<h3 id="usage">Usage</h3>
<p>This API can be used to assign a list of AP Macs associated with <code>site_id</code> to the specified <code>map_id</code>. Note that <code>map_id</code> must be associated with corresponding <code>site_id</code>.
This API obeys the following rules
1. if AP is unassigned to any Map, it gets associated with <code>map_id</code>
2. Any moved APs are returned in the response
3. If the AP is considered a <code>locked</code> AP, no action will be taken</p>
<h3 id="request-payload">Request Payload</h3>
<pre><code>{
    "macs": [
        "5c5b35000001",
        "5c5b35584a6f"
    ]
}
</code></pre>
<p>Assigns the devices present in input list of devices to <code>:map_id</code></p>
<h3 id="response_3">Response</h3>
<pre><code>{
    "moved": ["5c5b35584a6f"],
    "locked": ["5c5b35000001"]
}
</code></pre>
<h1 id="zone">Zone</h1>
<h2 id="zone-schema">Zone schema</h2>
<p>Zones are areas on a map defined by the admin for different purposes. e.g. different Wlans, occupancies, policies.</p>
<h3 id="base-uri_2">Base URI</h3>
<pre><code>/api/v1/sites/:site_id/zones
</code></pre>
<h3 id="example_2">Example</h3>
<pre><code>{
    "name": "Board Room",
    "map_id": "63eda950-c6da-11e4-a628-60f81dd250cc",
    "vertices": [
        { "x":1119, "y":518 },
        { "x":1393, "y":518 },
        { "x":1393, "y":740 },
        { "x":1119, "y":740 }
    ]
}
</code></pre>
<h3 id="parameters_11">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>The name of the zone</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map where this zone is defined</td>
</tr>
<tr>
<td><code>vertices</code></td>
<td><code>list</code></td>
<td>vertices used to define an area. It’s assumed that the last point connects to the first point and forms an closed area</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>float</code></td>
<td>x in pixel</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>float</code></td>
<td>y in pixel</td>
</tr>
</tbody>
</table>
<h1 id="virtual-beacons">Virtual Beacons</h1>
<p>Virtual beacons appear to consumer of our VBLE Mobile SDK as regular BLE beacons.</p>
<h3 id="base-uri_3">Base URI</h3>
<pre><code>/api/v1/sites/:site_id/vbeacons
</code></pre>
<h2 id="example_3">Example</h2>
<pre><code>{
    "uuid": "31375aeb-b8d3-1ea6-83bf-a31eb04e1c38",
    "major": 1356,
    "minor": 21,

    "power_mode": "default",
    "message": "Welcome to Mist",

    "url": "http://www.mist.com/any",
    "wayfinding_nodename": "node1",

    "name": "conference room",
    "map_id": "63eda950-c6da-11e4-a628-60f81dd250cc",
    "x": 53.5,
    "y": 173.1
}
</code></pre>
<h3 id="parameters_12">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>uuid</code></td>
<td><code>string</code></td>
<td>bluetooth tag UUID</td>
</tr>
<tr>
<td><code>major</code></td>
<td><code>int</code></td>
<td>bluetooth tag major</td>
</tr>
<tr>
<td><code>minor</code></td>
<td><code>int</code></td>
<td>bluetooth tag minor</td>
</tr>
<tr>
<td><code>power_mode</code></td>
<td><code>string</code></td>
<td>default / custom</td>
</tr>
<tr>
<td><code>power</code></td>
<td><code>int</code></td>
<td>required if power_mode==custom, -30 - 100, in dBm. For default power_mode, power = 4 dBm.</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name / label of the device</td>
</tr>
<tr>
<td><code>message</code></td>
<td><code>string</code></td>
<td>a message that can be displayed when the sdkclient gets near the vbeacon</td>
</tr>
<tr>
<td><code>url</code></td>
<td><code>string</code></td>
<td>URL to show, optional</td>
</tr>
<tr>
<td><code>wayfinding_nodename</code></td>
<td><code>string</code></td>
<td>the name to be used in wayfinding_path or wayfinding_grid blob</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map where the device belongs to</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>float</code></td>
<td>x in pixel</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>float</code></td>
<td>y in pixel</td>
</tr>
</tbody>
</table>
<h1 id="rssi-zone">RSSI Zone</h1>
<h2 id="rssi-zone-schema">RSSI Zone schema</h2>
<p>RSSI Zone is RSSI-based</p>
<h3 id="base-uri_4">Base URI</h3>
<pre><code>/api/v1/sites/:site_id/rssizones
</code></pre>
<h3 id="example_4">Example</h3>
<pre><code>{
    "name": "Board Room",
    "devices": [
        {
            "device_id": "00000000-0000-0000-1000-5c5b35bd76bb",
            "rssi": -80
        }
    ]
}
</code></pre>
<h3 id="parameters_13">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>The name of the zone</td>
</tr>
<tr>
<td><code>devices</code></td>
<td><code>list</code></td>
<td>List of devices and the respective RSSI values to be considered in the zone</td>
</tr>
<tr>
<td><code>rssi</code></td>
<td><code>int</code></td>
<td>RSSI threshold</td>
</tr>
</tbody>
</table>
<h1 id="beacons">Beacons</h1>
<p>Beacons represents a physical 3rd-party beacon. The customer will need to tell us the <em>properties</em> of this BLE beacon.
So we can use it in our locationing.</p>
<h3 id="base-uri_5">Base URI</h3>
<pre><code>/api/v1/sites/:site_id/beacons
</code></pre>
<h2 id="example_5">Example</h2>
<pre><code>{
    // for iBeacon
    "type": "ibeacon",
    "ibeacon_uuid": "31375aeb-b8d3-1ea6-83bf-a31eb04e1c38",
    "ibeacon_major": 1356,
    "ibeacon_minor": 21,

    // for Eddystone using UID
    "type": "eddystone-uid",
    "eddystone_namespace": "2818e3868dec25629ede",
    "eddystone_instance": "5c5b35000001",

    // for Eddystone using URL
    "type": "eddystone-url",
    "eddystone_url": "https://www.abc.com",

    "power": 4,

    "name": "conference room",
    "map_id": "63eda950-c6da-11e4-a628-60f81dd250cc",
    "x": 53.5,
    "y": 173.1,

    "mac": "c4887201b5a8",
}
</code></pre>
<h3 id="parameters_14">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>default is <code>eddystone-uid</code></td>
</tr>
<tr>
<td><code>ibeacon_uuid</code></td>
<td><code>string</code></td>
<td>bluetooth tag UUID</td>
</tr>
<tr>
<td><code>ibeacon_major</code></td>
<td><code>int</code></td>
<td>bluetooth tag major</td>
</tr>
<tr>
<td><code>ibeacon_minor</code></td>
<td><code>int</code></td>
<td>bluetooth tag minor</td>
</tr>
<tr>
<td><code>eddystone_namespace</code></td>
<td><code>string</code></td>
<td>Eddystone-UID namespace (10 bytes) in hexstring format</td>
</tr>
<tr>
<td><code>eddystone_instance</code></td>
<td><code>string</code></td>
<td>Eddystone-UID instance (6 bytes) in hexstring format</td>
</tr>
<tr>
<td><code>eddystone_url</code></td>
<td><code>string</code></td>
<td>Eddystone-URL url</td>
</tr>
<tr>
<td><code>power</code></td>
<td><code>int</code></td>
<td>in dBm, default is -12</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name / label of the device</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map where the device belongs to</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>float</code></td>
<td>x in pixel</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>float</code></td>
<td>y in pixel</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>optiona, MAC of the beacon, currently used only to identify battery voltage</td>
</tr>
</tbody>
</table>
<h2 id="get-beacon-stats">Get Beacon Stats</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/beacons
</code></pre>
<h3 id="response_4">Response</h3>
<pre><code>[
    {
        "mac": "c4887201b5a8",
        "name": "conference room",
        "type": "eddystone-uid",
        "eddystone_namespace": "2818e3868dec25629ede",
        "eddystone_instance": "5c5b35000001",
        "power": 4,
        "map_id": "63eda950-c6da-11e4-a628-60f81dd250cc",
        "x": 53.5,
        "y": 173.1,

        "battery_voltage": 3370,
        "last_seen": 1492110810
    }
]
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>battery_voltage</code></td>
<td><code>int</code></td>
<td>battery voltage, in mV</td>
</tr>
</tbody>
</table>
<h1 id="asset-filters">Asset Filters</h1>
<h3 id="base-uri_6">Base URI</h3>
<pre><code>/api/v1/sites/:site_id/assetfilters
</code></pre>
<h2 id="example_6">Example</h2>
<pre><code>{
    // required
    "name": "Visitor Tags",
    "disabled": false,

    // must contain at-least one of the following filter properties
    "ibeacon_uuid": "f3f17139-704a-f03a-2786-0400279e37c3",
    "ibeacon_major": 13,
    "eddystone_uid_namespace": "2818e3868dec25629ede",
    "eddystone_url": "https://www.abc.com",
    "mfg_company_id": 935,
    "service_uuid": "0000fe6a-0000-1000-8000-0030459b3cfb"
}
</code></pre>
<h3 id="parameters_15">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>asset filter name</td>
</tr>
<tr>
<td><code>disabled</code></td>
<td><code>boolean</code></td>
<td>optional; whether the asset filter is disabled, default is false</td>
</tr>
<tr>
<td><code>ibeacon_uuid</code></td>
<td><code>string</code></td>
<td>optional; ibeacon uuid used to filter assets</td>
</tr>
<tr>
<td><code>ibeacon_major</code></td>
<td><code>int</code></td>
<td>optional; ibeacon major value used to filter assets</td>
</tr>
<tr>
<td><code>eddystone_uid_namespace</code></td>
<td><code>string</code></td>
<td>optional; eddystone uid namespace used to filter assets</td>
</tr>
<tr>
<td><code>eddystone_url</code></td>
<td><code>string</code></td>
<td>optional; eddystone url used to filter assets</td>
</tr>
<tr>
<td><code>mfg_company_id</code></td>
<td><code>int</code></td>
<td>optional; ble manufacturing-specific company-id used to filter assets</td>
</tr>
<tr>
<td><code>service_uuid</code></td>
<td><code>string</code></td>
<td>optional; ble service data uuid used to filter assets</td>
</tr>
</tbody>
</table>
<h2 id="get-asset-filters">Get Asset Filters</h2>
<p>Get the list of all BLE asset filters for the given site. Each asset filter in the list operates independently. For a
filter object to match an asset, all of the filter properties must match (logical ‘AND’ of each filter property). For
example, the “Visitor Tags” filter below will match an asset when both the “ibeacon_uuid” and “ibeacon_major” properties
match the asset. All non-matching assets are ignored.</p>
<pre><code>GET /api/v1/sites/:site_id/assetfilters
</code></pre>
<h3 id="response_5">Response</h3>
<pre><code>[
    {
        // Filter #1: each filter can contain any subset of filter properties
        "name": "Visitor Tags",
        "ibeacon_uuid": "f3f17139-704a-f03a-2786-0400279e37c3",
        "ibeacon_major": 13
    },
    {
        // Filter #2: each filter can contain any subset of filter properties
        "name": "Company Tags",
        "eddystone_uid_namespace": "2818e3868dec25629ede",
        "eddystone_url": "https://www.abc.com",
        "mfg_company_id": 935
    }
]
</code></pre>
<h2 id="get-single-asset-filter">Get Single Asset Filter</h2>
<p>Gets a single asset filter by id.</p>
<pre><code>GET /api/v1/sites/:site_id/assetfilters/:filter_id
</code></pre>
<h2 id="create-asset-filter">Create Asset Filter</h2>
<p>Creates a single BLE asset filter for the given site. Any subset of filter properties can be included in the filter. A
matching asset must meet the conditions of all given filter properties (logical ‘AND’).</p>
<pre><code>POST /api/v1/sites/:site_id/assetfilters
</code></pre>
<h3 id="request_17">Request</h3>
<pre><code>{
    "name": "Visitor Tags",
    "ibeacon_uuid": "f3f17139-704a-f03a-2786-0400279e37c3",
    "ibeacon_major": 13,
    "eddystone_uid_namespace": "2818e3868dec25629ede",
    "eddystone_url": "https://www.abc.com",
    "mfg_company_id": 935,
    "service_uuid": "0000fe6a-0000-1000-8000-0030459b3cfb"
    "disabled": False,
}
</code></pre>
<h3 id="parameters_16">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name of Asset Filter</td>
</tr>
<tr>
<td><code>ibeacon_uuid</code></td>
<td><code>string</code></td>
<td>ibeacon_uuid</td>
</tr>
<tr>
<td><code>ibeacon_major</code></td>
<td><code>int</code></td>
<td>ibeacon_major</td>
</tr>
<tr>
<td><code>eddystone_uid_namespace</code></td>
<td><code>string</code></td>
<td>eddystone_uid_namespace</td>
</tr>
<tr>
<td><code>eddystone_uid_namespace</code></td>
<td><code>string</code></td>
<td>eddystone_uid_namespace</td>
</tr>
<tr>
<td><code>mfg_company_id</code></td>
<td><code>int</code></td>
<td>mfg_company_id</td>
</tr>
<tr>
<td><code>service_uuid</code></td>
<td><code>string</code></td>
<td>service_uuid</td>
</tr>
<tr>
<td><code>disabled</code></td>
<td><code>bool</code></td>
<td>whether to disable Asset Filter</td>
</tr>
</tbody>
</table>
<h3 id="response_6">Response</h3>
<pre><code>Status: 200 OK
Status: 400 At least one filter must be specified
</code></pre>
<h2 id="update-asset-filter">Update Asset Filter</h2>
<p>Updates an existing BLE asset filter for the given site.</p>
<pre><code>PUT /api/v1/sites/:site_id/assetfilters/:filter_id
</code></pre>
<h2 id="delete-asset-filter">Delete Asset Filter</h2>
<p>Deletes an existing BLE asset filter for the given site.</p>
<pre><code>DELETE /api/v1/sites/:site_id/assetfilters/:filter_id
</code></pre>
<h1 id="assets">Assets</h1>
<h3 id="base-uri_7">Base URI</h3>
<pre><code>/api/v1/sites/:site_id/assets
</code></pre>
<h3 id="example_7">Example</h3>
<pre><code>{
    "name": "Expensive Instrument",
    "mac": "a31eb04e1c38"
}
</code></pre>
<h3 id="parameters_17">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name / label of the device</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>bluetooth MAC</td>
</tr>
</tbody>
</table>
<h2 id="import-assets">Import assets</h2>
<p>API will replace the assets with same mac if provided upsert=True, otherwise will report in errors in response.</p>
<pre><code>POST /api/v1/sites/:sites_id/assets/import?upsert=True
</code></pre>
<h3 id="upload-via-csv-file">Upload via CSV file</h3>
<h4 id="a-multi-part-post">A multi-part POST</h4>
<pre><code>"file": CSV File
</code></pre>
<h4 id="csv-file-format">CSV File Format</h4>
<pre><code>name,mac
"asset_name",5c5b53010101
</code></pre>
<h3 id="upload-via-json-payload">Upload via JSON Payload</h3>
<pre><code>[
    {
        "name": "Expensive Instrument",
        "mac": "a31eb04e1c38"
    },
    {
        "name": "Cheap Instrument",
        "mac": "a31eb04e1c37"
    }
]
</code></pre>
<h2 id="get-asset-stats">Get Asset Stats</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/assets
</code></pre>
<h3 id="response_7">Response</h3>
<pre><code>[
    {
        "name": "Expensive Instrument",

        "mac": "a31eb04e1c38",

        // populated automatically
        "last_seen": 1492110810,
        "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
        "x": 60,
        "y": 80,

        "ibeacon_uuid": "f3f17139-704a-f03a-2786-0400279e37c3",
        "ibeacon_major": 13,
        "ibeacon_minor": 138,
        "eddystone_uid_namespace": "2818e3868dec25629ede",
        "eddystone_uid_instance": "5c5b35000001",
        "eddystone_url_url": "https://www.abc.com",

        "battery_voltage": 3370
    }
]
</code></pre>
<h3 id="parameters_18">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name / label of the device</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>bluetooth MAC</td>
</tr>
<tr>
<td><code>last_seen</code></td>
<td><code>int</code></td>
<td>last seen timestamp</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map where the device belongs to</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>float</code></td>
<td>x in pixel</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>float</code></td>
<td>y in pixel</td>
</tr>
<tr>
<td><code>battery_voltage</code></td>
<td><code>int</code></td>
<td>battery voltage, in mV</td>
</tr>
</tbody>
</table>
<h2 id="get-detail-asset-stats">Get Detail Asset Stats</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/assets/:asset_id
</code></pre>
<h3 id="response_8">Response</h3>
<pre><code>{
    "name": "Expensive Instrument",

    "mac": "a31eb04e1c38",

    // populated automatically
    "last_seen": 1492110810,
    "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
    "x": 60,
    "y": 80
    "battery_voltage": 3370

    // only send this for individual asset stat
    "zones": [
        {
            "id": "8ac84899-32db-6327-334c-9b6d58544cfe",
            "since": 1428939600
        }
    ],
    "rssizones": [
        {
            "id": "b2af5d7b-c3d0-c5c9-57e9-4d740871db47",
            "since": 1428939600
        }
    ]
}
</code></pre>
<h2 id="get-ble-assets-of-interest">Get BLE Assets of interest</h2>
<p>Get a list of BLE beacons that matches Asset or AssetFilter</p>
<pre><code>GET /api/v1/sites/:site_id/stats/filtered_assets?duration=1d
</code></pre>
<h3 id="response_9">Response</h3>
<pre><code>[
    {
        "mac": "5c5b350eaaaa",
        "curr_site": "67970e46-4e12-11e6-9188-0242ac11aaaa",
        "device_name": "",
        "manufacture": "Mist Systems",
        "id": "3c0c8abc-aaaa-4070-9dd0-b9a18e7ec6fa",
        "name": "asset4",
        "by": "asset",
        "last_seen": 1643837316.760462,
        "map_id": "f5d26c7f-1670-4921-a79d-09f887f4aaaa",
        "_checkpoint_preparer": 1635888509,
        "_checkpoint_scan": 1636148467,
        "_checkpoint_prep": 1636148467,
        "_timestamp": 1643837316,
        "_ttl": 86349,
        "_id": "5c5b350eaaaa",
        "ap_mac": "5c5bbbbeaaaa",
        "beam": 6,
        "rssi": -30
    }
]
</code></pre>
<h2 id="get-discovered-ble-assets">Get Discovered BLE Assets</h2>
<p>Get a list of Discovered Assets that doesn’t match any of the Asset / Assetfilters</p>
<pre><code>GET /api/v1/sites/:site_id/stats/discovered_assets
</code></pre>
<h2 id="get-discovered-ble-assets-by-map">Get Discovered BLE Assets by Map</h2>
<p>Get a list of BLE beacons that we discovered (whether they’re defined as assets or not)</p>
<pre><code>GET /api/v1/sites/:site_id/stats/maps/:map_id/discovered_assets
</code></pre>
<h3 id="response_10">Response</h3>
<pre><code>[
    {
        "mac": "6fa474be7ae5",
        "device_name": "[TV] UN65JU670D",
        "x": 60,
        "y": 80,
        "manufacture": "Apple",
        "last_seen": 1428939600,

        // optionally populated
        "ibeacon_uuid": "f3f17139-704a-f03a-2786-0400279e37c3",
        "ibeacon_major": 13,
        "ibeacon_minor": 138,
        "eddystone_uid_namespace": "2818e3868dec25629ede",
        "eddystone_uid_instance": "5c5b35000001",
        "eddystone_url_url": "https://www.abc.com",
        "mfg_company_id": 935,
        "mfg_data": "648520a1020000",
        "duration": 120

    }
]
</code></pre>
<h3 id="definitions">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>mac address of the (unconnected) client</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map_id of the sdk client (if known), or null</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>int</code></td>
<td>x (in pixels) of user location on the map (if known)</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>int</code></td>
<td>y (in pixels) of user location on the map (if known)</td>
</tr>
<tr>
<td><code>manufacture</code></td>
<td><code>string</code></td>
<td>device manufacture, through fingerprinting or OUI</td>
</tr>
<tr>
<td><code>ibeacon_uuid</code></td>
<td><code>string</code></td>
<td>bluetooth tag UUID</td>
</tr>
<tr>
<td><code>ibeacon_major</code></td>
<td><code>int</code></td>
<td>bluetooth tag major</td>
</tr>
<tr>
<td><code>ibeacon_minor</code></td>
<td><code>int</code></td>
<td>bluetooth tag minor</td>
</tr>
<tr>
<td><code>eddystone_namespace</code></td>
<td><code>string</code></td>
<td>Eddystone-UID namespace (10 bytes) in hexstring format</td>
</tr>
<tr>
<td><code>eddystone_instance</code></td>
<td><code>string</code></td>
<td>Eddystone-UID instance (6 bytes) in hexstring format</td>
</tr>
<tr>
<td><code>eddystone_url</code></td>
<td><code>string</code></td>
<td>Eddystone-URL url</td>
</tr>
<tr>
<td><code>last_seen</code></td>
<td><code>long</code></td>
<td>last seen timestamp</td>
</tr>
<tr>
<td><code>mfg_company_id</code></td>
<td><code>int</code></td>
<td>optional, BLE manufacturing company ID</td>
</tr>
<tr>
<td><code>mfg_data</code></td>
<td><code>string</code></td>
<td>optional, BLE manufacturing data in hex byte-string format (ie: “112233AABBCC”)</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>optional (60-86400; default=60); time duration TTL filter (secs) for each returned asset</td>
</tr>
</tbody>
</table>
<h2 id="assets-search">Assets Search</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/assets/search
GET /api/v1/sites/:site_id/stats/assets/search?mac='fbc721cc3022'
</code></pre>
<h3 id="parameters_19">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>In</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>site_id</code></td>
<td>string</td>
<td>path</td>
<td>UUID of the site</td>
</tr>
<tr>
<td><code>query</code></td>
<td><code>string</code></td>
<td><code>mac</code>,<code>map_id</code>,<code>ibeacon_uuid</code>,<code>ibeacon_major</code>,<code>ibeacon_minor</code>, <code>eddystone_uid_namespace</code>, <code>eddystone_uid_instance</code>, <code>eddystone_url</code>, <code>by</code>, <code>name</code>, <code>device_name</code>, <code>ap_mac</code>,<code>beam</code>,<code>rssi</code></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="response_11">Response</h3>
<pre><code>{
    "results": [
        {
            "battery_voltage": "283",
            "eddystone_uid_namespace": "f7826da6bc5b71e0893e",
            "last_seen": 1633971808,
            "eddystone_uid_instance": "424c43527039",
            "eddystone_url": "eddystone_url",
            "mac": "fbc721cc3022",
            "manufacture": "Unknown",
            "timestamp": 1633971808667,
            "map_id": "map_id",
            "org_id": "org_id",
            "by": "assetfilter",
            "site_id": "site_id",
            "name": "name",
            "temperature": "0.0",
            "ap_mac": "fbc721ccaaaa",
            "rssi": -30,
            "beam": "7"
        },
    ],
    "start": 1633367108.3799882,
    "end": 1633971908.3799632,
    "limit": 100,
    "total": 1
}
</code></pre>
<h2 id="count-asset-by-distinct-field">Count Asset by distinct field</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/assets/count     
GET /api/v1/sites/:site_id/stats/assets/count?distinct=ibeacon_uuid
</code></pre>
<h3 id="parameters_20">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>In</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>site_id</code></td>
<td>string</td>
<td>path</td>
<td>UUID of the site</td>
</tr>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td><code>mac</code>,<code>map_id</code>,<code>ibeacon_uuid</code>,<code>ibeacon_major</code>,<code>ibeacon_minor</code>, <code>eddystone_uid_namespace</code>, <code>eddystone_uid_instance</code>, <code>eddystone_url</code>, <code>by</code>, <code>name</code>, <code>device_name</code>, default is <code>site_id</code></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="response_12">Response</h3>
<pre><code>{
    "results": [
        {
            "site_id": "site_id",
            "count": 19
        }
    ],
    "start": 1633368208.7445683,
    "end": 1633973008.7445416,
    "limit": 100,
    "distinct": "site_id",
    "total": 1,
}

</code></pre>
<h2 id="subscribe-to-discovered-ble-assets-stream">Subscribe to Discovered BLE Assets Stream</h2>
<pre><code>WS /api-ws/v1/stream
</code></pre>
<h3 id="request_18">Request</h3>
<pre><code>{
    "subscribe": "/sites/:site_id/stats/maps/:map_id/discovered_assets"
}
</code></pre>
<h3 id="response_13">Response</h3>
<pre><code>{
    "event": "data",
    "channel": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/stats/maps/63eda950-c6da-11e4-a628-60f81dd250cc/discovered_assets",
    "data": {
         "mac": "4a0222000e31",
         "map_id": "63eda950-c6da-11e4-a628-60f81dd250cc",
         "x": 51.0,
         "y": 29.0,
         "manufacture": "Unknown",
         "last_seen": 1480716946
    }
}
</code></pre>
<h2 id="subscribe-to-ble-assets-stream">Subscribe to BLE Assets Stream</h2>
<pre><code>WS /api-ws/v1/stream
</code></pre>
<h3 id="request_19">Request</h3>
<pre><code>{
    "subscribe": "/sites/:site_id/stats/maps/:map_id/assets"
}
</code></pre>
<h3 id="response_14">Response</h3>
<pre><code>{
    "event": "data",
    "channel": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/stats/maps/63eda950-c6da-11e4-a628-60f81dd250cc/assets",
    "data": {
         "mac": "4a0222000e31",
         "x": 51.0,
         "y": 29.0,
         "last_seen": 1480716946
    }
}
</code></pre>
<p>## Subscribe to MxEdges Stream</p>
<pre><code> WS /api-ws/v1/stream
</code></pre>
<p>### Request</p>
<p><code>{
     "subscribe": "/sites/:site_id/mxedges"
 }</code></p>
<p>### Response</p>
<p><code>{
     "event": "data",
     "channel": "/sites/67970e46-4e12-11e6-9188-0242ac110007/mxedges",
     "data": {
         "device_id": "00000000-0000-0000-1000-5c5b3524500b",
         "event_type": "fwupdate",
         "detail": {
             "timestamp": 1485381027,
             "status": "inprogress",
             "progress": 45
         }
     }
 }</code></p>
<p>### Definition</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>device_id</code></td>
<td><code>string</code></td>
<td>device_id of the device corresponding to the event</td>
</tr>
<tr>
<td><code>event_type</code></td>
<td><code>string</code></td>
<td>type of the event that occurred. currently, on device updates are reported on the stream.</td>
</tr>
<tr>
<td><code>detail</code></td>
<td><code>object</code></td>
<td>detail will be specific to the <code>event_type</code>.</td>
</tr>
</tbody>
</table>
<h2 id="subscribe-to-streaming-pcap">Subscribe to streaming PCAP</h2>
<pre><code>WS /api-ws/v1/stream
</code></pre>
<h3 id="request_20">Request</h3>
<pre><code>{
    {subscribe: "/sites/:site_id/pcaps"}
}
</code></pre>
<h3 id="response-wirelessradiotap">Response (Wireless/RadioTap)</h3>
<pre><code>{
    "event": "data"
    "channel": "/sites/:site_id/pcaps"
    "data": {
         "capture_id": "6b1be4fb-b239-44d9-9d3b-cb1ff3af1721"
         "pcap_dict": {
             "channel_frequency": 2412,
             "channel": "1",
             "datarate": "1.0 Mbps",
             "rssi": -75, 
             "dst": "78:bd:bc:ca:0b:0a",
             "src": "18:b8:1f:4c:91:c0",
             "bssid": "18:b8:1f:4c:91:c0",
             "frame_type": "Management", 
             "frame_subtype": "Probe Response",
             "proto": "802.11", 
             "ap_mac": "d4:20:b0:81:99:2e", 
             "direction": "tx", 
             "timestamp": 1652246543, 
             "length": 416.0,
             "interface": "radiotap",
             "info": "1652246544.467733 1683216786us tsft 1.0 Mb/s 2412 MHz 11g -75dBm signal -82dBm noise antenna 0 Probe Response (ATTKmsWiVS) [1.0* 
                      2.0* 5.5* 11.0* 18.0 24.0 36.0 54.0 Mbit] CH: 2, PRIVACY\\n",
         }, 
        "pcap_raw":         "1MOyoQIABAAAAAAAAAAAAP//AAABAAAAEEh7Yh5VBwCgAQAAoAEAAAAAKwBvCADAAQAAAIw7reCS2VNkAAAAABACbAmABLWuAAEAEBgAAwACAABQADoBeL28ygsKGLgfTJHAGLgfTJHAcIZ2WDlBJQAAAGQAERUACkFUVEttc1dpVlMBCIKEi5YkMEhsAwECBwZVUyABCx4gAQAjAhkAKgEEMgQMEhhgMBQBAAAPrAQBAAAPrAQBAAAPrAIMAAsFAQAbAABGBTIIAQAALRqtCR////8AAAAAAAAAAAAAAAAAAAAAAAAAAD0WAggVAAAAAAAAAAAAAAAAAAAAAAAAAH8IBAAIAAAAAEDdkwBQ8gQQSgABEBBEAAECEDsAAQMQRwAQn2481frn3KT+uGod2ERx+RAhAAtBcnJpcywgSW5jLhAjAApCR1cyMTAtNzAwECQACkJHVzIxMC03MDAQQgAKQkdXMjEwLTcwMBBUAAgABgBQ8gQAARARAA5BcnJpcyBXaXJlbGVzcxAIAAIgCBA8AAEBEEkABgA3KgABIN0JABAYAgEQHAAA3RgAUPICAQGEAAOkAAAnpAAAQkNeAGIyLwAzjakr\"

}
</code></pre>
<h3 id="response-wired">Response (Wired)</h3>
<pre><code>{
    "event": "data"
    "channel": "/sites/67970e46-4e12-11e6-9188-0242ac110007/pcaps"
    "data": {
        "capture_id": "f039b1b4-a23e-48b2-906a-0da40524de73", 
        "pcap_dict": {
             "dst_mac": "68:ec:c5:09:2e:87",
             "src_mac": "8c:3b:ad:e0:47:40", 
             "vlan": 1, 
             "src_ip": "34.224.147.117", 
             "dst_ip": "192.168.1.55",
             "dst_port": 51635, 
             "src_port": 443,
             "proto": "TCP", 
             "ap_mac": "d4:20:b0:81:99:2e",
             "direction": "tx", 
             "timestamp": 1652247615, 
             "length": 159.0, 
             "interface": "wired",
             "info": "1652247616.007409 IP ec2-34-224-147-117.compute-1.amazonaws.com.https &gt; ip-192-168-1-55.ec2.internal.51635: Flags [P.], seq 
                      2192123968:2192124057, ack 4035166782, win 12, options [nop,nop,TS val 597467050 ecr 740580660], length 89\\n",
             }, 
        "pcap_raw": "1MOyoQIABAAAAAAAAAAAAP//AAABAAAAQEx7YhMzAACfAAAAnwAAAGjsxQkuh4w7reBHQIEAAAEIAEUAAI1bLEAAKAZ/CiLgk3XAqAE3AbvJs4KpKEDwg8I+gBgADFf9AAABAQgKI5yfqiwkXTQXAwMAVKY5JopoKQrVEn0/3ld4YntctGEH/rTZuwtCvzSncFw71QJveJi9uxHs57KC8w9Apph3YvXJrmWg7M37+o+YV0KH/xmr626s5Bkhb3QhKOu+NoNEmA==\"

    }
}
</code></pre>
<h3 id="stop-response-wiredwireless">Stop Response (Wired/Wireless)</h3>
<pre><code>{
    "event": "data"
    "channel": "/sites/67970e46-4e12-11e6-9188-0242ac110007/pcaps"
    "data": {
      "capture_id": "a2f7374d-6a70-41fd-8a3f-71e42573baaf", 
      "pcap_dict": null
    }
}
</code></pre>
<h3 id="definitions_1">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>event</code></td>
<td><code>string</code></td>
<td>what type of event is received.</td>
</tr>
<tr>
<td><code>channel</code></td>
<td><code>string</code></td>
<td>from which channel the data is received</td>
</tr>
<tr>
<td><code>capture_id (common)</code></td>
<td><code>string</code></td>
<td>Capture id for the current PCAP.</td>
</tr>
<tr>
<td><code>tcpdump (common)</code></td>
<td><code>string</code></td>
<td>PCAP content recieved after running tcpdump. (can be deprecated as it no longer used by UI)</td>
</tr>
<tr>
<td><code>pcap_dict (common)</code></td>
<td><code>json</code></td>
<td>contains json data for PCAP content. If null capture has been stopped.</td>
</tr>
<tr>
<td><code>dst_mac</code></td>
<td><code>string</code></td>
<td>destination mac address</td>
</tr>
<tr>
<td><code>src_mac</code></td>
<td><code>string</code></td>
<td>source mac address</td>
</tr>
<tr>
<td><code>vlan</code></td>
<td><code>int</code></td>
<td>vlan id</td>
</tr>
<tr>
<td><code>src_ip</code></td>
<td><code>string</code></td>
<td>source ip address</td>
</tr>
<tr>
<td><code>dst_ip</code></td>
<td><code>string</code></td>
<td>destination ip address</td>
</tr>
<tr>
<td><code>dst_port</code></td>
<td><code>string</code></td>
<td>destination port</td>
</tr>
<tr>
<td><code>src_port</code></td>
<td><code>string</code></td>
<td>source port</td>
</tr>
<tr>
<td><code>proto (common)</code></td>
<td><code>string</code></td>
<td>Application / Transport layer protocol associated with the packet</td>
</tr>
<tr>
<td><code>ap_mac</code></td>
<td><code>string</code></td>
<td>Packet belongs to which AP</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>Packet belongs to which device (gateway, switch)</td>
</tr>
<tr>
<td><code>mxedge_id</code></td>
<td><code>string</code></td>
<td>Packet belongs to which Mist Edge</td>
</tr>
<tr>
<td><code>direction (common)</code></td>
<td><code>string</code></td>
<td>tx/rx based on device</td>
</tr>
<tr>
<td><code>timestamp (common)</code></td>
<td><code>float</code></td>
<td>precision upto milliseconds. i.e (1652247616.740)</td>
</tr>
<tr>
<td><code>length (common)</code></td>
<td><code>int</code></td>
<td>length of the packet</td>
</tr>
<tr>
<td><code>lost_messages (common)</code></td>
<td><code>int</code></td>
<td>number of messages lost before sending this packets</td>
</tr>
<tr>
<td><code>channel_frequency (Radiotap)</code></td>
<td><code>int</code></td>
<td>radio band used for sending the packet</td>
</tr>
<tr>
<td><code>channel (Radiotap)</code></td>
<td><code>string</code></td>
<td>an int value representing the channel</td>
</tr>
<tr>
<td><code>datarate (Radiotap)</code></td>
<td><code>string</code></td>
<td>internet speed , represented in Mbps</td>
</tr>
<tr>
<td><code>rssi (Radiotap)</code></td>
<td><code>int</code></td>
<td>rssi value can range from 0 - 255.</td>
</tr>
<tr>
<td><code>dst (Radiotap)</code></td>
<td><code>string</code></td>
<td>destination mac address (Can change to dst_mac)</td>
</tr>
<tr>
<td><code>src (Radiotap)</code></td>
<td><code>string</code></td>
<td>source mac address (Can change to src_mac)</td>
</tr>
<tr>
<td><code>bssid (Radiotap)</code></td>
<td><code>string</code></td>
<td>it’s the MAC physical address of the access point</td>
</tr>
<tr>
<td><code>frame_type (Radiotap)</code></td>
<td><code>string</code></td>
<td>will represent packet belongs to which frame, possible values are management, control, and data.</td>
</tr>
<tr>
<td><code>frame_subtype (Radiotap)</code></td>
<td><code>string</code></td>
<td>will represent packet belongs to which subtype, multiple values are possible.</td>
</tr>
<tr>
<td><code>info (common)</code></td>
<td><code>string</code></td>
<td>PCAP content recieved after running tcpdump.</td>
</tr>
<tr>
<td><code>interface (common)</code></td>
<td><code>string</code></td>
<td>Used to identify whether packet belongs to wired or radiotap. or anyother interface.</td>
</tr>
</tbody>
</table>
<h1 id="psk">PSK</h1>
<h3 id="base-uri_8">Base URI</h3>
<pre><code>/api/v1/sites/:site_id/psks
</code></pre>
<h2 id="add-psk">Add PSK</h2>
<p>Add psk on the site. Required: <code>ssid</code>, <code>passphrase</code>.</p>
<pre><code>POST /api/v1/sites/:site_id/psks
</code></pre>
<h2 id="get-psk">Get PSK</h2>
<p>Get list of psks on the site. If provided, <code>name</code> or <code>ssid</code> or <code>role</code>  query param, psks with exact name/ssid/role match will be
returned.</p>
<pre><code>GET /api/v1/sites/:site_id/psks?name=Common
</code></pre>
<h2 id="example_8">Example</h2>
<pre><code>{
    "name": "Common",
    "passphrase": "foryoureyesonly",
    "ssid": "warehouse",
    "usage": "single",
    "vlan_id": 417,            // optional
    "mac": "5684dae9ac8b",     // optional
    "expire_time": 1614990263  // optional, epoch time in seconds, default is null, as no expiration  
    "notes": "notes"           // optional
    "notify_expiry": true      // optional
    "expiry_notification_time": 2      // optional, unit days
    "notify_on_create_or_edit": true   // optional
    "email": "admin@test.com"  // email to send psk expiring notifications to
}
</code></pre>
<h3 id="definitions_2">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>a name for the PSK</td>
</tr>
<tr>
<td><code>passphrase</code></td>
<td><code>string</code></td>
<td>passphrase of the PSK (8-63 character or 64 in hex)</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>SSID this PSK should be applicable to</td>
</tr>
<tr>
<td><code>usage</code></td>
<td><code>string</code></td>
<td>multi (default) / single</td>
</tr>
<tr>
<td><code>vlan_id</code></td>
<td><code>int</code></td>
<td>VLAN for this PSK key</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>if usage==single, the mac that this PSK ties to, empty if auto-binding</td>
</tr>
<tr>
<td><code>expire_time</code></td>
<td><code>int</code></td>
<td>default is half year, max is 5 year</td>
</tr>
<tr>
<td><code>notes</code></td>
<td><code>string</code></td>
<td>notes</td>
</tr>
<tr>
<td><code>notify_expiry</code></td>
<td><code>boolean</code></td>
<td>If set to true, reminder notification will be sent when psk is about to expire</td>
</tr>
<tr>
<td><code>expiry_notification_time</code></td>
<td><code>int</code></td>
<td>Number of days before psk is expired. Used as to when to start sending reminder notification when the psk is about to expire</td>
</tr>
<tr>
<td><code>notify_on_create_or_edit</code></td>
<td><code>boolean</code></td>
<td>If set to true, notification will be sent when psk is created or edited</td>
</tr>
<tr>
<td><code>email</code></td>
<td><code>string</code></td>
<td>Email to send psk expiring notifications to</td>
</tr>
</tbody>
</table>
<h2 id="delete-psk">Delete PSK</h2>
<p>Delete psks on site. If provided, <code>name</code> or <code>ssid</code> param, psks with exact name/ssid match will be deleted.</p>
<pre><code>DELETE /api/v1/sites/:site_id/psks?ssid=warehouse
</code></pre>
<h3 id="update-multi-psks">Update multi PSKs</h3>
<pre><code>PUT /api/v1/sites/:site_id/psks
</code></pre>
<h3 id="example_9">Example</h3>
<pre><code>[
    {
         "id": "2f64a022-9422-4fa3-92aa-ff6559a9f7f9", //psk_id, required
         "name": "common123",
    },
    {
        "id": "110c59ae-d7b2-40f9-9bf2-82367370e55a", //psk_id, required
        "usage": "single",
        "name": "common12",
        "passphrase": "foryoureyesonly1",
        "role": "teacher",
    }
]
</code></pre>
<h1 id="device">Device</h1>
<p>Devices are things we manufacture. They are traceable to a manufactured entry. They will be added into inventory and
they will need to be assigned to a site in order to be functional.</p>
<h2 id="get-site-devices">Get Site Devices</h2>
<p>Get list of devices on the site.</p>
<pre><code>GET /api/v1/sites/:site_id/devices?name=ap-001
</code></pre>
<h3 id="request_21">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>optional, device name</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>ap, switch, gateway, all, default is ap</td>
</tr>
</tbody>
</table>
<pre><code>[
    {
        "model": "AP41",
        "hw_rev": "0",
        "map_id": "01b04bbe-9687-11e8-a5a9-346895ed1b7d",
        "orientation": 0,
        "org_id": "476057fe-cebb-4be9-9c15-caf1f09d95e0",
        "site_id": "eaa6b2b7-88cd-41ea-8150-9b46b6779235",
        "mac": "5c5b350e0001",
        "modified_time": 1533206823,
        "created_time": 1533196761,
        "tag_id": 107,
        "tag_uuid": "9c557d6a-8a5e-11e6-b1db-0242ac110004",
        "serial": "1002710010001",
        "type": "ap",
        "id": "00000000-0000-0000-1000-5c5b350e0001",
        "name": "ap-001"
    }
]
</code></pre>
<h2 id="device-config">Device Config</h2>
<pre><code>PUT /api/v1/sites/:site_id/devices/:device_id
</code></pre>
<h3 id="request-example">Request Example</h3>
<pre><code>{
    "name": "conference room",
    "notes": "slightly off center",
    "map_id": "63eda950-c6da-11e4-a628-60f81dd250cc",
    "x": 53.5,
    "y": 173.1,
    "orientation": 45,
    "height": 3,
    "locked": false,
    "radio_config": {
        "band_24": {
            "disabled": false,

            "channel": 0,
            "bandwidth": 20,
            "power": 1,
            "antenna_mode": "1x1",
            "allow_rrm_disable": false,
        },
        "band_5": {
            "disabled": false,
            "channel": 0,
            "bandwidth": 40,
            "power": 0,
            "antenna_mode": "default"
        },
        "band_6": {
            "disabled": false,
            "channel": 0,
            "bandwidth": 40,
            "power": 0,
            "antenna_mode": "default"
        },
        "ant_gain_24": 4,       // for models with external antenna
        "ant_gain_5": 5,        // for models with external antenna
        "ant_gain_6": 5,        // for models with external antenna

        // for some AP models (e.g. AP43), 2.4G radio can operation in 5G band
        "band_24_usage": "5",  // 24 (default) / auto
        // if band_24_usage == "5", by default, band_5 properties is used, if specific channel/bandwidth/power/...
        // is desired, use the following
        "band_5_on_24_radio": {
            "disabled": false,
            "channel": 0,
            "bandwidth": 40,
            "power": 0,
            "antenna_mode": "default"
        },

        // to make an outdoor operate indoor, default is false
        // for an outdoor-ap, some channels are disallowed by default, this allows the user
        // to use it as an indoor-ap
        "indoor_use": false,

        "scanning_enabled": true
    },
    "ip_config": {
        "type": "static",
        "ip": "10.2.1.1",
        "netmask": "255.255.255.0",
        "gateway": "10.2.1.254",

        "type6": "static",
        "ip6": "2607:f8b0:4005:808::2004",
        "netmask6": "/32",
        "gateway6": "2607:f8b0:4005:808::1",

        "dns": [ "8.8.8.8", "4.4.4.4" ],
        "dns_suffix": [ ".mist.local", ".mist.com" ],
        "vlan_id": 1,
        "mtu": 0
    },
    "ble_config": {
        "power_mode": "custom",
        "power": 10,
        "beacon_enabled": true,
        "beacon_rate_mode": "custom",
        "beacon_rate": 3,
        "beam_disabled": [ 1, 3, 6 ],

        // ibeacon
        "ibeacon_enabled": true,
        "ibeacon_uuid": "f3f17139-704a-f03a-2786-0400279e37c3",
        "ibeacon_major": 13,
        "ibeacon_minor": 138,
        "ibeacon_adv_power": -65,
        "ibeacon_beams": "2-4,7",  // or 'default' to auto-set

        "eddystone_uid_enabled": false,
        "eddystone_uid_namespace": "2818e3868dec25629ede",
        "eddystone_uid_instance": "5c5b35000001",
        "eddystone_uid_freq_msec": 200,
        "eddystone_uid_adv_power": -65,
        "eddystone_uid_beams": "2-4,7",  // or 'default' to auto-set

        "eddystone_url_enabled": false,
        "eddystone_url_url": "https://www.abc.com",
        "eddystone_url_freq_msec": 1000,
        "eddystone_url_adv_power": -65,
        "eddystone_url_beams": "2-4,7",  // or 'default' to auto-set

        // custom packet
        "custom_ble_packet_enabled": true,
        "custom_ble_packet_freq_msec": 300,
        "custom_ble_packet_frame": "0x........"
    },
    "usb_config": {
        "enabled": true,

        // imagotag
        "type": "imagotag",
        "host": "1.1.1.1",
        "channel": 3,
        "port": 0,
        "verify_cert": false,
        "cacert": ""

        // Solum or Hanshow
        "type": "solum", // or "hanshow"
        "vlan_id": 1, // default is 1
    },
    "esl_config": {
        "enabled": true,

        // usb_config is ignored if esl_config enabled
        "type": "imagotag",  // imagotag / hanshow / solum / native

        // imagotag, native: AP imagotage native solution
        // note: ble_config will be ingored if esl_config is enabled and with native mode. 
        "type": "imagotag", // or "native"
        "host": "1.1.1.1",
        "channel": 3,
        "port": 0,
        "verify_cert": false,
        "cacert": ""

        // Solum or Hanshow
        "type": "solum", // or "hanshow"
        "vlan_id": 1, // default is 1
    }
    "aeroscout": {
        "enabled": true,
        "host": "aero.pvt.net",
        "locate_connected": true
    },
    "centrak": {
        "enabled": true,
    },
    "led": {
        "enabled": true,
        "brightness": 255
    },
    "mesh": {
        "enabled": true,
        "role": "base",  // base / relay
        "group": 0,
        "bands": ["5", "6"]  // default is ["5"], for relay, the first viable one will be picked
    },

    "client_bridge": {
        // when acted as client bridge
        // - only 5G radio can be used
        // - will not serve as AP on any radios        
        "enabled": true,
        "ssid": "Uplink-SSID",
        "auth": {
            "type": "psk",  // psk (default) / open            
            "psk": "foryoureyesonly",
            // - wpa2-ccmp is assumed when `psk` is choosed
        }
    },

    "uplink_port_config": {
        // whether to do 802.1x against uplink switch
        // when enaled, AP cert will be used to do EAP-TLS
        // and the Org's CA Cert has to be provisioned at the switch
        "dot1x": false,         
        "keep_wlans_up_if_down": false  // by default, WLANs are disabled when uplink is down. In some scenario, like SiteSurvey, one would want the AP to keep sending beacons.
    },

    "port_config": {
        // eth0 is not allowed here
        // if spcified, this takes predecence over switch_config (deprecated)
        "eth1,eth2": {
            "forwarding": "all",  // all (vlans as eth0) / limited / wxtunnel / mxtunnel / site_mxedge 

            // if forwrding == limited
            "vlan_ids": [1, 10, 50],
            "port_vlan_id": 1,

            // if forwarding == wxtunnel, the port is bridged to the vlan of the session
            "wxtunnel_id": "7dae216d-7c98-a51b-e068-dd7d477b7216",
            "wxtunnel_remote_id": "wifiguest",

            // if forwarding == mxtunnel, vlan_ids comes from mxtunnel
            "mxtunnel_id": "08cd7499-5841-51c8-e663-fb16b6f3b45e",
            // optional to specify the vlan id for a tunnel if forwarding is for wxtunnel, mxtunnel and site_mxedge.
            // if vlan_id is not specified then it will use first one in vlan_ids[] of the mxtunnel
            "vlan_id": 9,

            // if forwarding == site_mxedge, vlan_ids comes from site_mxedge (`mxtunnels` under site setting)
            "mxtunnel_name": "default",
            "vlan_id": 9, // optional

            // other common attributes

            // whether to do port auth
            "port_auth": "dot1x",  // none (default)
            "enable_mac_auth": true,
            "mac_auth_protocol": "eap-md5",
            "mac_auth_preferred": false,  // when enable_mac_auth=true, we'll do dot1x then mac_auth. enable this to prefer mac_auth

            // whether simply disabled
            "disabled": false,

            // site setting will be used unless overwriten here
            "radius_config": {
                // if per-device overwrite is desired. see site setting for schema
            },
            // or radsec can be used
            "radsec": {
                // see WLAN radsec config for schema
            },
            "mist_nac": {
                "enabled": true,
            },

            // optional dynamic vlan
            "dynamic_vlan": {
                "enabled": true,
                "type": "standard",
                "vlans": {
                    "1-10": null,
                    "user": null,
                },
                "default_vlan_id": 999
            }
        }
    },

    "iot_config": {
        "DO": {
            "enabled": true,
            "value": 1
        },
        // 'DI1', 'DI2' pins can only be configured as inputs with an external pull-up
        "DI1": {
            "name": "motion",
            "enabled": true,
        },
        "A1": {
            "name": "pulled-up analog",
            "enabled": true
        }
    },
    "lacp_config": {
        "enabled": true,
    },
    "disable_eth1": false,
    // disable_eth2 and disable_eth3 are applied for some specific models, e.g. AP12
    "disable_eth2": false,
    "disable_eth3": false,
    "disable_module": false,
    "poe_passthrough": false,

    // for some AP models, flow_control can be enabled to address some switch compatibility issue
    "flow_control": {
        "enabled": true,  // default is false
    }

    "pwr_config": {
        "base": 2000,
        "prefer_usb_over_wifi": false
    },

    "vars": {
        "RADIUS_SECRET": "11s64632d",
        "RADIUS_IP1": "172.31.2.5"
    },

    "ntp_servers": [], // optional

    "deviceprofile_id": "6f4bf402-45f9-2a56-6c8b-7f83d3bc98e9", 

    "image1_url": "https://url/to/image.png"
}
</code></pre>
<h3 id="parameters_21">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name / label of the device</td>
</tr>
<tr>
<td><code>notes</code></td>
<td><code>string</code></td>
<td>any notes about this AP</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map where the device belongs to</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>float</code></td>
<td>x in pixel</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>float</code></td>
<td>y in pixel</td>
</tr>
<tr>
<td><code>orientation</code></td>
<td><code>int</code></td>
<td>orientation, 0-359, in degrees, up is 0, right is 90.</td>
</tr>
<tr>
<td><code>height</code></td>
<td><code>float</code></td>
<td>height, in meters, optional</td>
</tr>
<tr>
<td><code>locked</code></td>
<td><code>boolean</code></td>
<td>whether this AP is considered locked (placement / orientation has been vetted)</td>
</tr>
<tr>
<td><code>vars</code></td>
<td><code>object</code></td>
<td>a dictionary of name-&gt;value, the vars can then be used in Wlans. This can overwrite those from Site Vars</td>
</tr>
<tr>
<td>* <code>orientation</code>: AP orientation, netural to user’s perspective, LED always points to antenna 1</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="radio-configs">Radio Configs</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>radio_config</code></td>
<td><code>object</code></td>
<td>radio configs</td>
</tr>
<tr>
<td><code>band_24</code></td>
<td><code>object</code></td>
<td>radio config for 2.4G</td>
</tr>
<tr>
<td><code>band_5</code></td>
<td><code>object</code></td>
<td>radio config for 5G</td>
</tr>
<tr>
<td><code>band_6</code></td>
<td><code>object</code></td>
<td>radio config for 6G</td>
</tr>
<tr>
<td><code>band_24_usage</code></td>
<td><code>string</code></td>
<td>24 / 5 / 6 / auto, default is 24</td>
</tr>
<tr>
<td><code>scanning_enabled</code></td>
<td><code>boolean</code></td>
<td>whether scanning radio is enabled</td>
</tr>
<tr>
<td><code>disabled</code></td>
<td><code>boolean</code></td>
<td>whether to disable the radio</td>
</tr>
<tr>
<td><code>channel</code></td>
<td><code>int</code></td>
<td>(primary) channel for the band, 0 means using the Site Setting</td>
</tr>
<tr>
<td><code>power</code></td>
<td><code>int</code></td>
<td>tx power of the radio, null or 0 means auto, when power_min=power_max=power=0 to indicate power=0</td>
</tr>
<tr>
<td><code>ant_gain_24</code></td>
<td><code>int</code></td>
<td>antenna gain for 2.4G - for models with external antenna only</td>
</tr>
<tr>
<td><code>ant_gain_5</code></td>
<td><code>int</code></td>
<td>antenna gain for 5G - for models with external antenna only</td>
</tr>
<tr>
<td><code>bandwidth</code></td>
<td><code>int</code></td>
<td>channel width for the band, 20 / 40 / 80 / 160, 80 is only applicable for band_5 and 160 is only for band_6, ignored if channel is 0</td>
</tr>
<tr>
<td><code>channels</code></td>
<td><code>list</code></td>
<td>list of channels, null or empty array means auto</td>
</tr>
<tr>
<td><code>antenna_mode</code></td>
<td><code>string</code></td>
<td>default / 1x1 / 2x2 / 3x3 / 1x4</td>
</tr>
<tr>
<td><code>power_min</code></td>
<td><code>int</code></td>
<td>when power=0, min tx power to use, HW-specific values will be used if not set</td>
</tr>
<tr>
<td><code>power_max</code></td>
<td><code>int</code></td>
<td>when power=0, max tx power to use, HW-specific values will be used if not set</td>
</tr>
<tr>
<td><code>preamble</code></td>
<td><code>string</code></td>
<td>short / long / auto, default is short</td>
</tr>
<tr>
<td><code>usage</code></td>
<td><code>string</code></td>
<td>for band_24 radio, 24 / 5 / rrm, default is 24</td>
</tr>
</tbody>
</table>
<h4 id="ip-config">IP Config</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ip_config</code></td>
<td><code>object</code></td>
<td>ip config</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>static / dhcp (default)</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>required if type==static</td>
</tr>
<tr>
<td><code>netmask</code></td>
<td><code>string</code></td>
<td>required if type==static</td>
</tr>
<tr>
<td><code>gateway</code></td>
<td><code>string</code></td>
<td>required if type==static</td>
</tr>
<tr>
<td><code>dns</code></td>
<td><code>list</code></td>
<td>required if type==static</td>
</tr>
<tr>
<td><code>dns_suffix</code></td>
<td><code>list</code></td>
<td>if type==static</td>
</tr>
<tr>
<td><code>vlan_id</code></td>
<td><code>int</code></td>
<td>management vlan id, default is 1 (untagged)</td>
</tr>
</tbody>
</table>
<h4 id="ble">BLE</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ble_config</code></td>
<td><code>object</code></td>
<td>BLE config</td>
</tr>
<tr>
<td><code>power_mode</code></td>
<td><code>string</code></td>
<td>default / custom</td>
</tr>
<tr>
<td><code>power</code></td>
<td><code>int</code></td>
<td>required if power_mode==custom, 2-7; else use <code>power_mode</code> as default</td>
</tr>
<tr>
<td><code>beacon_enabled</code></td>
<td><code>boolean</code></td>
<td>whether Mist beacons is enabled, default is true</td>
</tr>
<tr>
<td><code>beacon_rate_mode</code></td>
<td><code>string</code></td>
<td>default / custom</td>
</tr>
<tr>
<td><code>beacon_rate</code></td>
<td><code>int</code></td>
<td>required if beacon_rate_mode==custom, 1-10, in number-beacons-per-second</td>
</tr>
<tr>
<td><code>beam_disabled</code></td>
<td><code>list</code></td>
<td>list of AP BLE location beam numbers (1-8) which should be disabled at the AP and not transmit location information (where beam 1 is oriented at the top the AP, growing counter-clock-wise, with 9 being the omni BLE beam)</td>
</tr>
<tr>
<td><code>ibeacon_enabled</code></td>
<td><code>boolean</code></td>
<td>can be enabled if beacon_enabled=true, whether to send iBeacon, default is false</td>
</tr>
<tr>
<td><code>ibeacon_uuid</code></td>
<td><code>string</code></td>
<td>optional, if not specified, the same UUID as the beacon will be used</td>
</tr>
<tr>
<td><code>ibeacon_major</code></td>
<td><code>int</code></td>
<td>Major number for iBeacon</td>
</tr>
<tr>
<td><code>ibeacon_minor</code></td>
<td><code>int</code></td>
<td>Minor number for iBeacon</td>
</tr>
<tr>
<td><code>ibeacon_freq_msec</code></td>
<td><code>int</code></td>
<td>Frequency (msec) of data emmit for iBeacon</td>
</tr>
<tr>
<td><code>ibeacon_adv_power</code></td>
<td><code>int</code></td>
<td>advertised TX Power, -100 to 20 (dBm), omit this attribute to use default</td>
</tr>
<tr>
<td><code>eddystone_uid_enabled</code></td>
<td><code>boolean</code></td>
<td>only if beacon_enabled=false, Whether Eddystone-UID beacon is enabled</td>
</tr>
<tr>
<td><code>eddystone_uid_namespace</code></td>
<td><code>string</code></td>
<td>Eddystone-UID namespace</td>
</tr>
<tr>
<td><code>eddystone_uid_instance</code></td>
<td><code>string</code></td>
<td>Eddystone-UID instance for the device</td>
</tr>
<tr>
<td><code>eddystone_uid_freq_msec</code></td>
<td><code>int</code></td>
<td>Frequency (msec) of data emmit by Eddystone-UID beacon</td>
</tr>
<tr>
<td><code>eddystone_uid_adv_power</code></td>
<td><code>int</code></td>
<td>advertised TX Power, -100 to 20 (dBm), omit this attribute to use default</td>
</tr>
<tr>
<td><code>eddystone_url_enabled</code></td>
<td><code>boolean</code></td>
<td>only if beacon_enabled=false, Whether Eddystone-URL beacon is enabled</td>
</tr>
<tr>
<td><code>eddystone_url_url</code></td>
<td><code>string</code></td>
<td>URL pointed by Eddystone-URL beacon</td>
</tr>
<tr>
<td><code>eddystone_url_freq_msec</code></td>
<td><code>int</code></td>
<td>Frequency (msec) of data emit by Eddystone-UID beacon</td>
</tr>
<tr>
<td><code>eddystone_url_adv_power</code></td>
<td><code>int</code></td>
<td>advertised TX Power, -100 to 20 (dBm), omit this attribute to use default</td>
</tr>
<tr>
<td><code>custom_ble_packet_enabled</code></td>
<td><code>boolean</code></td>
<td>can be enabled if beacon_enabled=true, whether to send custom packet, default is false</td>
</tr>
<tr>
<td><code>custom_ble_packet_freq_msec</code></td>
<td><code>int</code></td>
<td>Frequency (msec) of data emitted by custom ble beacon</td>
</tr>
<tr>
<td><code>custom_ble_packet_frame</code></td>
<td><code>string</code></td>
<td>The custom frame to be sent out in this beacon. The frame must be a hexstring</td>
</tr>
</tbody>
</table>
<h4 id="usb-config-for-imagotag">USB Config for Imagotag</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>usb_config</code></td>
<td><code>object</code></td>
<td>USB config</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether to enable any usb config</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>usb config type, option: imagotag</td>
</tr>
<tr>
<td><code>channel</code></td>
<td><code>int</code></td>
<td>channel selection, 0-10, not needed by default, required for manual channel override only</td>
</tr>
<tr>
<td><code>host</code></td>
<td><code>string</code></td>
<td>required if type==imagotag</td>
</tr>
<tr>
<td><code>port</code></td>
<td><code>int</code></td>
<td>port, default 0</td>
</tr>
<tr>
<td><code>verify_cert</code></td>
<td><code>boolean</code></td>
<td>whether to turn on SSL verification</td>
</tr>
<tr>
<td><code>cacert</code></td>
<td><code>string</code></td>
<td>ca certs</td>
</tr>
</tbody>
</table>
<p>Note: if native imagotag is enabled, BLE will be disabled automatically
Note: legacy, new config moved to ESL Config. </p>
<h4 id="usb-config-for-solum-or-hanshow">USB Config for Solum or Hanshow</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>usb_config</code></td>
<td><code>object</code></td>
<td>USB config</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether to enable any usb config</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>usb config type, option: solum, hanshow</td>
</tr>
<tr>
<td><code>vlan_id</code></td>
<td><code>int</code></td>
<td>vlan id for type as solum or hanshow, default is 1</td>
</tr>
</tbody>
</table>
<h4 id="esl-config-for-imagotag-or-native">ESL Config for Imagotag or Native</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>esl_config</code></td>
<td><code>object</code></td>
<td>ESL config</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether to enable any esl config</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>esl config type, option: imagotag</td>
</tr>
<tr>
<td><code>channel</code></td>
<td><code>int</code></td>
<td>channel selection, 0-10, not needed by default, required for manual channel override only</td>
</tr>
<tr>
<td><code>host</code></td>
<td><code>string</code></td>
<td>required if type==imagotag</td>
</tr>
<tr>
<td><code>port</code></td>
<td><code>int</code></td>
<td>port, default 0</td>
</tr>
<tr>
<td><code>verify_cert</code></td>
<td><code>boolean</code></td>
<td>whether to turn on SSL verification</td>
</tr>
<tr>
<td><code>cacert</code></td>
<td><code>string</code></td>
<td>ca certs</td>
</tr>
</tbody>
</table>
<p>Note: if native imagotag is enabled, BLE will be disabled automatically</p>
<h4 id="esl-config-for-solum-or-hanshow">ESL Config for Solum or Hanshow</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>esl_config</code></td>
<td><code>object</code></td>
<td>ESL config</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether to enable any esl config</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>usb config type, option: solum, hanshow</td>
</tr>
<tr>
<td><code>vlan_id</code></td>
<td><code>int</code></td>
<td>vlan id for type as solum or hanshow, default is 1</td>
</tr>
</tbody>
</table>
<h4 id="aeroscout-config">Aeroscout Config</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>aeroscout</code></td>
<td><code>object</code></td>
<td>aeroscout config</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether to enable aeroscout config</td>
</tr>
<tr>
<td><code>host</code></td>
<td><code>string</code></td>
<td>required if enabled, aeroscout server host</td>
</tr>
<tr>
<td><code>locate_connected</code></td>
<td><code>boolean</code></td>
<td>whether to enable the feature to allow wireless clients data received and sent to AES server for location calculation</td>
</tr>
</tbody>
</table>
<h4 id="centrak-config">Centrak Config</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>centrak</code></td>
<td><code>object</code></td>
<td>centrak config</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether to enable centrak config</td>
</tr>
</tbody>
</table>
<h4 id="led-config">LED Config</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>led</code></td>
<td><code>object</code></td>
<td>LED control</td>
</tr>
</tbody>
</table>
<h4 id="mesh">Mesh</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mesh</code></td>
<td><code>object</code></td>
<td>mesh-related</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether mesh is enabled on this AP, default is false</td>
</tr>
<tr>
<td><code>role</code></td>
<td><code>string</code></td>
<td>base / remote</td>
</tr>
<tr>
<td><code>group</code></td>
<td><code>int</code></td>
<td>mesh group, base AP(s) will only allow remote AP(s) in the same mesh group to join, 1-9, optional</td>
</tr>
<tr>
<td><code>bands</code></td>
<td><code>list</code></td>
<td>list of bands that the mesh should apply to. For relay, the first viable one will be picked</td>
</tr>
</tbody>
</table>
<h4 id="port-configs">Port Configs</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>disable_eth1</code></td>
<td><code>boolean</code></td>
<td>whether to disable eth1 port, default is false</td>
</tr>
<tr>
<td><code>disable_eth2</code></td>
<td><code>boolean</code></td>
<td>whether to disable eth2 port, default is false</td>
</tr>
<tr>
<td><code>disable_eth3</code></td>
<td><code>boolean</code></td>
<td>whether to disable eth3 port, default is false</td>
</tr>
<tr>
<td><code>disable_module</code></td>
<td><code>boolean</code></td>
<td>whether to disable module port, default is false</td>
</tr>
</tbody>
</table>
<h4 id="power-configs">Power Configs</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>poe_passthrough</code></td>
<td><code>boolean</code></td>
<td>whether to enable power out through module port (for APH) or eth1 (for APL/BT11), default is false</td>
</tr>
<tr>
<td><code>pwr_config</code></td>
<td><code>object</code></td>
<td>power related configs</td>
</tr>
<tr>
<td><code>base</code></td>
<td><code>int</code></td>
<td>additional power to request during negotiating with PSE over PoE, in mW, default is 0</td>
</tr>
<tr>
<td><code>prefer_usb_over_wifi</code></td>
<td><code>boolean</code></td>
<td>whether to enable power out to peripheral, meanwhile will reduce power to wifi (only for AP45 at power mode), default is false</td>
</tr>
<tr>
<td>#### Port Config</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="iot-configs">IoT Configs</h4>
<p>Configuration of IoT pins. By default, all the pins are disabled</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>iot_config</code></td>
<td><code>object</code></td>
<td>IoT port configuration</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>optional; descriptive pin name</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether to enable a pin, default is <code>false</code></td>
</tr>
<tr>
<td><code>value</code></td>
<td><code>boolean</code></td>
<td>output pin signal level, default <code>0</code></td>
</tr>
<tr>
<td><code>pullup</code></td>
<td><code>string</code></td>
<td>the type of pull-up the pin uses (<code>internal</code>, <code>external</code>, <code>none</code>), default <code>none</code></td>
</tr>
<tr>
<td><code>DO</code></td>
<td><code>object</code></td>
<td>Digital Output pin settings, <code>value</code> can be 0 / 1</td>
</tr>
<tr>
<td><code>DI1</code></td>
<td><code>object</code></td>
<td>Digital Input-1 pin settings</td>
</tr>
<tr>
<td><code>DI2</code></td>
<td><code>object</code></td>
<td>Digital Input-2 pin settings</td>
</tr>
<tr>
<td><code>A1</code></td>
<td><code>object</code></td>
<td>Analog Input pin settings</td>
</tr>
<tr>
<td><code>A2</code></td>
<td><code>object</code></td>
<td>Analog Input pin settings</td>
</tr>
<tr>
<td><code>A3</code></td>
<td><code>object</code></td>
<td>Analog Input pin settings</td>
</tr>
<tr>
<td><code>A4</code></td>
<td><code>object</code></td>
<td>Analog Input pin settings</td>
</tr>
<tr>
<td><code>output</code></td>
<td><code>boolean</code></td>
<td>whether the pin is configured as an output. <code>DO</code> and <code>A1</code>-<code>A4</code> can be repurposed by changing</td>
</tr>
</tbody>
</table>
<h2 id="switch-config">Switch Config</h2>
<pre><code>{
    "name": "corp-a135",
    "role": "access",  // switch role
    "notes": "slightly off center",

    "ip_config": {
        // the default l3 interface of the switch
        "type": "static",
        "ip": "10.2.1.10",
        "netmask": "255.255.255.0",
        "gateway": "10.2.1.254",

        "dns": [ "8.8.8.8", "4.4.4.4" ],
        "dns_suffix": [ ".mist.local", ".mist.com" ],

        // or the network where this mgmt IP reside, this will be used as default network for
        // outbound-ssh, dns, ntp, dns, tacplus, radius, syslog, snmp
        "network": "default"
    },
    "oob_ip_config": {
        // out-of-band (vme/em0/fxp0) IP config
        // same payload as `ip_config` except dns / dns_suffix / gateway

        // for HA Cluster, node1 can have different IP Config
        "node1": {
            // same payload as `ip_config` except dns / dns_suffix / gateway
        }

        // if supported on the platform. If enabled, DNS will be using this routing-instance, too
        "use_mgmt_vrf": false  // false (default) / true

        // for host-out traffic (NTP/TACPLUS/RADIUS/SYSLOG/SNMP), if alternative source network/ip is desired, 
        "use_mgmt_vrf_for_host_out": false, // false (default), whether to use `mgmt_junos`
    },

    // most of the time, it's better to use `port_usages` and `networks` in Site Setting to achieve better consistency
    // and be able to re-use the same settings across switches
    // entries defined here will "replace" those defined in Site Setting/Network Template
    "networks": {
        "guest": {
            "vlan_id": 300,
            "ospf_passive": true
        }
    },

    "other_ip_configs": {
        // optional, if it's required to have switch's L3 presense on a network/vlan 
        "guest": {
            "type": "static",
            "ip": "10.3.3.1",
            "netmask": "255.255.255.0",  // optional, `subnet` from `network` definition will be used if defined

            // for EVPN, if anycast is desired
            "evpn_anycast": false   // default is false 

            "type6": "static",  // disabled (default) / autoconf / dhcp / static
            "ip6": "fdad:b0bc:f29e::3d16",
            "netmask6": "/64",
            "gateway6": "fdad:b0bc:f29e::1"
        }
    },
    "ntp_servers": [
        "pool.ntp.org",
        "time.google.com"
    ],
    // global dns settings. To keep compatibility, dns settings in ip_config and oob_ip_config
    // will overwrite this setting
    "dns_servers": [ "8.8.8.8", "4.4.4.4" ],
    "dns_suffix": [ ".mist.local", ".mist.com" ],

    "port_config": {
        "ge-0/0/0": {
            "usage": "uplink"

            // if aggregated
            "aggregated": true,
            "ae_idx": 1,                      // optional. Users could force to use the designated AE name
            "ae_disable_lacp": true,          // optional. To disable LCP support for the AE interface
            "description": "to dist-sw-01",   // optional
            "ae_lacp_slow": true,             // optional, by default, fast timeout is used
            // for esilag
            "esilag": true
        },
        "ge-0/0/1": {
            "usage": "default",
            // Enable dynamic usage for this port
            "dynamic_usage": "dynamic"
        },
        "ge-0/0/8-16,ge-1/0/0-47": {
            "usage": "ap"
        },

        "ge-0/0/2-3": {
            "usage": "evpn_uplink'
        },

        "ge-0/0/4": {
            "usage": "inet",
            "port_network": "guest",

            // optional
            // speed, duplex, disable_autoneg, mtu, poe_disabled            
        },

        "ge-0/0/5": {
            "usage": "vlan_tunnel",
            "port_network": "customer1",  // required

            // optional
            // speed, duplex, disable_autoneg, mtu, disabled, poe_disabled, storm_control          
        },

        // this is assumed
        "*": {
            "usage": "default"
        }
    },

    // per-device only, supported attributes:
    // - description
    // - poe_disabled
    // - disabled
    // - speed
    // - duplex
    "port_config_overwrite": {
        "ge-0/0/9": {
            "disabled": true
        },
    },

    // static routes
    "extra_routes": {
        "it_mgmt": {   // use names from `networks`
            "via": "10.2.1.1",

            // all optional
            "metric": null,  // 0-4294967295
            "preference": 30,  // 0-4294967295
            "next_qualified": {
                "10.3.1.1": {
                    "metric": null,
                    "preference": 40
                },                
            },
            "discard": false,  // this takes precedence
            "no_resolve": false
        },
        "172.16.3.0/24": {
            "via": "10.2.1.1"
        }
    },
    // for ipv6
    "extra_routes6": {
        "2a02:1234:420a:10c9::/64": {
            "via": "2a02:1234:200a::100"
        }
    },

    // aggregate routes
    "aggregate_routes": {
        "172.16.3.0/24": {
            // all optional
            "metric": null,  // 0-4294967295
            "preference": 30,  // 0-4294967295
            "discard": false
        }
    },
    // for ipv6
    "aggregate_routes6": {
        "2a02:1234:420a:10c9::/64": {}
    },

    // used for ospf / bgp / ...
    "router_id": "10.2.1.10",
    // whether to use it for snmp / syslog / tacplus / radius
    "use_router_id_as_source_ip": false,

    "stp_config": {
        "bridge_priority": "40k", // 32k (default), Range [0, 4k, 8k.. 60k] in steps of 4k. Bridge priority applies to both VSTP and RSTP.
    }

    // to enable OSPF on this device
    "ospf_config": {
        "enabled": true,
        "reference_bandwidth": "100M", //Bandwidth for calculating metric defaults (9600..4000000000000), default is 100M
        "areas": {
            "0": {
                "no_summary": false
            }
        }
    },

    "dhcpd_config": {
        "enabled": true,
        "corp": {
            "type": "local",  // default
            "ip_start": "192.168.70.100",
            "ip_end": "192.168.70.200",                
            "gateway": "192.168.70.1",

            // Maximum number of seconds the lease can be held
            "lease_time": 86400, // in seconds, lease time has to be between 3600 [1hr] - 604800 [1 week], default is 86400 [1 day]

            // optional, system one will be used
            "dns_servers": [ "8.8.8.8", "4.4.4.4" ],
            "dns_suffix": [ ".mist.local", ".mist.com" ],

            // fixed binding
            "fixed_bindings": {
                "5684dae9ac8b": {
                    "name": "John",
                    "ip": "192.168.70.35"
                }
            }

            // if using DHCP relay
            "type": "relay",
            "servers": ["11.2.3.4"],

            // if using DHCPv6 server
            "type6": "local" // none (default) / relay / local
            "ip6_start": "2607:f8b0:4005:808::2",
            "ip6_end": "2607:f8b0:4005:808::ff",

            // if using DHCPv6 relay
            "type6": "relay"
            "serversv6": ["2607:f8b0:4005:808::64"]

            // when defined in template, this allows device to override
            "disabled": false
        },
        // it's common for many networks to use the same dhcp relay, comma-separated network names can be used here
        "net1,net2": {
            "type": "relay",
            "servers": ["11.2.3.4"]
        }        
    },

    "dhcp_snooping": {
        "enabled": true,
        "all_networks": false,

        // if all_networks = false
        "networks": [ "corp" ],

        // Enable for dynamic ARP inspection check 
        "enable_arp_spoof_check": true,

        // Enable for check for forging source IP address
        "enable_ip_source_guard": true,
    },

    // to enable VRRP on this device
    "vrrp_config": {
        "enabled": true,
        "groups": {
            "0": {
                // optional
                "priority": 200,
                "accept_data": true, // default false, accept packets destined for VRRP address
                "preempt": true, // default false, allow preemption (a backup router can preempt a primary router)
            }
        }
    },

    "vrf_config": {
        "enabled": true,  // whether to enable VRF (when supported on the device)
    },

    "acl_tags": {

        "iot": {
            "type": "mac",
            "network": "iot",  // optional, default is any
            "macs": ["010203040506", "abcdef*"],
        },

        "printer": {
            "type": "subnet",
            "network": "lan",  // optional, default is any
            "subnets": ["192.168.1.30/32"]
        },

        "guest": {
            "type": "network",
            "network": "guest"
        },

        "vip_from_filter_id": {
            "type": "radius_group",
            "radius_group": "VIP"
            // optional
            "subnets": ["192.168.1.30/32"],
            "specs": [
                {
                    "protocol": "tcp",  // tcp / udp / icmp / gre / any / ":protocol_number", `protocol_number` is between 1-254, default is `any`
                    "port_range": "80"  // matched dst port, "0" means any, default is "0"
                }                
            ]
        },

        "iot": {
            "type": "port_usage",
            "port_usgae": "iot",
            // optional
            "subnets": ["192.168.1.30/32"],
            "specs": [
                {
                    "protocol": "tcp",  // tcp / udp / icmp / gre / any / ":protocol_number", `protocol_number` is between 1-254, default is `any`
                    "port_range": "80"  // matched dst port, "0" means any, default is "0"
                }                
            ]
        },

        // implicit, cannot override
        "any": {
            // matching anything not identified
            "type": "any"
        },

        "resource": {
            // resource can only be used in `dst_tags`
            "type": "resource",

            "network": "dmz",  // default is any
            "subnets": ["192.168.0.5"],  // default is any
            "ether_types": ["arp"] // arp / ipv6. Default is any. Can only be used under dst tags. 
            "specs": [
                {
                    "protocol": "tcp",  // tcp / udp / icmp / gre / any / ":protocol_number", `protocol_number` is between 1-254, default is `any`
                    "port_range": "80"  // matched dst port, "0" means any, default is "0"
                }                
            ]  // empty means unrestricted, i.e. any
        },

        // GBP tags
        "vip_tagged_by_radius": {
            // from the gbp_tag received from RADIUS
            "type": "dynamic_gbp",
            "gbp_tag": 100,
        },

        "vip_tagged_from_traffic": {
            // applying gbp tag against matching conditions
            "type": "static_gbp",
            "gbp_tag": 100,

            // or matching network (vlan)           
            "network": "employee",
            // or subnet
            "subnets": ["192.168.0.0/16"],
            // or MAC
            "macs": ["010203040506", "abcdef*"]
        },

        "gbp_resource": {
            // can only be used in `dst_tags`
            "type": "gbp_resource",
            "gbp_tag": 100,
            "specs": [
                {
                    "protocol": "tcp",  // tcp / udp / gre / icmp / icmp6
                    "port_range": "80"  // matched dst port, "0" means any
                }                
            ]
        },
    },

    "acl_policies": [
        {
            "name": "guest access",
            "src_tags": ["macs"], 
            "actions": [
                {
                    "dst_tag": "rfc1918", 
                    "action": "deny"
                }, 
                {
                    "dst_tag": "corp", 
                    "action": "allow"
                }
            ]
        },
        {
            "name": "corp"
            "src_tags": ["corp-vip"], 
            "actions": [
                {
                    "dst_tag": "corp", 
                    "action": "allow"
                }, 
                {
                    "dst_tag": "corp-port-ranged", 
                    "action": "deny"
                }
            ]
        }

        // NOTES:
        // 1. for GBP-based policy, all src_tags and dst_tags have to be gbp-based
        // 2. for ACL-based policy, `network` is required in either the source or destination
        //    so that we know where to attach the policy to
    ],

    // EVPN
    see EVPN section

    // optional, most of the times, `radius_config` comes from Site Settings; however, there are occasions where 
    // we may want to try experimental radius servers
    "radius_config": {
        "auth_servers_timeout": 5,
        "auth_servers_retries": 3,
        "auth_servers": [
            {
                "host": "1.2.3.4",
                "port": 1812,
                "secret": "testing123"
            },
            {
                "host": "radius.internal",
                "port": 1812,
                "secret": "testing123"
            }
        ],
        "acct_servers": [
            {
                "host": "1.2.3.4",
                "port": 1812,
                "secret": "testing123"
            }
        ],
        "acct_interim_interval": 0,

        // Enable COA. Default is false. When coa_port is not specified, 3799 is the default value.
        “coa_enabled”: true,
        “coa_port”: 3799,

        // which network the RADIUS server resides, if there's static IP for this network,
        // we'd use it as source-ip
        "network": "default"

        // or specifiy "source_ip" directly
        "source_ip": "192.168.3.5"
    },

    // for an adopted switch, this can be enabled to make it fully-managed by mist
    "managed": false,

    // for a claimed switch, this can disable auto configuration
    "disable_auto_config": false,

    // additional CLI commands to append to the generated config
    // NOTE: no check is done
    "additional_config_cmds": [
        "set snmp community public"
    ],

    "vars": {
        "RADIUS_SECRET": "11s64632d",
        "RADIUS_IP1": "172.31.2.5"
    },
    "deviceprofile_id": "6f4bf402-45f9-2a56-6c8b-7f83d3bc98e9",
    "image1_url": "https://url/to/image.png",

    // port_mirroring
    "port_mirroring": {
        "port_mirror": {
            // at least one of them should be specified
            "ingress_port_ids": [ "ge-0/0/3" ],
            "egress_port_ids": [ "ge-0/0/3" ],
            "ingress_networks": [ "corp" ],

            // exactly one of either output should be provided
            "output_port_id": "ge-0/0/5",
            "output_network": "analyze",

            // future
            "filter": { ... }
        }
    },

    // IOT ports
    "iot_config": {
        // IN0 and IN1 triggered by input over 5v
        "IN0": {
            "name": "dry contact",
            "enabled": true,
            "alarm_class": "major",  // minor (default) / major
        },
        "IN0": {
            "name": "motion",
            "enabled": true,
            "alarm_class": "major",  // minor (default) / major
        },

        // OUT can only be triggered by either IN0 or IN1
        "OUT": {
            "name": "output",
            "enabled": true,
            "input_src": "IN0",  // IN0 (default) / IN1
            "alarm_class": "minor",  // minor (default) / major
        }

        // for VC
        "1/IN0": {
            "name": "dry contact",
            "enabled": true,
            "alarm_class": "major",  // minor (default) / major
        },
        "1/OUT": {
            "name": "output",
            "enabled": true,
            "input_src": "IN0",  // IN0 (default) / IN1
            "alarm_class": "minor",  // minor (default) / major
        }
    },

}
</code></pre>
<h3 id="switch-specific-parameters">Switch-specific Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>role</code></td>
<td><code>string</code></td>
<td>access / aggregation, default is <code>access</code></td>
</tr>
<tr>
<td><code>ip_config</code></td>
<td><code>object</code></td>
<td>ip config (for irb)</td>
</tr>
<tr>
<td><code>oob_ip_config</code></td>
<td><code>object</code></td>
<td>OOB management ip settings (i.e. for vme)</td>
</tr>
<tr>
<td><code>port_config</code></td>
<td><code>object</code></td>
<td>port configs</td>
</tr>
<tr>
<td><code>ntp_servers</code></td>
<td><code>list</code></td>
<td>list of NTP servers specific to this device. By default, those in Site Settings will be used</td>
</tr>
<tr>
<td><code>radius_config</code></td>
<td><code>object</code></td>
<td>per-switch <code>radius_config</code> overwrite, optional</td>
</tr>
<tr>
<td><code>managed</code></td>
<td><code>bool</code></td>
<td>default is false, for an adopted switch, we don’t overwrite their existing configs automatically</td>
</tr>
<tr>
<td><code>disable_auto_config</code></td>
<td><code>bool</code></td>
<td>default is false, for a claimed switch, we control the configs by default. This option (disables the behavior)</td>
</tr>
</tbody>
</table>
<h4 id="switch-ip-config">Switch IP Config</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ip_config</code></td>
<td><code>object</code></td>
<td>ip config</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>static / dhcp (default)</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>required if type==static</td>
</tr>
<tr>
<td><code>netmask</code></td>
<td><code>string</code></td>
<td>required if type==static</td>
</tr>
<tr>
<td><code>gateway</code></td>
<td><code>string</code></td>
<td>required if type==static</td>
</tr>
<tr>
<td><code>dns</code></td>
<td><code>list</code></td>
<td>required if type==static</td>
</tr>
<tr>
<td><code>dns_suffix</code></td>
<td><code>list</code></td>
<td>if type==static</td>
</tr>
<tr>
<td><code>vlan_id</code></td>
<td><code>int</code></td>
<td>management vlan id, default is 1 (untagged)</td>
</tr>
</tbody>
</table>
<h4 id="switch-dns-config">Switch DNS Config</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dns_servers</code></td>
<td><code>list</code></td>
<td>required if type==static</td>
</tr>
<tr>
<td><code>dns_suffix</code></td>
<td><code>list</code></td>
<td>if type==static</td>
</tr>
</tbody>
</table>
<h3 id="switch-and-gateway-ospf">Switch and Gateway OSPF</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>router_id</code></td>
<td><code>string</code></td>
<td>router-id used for OSPF/ BGP, required if ospf_config.enabled=true</td>
</tr>
<tr>
<td><code>ospf_config</code></td>
<td><code>object</code></td>
<td>OSPF config</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether to rung OSPF on this device</td>
</tr>
<tr>
<td><code>areas</code></td>
<td><code>object</code></td>
<td>OSPF areas to run on this device and the corresponding per-area-specific configs</td>
</tr>
<tr>
<td><code>no_summary</code></td>
<td><code>boolean</code></td>
<td>for a stub/nssa area, where to avoid forwarding type-3 LSA to this area</td>
</tr>
<tr>
<td><code>reference_bandwidth</code></td>
<td><code>string</code></td>
<td>Bandwidth for calculating metric defaults (9600..4000000000000), default is 100M</td>
</tr>
</tbody>
</table>
<h3 id="extra-routes">Extra Routes</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>extra_routes</code></td>
<td><code>object</code></td>
<td>key is the dest</td>
</tr>
<tr>
<td><code>via</code></td>
<td><code>string</code></td>
<td>next-hop</td>
</tr>
</tbody>
</table>
<h2 id="get-ztp-password">Get ZTP Password</h2>
<p>In the case where soemthing happens during/after ZTP, the root-password is modified (required for ZTP to set up outbound-ssh) 
but the user-defined password config has not be configured.
This API can be used to retrieve the temporary password.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/request_ztp_password
</code></pre>
<h3 id="response-example">Response Example</h3>
<pre><code>{
    "root_password": "ef8070ef8f924edb592e1819ed64b31172ab8de9d5cde75d3f46acd9506202ab9b1cbb97e381c5aa11037f17e5ed7b4b609461cd813d944670549d410ef82f2e"
}
</code></pre>
<h2 id="get-config-cli-commands">Get Config CLI Commands</h2>
<p>For a brown-field switch deployment where we adopted the switch through <a href="https://api.mist.com/api/v1/docs/Org#get-adoption-command">Adoption Command</a>, we
do not wipe out / overwrite the existing config automatically. Instead, we generate CLI commands that we would have
generated. The user can inspect, modify, and incorporate this into their existing config manually.</p>
<p>Once they feel comfortable about the config we generate, they can enable <code>allow_mist_config</code> where we will take full
control of their config like a claimed switch</p>
<pre><code>GET /api/v1/sites/:site_id/devices/:device_id/config_cmd
</code></pre>
<h3 id="optional-parameter">Optional parameter</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sort</code></td>
<td><code>boolean</code></td>
<td>Make output cmds sorted (for better readability) or not. False by default</td>
</tr>
</tbody>
</table>
<h3 id="response_15">Response</h3>
<pre><code>{
    "cli": [
        "set system hostname corp-a135"
        ...
    ]
}
</code></pre>
<h1 id="evpn">EVPN</h1>
<p>EVPN allows an alternative but more efficient LAN architecture utilizing VxLAN / MP-BGP - separating control plane (MAC
/ IP Learning) from forwarding plane.</p>
<p>In our implementation, following the steps to deploy EVPN topologies in a Site</p>
<h3 id="1-build-the-topology">1. build the topology</h3>
<p>While all the evpn_id / downlink_ips can be specified by hand, the easiest way is to call the build_vpn_topology API,
allowing you to examine the diff, and update it yourself. You can also simply call it with <code>overwrite=true</code> which will
apply the updates for you.</p>
<p>Notes:</p>
<ol>
<li>you can use <code>core</code> / <code>distribution</code> / <code>access</code> to create a CLOS topology</li>
<li>you can also use <code>core</code> / <code>distribution</code> to form a 2-tier EVPN topology where ESI-Lag is configured distribution to
   connect to access switches</li>
<li>in a small/medium campus, <code>collapsed-core</code> can be used where core switches are the inter-connected to do EVPN</li>
</ol>
<p>POST /api/v1/sites/:site_id/evpn_topologies</p>
<h4 id="request_22">Request</h4>
<pre><code>{
    "overwrite": true
    "name": "CC",
    "pod_names": {
        "1": "default",
        "2": "default"
    },
    // evpn topology options
    "evpn_options": {
        "overlay": {
            // optional, these are defaults
            "as": 65000
        },
        "underlay": {
            "as_base": 65001,
            "router_id_prefix": "/24",
            "subnet": "10.255.240.0/20",  // underlay subnet, by default, 10.255.240.0/20, or 'fd31:5700::/64' for ipv6

            // if v6 is desired for underlay
            "use_ipv6": true
        },
        // optional, where virtual-gateway should reside
        "routed_at": "edge",  // edge (default) / core / distribution

        // optional, for ERB or CLOS, you can either use esilag to upstream routers or to also be the virtual-gateway        
        "core_as_border": false,  // when routed != "core", whether to do virtual-gateway at core as well, default is false

        // inband-ztp
        // if the mangement traffic goes inbnd, during installation, only the border/core switches are connected to the Internet
        // to allow initial configuration to be pushed down and leave the downstream access switches stay in the Factory Default state
        // enabling inband-ztp allows upstream switches to use LLDP to assign IP and gives Internet to downstream switches in that state 
        "enable_inband_ztp": true,  // default is false

        // by default, JUNOS uses 00-00-5e-00-01-01 as the virtual-gateway-address's v4-mac and 00-00-5e-00-02-01 for v6-mac
        "per_vlan_vga_v4_mac": false,  // if enabled, 00-00-5e-00-0X-YY will be used (where X=vlan_id/256, YY=vlan_id%256),
        "per_vlan_vga_v6_mac": false,  // if enabled, 00-00-5e-00-1X-YY will be used (where X=vlan_id/256, YY=vlan_id%256),

        // optional, this generates router_id automatically, if specified, `router_id_prefix` is ignored
        "auto_router_id_subnet": "100.100.0.0/24",   // optional
        "auto_router_id_subnet6": "fd31:5700:1::/64",  // subnet for lo0.0 v6 IP, default is 'fd31:5700:1::/64'

        // optional, for dhcp_relay, unique loopback IPs are required for ERB or IPClos where we can set option-82 server-id-overrides
        "auto_loopback_subnet": "100.101.0.0/24",
        "auto_loopback_subnet6": "fd33:ab00:2::/64",

        // optional, for EX9200 only to seggregate virtual-switches
        "vs_instances": {
            "guest": {
                "networks": ["guest"]
            },
            "iot": {
                "networks": ["iot-wifi", "iot-lan"]
            }    
        }
    },
    "switches": [
        {
            "mac": "5c5b35000003",
            "role": "collapsed-core",

            // by default, core switches are assumed to be connecting all pods
            // if you want to limit the pods, you can specify pods
            "pods": [ 1, 2 ]
        },
        {
            "mac": "5c5b35000004",
            "role": "collapsed-core",
        },
        {
            "mac": "5c5b3500000f",
            "role": "esilag-access",

            // optionally, for distribution / access / esilag-access, they can be placed into different pods
            // e.g. for CLOS, to group dist / access switches into pods
            //      for ERB/CRB, to group dist / esilag-access into pods
            "pod": 1  // 1-255 (default is 1)
        }        
    ],
    // common configs for all switches in the topology
    "config": {
        // see switch related in [Site Setting]
    },
    // switch-specific configs
    "switch_configs": {
        "5c5b35000003": {
            // see switch related in [Site Setting]
        },
        ...
    }
}
</code></pre>
<h4 id="response_16">Response</h4>
<pre><code>{
    "id": "9197ec96-4c8d-529f-c595-035895e688b2",
    "name": "CC",
    "pod_names": {
        "1": "default",
        "2": "default"
    },

    "switches": [
        {
            "mac": "5c5b35000003",
            "model": "QFX10002-36Q",
            "role": "collapsed-core",

            // below are generated
            "evpn_id": 1,
            // the links, if not specified in the request, suggested ones will be used
            "uplinks": ["5c5b35000005", "5c5b35000006"],
            "downlinks": ["5c5b35000007", "5c5b35000008"],
            "esilaglinks": ["5c5b3500000f"],
            "site_id": "1916d52a-4a90-11e5-8b45-1258369c38a9",
            "deviceprofile_id": "6a1deab1-96df-4fa2-8455-d5253f943d06",

            // all the required links for this topology
            "suggested_uplinks": ["5c5b35000005", "5c5b35000006"],
            "suggested_downlinks": ["5c5b35000007", "5c5b35000008"],
            "suggested_esilaglinks": ["5c5b3500000f"]
        },
        ...
        {
            "mac": "5c5b3500000f",
            "model": "EX4300-48P",
            "role": "esilag-access",
            "esilaglinks": ["5c5b35000003", "5c5b35000004"]
        }        
    ]    
}
</code></pre>
<h3 id="2-update-the-topology">2. update the topology</h3>
<pre><code>PUT /api/v1/sites/:site_id/evpn_topologies/:evpn_topology_id
</code></pre>
<h4 id="_1"></h4>
<pre><code>{
    "overwrite": false,

    "switches": [
        // to add a new node to the topology, add it with the desired role
        {
            "mac": "5c5b35000003",
            "role": "collapsed-core"
        },

        // to remove a node from the topology, set the role to 'none'
        {
            "mac": "5c5b35000004",
            "role": "none"
        }        
    ]
    // to add switches to topology

}
</code></pre>
<h3 id="3-specify-ports-for-each-switch-that-will-be-used-for-uplinkdownlinks">3. specify ports for each switch that will be used for uplink/downlinks</h3>
<p>Specify the actual physical ports you have used (or plan to use) to inter-connect the switches.</p>
<pre><code>PUT /api/v1/sites/:site_id/devices/:device_id
</code></pre>
<pre><code>{
    "port_config": {
        "ge-0/0/10-11": {"usage": "evpn_uplink"},
        "ge-0/0/20-21": {"usage": "evpn_downlink"},
        "ge-0/0/30-31": {"usage": "esilag"},
    }
}
</code></pre>
<p>Note: only use <em>one</em> entry for the same evpn_uplink/evpn_downlink as the order is improtant. For example,
the above config will configure 5c5b35000003’s ge-0/0/10 to connect to 5c5b35000005.</p>
<h3 id="4-collapsed-core">4. Collapsed Core</h3>
<p>In a small-medium campus, EVPN can also be enabled only at the core switches (up to 4) by assigning all participating switches
with <code>collapsed-core</code> role. When there are more than 2 switches, a ring-like topology will be formed.</p>
<h3 id="5-esi-lag">5. ESI-Lag</h3>
<p>If the access switchess does not have EVPN support, you can take advantage of EVPN by setting up ESI-Lag on
distribution switches</p>
<p>In the following example, two distribution switches</p>
<pre><code>// on two aggragation switches where both ge-0/0/10's are intended to connect to access#1 and
// ge-0/0/11's to access#2
{     
    "port_config": {
        "ge-0/0/10": {
            "usage": "esilag",
            "ae_idx": 1
        },
        "ge-0/0/11": {
            "usage": "esilag",
            "ae_idx": 2
        },
     }
}

// on two access switches that simply treat do normal port aggregation
{
    "port_config": {
        "ge-0/0/1-2": {
            "usage": "esilag",
            "aggregate": true
        },
     }
}
</code></pre>
<h3 id="6-leaf-access-collapsed-core">6. Leaf / Access / Collapsed-Core</h3>
<p>For leaf nodes in a EVPN topology, you’d have to configure the IPs for networks that would participate in EVPN.
Optionally, VRFs to isolate traffic from one tenant verus another</p>
<pre><code>{
    "other_ip_configs": {
        "guest": {
            "ip": "192.168.70.1"
        },
        "iot-wifi": {
            "ip": "192.168.80.1"
        },
        "iot-lan": {
            "ip": "192.168.81.1"
        },
    },

    // optionally VRF (this can be defined in site settings / network templates)
    "vrf_instances": {
        "guest": {
            "networks": ["guest"]
        },
        "iot": {
            "networks": ["iot-wifi", "iot-lan"]
        }    
    },
    # for the device
    "vrf_config": {
        "enabled": true
    }    
}
</code></pre>
<h3 id="7-other-apis">7. Other APIs</h3>
<h4 id="get-all-evpn-topologies">Get All EVPN Topologies</h4>
<p>Get the existing EVPN topology</p>
<pre><code>GET /api/v1/sites/:site_id/evpn_topologies
</code></pre>
<h4 id="get-one-evpn-topology-detail">Get One EVPN Topology Detail</h4>
<p>Get the existing EVPN topology</p>
<pre><code>GET /api/v1/sites/:site_id/evpn_topologies/:evpn_topology_id
</code></pre>
<h4 id="delete-evpn-topology">Delete EVPN Topology</h4>
<p>Delete existing EVPN topology</p>
<pre><code>DELETE /api/v1/sites/:site_id/evpn_topologies/:evpn_topology_id
</code></pre>
<h4 id="rebuild-evpn-topology">Rebuild EVPN Topology</h4>
<p>Rebuild existing EVPN topology</p>
<pre><code>PUT /api/v1/sites/:site_id/evpn_topologies/:evpn_topology_id
</code></pre>
<h2 id="gateway-config-draft">Gateway Config (draft)</h2>
<p>Gateway comes with a default configuration with WAN + LAN where
* WAN port gets IP from DHCP
* LAN port(s) has an IP of 192.168.1.1/24 with DHCP Server</p>
<p>This is determined by the missing of <code>port_config</code> for a Gateway where the following are assumed, matching Gateway’s
factory-default config</p>
<pre><code>    "port_config": {
        "ge-0/0/0": {  // model-dependent
            "usage": "wan"
        },
        "ge-0/0/1-5": {  // model-dependent
            "usage": "lan",
            "port_network": "default"
        }
    }        
</code></pre>
<h3 id="minimum">Minimum</h3>
<p>To start adding configs, say to use static IP on WAN and change the subnet on LAN side to use 192.168.30.0/24</p>
<pre><code>    "port_config": {
        "ge-0/0/0": {
            "usage": "wan",
            "ip_config": {
                "ip': "63.31.5.7",
                "netmask": "/32",
                "gateway": "63.31.5.254"                
            }
        },
        "ge-0/0/1-5": {
            "usage": "lan",
            "port_network": "default"
        }
    },
    "ip_configs": {
        "default": {
            "type": "static",
            "ip": "192.168.30.1",
            "netmask": "/24"
        }
    },

    // dhcpd_config is assumed to be enabled for `default` network and 
</code></pre>
<h3 id="port-mirroring">Port-Mirroring</h3>
<p>Sample port-mirror config for SRX devices</p>
<pre><code>"port_mirroring": {
    "port_mirror": {
        "run_length": 12,
        "rate": 2,
        "family_type": 'inet',
        "ingress_port_ids": ["ge-0/0/3", "ge-0/0/4"],
        "output_port_id": "ge-0/0/5",
    }
}

</code></pre>
<h3 id="networks">Networks</h3>
<p>see <a href="https://api.mist.com/api/v1/docs/Org#networks">Networks</a></p>
<p><code>networks</code> can be configured directly in Gateway Config directly for smaller deployemnt (e.g. Home, Testing)</p>
<h3 id="services">Services</h3>
<p>see <a href="https://api.mist.com/api/v1/docs/Org#services">Services</a></p>
<p><code>services</code> can also be configured directly in Gateway Config directly for smaller deployemnt (e.g. Home, Testing)</p>
<h3 id="spec">Spec</h3>
<pre><code>{
    "name": "corp-a135",

    // gateways use/share `networks` that switches uses 
    "networks": {
        // see Gateway Template
    },

    "port_config": {
        // see Gateway Template
    },

    "ip_configs": {
        "corp": {
            "type": "static",
            "ip": "192.168.10.1"
        }
    },

    "dhcpd_config": {
        "enabled": true,
        "corp": {
            "type": "local",  // local (default) / relay / none
            "ip_start": "192.168.70.100",
            "ip_end": "192.168.70.200",                
            "gateway": "192.168.70.1",

            // optional, system one will be used
            "dns_servers": [ "8.8.8.8", "4.4.4.4" ],
            "dns_suffix": [ ".mist.local", ".mist.com" ],

            // fixed binding
            "fixed_bindings": {
                "5684dae9ac8b": {
                    "name": "John",
                    "ip": "192.168.70.35"
                }
            },

            // server_options
            "options": {
                "80": {
                    "type": "string",  //  string / boolean / ip / hex / int16 / int32 / uint16 / uint32

                    "value": "string",  // string
                    "value": "686578",  // hex
                    "value": "true",    // single boolean
                    "value": "1.1.1.1,2.2.2.2"  // list of ip addresses, comma-separated
                }                
            },
            "vendor_encapsulated": {
                // &lt;enterprise number&gt;:&lt;sub option code&gt; 
                // enterprise number": 25300,  // 1-65535  (https://www.iana.org/assignments/enterprise-numbers/enterprise-numbers)
                // sub option code": 8,  // 1-255, sub-option code
                "25300:8": {
                    "type": "string",  //  string / boolean / ip / hex / int16 / int32 / uint16 / uint32
                    "value": ...  // see above
                }
            },

            //
            // if using DHCP relay
            //
            "type": "relay",
            "servers": ["11.2.3.4"],

            // server_id_override
            //   Default is false.
            //   True means the device, when acts as DHCP relay and forwards DHCP responses from DHCP server to clients, 
            //   should overwrite the Sever Identifier option (i.e. DHCP option 54) in DHCP responses with its own IP address.
            "server_id_override": true
        }
    },

    "extra_routes": {
        "0.0.0.0/0": {
            "via": "10.2.1.1"
        }   
    },

    "oob_ip_config": {
        // fxp0 IP config

        "type": "static",
        "ip": "192.168.50.3",
        "netmask": "255.255.255.0",

        // when there are 2 routing engines, re1 mgmt IP has to be set separately (if desired)
        "re1": {
            // same payload as `ip_config` except dns / dns_suffix / gateway
        },

        // if supported on the platform, whether to place OOB port into it's own RI (mgmt_junos)
        // https://www.juniper.net/documentation/us/en/software/junos/junos-getting-started/topics/topic-map/management-interface-in-non-default-instance.html
        "use_mgmt_vrf": false  // false (default) / true
    },

    "ntp_servers": [
        "pool.ntp.org",
        "time.google.com"
    ],

    // for an adopted gateway/switches, this can be enabled to make it fully-managed by mist
    "managed": false,

    // additional CLI commands to append to the generated config
    // NOTE: no check is done
    "additional_config_cmds": [
        "set snmp community public"
    ],

    "vars": {
        "RADIUS_SECRET": "11s64632d",
        "RADIUS_IP1": "172.31.2.5"
    },
    "deviceprofile_id": "6f4bf402-45f9-2a56-6c8b-7f83d3bc98e9",
    "image1_url": "https://url/to/image.png"
}
</code></pre>
<h2 id="attach-device-image">Attach Device Image</h2>
<p>Attach up to 3 images to a device</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/image1
POST /api/v1/sites/:site_id/devices/:device_id/image2
POST /api/v1/sites/:site_id/devices/:device_id/image3
</code></pre>
<h3 id="request_23">Request</h3>
<p>A multi-part POST</p>
<pre><code>"file": a binary file
</code></pre>
<h2 id="remove-device-image">Remove Device Image</h2>
<p>Delete background image for Portal</p>
<pre><code>DELETE /api/v1/sites/:site_id/devices/:device_id/image1
DELETE /api/v1/sites/:site_id/devices/:device_id/image2
DELETE /api/v1/sites/:site_id/devices/:device_id/image3
</code></pre>
<h2 id="device-locating-ap">Device Locating - AP</h2>
<p>Locate a Device by blinking it’s LED, it’s a persisted state that has to be stopped by calling Stop Locating API</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/locate
</code></pre>
<h2 id="device-locating-switch">Device Locating - Switch</h2>
<p>Locate a Switch by blinking all port LEDs. By default, request is sent to ‘master’ switch and LEDs will keep flashing for 
5 minutes.
In case of virtual chassis (VC) the desired member mac has to be passed in the request payload. 
At anypoint, only one VC member can be requested to flash the LED. To stop LED flashing before the duration ends 
/unlocate API request can be made.
If /unlocate API is not called LED will continue to flash on device for the given duration. 
Default duration is 5 minutes and 120 minutes is the maximum.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/locate
</code></pre>
<h3 id="request_24">Request</h3>
<pre><code>{
    "mac": "f01c2d4ff760",  // optional: for virtual chassis, the MAC of the member
    "duration": 5  // minutes (1 - 120, default is 5)
}
</code></pre>
<h3 id="params">Params</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>optional: member mac address, default is master mac address</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>optional: minutes the leds should keep flashing, default - 5 minutes, maximum 120 minutes</td>
</tr>
</tbody>
</table>
<h3 id="response_17">Response</h3>
<pre><code>Status: 200 OK - locating requested
Status: 400 couldn't find member mac
</code></pre>
<h2 id="device-stop-locating-ap-switch">Device Stop Locating - AP, Switch</h2>
<p>Stop Locate a Device</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/unlocate
</code></pre>
<h2 id="device-restart">Device Restart</h2>
<p>Restart / Reboot a device</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/restart
</code></pre>
<h3 id="request_25">Request</h3>
<pre><code>{
    // optional: for SSR, if node is not present, both nodes are restarted
    // for other devices, node should not be present
    "node": "node0",
    // optional for VC member
    "member": 1
}
</code></pre>
<h3 id="response_18">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h2 id="restarting-multiple-devices">Restarting multiple devices</h2>
<p>Note that only the devices that are connected will be restarted.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/restart
</code></pre>
<h3 id="request_26">Request</h3>
<pre><code>{
    "device_ids": [
        "00000000-0000-0000-1000-5c5b35584a6f",
        "00000000-0000-0000-1000-5c5b350ea3b3"
    ]
    // optional: for SSR, if node is not present, both nodes are restarted
    // for other devices, node should not be present
    "node": "node0"
}
</code></pre>
<h3 id="response_19">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h2 id="upload-device-support-files">Upload Device support files</h2>
<p>Support / Upload device support files</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/support
</code></pre>
<h3 id="request_27">Request</h3>
<pre><code>{
    "info": "process"
    "node": "node0"
}
</code></pre>
<h3 id="params_1">Params</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>info</code></td>
<td><code>string</code></td>
<td>optional: <code>full</code> (default), see info param table for list of choices</td>
</tr>
<tr>
<td><code>num_messages_files</code></td>
<td><code>int</code></td>
<td>optional: number of most recent messages files to upload, default is 1, max is 10</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>optional: for SSR, if node is not present, both nodes support files are uploaded</td>
</tr>
</tbody>
</table>
<h4 id="info-param">Info Param</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>process</code></td>
<td><code>string</code></td>
<td>Upload 1 file with output of <code>show system processes extensive</code></td>
</tr>
<tr>
<td><code>outbound-ssh</code></td>
<td><code>string</code></td>
<td>Upload 1 file that concatenates all <code>/var/log/outbound-ssh.log*</code> files</td>
</tr>
<tr>
<td><code>messages</code></td>
<td><code>string</code></td>
<td>Upload 1 to 10 <code>/var/log/messages*</code> files</td>
</tr>
<tr>
<td><code>core-dumps</code></td>
<td><code>string</code></td>
<td>Upload all core dump files, if any found</td>
</tr>
<tr>
<td><code>full</code></td>
<td><code>string</code></td>
<td>Upload 1 file with output of <code>request support information</code>, 1 file that concatenates all <code>/var/log/outbound-ssh.log*</code> files, all core dump files, the 5 most recent <code>/var/log/messages*</code> files, and Mist agent logs</td>
</tr>
<tr>
<td><code>var-logs</code></td>
<td><code>string</code></td>
<td>Upload all non-empty files in the <code>/var/log/</code> directory</td>
</tr>
</tbody>
</table>
<h3 id="response_20">Response</h3>
<pre><code>Status: 200 OK - uploading started
Status: 400 Device not online
</code></pre>
<h2 id="device-synthetic-test">Device Synthetic Test</h2>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/synthetic_test
</code></pre>
<h3 id="request_28">Request</h3>
<pre><code>{
    "type": "dns",  // dns / arp / dhcp / curl / radius / speedtest / dhcp6 / lan_connectivity
    "vlan_id": 30,  // required for AP
    "tenant": "lan_network1", // for curl/ lan_connectivity

    // type = dns
    "hostname": "google.com".

    // type = arp
    "ip": "192.168.3.5",

    // type = curl
    "url": "https://www.example.com",
    "timeout": 60, // max_time, default is 60, Range 30-120

    // type = radius
    "username": "user",
    "password": "test123",

    // type = speedtest
    "port_id": "wan0", // required for ssr

    // type = lan_connectivity
    "protocol": "ping", // ping / traceroute / ping+traceroute(default)
    "host": "www.example.com",
    "ping_details": false, // false(default) / true
    "ping_count": 10, // default is 10, max 60
    "ping_size": 56, // default is 56. Range 56-65535
    "traceroute_udp_port": 33434, // SRX only, traceroute udp port (default is 33434),
}
</code></pre>
<h3 id="response_21">Response</h3>
<pre><code>Status: 200 OK - scheduled
Status: 400 Device not online
Status: 400 Device not supported
Status: 400 already in progress
</code></pre>
<h2 id="get-device-synthetic-testing-status">Get Device Synthetic Testing Status</h2>
<pre><code>GET /api/v1/sites/:site_id/devices/:device_id/synthetic_test
</code></pre>
<h3 id="response_22">Response</h3>
<pre><code>{
    // TBD extra information populated
    "start_time": 1675718807,
    "device_type": "gateway",
    "type": "speedtest",
    "mac": "5c5b35584a6f",
    "port_id": "ge-0/0/1.100",
    "status": "inprogress"
}
</code></pre>
<h2 id="device-bios-upgrade">Device Bios Upgrade</h2>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/upgrade_bios
</code></pre>
<p>Upgrade device bios</p>
<h3 id="request_29">Request</h3>
<pre><code>{
    "version": "CDEN_P_EX1_00.20.01.00"
}
</code></pre>
<h3 id="parameters_22">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>specific bios version</td>
</tr>
<tr>
<td><code>reboot</code></td>
<td><code>boolean</code></td>
<td>Reboot device immediately after upgrade is completed, default is false</td>
</tr>
</tbody>
</table>
<h3 id="bios-upgrade-response">Bios Upgrade Response</h3>
<pre><code>{
    "timestamp": 1428949501,
    "status": "inprogress",
}
</code></pre>
<h2 id="upgrade-bios-multiple-device">Upgrade Bios Multiple Device</h2>
<pre><code>POST /api/v1/sites/:site_id/devices/upgrade_bios
</code></pre>
<h3 id="request_30">Request</h3>
<pre><code>{
    "version": "CDEN_P_EX1_00.15.01.00",
    // filters that can be used, if no filter specified, it means entire site
    "device_ids": [
        "00000000-0000-0000-1000-5c5b35584a6f"
    ],

    "models": [
        "EX4400-48T"   
    ]
}
</code></pre>
<h3 id="parameters_23">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>specific bios version</td>
</tr>
<tr>
<td><code>reboot</code></td>
<td><code>boolean</code></td>
<td>Reboot device immediately after upgrade is completed. default is false</td>
</tr>
<tr>
<td><code>device_ids</code></td>
<td><code>list</code></td>
<td>list of device id to upgrade bios</td>
</tr>
<tr>
<td><code>models</code></td>
<td><code>list</code></td>
<td>list of device model to upgrade bios</td>
</tr>
</tbody>
</table>
<h2 id="device-fpga-upgrade">Device FPGA Upgrade</h2>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/upgrade_fpga
</code></pre>
<p>Upgrade device bios</p>
<h3 id="request_31">Request</h3>
<pre><code>{
    "version": "REV37"
}
</code></pre>
<h3 id="parameters_24">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>specific fpga version</td>
</tr>
</tbody>
</table>
<h3 id="bios-upgrade-response_1">Bios Upgrade Response</h3>
<pre><code>{
    "timestamp": 1428949501,
    "status": "inprogress",
}
</code></pre>
<h2 id="upgrade-bios-multiple-device_1">Upgrade Bios Multiple Device</h2>
<pre><code>POST /api/v1/sites/:site_id/devices/upgrade_fpga
</code></pre>
<h3 id="request_32">Request</h3>
<pre><code>{
    "version": "REV37",
    // filters that can be used, if no filter specified, it means entire site
    "device_ids": [
        "00000000-0000-0000-1000-5c5b35584a6f"
    ],

    "models": [
        "EX2300-24MP"   
    ]
}
</code></pre>
<h3 id="parameters_25">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>specific fpga version</td>
</tr>
<tr>
<td><code>device_ids</code></td>
<td><code>list</code></td>
<td>list of device id to upgrade fpga</td>
</tr>
<tr>
<td><code>models</code></td>
<td><code>list</code></td>
<td>list of device model to upgrade fpga</td>
</tr>
</tbody>
</table>
<h2 id="device-upgrade">Device Upgrade</h2>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/upgrade
</code></pre>
<p>Upgrade device firmware</p>
<h3 id="request_33">Request</h3>
<pre><code>{
    "version": "3.1.5"
}
</code></pre>
<h3 id="parameters_26">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>specific version / <code>stable</code>, default is to use the latest</td>
</tr>
<tr>
<td><code>reboot</code></td>
<td><code>boolean</code></td>
<td>Reboot device immediately after upgrade is completed, default is false (Available on Junos OS devices)</td>
</tr>
<tr>
<td><code>snapshot</code></td>
<td><code>boolean</code></td>
<td>Perform recovery snapshot after device is rebooted, default is false (Available on Junos OS devices)</td>
</tr>
</tbody>
</table>
<h3 id="upgrade-response">Upgrade Response</h3>
<pre><code>{
    "timestamp": 1428949501,
    "status": "inprogress",
    "status_id": 5
}
</code></pre>
<h2 id="device-snapshot">Device Snapshot</h2>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/snapshot
</code></pre>
<p>Create recovery device snapshot (Available on Junos OS EX2300-, EX3400-, EX4400- devices)</p>
<h3 id="snapshot-response">Snapshot Response</h3>
<pre><code>Status: 200 OK
Status: 400 - snapshot not supported
Status: 400 - cannot snapshot an offline device
</code></pre>
<h3 id="definition">Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>timestamp</code></td>
<td><code>float</code></td>
<td>timestamp</td>
</tr>
<tr>
<td><code>status</code></td>
<td><code>string</code></td>
<td>starting / inprogress / success / error / scheduled</td>
</tr>
<tr>
<td><code>status_id</code></td>
<td><code>int</code></td>
<td>the internal status id</td>
</tr>
</tbody>
</table>
<h2 id="upgrade-multiple-device">Upgrade Multiple Device</h2>
<p>Note that this call doesn’t guarantee the devices to be upgraded right away (they may be offline)</p>
<pre><code>POST /api/v1/sites/:site_id/devices/upgrade
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>reboot</code></td>
<td><code>boolean</code></td>
<td>Reboot device immediately after upgrade is completed. default is false (Available on Junos OS devices)</td>
</tr>
<tr>
<td><code>snapshot</code></td>
<td><code>boolean</code></td>
<td>Perform recovery snapshot after device is rebooted. default is false (Available on Junos OS devices)</td>
</tr>
</tbody>
</table>
<h3 id="request_34">Request</h3>
<pre><code>{
    "version": "3.1.5",
    "enable_p2p": true,
    "p2p_parallelism": 2, 
    "p2p_cluster_size": 10,

    // filters that can be used, if no filter specified, it means entire site
    "device_ids": [
        "00000000-0000-0000-1000-5c5b35584a6f"
    ],
    "models": [
        "AP41"   
    ],
    "rules": [
        {
            // all AP63's in this site will be selected for upgrade
            "match_model": "AP63"
        },
        {
            // AP43's whose name has the word 'access' from character 2 to 7 will be selected for upgrade
            "match_model": "AP43",
            "match_name[2:8]": "access"
        }
    ],
    "strategy": "canary",
    "canary_phases": [5,25,50,100],
    "max_failures": [1,1,5,5], // will be used if provided, else max_failure_percentage will be used
    "max_failure_percentage": 5
    "start_time": 1624399840,
    "reboot_at": 1624399840,
    "force": True,

    // rrm
    "rrm_node_order": "fringe_to_center",
    "rrm_slow_ramp": true,
    "rrm_max_batch_percentage": 10,
    "rrm_first_batch_percentage": 2,
    "rrm_mesh_upgrade": "parallel"     
}
</code></pre>
<h3 id="parameters_27">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>specific version / <code>stable</code>, default is to use the latest</td>
</tr>
<tr>
<td><code>enable_p2p</code></td>
<td><code>boolean</code></td>
<td>whether to allow local AP-to-AP FW upgrade</td>
</tr>
<tr>
<td><code>p2p_parallelism</code></td>
<td><code>int</code></td>
<td>number of parallel p2p download batches to create, default is 1</td>
</tr>
<tr>
<td><code>p2p_cluster_size</code></td>
<td><code>int</code></td>
<td>size to split the devices for p2p, default 10</td>
</tr>
<tr>
<td><code>device_ids</code></td>
<td><code>array of strings</code></td>
<td>id’s of devices which will be selected for upgrade</td>
</tr>
<tr>
<td><code>models</code></td>
<td><code>array of strings</code></td>
<td>models which will be selected for upgrade</td>
</tr>
<tr>
<td><code>rules</code></td>
<td><code>array of objects</code></td>
<td>rules used to identify devices which will be selected for upgrade. Device will be selected as long as it satisfies any one rule</td>
</tr>
<tr>
<td><code>strategy</code></td>
<td><code>string</code></td>
<td><code>big_bang</code>(upgrade all at once), <code>serial</code>(one at a time), <code>canary</code> or  <code>rrm</code>, default is big_bang</td>
</tr>
<tr>
<td><code>canary_phases</code></td>
<td><code>array of ints</code></td>
<td>phases for canary deployment. Each phase represents percentage of devices that need to be upgraded in that phase. default is [1, 10, 50, 100]</td>
</tr>
<tr>
<td><code>max_failures</code></td>
<td><code>array of ints</code></td>
<td>number of failures allowed within each phase. Only applicable for <code>canary</code>. Array length should be same as <code>canary_phases</code>. Will be used if provided, else max_failure_percentage will be used</td>
</tr>
<tr>
<td><code>max_failure_percentage</code></td>
<td><code>int</code></td>
<td>percentage of failures allowed across the entire upgrade(not applicable for <code>big_bang</code>), default is 5</td>
</tr>
<tr>
<td><code>rrm_node_order</code></td>
<td><code>string</code></td>
<td>fringe_to_center or center_to_fringe (default fringe_to_center). Used in <code>rrm</code> to determine whether to start upgrade from fringe or center AP’s</td>
</tr>
<tr>
<td><code>rrm_slow_ramp</code></td>
<td><code>boolean</code></td>
<td>true will make rrm batch sizes slowly ramp up</td>
</tr>
<tr>
<td><code>rrm_max_batch_percentage</code></td>
<td><code>int</code></td>
<td>max percentage of AP’s that need to be present in each <code>rrm</code> batch</td>
</tr>
<tr>
<td><code>rrm_first_batch_percentage</code></td>
<td><code>int</code></td>
<td>percentage of AP’s that need to be present in the first <code>rrm</code> batch</td>
</tr>
<tr>
<td><code>rrm_mesh_upgrade</code></td>
<td><code>string</code></td>
<td>sequential or parallel (default parallel). Whether to upgrade mesh AP’s parallelly or sequentially at the end of the upgrade</td>
</tr>
<tr>
<td><code>start_time</code></td>
<td><code>long</code></td>
<td>firmware download start time in epoch seconds, default is now</td>
</tr>
<tr>
<td><code>reboot_at</code></td>
<td><code>long</code></td>
<td>reboot start time in epoch seconds, default is <code>start_time</code></td>
</tr>
<tr>
<td><code>force</code></td>
<td><code>bool</code></td>
<td>true will force upgrade when requested version is same as running version</td>
</tr>
</tbody>
</table>
<h4 id="rules">Rules</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>match_model</code></td>
<td><code>string</code></td>
<td>match devices of this model. Can optionally use offsets to select a substring. For eg: match_model[1:3]</td>
</tr>
<tr>
<td><code>match_name</code></td>
<td><code>string</code></td>
<td>match devices with this name. Can optionally use offsets to select a substring. For eg: match_name[1:3]</td>
</tr>
</tbody>
</table>
<h2 id="get-all-upgrades-for-site">Get all upgrades for site</h2>
<pre><code>GET /api/v1/sites/:site_id/devices/upgrade
GET /api/v1/sites/:site_id/devices/upgrade?status=completed
</code></pre>
<h3 id="response_23">Response</h3>
<pre><code>{
    [{
            "id": "e110e3ef-5ce9-4c7c-a056-714f154f354f",
            "target_version": "apfw-0.7.20216-gilly-d4fc",
            "status": "downloading",
            "strategy": "big_bang",
            "enable_p2p": false,
            "force": true,
            "start_time": 1624499588,
            "reboot_at": 1624499588,
            "max_failure_percentage": 5,
            "counts": {
                "download_requested": 1,
                "downloaded": 2,
                "total": 3
            }
        },
        {
            "id": "57bf9d30-bd30-48e6-bb76-43c2efa375dc",
            "target_version": "apfw-0.7.20216-gilly-d4fc",
            "status": "completed",
            "strategy": "serial",
            "enable_p2p": false,
            "force": false,
            "start_time": 1624499588,
            "reboot_at": 1624499588,
            "max_failure_percentage": 5,
            "counts": {
                "upgraded": 2,              
                "failed": 1,
                "total": 3
            }
        }
    ]
}
</code></pre>
<h2 id="get-site-upgrade">Get site upgrade</h2>
<pre><code>GET /api/v1/sites/:site_id/devices/upgrade/:upgrade_id
</code></pre>
<h3 id="response_24">Response</h3>
<pre><code>{
    "id": "b040efc5-6bb0-423e-8f7d-66d80176aa71",
    "target_version": "apfw-0.11.25907-kedge-9019",
    "status": "completed",
    "strategy": "big_bang",
    "enable_p2p": true,
    "force": true,
    "start_time": 1648752756,
    "reboot_at": 0,
    "targets": {
        "scheduled": [],
        "download_requested": [],
        "downloaded": [],
        "reboot_in_progress": [],
        "rebooted": [],
        "upgraded": [
            "5c5b354e35f7",
            "5c5b353e537a"
        ],
        "skipped": [],
        "failed": [
            "5c5b353e190a"
        ],
        "total": 3
    }
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td><code>uuid</code></td>
<td>unique id for the upgrade</td>
</tr>
<tr>
<td><code>target_version</code></td>
<td><code>string</code></td>
<td>version to upgrade to</td>
</tr>
<tr>
<td><code>status</code></td>
<td><code>string</code></td>
<td>status upgrade is in (created/downloading/downloaded/upgrading/completed/cancelled/failed)</td>
</tr>
<tr>
<td><code>strategy</code></td>
<td><code>string</code></td>
<td>upgrade strategy</td>
</tr>
<tr>
<td><code>enable_p2p</code></td>
<td><code>bool</code></td>
<td>whether to allow local AP-to-AP FW upgrade, default False</td>
</tr>
<tr>
<td><code>p2p_cluster_size</code></td>
<td><code>int</code></td>
<td>size to split the devices for p2p, default 10</td>
</tr>
<tr>
<td><code>force</code></td>
<td><code>bool</code></td>
<td>whether to force upgrade when requested version is same as running version</td>
</tr>
<tr>
<td><code>start_time</code></td>
<td><code>int</code></td>
<td>firmware download start time in epoch</td>
</tr>
<tr>
<td><code>reboot_at</code></td>
<td><code>int</code></td>
<td>reboot start time in epoch</td>
</tr>
<tr>
<td><code>max_failure_percentage</code></td>
<td><code>int</code></td>
<td>percentage of failures allowed</td>
</tr>
<tr>
<td><code>max_failures</code></td>
<td><code>array of ints</code></td>
<td>number of failures allowed within a canary phase or serial rollout</td>
</tr>
<tr>
<td><code>current_phase</code></td>
<td><code>int</code></td>
<td>current canary/rrm phase in progress</td>
</tr>
<tr>
<td><code>upgrade_plan</code></td>
<td><code>object</code></td>
<td>a dictionary of canary/rrm phase number to devices part of that phase</td>
</tr>
<tr>
<td><code>download_time</code></td>
<td><code>string</code></td>
<td>time taken to download firmware on all devices</td>
</tr>
<tr>
<td><code>upgrade_time</code></td>
<td><code>string</code></td>
<td>time taken to upgrade firmware all devices</td>
</tr>
<tr>
<td><code>counts.total</code></td>
<td><code>int</code></td>
<td>count of devices part of this upgrade</td>
</tr>
<tr>
<td><code>counts.scheduled</code></td>
<td><code>int</code></td>
<td>count of devices which cloud has scheduled an upgrade for</td>
</tr>
<tr>
<td><code>counts.download_requested</code></td>
<td><code>int</code></td>
<td>count of devices which cloud has requested to download firmware</td>
</tr>
<tr>
<td><code>counts.downloaded</code></td>
<td><code>int</code></td>
<td>count of devices which have the firmware downloaded</td>
</tr>
<tr>
<td><code>counts.reboot_in_progress</code></td>
<td><code>int</code></td>
<td>count of devices which are rebooting</td>
</tr>
<tr>
<td><code>counts.rebooted</code></td>
<td><code>int</code></td>
<td>count of devices which have rebooted successfully</td>
</tr>
<tr>
<td><code>counts.upgraded</code></td>
<td><code>int</code></td>
<td>count of devices which have upgraded successfully</td>
</tr>
<tr>
<td><code>counts.skipped</code></td>
<td><code>int</code></td>
<td>count of devices which skipped upgrade since requested version was same as running version. Use <code>force</code> to always upgrade</td>
</tr>
<tr>
<td><code>counts.failed</code></td>
<td><code>int</code></td>
<td>count of devices which have failed to upgrade</td>
</tr>
</tbody>
</table>
<h2 id="cancel-upgrade">Cancel upgrade</h2>
<p>Best effort to cancel an upgrade. Devices which are already upgraded wont be touched</p>
<pre><code>POST /api/v1/sites/:site_id/devices/upgrade/:upgrade_id/cancel
</code></pre>
<h2 id="re-provision-all-devices-in-the-site">Re-provision all devices in the Site</h2>
<p>To force every device to reprovision itself again. By default, only APs are reprovisioned</p>
<pre><code>POST /api/v1/sites/:site_id/devices/reprovision
</code></pre>
<h2 id="re-provision-one-device">Re-provision one device</h2>
<p>To force one device to reprovision itself again.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/reprovision
</code></pre>
<h2 id="zeroize-all-fips-aps-in-the-site">Zeroize all FIPS APs in the Site</h2>
<pre><code>POST /api/v1/sites/:site_id/devices/zerioze
</code></pre>
<h3 id="request_35">Request</h3>
<pre><code>{
    "password": "NUKETHESITE"
}
</code></pre>
<h3 id="parameters_28">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>password</code></td>
<td><code>string</code></td>
<td>FIPS zeroize password</td>
</tr>
</tbody>
</table>
<h2 id="send-arbitrary-ble-beacon-for-a-period-of-time">Send arbitrary BLE Beacon for a period of time</h2>
<p>Note that only the devices that are connected will be restarted.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/send_ble_beacon
</code></pre>
<h3 id="request_36">Request</h3>
<pre><code>{
    // by default, all APs in the site will be considered
    "macs": [
        "5c5b35584a6f",
        "5c5b350ea3b3"
    ],
    "map_ids": [ "845a23bf-bed9-e43c-4c86-6fa474be7ae5" ],

    "beacon_frame": "68b329da9893e34099c7d8ad5cb9c940",
    "beacon_freq": 100,
    "duration": 10,  // 1 - 60
}
</code></pre>
<h2 id="radius-synthetic-test-from-switch">Radius Synthetic Test from Switch</h2>
<p>Ping test from the AP to confirm ‘reachability’ of the Radius server. Utilize Juniper EX switch(to which an AP is
connected to) radius test capabilities to get details on the Radius Server ‘availability’.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/check_radius_server
</code></pre>
<h3 id="request_37">Request</h3>
<pre><code>{
    "user": "username",
    "password": "password",
    "profile": "profilename"
}
</code></pre>
<h3 id="parameters_29">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>user</code></td>
<td><code>string</code></td>
<td>Specify the subscriber username to test</td>
</tr>
<tr>
<td><code>password</code></td>
<td><code>string</code></td>
<td>Specify the password associated with the username</td>
</tr>
<tr>
<td><code>profile</code></td>
<td><code>string</code></td>
<td>(Optional) Specify the access profile associated with the subscriber. default is dot1x</td>
</tr>
</tbody>
</table>
<h3 id="response_25">Response</h3>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h2 id="ping-from-ap-switch-and-ssr">Ping from AP, Switch and SSR</h2>
<p>Ping can be performed from the Device. The output will be available through websocket. As there can be multiple command
issued against the same AP at the same time and the output all goes through the same websocket stream, <code>session</code> is
introduced for demux.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/ping
</code></pre>
<h3 id="request_38">Request</h3>
<pre><code>{
    "host": "1.1.1.1",
    "count": 10
}
</code></pre>
<h3 id="parameters_30">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>host</code></td>
<td><code>string</code></td>
<td>host name</td>
</tr>
<tr>
<td><code>count</code></td>
<td><code>int</code></td>
<td>(Optional) Supported only for ping. default is 10</td>
</tr>
<tr>
<td><code>size</code></td>
<td><code>int</code></td>
<td>(Optional) default is 56. Range 56-65535</td>
</tr>
<tr>
<td><code>egress_interface</code></td>
<td><code>string</code></td>
<td>(Optional) Interface through which packet needs to egress</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(Optional) node0 / node1 for HA</td>
</tr>
</tbody>
</table>
<h3 id="response_26">Response</h3>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h2 id="subscribe-to-device-command-outputs">Subscribe to Device Command outputs</h2>
<pre><code>WS /api-ws/v1/stream
</code></pre>
<h3 id="request_39">Request</h3>
<pre><code>{
    "subscribe": "/sites/:site_id/devices/:device_id/cmd"
}
</code></pre>
<h3 id="response_27">Response</h3>
<pre><code>{
    "event": "data",
    "channel": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/devices/00000000-0000-0000-1000-5c5b350e0060/cmd",
    "data": {
        "session": "session_id",
        "raw": "64 bytes from 23.211.0.110: seq=8 ttl=58 time=12.323 ms\n"
    }
}
</code></pre>
<h2 id="service-ping-from-ssr">Service Ping from SSR</h2>
<p>Service Ping can be performed from the Device. The output will be available through websocket. As there can be multiple command
issued against the same device at the same time and the output all goes through the same websocket stream, <code>session</code> is
introduced for demux.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/service_ping
</code></pre>
<h3 id="request_40">Request</h3>
<pre><code>{
    "host": "1.1.1.1",
    "count": 10,
    "service": "web-session"
}
</code></pre>
<h3 id="parameters_31">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>host</code></td>
<td><code>string</code></td>
<td>host name</td>
</tr>
<tr>
<td><code>service</code></td>
<td><code>string</code></td>
<td>(Optional) ping packet takes the same path as the service</td>
</tr>
<tr>
<td><code>tenant</code></td>
<td><code>string</code></td>
<td>tenant context in which the packet is sent</td>
</tr>
<tr>
<td><code>count</code></td>
<td><code>int</code></td>
<td>(Optional) Supported only for ping. default is 10</td>
</tr>
<tr>
<td><code>size</code></td>
<td><code>int</code></td>
<td>(Optional) default is 56. Range 56-65535</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(Optional) node0 / node1 for HA</td>
</tr>
</tbody>
</table>
<h3 id="response_28">Response</h3>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h2 id="routes-from-ssr-srx-and-switch">Routes from SSR, SRX and Switch</h2>
<p>Get routes from the Device. The output will be available through websocket. As there can be multiple command
issued against the same device at the same time and the output all goes through the same websocket stream, <code>session</code> is
introduced for demux.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/show_route
</code></pre>
<h3 id="request_41">Request</h3>
<pre><code>{
    // all attributes are optional
    "prefix": "192.168.0.5/30",
    "protocol": "bgp", // bgp (default) / any / ospf / static / direct / evpn
    "vrf": "default",
    "neighbor": "192.168.4.1",
    // if specified, dump both received and advertised
    // for SSR, show bgp neighbors 10.250.18.202 received-routes/advertised-routes
    // for SRX &amp; Switches, show route receive-protocol/advertise-protocol bgp 192.168.255.12
    "route"": "advertised"
}
</code></pre>
<h3 id="parameters_32">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>prefix</code></td>
<td><code>string</code></td>
<td>(optional) route prefix</td>
</tr>
<tr>
<td><code>protocol</code></td>
<td><code>string</code></td>
<td>(optional) Supported only for bgp</td>
</tr>
<tr>
<td><code>vrf</code></td>
<td><code>string</code></td>
<td>(optional) VRF name</td>
</tr>
<tr>
<td><code>neighbor</code></td>
<td><code>string</code></td>
<td>(optional) IP of the neighbor</td>
</tr>
<tr>
<td><code>route</code></td>
<td><code>string</code></td>
<td>if neighbor is specified, received / advertised, if not specified, both will be shown</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(Optional) node0 / node1 for HA</td>
</tr>
<tr>
<td><code>interval</code></td>
<td><code>int</code></td>
<td>(Optional) rate at which output will refresh, default is 0 and valid range 0-10.</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>(Optional) duration in sec for which refresh is enabled, default is 0 and valid range 0-300 sec. Should be set only if interval is configured to non-zero value.</td>
</tr>
</tbody>
</table>
<h3 id="response_29">Response</h3>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h3 id="example-output-from-ws-stream">Example output from ws stream</h3>
<pre><code>admin@labsystem1.fiedler# show bgp neighbors
BGP neighbor is 192.168.4.1, remote AS 4200000001, local AS 4200000128, external
link
  BGP version 4, remote router ID 1.1.1.1
  BGP state = Established, up for 00:27:25
  Last read 00:00:25, hold time is 90, keepalive interval is 30 seconds
  Configured hold time is 90, keepalive interval is 30 seconds
  Neighbor capabilities:
    4 Byte AS: advertised and received
    Route refresh: advertised and received(old &amp;amp; new)
    Address family IPv4 Unicast: advertised and received
    Graceful Restart Capabilty: advertised and received
      Remote Restart timer is 120 seconds
      Address families by peer:
        none
        ...
</code></pre>
<h2 id="bgp-summary-from-ssr-srx-and-switch">BGP summary from SSR, SRX and Switch</h2>
<p>Get bgp summary from the Device. The output will be available through websocket. As there can be multiple command
issued against the same device at the same time and the output all goes through the same websocket stream, <code>session</code> is
introduced for demux.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/show_bgp_summary
</code></pre>
<h3 id="request_42">Request</h3>
<pre><code>{
    "node": "node0",
}
</code></pre>
<h3 id="parameters_33">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(Optional) node0 / node1 for HA</td>
</tr>
<tr>
<td><code>vrf</code></td>
<td><code>string</code></td>
<td>(Optional) VRF name</td>
</tr>
</tbody>
</table>
<h3 id="response_30">Response</h3>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h3 id="example-output-from-ws-stream_1">Example output from ws stream</h3>
<pre><code>Tue 2024-04-23 16:36:06 UTC
Retrieving bgp entries...
BGP table version is 354, local router ID is 10.224.8.16, vrf id 0
Default local pref 100, local AS 65000
Status codes:  s suppressed, d damped, h history, * valid, &gt; best, = multipath,
               i internal, r RIB-failure, S Stale, R Removed
Nexthop codes: @NNN nexthop's vrf id, &lt; announce-nh-self
Origin codes:  i - IGP, e - EGP, ? - incomplete
RPKI validation codes: V valid, I invalid, N Not found

   Network                                      Next Hop                                  Metric LocPrf Weight Path
*&gt; 161.161.161.0/24
</code></pre>
<h2 id="ospf-summary-from-ssr-and-srx">OSPF summary from SSR and SRX</h2>
<p>Get OSPF summary from the Device. The output will be available through websocket. As there can be multiple command
issued against the same device at the same time and the output all goes through the same websocket stream, <code>session</code> is
introduced for demux.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/show_ospf_summary
</code></pre>
<h3 id="request_43">Request</h3>
<pre><code>{
    "vrf": "lan"
}
</code></pre>
<h3 id="parameters_34">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vrf</code></td>
<td><code>string</code></td>
<td>(optional) VRF name</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(optional) node0 / node1 for HA</td>
</tr>
</tbody>
</table>
<h3 id="response_31">Response</h3>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h3 id="example-output-from-ws-stream_2">Example output from ws stream</h3>
<pre><code>===== =========== ========== ============= ==================== ========= =========== =============
 Vrf   Router ID   ABR Type   ASBR Router   External LSA Count   Area ID   Area Type   Area Border
                                                                                       Router
===== =========== ========== ============= ==================== ========= =========== =============
       1.0.0.2     cisco            False                    0   0.0.0.0
       1.0.0.2     cisco            False                    0   0.0.0.4   default
</code></pre>
<h2 id="ospf-interfaces-from-ssr-and-srx">OSPF interfaces from SSR and SRX</h2>
<p>Get OSPF interfaces from the Device. The output will be available through websocket. As there can be multiple command
issued against the same device at the same time and the output all goes through the same websocket stream, <code>session</code> is
introduced for demux.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/show_ospf_interfaces
</code></pre>
<h3 id="request_44">Request</h3>
<pre><code>{
    "port_id": "ge-0/0/2",
    "vrf": "lan"
}
</code></pre>
<h3 id="parameters_35">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>(optional) The nework interface</td>
</tr>
<tr>
<td><code>vrf</code></td>
<td><code>string</code></td>
<td>(optional) VRF name</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(optional) node0 / node1 for HA</td>
</tr>
</tbody>
</table>
<h3 id="response_32">Response</h3>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h3 id="example-output-from-ws-stream_3">Example output from ws stream</h3>
<pre><code>===== ================== =================== ============== =============== =========== ========= ===========
 Vrf   Device Interface   Network Interface   Interface Up   IP Address      OSPF Type   Area ID   Area Type
===== ================== =================== ============== =============== =========== ========= ===========
       net1               g1                          True   172.16.1.2/24   Broadcast   0.0.0.0   default
       net3               g3                          True   172.16.3.2/24   Broadcast   0.0.0.0   default
       net4               g4                          True   172.16.4.2/24   Broadcast   0.0.0.4   default
</code></pre>
<h2 id="ospf-neighbors-from-ssr-and-srx">OSPF Neighbors from SSR and SRX</h2>
<p>Get OSPF Neighbors from the Device. The output will be available through websocket. As there can be multiple command
issued against the same device at the same time and the output all goes through the same websocket stream, <code>session</code> is
introduced for demux.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/show_ospf_neighbors
</code></pre>
<h3 id="request_45">Request</h3>
<pre><code>{
    "neighbor": "10.1.1.1",
    "port_id": "ge-0/0/3",
    "vrf": "lan"
}
</code></pre>
<h3 id="parameters_36">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>neighbor</code></td>
<td><code>string</code></td>
<td>(optional) IP address</td>
</tr>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>(optional) The nework interface</td>
</tr>
<tr>
<td><code>vrf</code></td>
<td><code>string</code></td>
<td>(optional) VRF name</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(optional) node0 / node1 for HA</td>
</tr>
</tbody>
</table>
<h3 id="response_33">Response</h3>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h3 id="example-output-from-ws-stream_4">Example output from ws stream</h3>
<pre><code>===== ==================== ========== ======= ======== ================ =================== =================
 Vrf   Neighbor Router ID   Priority   State   Uptime   Dead Timer Due   Interface Address   Interface State
===== ==================== ========== ======= ======== ================ =================== =================
       1.0.0.3                     1   Full       852               38   172.16.3.2          Backup
       1.0.0.4                     1   Full       811               33   172.16.3.2          DROther
       1.0.0.3                     1   Full       852               38   172.16.4.2          Backup
       1.0.0.4                     1   Full       811               34   172.16.4.2          DROther
</code></pre>
<h2 id="ospf-database-from-ssr-and-srx">OSPF Database from SSR and SRX</h2>
<p>Get OSPF Database from the Device. The output will be available through websocket. As there can be multiple command
issued against the same device at the same time and the output all goes through the same websocket stream, <code>session</code> is
introduced for demux.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/show_ospf_database
</code></pre>
<h3 id="request_46">Request</h3>
<pre><code>{    
    "self_originate": true, // default is false
    "vrf": "lan"
}
</code></pre>
<h3 id="parameters_37">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>self_originate</code></td>
<td><code>boolean</code></td>
<td>(optional) show originating info, default is false</td>
</tr>
<tr>
<td><code>vrf</code></td>
<td><code>string</code></td>
<td>(optional) VRF name</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(optional) node0 / node1 for HA</td>
</tr>
</tbody>
</table>
<h3 id="response_34">Response</h3>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h3 id="example-output-from-ws-stream_5">Example output from ws stream</h3>
<pre><code>===== ========= ========== ============ ==================== ====== =================
 Vrf   Area ID   LSA Type   LSA ID       Advertising Router    Age   Sequence Number
===== ========= ========== ============ ==================== ====== =================
       0.0.0.0   Router     1.0.0.2      1.0.0.2, (self)      1264        2147483657
       0.0.0.0   Router     1.0.0.3      1.0.0.3              1265        2147483657
       0.0.0.0   Router     1.0.0.4      1.0.0.4              1264        2147483654
       0.0.0.0   Network    172.16.3.2   1.0.0.2, (self)      1264        2147483650
       0.0.0.0   Summary    172.16.2.0   1.0.0.4              1265        2147483649
       0.0.0.0   Summary    172.16.4.0   1.0.0.2, (self)      1410        2147483649
       0.0.0.0   Summary    172.16.4.0   1.0.0.3              1310        2147483649
       0.0.0.0   Summary    172.16.4.0   1.0.0.4              1255        2147483649
       0.0.0.4   Router     1.0.0.2      1.0.0.2, (self)      1264        2147483654
       0.0.0.4   Router     1.0.0.3      1.0.0.3              1265        2147483654
       0.0.0.4   Router     1.0.0.4      1.0.0.4              1230        2147483657
       0.0.0.4   Network    172.16.4.2   1.0.0.2, (self)      1264        2147483650
       0.0.0.4   Summary    172.16.1.0   1.0.0.2, (self)      1410        2147483649
       0.0.0.4   Summary    172.16.1.0   1.0.0.3              1286        2147483649
       0.0.0.4   Summary    172.16.1.0   1.0.0.4              1255        2147483649
       0.0.0.4   Summary    172.16.3.0   1.0.0.2, (self)      1410        2147483649
       0.0.0.4   Summary    172.16.3.0   1.0.0.3              1310        2147483649
       0.0.0.4   Summary    172.16.3.0   1.0.0.4              1255        2147483649
</code></pre>
<h2 id="service-path-from-ssr">Service Path from SSR</h2>
<p>Get service path information of the Device. The output will be available through websocket. As there can be multiple command
issued against the same device at the same time and the output all goes through the same websocket stream, <code>session</code> is
introduced for demux.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/show_service_path
</code></pre>
<h3 id="request_47">Request</h3>
<pre><code>{
    // all attributes are optional
    "service_name": "any"
}
</code></pre>
<h3 id="parameters_38">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>service_name</code></td>
<td><code>string</code></td>
<td>(Optional) The exact service name for which to display the service path</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(Optional) node0 / node1 for HA</td>
</tr>
</tbody>
</table>
<h3 id="response_35">Response</h3>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h3 id="example-output-from-ws-stream_6">Example output from ws stream</h3>
<pre><code>show service-path

Service    Service-route     Type              Destination  Next-Hop  Interface  Vector  Cost  Rate  Capacity        State

Web        web-route1        service-agent     4.4.4.4      1.1.1.2     lan        red     10    1    200/3000       Up*
Web        web-route1        service-agent     4.4.4.4      1.1.1.3     lan        red     10    1    200/3000       Up
Web        web-route2        service-agent     5.5.5.5      2.2.2.2     lan       blue     20    2    50/unlimited   Down
Login      &lt;None&gt;            BgpOverSVR        10.1.1.1     1.2.3.4     wan        red     10    3        -          Up
Login      &lt;None&gt;            BgpOverSVR        11.1.1.1     1.2.3.4     wan        red     10    1        -          Up
App1       &lt;None&gt;            Routed                -           -         -          -      -     -        -          -
App1       learned-routed    Routed                -           -         -          -      -     -        -          -


</code></pre>
<h2 id="sessions-from-ssr-and-srx">Sessions from SSR and SRX</h2>
<p>Get active sessions passing through the Device. The output will be available through websocket. As there can be multiple command
issued against the same device at the same time and the output all goes through the same websocket stream, <code>session</code> is
introduced for demux.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/show_session
</code></pre>
<h3 id="request_48">Request</h3>
<pre><code>{
    // all attributes are optional
    "service_name": "any"
}
</code></pre>
<h3 id="parameters_39">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>service_name</code></td>
<td><code>string</code></td>
<td>(Optional) The exact service name for which to display the active sessions</td>
</tr>
<tr>
<td><code>session_id</code></td>
<td><code>string</code></td>
<td>(Optional) Show session details by session_id</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(Optional) node0 / node1 for HA</td>
</tr>
</tbody>
</table>
<h3 id="response_36">Response</h3>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h3 id="example-output-from-ws-stream_7">Example output from ws stream</h3>
<pre><code>admin@ssr.node# show sessions
Fri 2020-04-17 16:55:34 UTC

Node: node1

====================================== ===== ============= =========== ========== ====== ======= ================= ========== ================= =========== ================= ========== =================== ========= =================
 Session Id                             Dir   Service       Tenant      Dev Name   VLAN   Proto   Src IP            Src Port   Dest IP           Dest Port   NAT IP            NAT Port   Payload Encrypted   Timeout   Uptime
====================================== ===== ============= =========== ========== ====== ======= ================= ========== ================= =========== ================= ========== =================== ========= =================
 01187fb8-765a-45e5-ae90-37d77f15e292   fwd   Internet      lanSubnet   lan           0   udp     192.168.0.28         44674   35.166.173.18          9930   96.230.191.130       19569   false                   154   0 days  0:00:28
 01187fb8-765a-45e5-ae90-37d77f15e292   rev   Internet      lanSubnet   wan           0   udp     35.166.173.18         9930   96.230.191.130        19569   0.0.0.0                  0   false                   154   0 days  0:00:28
 0859a4ae-bcff-4aa6-b812-79a5236a6c13   fwd   Internet      lanSubnet   lan           0   tcp     192.168.0.41         60843   17.249.171.246          443   96.230.191.130       51941   false                     2   0 days  0:00:10


admin@node0.90ec7732e327# show sessions by-id 262900cd-bca8-443a-8aab-e5c93d147ab5
Wed 2024-06-26 20:37:48 UTC
Retrieving session information...

=======================================================================================================================================================================================
 90ec7732e327.node0    Session ID: 262900cd-bca8-443a-8aab-e5c93d147ab5
=======================================================================================================================================================================================
 Service Name:                      Internet
 Service Route Name:                Internet-sr-local-breakout-1-node0
 Session Source:                    SourceType: PUBLIC
 Session Type:                      HTTPS
 Service Class:                     service-class-0-low
 Source Tenant:                     LAN
 Peer Name:                         N/A
 Inter Node:                        N/A
 Inter Router:                      N/A
 Ingress Source Nat:                N/A
 Payload Security Policy:           internal
 Payload Encrypted:                 True
 Common Name Info:                  N/A
 Tcp Time To Establish:             76
 Tls Time To Establish:             76
 Domain Name:                       N/A
 Uri:                               N/A
 Category:                          N/A
...
</code></pre>
<h2 id="subscribe-to-device-command-outputs_1">Subscribe to Device Command outputs</h2>
<pre><code>WS /api-ws/v1/stream
</code></pre>
<h3 id="request_49">Request</h3>
<pre><code>{
    "subscribe": "/sites/:site_id/devices/:device_id/cmd"
}
</code></pre>
<h3 id="response_37">Response</h3>
<pre><code>{
    "event": "data",
    "channel": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/devices/00000000-0000-0000-1000-5c5b350e0060/cmd",
    "data": {
        "session": "session_id",
        "raw": "64 bytes from 23.211.0.110: seq=8 ttl=58 time=12.323 ms\n"
    }
}
</code></pre>
<h2 id="arp-for-the-device">ARP for the Device</h2>
<p>ARP can be performed on the Device. The output will be available through websocket. As there can be multiple command
issued against the same AP at the same time and the output all goes through the same websocket stream, <code>session</code> is
introduced for demux.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/arp
</code></pre>
<h3 id="parameters_40">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(Optional) node0 / node1 for HA</td>
</tr>
</tbody>
</table>
<h3 id="response_38">Response</h3>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h2 id="subscribe-to-device-command-outputs_2">Subscribe to Device Command outputs</h2>
<pre><code>WS /api-ws/v1/stream
</code></pre>
<h3 id="request_50">Request</h3>
<pre><code>{
    "subscribe": "/sites/:site_id/devices/:device_id/cmd"
}
</code></pre>
<h3 id="response_39">Response</h3>
<pre><code>{
    "event": "data",
    "channel": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/devices/00000000-0000-0000-1000-5c5b350e0060/cmd",
    "data": {
        "session": "session_id",
        "raw": "Output": "\tMAC\t\tDEV\tVLAN\tRx Packets\t\t    Rx Bytes\t\tTx Packets\t\t    Tx Bytes\tFlows\tIdle..."
    }
}
</code></pre>
<h2 id="traceroute">Traceroute</h2>
<p>Traceroute can be performed from the Device. The output will be available through websocket. As there can be multiple
command issued against the same AP at the same time and the output all goes through the same websocket stream, <code>session</code>
is introduced for demux.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/traceroute
</code></pre>
<h3 id="request_51">Request</h3>
<pre><code>{
    "host": "1.1.1.1",
    "protocol": "udp",
    "port": 33434,
    "timeout": 120,

    // for SSR, optional, the source to initiate traceroute from. by default, host internal is assumed
    "network": "corp"
    // for SRX, optional, the source to initiate traceroute from. by default, master VRF/RI is assumed
    "vrf": "lan"
}
</code></pre>
<h3 id="parameters_41">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>host</code></td>
<td><code>string</code></td>
<td>host name</td>
</tr>
<tr>
<td><code>protocol</code></td>
<td><code>string</code></td>
<td>udp (default) /icmp (only supported in AP/MxEdge)</td>
</tr>
<tr>
<td><code>port</code></td>
<td><code>int</code></td>
<td>when protocol=udp, the udp port to use (default is 33434), not supported in SSR</td>
</tr>
<tr>
<td><code>timeout</code></td>
<td><code>uint</code></td>
<td>maximum time in seconds to wait for the response (default is 60, not supported in SSR)</td>
</tr>
<tr>
<td><code>network</code></td>
<td><code>string</code></td>
<td>The network on behalf of whom the traceroute is to be run (default is ‘internal’).</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(Optional) node0 / node1 for HA</td>
</tr>
</tbody>
</table>
<h2 id="show-arp-table">Show ARP Table</h2>
<p>Show ARP Table. The output will be available through websocket.</p>
<p>POST /api/v1/sites/:site_id/devices/:device_id/show_arp</p>
<h3 id="request_52">Request</h3>
<pre><code>{
    // all optional
    "ip": "192.168.30.7”,
    "port_id": "ge-0/0/0.0",
    "vrf": "guest"
}
</code></pre>
<h3 id="parameters_42">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>(optional) IP address</td>
</tr>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>(optional) port id</td>
</tr>
<tr>
<td><code>vrf</code></td>
<td><code>string</code></td>
<td>(Optional) vrf name</td>
</tr>
<tr>
<td><code>interval</code></td>
<td><code>int</code></td>
<td>(Optional) rate at which output will refresh, default is 0 and valid range 0-10.</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>(Optional) duration in sec for which refresh is enabled, default is 0 and valid range 0-300 sec. Should be set only if interval is configured to non-zero value.</td>
</tr>
</tbody>
</table>
<h3 id="response_40">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h2 id="show-mac-table">Show MAC Table</h2>
<p>Show MAC Table. The output will be available through websocket.</p>
<p>POST /api/v1/sites/:site_id/devices/:device_id/show_mac_table</p>
<h3 id="request_53">Request</h3>
<pre><code>{
    "mac": "112233445566”,
    "vlan_id": 1,
    "port_id": "ge-0/0/0.0"
}
</code></pre>
<h3 id="parameters_43">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>(optional) mac address</td>
</tr>
<tr>
<td><code>vlan_id</code></td>
<td><code>int</code></td>
<td>(optional) vlan id</td>
</tr>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>(optional) port id</td>
</tr>
<tr>
<td><code>interval</code></td>
<td><code>int</code></td>
<td>(Optional) rate at which output will refresh, default is 0 and valid range 0-10.</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>(Optional) duration in sec for which refresh is enabled, default is 0 and valid range 0-300 sec. Should be set only if interval is configured to non-zero value.</td>
</tr>
</tbody>
</table>
<h2 id="clear-mac-table">Clear MAC Table</h2>
<p>Clear MAC Table. The output will be available through websocket.</p>
<p>POST /api/v1/sites/:site_id/devices/:device_id/clear_mac_table</p>
<h3 id="request_54">Request</h3>
<pre><code>{
    "mac": "112233445566”,
    "vlan_id": 1,
    "port_id": "ge-0/0/0.0"
}
</code></pre>
<h3 id="parameters_44">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>(optional) mac address</td>
</tr>
<tr>
<td><code>vlan_id</code></td>
<td><code>int</code></td>
<td>(optional) vlan id</td>
</tr>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>(optional) port name</td>
</tr>
</tbody>
</table>
<h3 id="response_41">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h2 id="show-evpn-database">Show EVPN Database</h2>
<p>Show EVPN Database. The output will be available through websocket.</p>
<p>POST /api/v1/sites/:site_id/devices/:device_id/show_evpn_database</p>
<h3 id="request_55">Request</h3>
<pre><code>{
    // all optional
    "mac": "f8c1165c6400”,
    "port_id": "ge-0/0/0.0"
}
</code></pre>
<h3 id="parameters_45">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>(optional) client mac filter</td>
</tr>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>(optional) interface name</td>
</tr>
<tr>
<td><code>interval</code></td>
<td><code>int</code></td>
<td>(Optional) rate at which output will refresh, default is 0 and valid range 0-10.</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>(Optional) duration in sec for which refresh is enabled, default is 0 and valid range 0-300 sec. Should be set only if interval is configured to non-zero value.</td>
</tr>
</tbody>
</table>
<h3 id="response_42">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h2 id="dns-for-ssr-device">DNS for SSR Device</h2>
<p>DNS resolutions are performed on the Device. The output will be available through websocket. As there can be multiple command
 issued against the same SSR at the same time and the output all goes through the same websocket stream, <code>session</code> is
 used for demux.</p>
<pre><code> POST /api/v1/sites/:site_id/devices/:device_id/resolve_dns
</code></pre>
<h3 id="response_43">Response</h3>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h2 id="subscribe-to-device-command-outputs_3">Subscribe to Device Command outputs</h2>
<pre><code>WS /api-ws/v1/stream
</code></pre>
<h3 id="request_56">Request</h3>
<h3 id="request_57">Request</h3>
<pre><code>{
    "subscribe": "/sites/:site_id/devices/:device_id/cmd"
}
</code></pre>
<h3 id="response_44">Response</h3>
<table>
<thead>
<tr>
<th>Router</th>
<th>Hostname</th>
<th>Resolved</th>
<th>Last Resolved</th>
<th>Expiration</th>
</tr>
</thead>
<tbody>
<tr>
<td>test-device</td>
<td>xxx.yyy.net</td>
<td>Y</td>
<td>2022-03-28T03:56:49Z</td>
<td>2022-03-28T03:57:49Z</td>
</tr>
</tbody>
</table>
<h2 id="forwarding-table-from-ssr-srx-and-switch">Forwarding table from SSR, SRX and Switch</h2>
<p>Get forwarding table from the Device. The output will be available through websocket. As there can be multiple command
issued against the same device at the same time and the output all goes through the same websocket stream, <code>session</code> is
introduced for demux.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/show_forwarding_table
</code></pre>
<h3 id="request_58">Request</h3>
<pre><code>{
    // all optional
    "prefix": "3.1.1.0/24",
    "vrf": "guest",
    "node": "node0",

    // ssr forwarding table has service related information either
    //      by service, or
    "service_name": "internet-wan_and_lte"

    //      by matching (all parameters below needs to be specified)
    "service_tenant": "branch1-wifi-mgt",
    "service_ip": "3.1.1.10",
    "service_port": "32768",
    "service_protocol": "udp"
}
</code></pre>
<h3 id="parameters_46">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(Optional) node0 / node1 for HA</td>
</tr>
<tr>
<td><code>vrf</code></td>
<td><code>string</code></td>
<td>(Optional) VRF name</td>
</tr>
<tr>
<td><code>prefix</code></td>
<td><code>string</code></td>
<td>(Optional) IP prefix</td>
</tr>
<tr>
<td><code>service_name</code></td>
<td><code>string</code></td>
<td>(Optional) service name, only supported in SSR</td>
</tr>
<tr>
<td><code>service_tenant</code></td>
<td><code>string</code></td>
<td>(Optional) service tenent, only supported in SSR</td>
</tr>
<tr>
<td><code>service_ip</code></td>
<td><code>string</code></td>
<td>(Optional) service destination ip, only supported in SSR</td>
</tr>
<tr>
<td><code>service_port</code></td>
<td><code>int</code></td>
<td>(Optional) service destination port, only supported in SSR</td>
</tr>
<tr>
<td><code>service_protocol</code></td>
<td><code>string</code></td>
<td>(Optional) service protocol, only supported in SSR</td>
</tr>
</tbody>
</table>
<ul>
<li>Note: <code>prefix</code> or/and <code>service_name</code> must be used for filtering forwarding table</li>
</ul>
<h3 id="response_45">Response</h3>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h3 id="example-output-from-ws-stream_8">Example output from ws stream</h3>
<pre><code>Mon 2024-05-20 16:47:30 UTC
Retrieving fib entries...

Entry Count: 3268
Capacity:    22668

==================== ====== ======= ================== ===== ====================== =========== =========== ======
 IP Prefix            Port   Proto   Tenant             VRF   Service                Next Hops   Vector      Cost
==================== ====== ======= ================== ===== ====================== =========== =========== ======
 0.0.0.0/0               0   None    Old_Mgmt           -     internet-wan_and_lte   1-2.0       broadband      1
                                                                                     1-4.0       lte           10
                                     branch1-Kiosk      -     internet-wan_and_lte   1-2.0       broadband      1
                                                                                     1-4.0       lte           10
                                     branch1-MGT        -     internet-wan_and_lte   1-2.0       broadband      1
                                                                                     1-4.0       lte           10
 3.1.1.0/24              0   None    Old_Mgmt           -     internet-wan_and_lte   1-2.0       broadband      1
                                                                                     1-4.0       lte           10
                                     branch1-Kiosk      -     internet-wan_and_lte   1-2.0       broadband      1
                                                                                     1-4.0       lte           10
                                     branch1-MGT        -     internet-wan_and_lte   1-2.0       broadband      1
                                                                                     1-4.0       lte           10
</code></pre>
<h2 id="cable-test-from-switch">Cable Test from Switch</h2>
<p>TDR can be performed from the Switch. The output will be available through websocket. As there can be multiple command
issued against the same Switch at the same time and the output all goes through the same websocket stream, <code>session</code> is
introduced for demux.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/cable_test
</code></pre>
<h3 id="request_59">Request</h3>
<pre><code>{
    "port": "ge-0/0/0"
}
</code></pre>
<h3 id="parameters_47">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>port</code></td>
<td><code>string</code></td>
<td>the port to run the cable test</td>
</tr>
</tbody>
</table>
<h3 id="response_46">Response</h3>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h2 id="subscribe-to-cable-test-outputs">Subscribe to Cable Test outputs</h2>
<pre><code>WS /api-ws/v1/stream
</code></pre>
<h3 id="request_60">Request</h3>
<pre><code>{
    "subscribe": "/sites/:site_id/devices/:device_id/cmd"
}
</code></pre>
<h3 id="response_47">Response</h3>
<pre><code>{
    "event": "data",
    "channel": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/devices/00000000-0000-0000-1000-5c5b350e0060/cmd",
    "data": {
        "session": "session_id",
        "raw": "Interface TDR detail:\nTest status : Test successfully executed  ge-0/0/0\n"
    }
}
</code></pre>
<h2 id="create-shell-session">Create Shell Session</h2>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/shell
</code></pre>
<h3 id="request_61">Request</h3>
<pre><code>{
    "node": "node0"
}
</code></pre>
<h3 id="parameters_48">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(Optional) node0 / node1 for SSR HA</td>
</tr>
</tbody>
</table>
<h3 id="response_48">Response</h3>
<pre><code>{
    "session': "19e73828-937f-05e6-f709-e29efdb0a82b",
    "url": "wss://api-ws.mist.com/ssh?jwt=xxxx"
}
</code></pre>
<h2 id="monitor-traffic">Monitor Traffic</h2>
<p>Monitor traffic on switches and SRX.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/monitor_traffic
</code></pre>
<h3 id="request_62">Request</h3>
<pre><code>{
    "port": "ge-0/0/1"
}
</code></pre>
<h3 id="parameters_49">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>port</code></td>
<td><code>string</code></td>
<td>(optional) port name, if no port input is provided then all ports will be monitored</td>
</tr>
</tbody>
</table>
<pre><code>JUNOS uses cmd "monitor interface &lt;port&gt;" to monitor traffic on particular &lt;port&gt;
JUNOS uses cmd "monitor interface traffic" to monitor traffic on all ports
</code></pre>
<h3 id="response_49">Response</h3>
<pre><code>{
    "session': "19e73828-937f-05e6-f709-e29efdb0a82b",
    "url": "wss://api-ws.mist.com/ssh?jwt=xxxx"
}
</code></pre>
<h2 id="run-top-command">Run top command</h2>
<p>Run top command on switches and SRX.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/run_top
</code></pre>
<h3 id="response_50">Response</h3>
<pre><code>{
    "session': "19e73828-937f-05e6-f709-e29efdb0a82b"
    "url": "wss://api-ws.mist.com/ssh?jwt=xxxx"
}
</code></pre>
<h2 id="clear-bgp-routes">Clear BGP routes</h2>
<p>Clear routes associated with one or all BGP neighbors</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/clear_bgp
</code></pre>
<h3 id="request_63">Request</h3>
<pre><code>{
    "neighbor": "all",
    "type": "soft",
    "vrf": "TestVrf"
}
</code></pre>
<h3 id="parameters_50">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>neighbor</code></td>
<td><code>string</code></td>
<td>neighbor ip-address or ‘all’</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>hard (default) / soft / in / out</td>
</tr>
<tr>
<td><code>vrf</code></td>
<td><code>string</code></td>
<td>(Optional) vrf name</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(Optional) node0 / node1 for HA</td>
</tr>
</tbody>
</table>
<h3 id="response_51">Response</h3>
<pre><code>Status: 200 OK
Status: 400 - parameter neighbor absent
</code></pre>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h2 id="clear-policy-hit-count-for-srx">Clear Policy Hit Count for SRX</h2>
<p>Clear application policy hit counts for all the policies</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/clear_policy_hit_count
</code></pre>
<h3 id="response_52">Response</h3>
<pre><code>Status: 200 - OK
Status: 400 - Bad Request
</code></pre>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h2 id="release-dhcp-lease-for-ssr-wan-network-interface">Release DHCP lease for SSR Wan Network Interface</h2>
<p>Releases an active DHCP lease for SSR wan network interface.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/release_dhcp
</code></pre>
<h3 id="request_64">Request</h3>
<pre><code>{
    "port_id": "ge-0/0/1.10"
}
</code></pre>
<h3 id="parameters_51">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>The nework interface on which to release the current DHCP release</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(Optional) node0 / node1 for HA</td>
</tr>
</tbody>
</table>
<h3 id="response_53">Response</h3>
<pre><code>Status: 200 OK
Status: 400 - parameter port_id absent
</code></pre>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h2 id="show-dhcp-leases">Show DHCP leases</h2>
<p>Shows DHCP leases.
    POST /api/v1/sites/:site_id/devices/:device_id/show_dhcp_leases</p>
<h3 id="request_65">Request</h3>
<pre><code>{
    "network": "guest"
}
</code></pre>
<h3 id="parameters_52">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>network</code></td>
<td><code>string</code></td>
<td>(Optional) DHCP network for the leases, returns full table if not specified</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(Optional) node0 / node1 for HA</td>
</tr>
</tbody>
</table>
<h3 id="response_54">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h2 id="release-leases-from-dhcp-server">Release leases from DHCP server</h2>
<p>Releases active leases from DHCP server.
    POST /api/v1/sites/:site_id/devices/:device_id/release_dhcp_leases</p>
<h3 id="request_66">Request</h3>
<pre><code>{
    // all optional
    "port_id": "ge-0/0/1",
    "macs": ["90ec77aabbcc", "90ec77aabbdd"],
    "network": "guest,
}
</code></pre>
<h3 id="parameters_53">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>network</code></td>
<td><code>string</code></td>
<td>(Optional) The network for the leases IPs to be released</td>
</tr>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>(Optional) The nework interface on which to release the current DHCP release</td>
</tr>
<tr>
<td><code>macs</code></td>
<td><code>list</code></td>
<td>A list of client macs to be released</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(Optional) node0 / node1 for HA</td>
</tr>
</tbody>
</table>
<ul>
<li>Note: 1. valid combinations for Junos: [<code>port_id</code>, <code>macs</code>+<code>network</code>],
            for SSR: [<code>port_id</code>, <code>macs</code>+<code>network</code>, <code>port_id</code>+<code>macs</code>, <code>port_id</code>+<code>network</code>, <code>network</code>]
        2. if <code>network</code> or <code>port_id</code> is specified and <code>macs</code> is empty, it means all clients under <code>network</code> or <code>port_id</code></li>
</ul>
<h2 id="clear-arp-cache-for-ssr-srx-and-switch">Clear ARP cache for SSR, SRX and Switch</h2>
<p>Clear the entire ARP cache or a subset if arguments are provided.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/clear_arp
</code></pre>
<h3 id="request_67">Request</h3>
<pre><code>{
    "port_id": "wan",
    "vlan" : 1000,
    "ip" : "10.1.1.1",
    "vrf": "guest"
}
</code></pre>
<h3 id="parameters_54">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>The device interface on which to clear the ARP cache.</td>
</tr>
<tr>
<td><code>vlan</code></td>
<td><code>int</code></td>
<td>The VLAN on which to clear the ARP cache. port_id must be specified.</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>The IP address for which to clear an ARP entry. port_id must be specified.</td>
</tr>
<tr>
<td><code>vrf</code></td>
<td><code>string</code></td>
<td>The vrf for which to clear an ARP entry. applicable for switch.</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(Optional) node0 / node1 for HA</td>
</tr>
</tbody>
</table>
<ul>
<li>Note: <code>port_id</code> is optional if neither <code>vlan</code> nor <code>ip</code> is specified</li>
</ul>
<h3 id="response_55">Response</h3>
<pre><code>Status: 200 OK
Status: 400 - port_id must be specified with vlan or ip
</code></pre>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h2 id="clear-session-for-ssr-srx">Clear session for SSR, SRX</h2>
<p>Clear session</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/clear_session
</code></pre>
<h3 id="request_68">Request</h3>
<pre><code>{
    // all optional
    // session deletion by providing service_name to delete all sessions under the service,
    "service_name": "internet-wan_and_lte",

    // or by providing the session id to delete a particular session,
    "session_ids" : [88776655-0123-4567-890a-112233445566],

</code></pre>
<h3 id="parameters_55">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>service_name</code></td>
<td><code>string</code></td>
<td>(Optional) service name, only supported in SSR</td>
</tr>
<tr>
<td><code>session_ids</code></td>
<td><code>array of strings</code></td>
<td>List of id of the sessions to be cleared</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>(Optional) node0 / node1 for HA</td>
</tr>
</tbody>
</table>
<ul>
<li>Note: to use five tuples to lookup the session to be cleared, all must be provided</li>
</ul>
<h3 id="response_56">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h2 id="clear-all-learned-macs-from-port-on-switch">Clear all learned macs from port on Switch</h2>
<p>Clear all learned MAC addresses, including persistent MAC addresses, on a port.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/clear_macs
</code></pre>
<h3 id="request_69">Request</h3>
<pre><code>{
    "ports": ["ge-0/0/0.0"]
}
</code></pre>
<h3 id="parameters_56">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ports</code></td>
<td><code>list</code></td>
<td>a list of ports on which to clear mac addresses. must include logical unit number.</td>
</tr>
</tbody>
</table>
<h3 id="response_57">Response</h3>
<pre><code>Status: 200 OK
Status: 400 - logical unit number not specified
Status: 400 - ports not specified
</code></pre>
<h2 id="clear-bpdu-errors-from-ports-on-switch">Clear BPDU errors from port(s) on Switch</h2>
<p>Clear bridge protocol data unit (BPDU) error condition caused by the detection of a possible bridging loop from Spanning
Tree Protocol (STP) operation that renders the port unoperational.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/clear_bpdu_error
</code></pre>
<h3 id="request_70">Request</h3>
<pre><code>{
    "ports": ["ge-0/0/2"]
}
</code></pre>
<pre><code>{
    "ports": ["all"]
}
</code></pre>
<h3 id="parameters_57">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ports</code></td>
<td><code>list</code></td>
<td>the ports on which to clear the detected BPDU error, or <code>["all"]</code> for all ports</td>
</tr>
</tbody>
</table>
<h3 id="response_58">Response</h3>
<pre><code>Status: 200 OK
Status: 400 - ports not specified
</code></pre>
<h2 id="port-bounce-from-switch-gateway">Port Bounce from Switch / Gateway</h2>
<p>Port Bounce can be performed from the Switch/Gateway.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/bounce_port
</code></pre>
<h3 id="request-for-bounce-ports">Request for bounce ports</h3>
<pre><code>{
    "ports": ["ge-0/0/0"]
}
</code></pre>
<h3 id="request-for-bounce-multiple-ports">Request for bounce multiple ports</h3>
<pre><code>{
    "ports": ["ge-0/0/0", "ge-0/0/1"]
}
</code></pre>
<h3 id="request-for-bounce-a-port-and-multiple-ports">Request for bounce a port and multiple ports</h3>
<pre><code>{
    "ports": ["ge-0/0/1", "ge-0/0/2"]
}
</code></pre>
<h3 id="parameters_58">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ports</code></td>
<td><code>list</code></td>
<td>list of ports to bounce</td>
</tr>
</tbody>
</table>
<p>Note: Ports starting with <code>vme</code>, <code>ae</code>, <code>irb</code>, and HA control ports (for SSR only) are not supported</p>
<h3 id="response_59">Response</h3>
<pre><code>{
    "session": "session_id"
}
</code></pre>
<h2 id="subscribe-to-cable-test-outputs_1">Subscribe to Cable Test outputs</h2>
<pre><code>WS /api-ws/v1/stream
</code></pre>
<h3 id="request_71">Request</h3>
<pre><code>{
    "subscribe": "/sites/:site_id/devices/:device_id/cmd"
}
</code></pre>
<h3 id="response_60">Response</h3>
<pre><code>{
    "event": "data",
    "channel": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/devices/00000000-0000-0000-1000-5c5b350e0060/cmd",
    "data": {
        "session": "session_id",
        "raw": "Port bounce complete."
    }
}
</code></pre>
<h2 id="update-delete-local-switch-port-config">Update / Delete Local Switch Port Config</h2>
<p>Sometimes HelpDesk Admin needs to change port configs. They can use the following APIs.</p>
<pre><code>PUT /api/v1/sites/:site_id/devices/:device_id/local_port_config
DELETE /api/v1/sites/:site_id/devices/:device_id/local_port_config
</code></pre>
<h3 id="payload">Payload</h3>
<pre><code>{
    "ge-0/0/5-7": { ... }
}
</code></pre>
<h3 id="how-does-it-show-up-in-device-config">How does it show up in Device Config?</h3>
<p><code>local_port_config</code> will show up separately from the <code>port_config</code> so it can be easily identified (and cleared)</p>
<pre><code>{
    "local_port_config": {
        "ge-0/0/5-7": {
            ... 
            "note": "force 100M for camera"
        }
    }
}
</code></pre>
<h3 id="how-to-prevent-helpdesk-users-to-overwrite-a-port-config">How to prevent HelpDesk users to overwrite a port config?</h3>
<p><code>no_local_overwrite</code> can be added in port_config. e.g. </p>
<pre><code>{
    "port_config": {
        "ge-0/0/5-7": {
            "usage": "uplink",
            "no_local_overwrite": true
        }
    }
}
</code></pre>
<h2 id="poll-stats-proactively-from-switch">Poll Stats Proactively from Switch</h2>
<p>This API can be used to poll statistics from the Switch proactively once. After it is called, the statistics will be
pushed back to the cloud within the statistics interval.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/poll_stats
</code></pre>
<h3 id="response_61">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h2 id="readopt-the-octerm-devices">Readopt the octerm devices</h2>
<p>For the octerm devices, the device ID must come from fpc0. However, for a VC, the users may
change the original fpc0 from CLI. To fix the issue, the readopt API could be used to trigger
the readopt process so the device would get the corret device ID to connect the cloud.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/readopt
</code></pre>
<h3 id="response_62">Response</h3>
<pre><code>Status: 200 OK
Status: 400 - the device is not a virtual chassis
</code></pre>
<h2 id="set-iot-output-pins">Set IoT Output Pins</h2>
<p>Note: For each IoT pin referenced…</p>
<ol>
<li>The pin must be enabled using the Device ‘iot_config’ API</li>
<li>The pin must support the output direction</li>
</ol>
<p>PUT /api/v1/sites/:site_id/devices/:device_id/iot</p>
<h3 id="request_72">Request</h3>
<pre><code>{
    "DO": 0,
    "A1": 1
}
</code></pre>
<h3 id="response_63">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h2 id="get-iot-output-pins">Get IoT Output Pins</h2>
<p>Returns the current state of each enabled IoT pin configured as an output.</p>
<pre><code>GET /api/v1/sites/:site_id/devices/:device_id/iot
</code></pre>
<h3 id="response_64">Response</h3>
<pre><code>{
    "DO": 0,
    "A1": 1
}
</code></pre>
<h2 id="set-antenna-mode">Set Antenna Mode</h2>
<p>PUT /api/v1/sites/:site_id/devices/:device_id/set_ant_mode</p>
<h3 id="request_73">Request</h3>
<pre><code>{
    "ant_mode": "external"  // internal / external
}
</code></pre>
<h2 id="get-available-device-versions">Get Available Device Versions</h2>
<pre><code>GET /api/v1/sites/:site_id/devices/versions
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>fetch version for device type (E.g. switch)</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>fetch version for device model, use/combine with <code>type</code> as needed (for switch and gateway devices)</td>
</tr>
</tbody>
</table>
<h3 id="response_65">Response</h3>
<pre><code>[
    {
        "model": "AP41",
        "version": "v0.1.543",
        "tag": "stable",
    },
    {
        "model": "AP21",
        "version": "v0.1.545",
    },
    ...
]
</code></pre>
<h3 id="response-schema">Response Schema</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>device model (as seen in the device stats)</td>
</tr>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>firmware version</td>
</tr>
<tr>
<td><code>tag</code></td>
<td><code>string</code></td>
<td>annotation, stable / beta / alpha. Or it can be empty or nothing which is likely a dev build</td>
</tr>
</tbody>
</table>
<h2 id="check-ap-upgrade-status">Check AP Upgrade Status</h2>
<p>When the device is being upgraded, device stat will have the following.</p>
<pre><code>{
    "status": "upgrading",
    "fwupdate": {
        "timestamp": 1428949501,
        "status": "inprogress",
        "status_id": 5,
        "progress": 10
    },
    "auto_upgrade_stat": {
        "scheduled": true,
        "scheduled_version": "1.2.3",
        "scheduled_time": 1428949501
    }
}
</code></pre>
<p>the status will be <code>upgrading</code> and a <code>fwupdate</code> object will be added</p>
<p>see also <a href="https://api.mist.com/api/v1/docs/Site#device-stats">Device Stats</a></p>
<h2 id="get-ap-radio-channels">Get AP Radio Channels</h2>
<p>Get a list of allowed channels (per channel width)</p>
<pre><code>GET /api/v1/sites/:site_id/devices/ap_channels?country_code=US
</code></pre>
<h3 id="parameters_59">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>country_code</code></td>
<td><code>string</code></td>
<td>country code for the site (for AP config generation), in <a href="http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">two-character</a></td>
</tr>
</tbody>
</table>
<h3 id="response_66">Response</h3>
<pre><code>{
    "key": "US",
    "name": "United States"
    "code": 840,
    "band24_enabled": true,
    "band24_channels": {
        "20": [
            1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11
        ],
        "40": [
            1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11
        ]
    },
    "band5_enabled": true,
    "dfs_ok": true,
    "band5_channels": {
        "20": [
            36, 40, 44, 48, 52, 56, 60, 64, 100, 104, 108, 112, 116, 132, 136, 140, 149, 153, 157, 161, 165
        ],
        "40": [
            36, 40, 44, 48, 52, 56, 60, 64, 100, 104, 108, 112, 132, 136, 149, 153, 157, 161
        ],
        "80": [
            36, 40, 44, 48, 52, 56, 60, 64, 100, 104, 108, 112, 132, 136, 149, 153, 157, 161
        ],
        "dfs": [
            52, 56, 60, 64, 100, 104, 108, 112, 116, 132, 136, 140
        ],
        "outdoor": [
            "100, 104, 108, 112, 116, 132, 136, 140"
        ]
    }
}
</code></pre>
<h2 id="get-traffic-types">Get Traffic Types</h2>
<pre><code>GET /api/v1/const/traffic_types
</code></pre>
<h3 id="response_67">Response</h3>
<pre><code class="language-json">[
    {
        "name": "data_best_effort",
        "failover_policy": "non-revertible",
        "traffic_class": "low",
        "dscp": 0
    },
    ...
]
</code></pre>
<h2 id="get-ap-device-models">Get AP Device Models</h2>
<p>Get a list of AP device models for the Mist Site</p>
<pre><code>GET /api/v1/const/device_models
</code></pre>
<h3 id="response_68">Response</h3>
<pre><code>[
    {
        "model": "AP41",
        "display": "AP41",
        "description": "AP-41",
        "ap_type": "aph",
        "fcc_dfs_ok": true,
        "ce_dfs_ok": true,
        "other_dfs_ok": true,
        "has_scanning_radio": true,
        "has_extio": true,
        "extio": {
            "DO": {
                "input": true,
                "default_dir": "OUT",
                "output": true
            },
            "A1": {
                "input": true,
                "default_dir": "IN",
                "output": true
            },
            "A3": {
                "input": true,
                "default_dir": "IN",
                "output": true
            },
            "A2": {
                "input": true,
                "default_dir": "IN",
                "output": true
            },
            "A4": {
                "input": true,
                "default_dir": "IN",
                "output": true
            },
            "DI1": {
                "input": true,
                "default_dir": "IN",
                "output": false
            },
            "DI2": {
                "input": true,
                "default_dir": "IN",
                "output": false
            }
        },
        "has_height": true,
        "has_usb": true,
        "has_wifi_band5": true,
        "has_wifi_band24": true,
        "band5": {
            "max_clients": 128,
            "max_power": 17,
            "min_power": 8
        },
        "band24": {
            "max_clients": 128,
            "max_power": 19,
            "min_power": 8
        },
        "max_poe_out": 6000,
        "has_module_port": true,
        "has_compass": true,
        "has_vble": true,
        "vble": {
            "beacon_rate": 4,
            "power": 8
        }
    }
]
</code></pre>
<h3 id="definition_1">Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>fcc_dfs_ok</code></td>
<td><code>boolean</code></td>
<td>US-only; whether DFS channels are allowed in US for the AP model</td>
</tr>
<tr>
<td><code>ce_dfs_ok</code></td>
<td><code>boolean</code></td>
<td>EU-only; whether DFS channels are allowed in EU countries for the AP model</td>
</tr>
<tr>
<td><code>other_dfs_ok</code></td>
<td><code>boolean</code></td>
<td>JP + all other countries; whether DFS channels are allowed in JP and other remaining countries for the AP model</td>
</tr>
</tbody>
</table>
<h2 id="get-device-models">Get Device Models</h2>
<p>Get a list of model definitions (mapping model to its display name, etc)</p>
<pre><code>GET /api/v1/const/device_models
</code></pre>
<h3 id="response_69">Response</h3>
<pre><code>[
    {
        "model": "APH",
        "description": "AP-H, our initial AP with integrated antennas",
        "display": "AP-Premium",
        "has_wifi_band5": true,
        "has_wifi_band24": true,
        "has_scanning_radio": true,
        "has_vble": true,
        "outdoor": false,
        "vble": {
            "power": 8,
            "beacon_rate": 4
        },
        "band24": {
            "max_clients": 128,
            "max_power": 17,
            "min_power": 11
        },
        "band5": {
            "max_clients": 128,
            "max_power": 17,
            "min_power": 11
        },
        "has_compass": true,
        "has_height": true,
        "fcc_dfs_ok": true,
        "ce_dfs_ok": true,
        "other_dfs_ok": true
    }
]
</code></pre>
<h3 id="definition_2">Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>fcc_dfs_ok</code></td>
<td><code>boolean</code></td>
<td>US-only; whether DFS channels are allowed in US for the AP model</td>
</tr>
<tr>
<td><code>ce_dfs_ok</code></td>
<td><code>boolean</code></td>
<td>EU-only; whether DFS channels are allowed in EU countries for the AP model</td>
</tr>
<tr>
<td><code>other_dfs_ok</code></td>
<td><code>boolean</code></td>
<td>JP + all other countries; whether DFS channels are allowed in JP and other remaining countries for the AP model</td>
</tr>
</tbody>
</table>
<p>Note: <code>min_power</code> and <code>max_power</code> are limits that we consider operational (depending on the AP model and testing). And
AP may further limit it depending on country/regulatory/channel.</p>
<h2 id="subscribe-to-devices-stream">Subscribe to devices Stream</h2>
<pre><code>WS /api-ws/v1/stream
</code></pre>
<h3 id="request_74">Request</h3>
<pre><code>{
    "subscribe": "/sites/:site_id/devices"
}
</code></pre>
<h3 id="response_70">Response</h3>
<pre><code>{
    "event": "data",
    "channel": "/sites/67970e46-4e12-11e6-9188-0242ac110007/devices",
    "data": {
        "site_id": "67970e46-4e12-11e6-9188-0242ac110007",
        "device_id": "00000000-0000-0000-1000-5c5b3524500b",
        "event_type": "fwupdate",
        "detail": {
            'timestamp': 1485381027,
            'status': 'inprogress,
            'status_id': 4,
            'progress': 45
        }
    }
}
</code></pre>
<h3 id="definition_3">Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ap_mac</code></td>
<td><code>string</code></td>
<td>mac of the device corresponding to the event</td>
</tr>
<tr>
<td><code>event_type</code></td>
<td><code>string</code></td>
<td>type of the event that occurred. currently, on device updates are reported on the stream.</td>
</tr>
<tr>
<td><code>detail</code></td>
<td><code>object</code></td>
<td>detail will be specific to the <code>event_type</code>.</td>
</tr>
</tbody>
</table>
<h2 id="subscribe-to-devices-stats-stream">Subscribe to devices stats Stream</h2>
<pre><code>WS /api-ws/v1/stream
</code></pre>
<h3 id="request_75">Request</h3>
<pre><code>{
    "subscribe": "/sites/:site_id/stats/devices"
}
</code></pre>
<h3 id="response_71">Response</h3>
<pre><code>{
    "event": "data",
    "channel": "/sites/67970e46-4e12-11e6-9188-0242ac110007/stats/devices",
    "data": {
        "mac": "5c5b350e1300",
        "version": "0.1.11681",
        "ip": "10.2.10.193",
        "ext_ip": "73.92.124.103",
        "power_src": "PoE 802.3af",
        "uptime": 706659,
        "last_seen": 1504917238,
        "num_clients": 1,
        "num_wlans": 3,
        "ip_stat": {
            // v4
            "ip": "10.2.10.193",
            "netmask": "255.255.192.0",
            "gateway": "10.2.1.1",
            // v6
            "ip6": "2607:f8b0:4005:808::2004",
            "netmask6": "/32",
            "gateway6": "2607:f8b0:4005:808::1",
            "dns": [
                "8.8.8.8",
                "8.8.4.4"
            ],
            "ips": {
                "vlan1": "10.2.1.1/24,2607:f8b0:4005:808::1/32"
            }
        },
        "radio_stat": {
            "band_5": {
                "mac": "5c5b3500bc50",
                "tx_pkts": 29790678,
                "bandwidth": 40,
                "channel": 149,
                "power": 15,
                "tx_bytes": 642844306,
                "rx_pkts": 214935,
                "rx_bytes": 28557893,
                "num_wlans": 1,
                "num_clients": 1
            },
            "band_24": {
                "mac": "5c5b3500bc40",
                "tx_pkts": 19831714,
                "bandwidth": 20,
                "channel": 11,
                "power": 11,
                "tx_bytes": 3118012867,
                "rx_pkts": 3,
                "rx_bytes": 298,
                "num_wlans": 1,
                "num_clients": 0
            },
            "band_6": {
                "mac": "5c5b3500bc60",
                "tx_pkts": 29790678,
                "bandwidth": 40,
                "channel": 53,
                "power": 15,
                "tx_bytes": 642844306,
                "rx_pkts": 214935,
                "rx_bytes": 28557893,
                "num_wlans": 1,
                "num_clients": 1
            },            
        },
        "port_stat": {
            "module": {
                "tx_pkts": 6413453,
                "rx_pkts": 951238,
                "rx_bytes": 877498272,
                "tx_bytes": 1009414543,
                "rx_peak_bps": 31116,
                "tx_peak_bps": 42165,
                "full_duplex": true,
                "speed": 1000,
                "up": true,
                "rx_errors": 0
            },
            "eth3": {
                "tx_pkts": 0,
                "rx_pkts": 0,
                "rx_bytes": 0,
                "tx_bytes": 0,
                "rx_peak_bps": 0,
                "tx_peak_bps": 0,
                "full_duplex": false,
                "speed": 0,
                "up": false,
                "rx_errors": 0
            },
            "eth2": {
                "tx_pkts": 0,
                "rx_pkts": 0,
                "rx_bytes": 0,
                "tx_bytes": 0,
                "rx_peak_bps": 0,
                "tx_peak_bps": 0,
                "full_duplex": false,
                "speed": 0,
                "up": false,
                "rx_errors": 0
            },
            "eth1": {
                "tx_pkts": 0,
                "rx_pkts": 0,
                "rx_bytes": 0,
                "tx_bytes": 0,
                "rx_peak_bps": 0,
                "tx_peak_bps": 0,
                "full_duplex": false,
                "speed": 0,
                "up": false,
                "rx_errors": 0
            },
            "eth0": {
                "tx_pkts": 2731519,
                "rx_pkts": 8325448,
                "rx_bytes": 3224888514,
                "tx_bytes": 2116882740,
                "rx_peak_bps": 482729,
                "tx_peak_bps": 293857,
                "full_duplex": true,
                "speed": 1000,
                "up": true,
                "rx_errors": 0
            }
        },
        "lldp_stat": {
            "system_name": "TC2-OWL-Stack-01",
            "system_desc": "HP J9729A 2920-48G-POE+ Switch",
            "mgmt_addr": "10.1.5.2",
            "lldp_med_supported": false,
            "port_desc": "",
            "port_id": "",
            "power_request_count": 0,
            "power_allocated": 0,
            "power_draw": 0,
            "power_requested": 0
        },
        "l2tp_stat": {
        },
        "rx_bytes": 28558191,
        "rx_pkts": 214938,
        "tx_pkts": 49622392,
        "tx_bytes": 3760857173,
        "tx_bps": 0,
        "rx_bps": 0,
        "cpu_stat": {
            "system": 5,
            "idle": 81,
            "interrupt": 0,
            "user": 14,
            "load_avg": [
                0.14,
                0.23,
                0.24
            ]
        },
        "memory_stat": {
            "usage": 33
        },
    }
}
</code></pre>
<h2 id="search-ap">Search AP</h2>
<pre><code> GET /api/v1/sites/:site_id/devices/search?ip=10.2.16.205
</code></pre>
<h3 id="supported-filters">Supported Filters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>hostname</code></td>
<td><code>string</code></td>
<td>partial / full hostname</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>device model</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>AP mac</td>
</tr>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>version</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>ip address</td>
</tr>
<tr>
<td><code>mxtunnel_status</code></td>
<td><code>string</code></td>
<td>MxTunnel status, up / down</td>
</tr>
<tr>
<td><code>mxedge_id</code></td>
<td><code>string</code></td>
<td>Mist Edge id, if AP is connecting to a Mist Edge</td>
</tr>
<tr>
<td><code>mxedge_ids</code></td>
<td><code>list</code></td>
<td>Mist Edge ids, if AP is connecting to a Mist Edge</td>
</tr>
<tr>
<td><code>lldp_system_name</code></td>
<td><code>string</code></td>
<td>LLDP system name</td>
</tr>
<tr>
<td><code>lldp_system_desc</code></td>
<td><code>string</code></td>
<td>LLDP system description</td>
</tr>
<tr>
<td><code>lldp_port_id</code></td>
<td><code>string</code></td>
<td>LLDP port id</td>
</tr>
<tr>
<td><code>lldp_mgmt_addr</code></td>
<td><code>string</code></td>
<td>LLDP management ip address</td>
</tr>
<tr>
<td><code>sort</code></td>
<td><code>string</code></td>
<td>sort options, timestamp/mac/model/sku, -prefix represents DESC order, default is -timestamp</td>
</tr>
<tr>
<td><code>stats</code></td>
<td><code>boolean</code></td>
<td>whether to return device stats, default is false</td>
</tr>
</tbody>
</table>
<h3 id="response_72">Response</h3>
<pre><code>{
    "results": [
        {
            "mac": "5c5b353e5299",
            "model": "AP41",
            "sku": "AP41-US",
            "ip": "10.2.16.205",
            "version": "0.7.20216",
            "uptime": 85280,
            "org_id": "6748cfa6-4e12-11e6-9188-0242ac110007",
            "site_id": "a8178443-ecb5-461c-b854-f16627619ab3",
            "mxedge_id": "00000000-0000-0000-1000-43a81f238391",
            "mxedge_ids": [
                "00000000-0000-0000-1000-43a81f238391"
            ],
            "mxtunnel_status": "down",
            "hostname": [
                            "AP41-STB-3E5299-WH-2001",
                            "AP41-STB-3E5299-WH-50",
                            "AP41-STB-3E5299",
                            "5c5b353e5299"
                        ],
            "lldp_port_desc": "GigabitEthernet1/0/1",
            "lldp_mgmt_addr": "10.2.10.139",
            "lldp_system_desc": "Cisco IOS Software, C2960S Software (C2960S-UNIVERSALK9-M), Version 15.2(1)E1, RELEASE SOFTWARE (fc2)\nTechnical Support: http://www.cisco.com/techsupport\nCopyright (c) 1986-2013 by Cisco Systems, Inc.\nCompiled Fri 22-Nov-13 07:10 by prod_rel_team",
            "lldp_system_name": "ME-DC-1-ACC-SW",
            "lldp_port_id": "Gi1/0/1",
            "timestamp": 1596588619.007
        }
    ]
}
</code></pre>
<h2 id="count-ap">Count AP</h2>
<p>Counts the number of entries in ap events history for distinct field with given filters</p>
<pre><code>GET /api/v1/sites/:site_id/devices/count?distinct=type&amp;start=1531776183&amp;end=1531862583&amp;limit=10
</code></pre>
<h3 id="response_73">Response</h3>
<pre><code>{
    "end": 1531862583.0,
    "distinct": "version",
    "results": [
        {
            "count": 10,
            "version": "apfw-0.5.16833-ellaria-0455"
        },
        {
            "count": 4,
            "type": "apfw-0.3.14833-cersei-0455"
        }
    ],
    "start": 1531776183.0,
    "limit": 10,
    "total": 2
}
</code></pre>
<h2 id="search-device-config-history">Search Device Config History</h2>
<pre><code>GET /api/v1/sites/:site_id/devices/config_history/search?mac=5c5b350e0001&amp;start=1531776183&amp;end=1531862583&amp;limit=10
</code></pre>
<h3 id="response_74">Response</h3>
<pre><code>{
    "total": 1,
    "start": 1531776183.0,
    "limit": 10,
    "end": 1531862583.0,
    "results": [
        {
            "channel_5": 100,
            "ssids_24": [
                "test24",
            ],
            "radios": [
                {
                    "band": "24",
                    "channel": 11
                },
                {
                    "band": "5",
                    "channel": 100
                }
            ],
            "timestamp": 1531855856.643369,
            "version": "apfw-0.2.14754-cersei-75c8",
            "channel_24": 11,
            "ssids": [
                "test24",
                "test5",
                "test6"
            ],
            "wlans": [
                {
                    "id": "be22bba7-8e22-e1cf-5185-b880816fe2cf",
                    "bands": [
                        "24",
                    ],
                    "vlan_ids": [
                        "1"
                    ],
                    "ssid": "test24",
                    "auth": "psk"
                },
                {
                    "id": "f8c18724-4118-3487-811a-f98964988604",
                    "bands": [
                        "5"
                    ],
                    "vlan_ids": [
                        "1"
                    ],
                    "ssid": "test5",
                    "auth": "psk"
                },
                { 
                    "id": "f8c18724-4118-3487-811a-f98964988605",
                    "bands": [
                        "6"
                    ],
                    "vlan_ids": [
                        "1"
                    ],
                    "ssid": "test6",
                    "auth": "psk"
                }
            ],
            "radio_macs": [
                "5c5b352e000a",
                "5c5b352e000b",
                "5c5b352e000c"
            ],
            "ssids_5": [
                "test5"
            ],
            "ssids_6": [
                "test6"
            ],
            "channel_6": 85,
            "secpolicy_violated": false
        }
    ]
}
</code></pre>
<h2 id="count-device-config-history">Count Device Config History</h2>
<p>Counts the number of entries in device config history for distinct field with given filters</p>
<pre><code>GET /api/v1/sites/:site_id/devices/config_history/count?distinct=mac&amp;start=1531776183&amp;end=1531862583&amp;limit=10
</code></pre>
<h3 id="response_75">Response</h3>
<pre><code>{
    "end": 1531862583,
    "distinct": "ap",
    "results": [
        {
            "count": 1,
            "ap": "5c5b350e0001"
        },
        {
            "count": 5,
            "ap": "5c5b350e0002"
        },
        {
            "count": 5,
            "ap": "5c5b350e0003"
        }
    ],
    "start": 1531776183,
    "limit": 10,
    "total": 3
}
</code></pre>
<h2 id="search-device-last-configs">Search Device Last Configs</h2>
<pre><code>GET /api/v1/sites/:site_id/devices/last_config/search?mac=5c5b350e0001&amp;start=1531776183&amp;end=1531862583&amp;limit=10
</code></pre>
<h3 id="request-parameters">Request Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>device_type</code></td>
<td><code>string</code></td>
<td>ap (default) / switch / gateway</td>
</tr>
</tbody>
</table>
<h3 id="response_76">Response</h3>
<p>see (Search Device Config History)[Site#search-device-config-history]</p>
<h2 id="count-device-last-configs">Count Device Last Configs</h2>
<p>Counts the number of entries in device config history for distinct field with given filters</p>
<pre><code>GET /api/v1/sites/:site_id/devices/last_config/count?distinct=mac&amp;start=1531776183&amp;end=1531862583&amp;limit=10
</code></pre>
<h3 id="response_77">Response</h3>
<p>see (Count Device Config History)[Site#count-device-config-history]</p>
<h2 id="search-ap-events">Search AP Events</h2>
<p>Search AP Events</p>
<pre><code> GET /api/v1/sites/:site_id/devices/events/search?ap=5c5b350e0001&amp;start=1531776183&amp;end=1531862583&amp;limit=2
</code></pre>
<h3 id="response_78">Response</h3>
<pre><code>{
    "end": 1531862583.0,
    "results": [
        {
            "type": "AP_CONNECT_STATUS",
            "text": "Success",
            "last_reboot_time": 1531854327,
            "type_code": 2002,
            "timestamp": 1531855849.226722
        },
        {
            "timestamp": 1531854326,
            "type": "AP_CONFIGURED"
        }
    ],
    "next": "/api/v1/sites/8aaba0aa-09cc-44bd-9709-33b98040550c/devices/events/search?ap=5c5b350e0001&amp;end=1531855849.000&amp;limit=2&amp;start=1531776183.0",
    "start": 1531776183.0,
    "limit": 2,
    "total": 14
}
</code></pre>
<h2 id="search-device-events-including-prisma-events">Search device events including prisma events</h2>
<p>Search prisma prisma events</p>
<pre><code> GET /api/v1/sites/:site_id/devices/events/search?includes=ext_tunnel&amp;mac=00c52c3cfaa4&amp;start=1531776183&amp;end=1531862583&amp;limit=2
</code></pre>
<h3 id="parameters_60">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>includes</code></td>
<td><code>string</code></td>
<td>Keyword to include events from additional indices, e.g. <strong>ext_tunnel</strong> for  prisma events</td>
</tr>
</tbody>
</table>
<h3 id="response_79">Response</h3>
<pre><code>{
    "results": [
        {
           "tunnel_name": "Prisma-Tunnel-II",
           "type": "PRISMA_RN_SECONDARY_WAN_TUNNEL_UP",
           "text": "Remote Network Site RN_SITE_1 SECONDARY WAN Tunnel Stage-Tunnel2 is down",
           "timestamp": 1531856649,
           "ext_tunnel_site": "RN_SITE_1",
           "ext_tunnel_name": "Stage-Tunnel2",
           "ext_tunnel_event_id": b1b1ccdd-4444-4a2d-a81d-8888bc8f6fa1",
           "ext_tunnel_debug_url": "https://stratacloudmanager.paloaltonetworks.com/incidents-alerts/logviewer?logType=log.system&amp;query=Event%25C2%25A0Component%20=%20%27RN_SITE_1%27%20OR%20Event%25C2%25A0Component%20=%20%27Stage-Tunnel2%27%20&amp;timePreset=custom&amp;startTime=1745977906000&amp;endTime=1745980306000&amp;queryMode=lq",
           "site_id: "f1e17c67-8e42-4a2d-a81d-98ddbc8f6fa1",
           "org_id: "f3045b5a-f2ea-445e-b923-5bbb5a670c35",
           "device_type: "gateway",
           "mac: "00c52c3cfaa4",
           "port_id: "reth2.0",
           "ext_tunnel_provider": "prisma"
        },
        {
           "tunnel_name": "Prisma-Tunnel-II",
           "type": "PRISMA_RN_SECONDARY_WAN_TUNNEL_DOWN",
           "text": "Remote Network Site RN_SITE_1 SECONDARY WAN Tunnel Stage-Tunnel2 is down",
           "timestamp": 1531855849,
           "ext_tunnel_site": "RN_SITE_1",
           "ext_tunnel_name": "Stage-Tunnel2",
           "ext_tunnel_event_id": b1b1ccdd-4444-4a2d-a81d-8888bc8f6fa1",
           "ext_tunnel_debug_url": "https://stratacloudmanager.paloaltonetworks.com/incidents-alerts/logviewer?logType=log.system&amp;query=Event%25C2%25A0Component%20=%20%27RN_SITE_1%27%20OR%20Event%25C2%25A0Component%20=%20%27Stage-Tunnel2%27%20&amp;timePreset=custom&amp;startTime=1745977906000&amp;endTime=1745980306000&amp;queryMode=lq",
           "site_id: "f1e17c67-8e42-4a2d-a81d-98ddbc8f6fa1",
           "org_id: "f3045b5a-f2ea-445e-b923-5bbb5a670c35",
           "device_type: "gateway",
           "mac: "00c52c3cfaa4",
           "port_id: "reth2.0",
           "ext_tunnel_provider": "prisma"
        }
    ],
    "start": 1531776183.0,
    "end": 1531862583.0,
    "limit": 2,
    "total": 14
}
</code></pre>
<h2 id="fetch-most-recent-device-events">Fetch most recent device events.</h2>
<pre><code>GET /api/v1/sites/:site_id/devices/events/search?last_by=port_id&amp;type=SW_PORT_UP,SW_PORT_DOWN
</code></pre>
<p>Return last/recent event for passed in field</p>
<h3 id="response_80">Response</h3>
<pre><code>{
    "results": [
        {
            "timestamp": 1685566764.144,
            "org_id": "98272e44-d31d-4e9a-b52d-18ae2183446e",
            "site_id": "b60a57e3-dd74-4da3-af12-02987a141665",
            "port_id": "xe-2/2/2",
            "type": "SW_PORT_UP",
            "model": "EX4300-48MP",
            "device_type": "switch",
            "text": "SNMP_TRAP_LINK_UP: ifIndex 894, ifAdminStatus up(1), ifOperStatus up(1), ifName xe-2/2/2",
            "version": "21.4R3-S3.4",
            "mac": "c042d0f52a00"
        }
    ],
    "total": 234266
}
</code></pre>
<h3 id="response-definition">Response Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>results</code></td>
<td><code>list</code></td>
<td>Array of events where each entry represents the most recent event for each unique value of the last_by field (e.g., when last_by=port_id, you get the latest event for each port)</td>
</tr>
<tr>
<td><code>total</code></td>
<td><code>int</code></td>
<td>The total number of events that match the search criteria (type=SW_PORT_UP,SW_PORT_DOWN)</td>
</tr>
</tbody>
</table>
<h2 id="count-ap-events">Count AP Events</h2>
<p>Counts the number of entries in ap events history for distinct field with given filters</p>
<pre><code>GET /api/v1/sites/:site_id/devices/events/count?distinct=type&amp;start=1531776183&amp;end=1531862583&amp;limit=10
</code></pre>
<h3 id="response_81">Response</h3>
<pre><code>{
    "end": 1531862583.0,
    "distinct": "type",
    "results": [
        {
            "count": 10,
            "type": "AP_CONNECT_STATUS"
        },
        {
            "count": 4,
            "type": "AP_CONFIGURED"
        }
    ],
    "start": 1531776183.0,
    "limit": 10,
    "total": 2
}
</code></pre>
<h2 id="count-device-events-including-prisma-events">Count Device Events including Prisma Events</h2>
<p>Counts the number of entries in events history for distinct field with given filters</p>
<pre><code>GET /api/v1/sites/:site_id/devices/events/count?includes=ext_tunnel&amp;distinct=type&amp;start=1531776183&amp;end=1531862583&amp;limit=10
</code></pre>
<h3 id="parameters_61">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>includes</code></td>
<td><code>string</code></td>
<td>Keyword to include events from additional indices, e.g. <strong>ext_tunnel</strong> for  prisma events</td>
</tr>
</tbody>
</table>
<h3 id="response_82">Response</h3>
<pre><code>{
    "end": 1531862583.0,
    "distinct": "type",
    "results": [
        {
            "count": 1,
            "type": "PRISMA_RN_PRIMARY_WAN_TUNNEL_UP"
        },
        {
            "count": 1,
            "type": "PRISMA_RN_PRIMARY_WAN_TUNNEL_DOWN"
        },
        {
            "count": 2,
            "type": "PRISMA_RN_SECONDARY_WAN_BGP_DOWN"
        },
        {
            "count": 1,
            "type": "PRISMA_RN_SECONDARY_WAN_BGP_UP"
        }
    ],
    "start": 1531776183.0,
    "limit": 10,
    "total": 4
}
</code></pre>
<h1 id="wxlan">WXLAN</h1>
<p>WxLAN are ordered rules that defines User Context and Resource relationship</p>
<h2 id="wxlan-tags">WXLAN Tags</h2>
<h3 id="base-uri_9">Base URI</h3>
<pre><code>/api/v1/sites/:site_id/wxtags
</code></pre>
<h3 id="example_10">Example</h3>
<pre><code>// matches wlan_id(s)
{
    "type": "match",
    "name": "guest-wlan",
    "match": "wlan_id",
    "values": [ "be22bba78e22e1cf5185b880816fe2cf" ]
}
// matches client_mac(s)
{
    "type": "match",
    "name": "file-servers",
    "match": "client_mac",
    "values": [ "b0c4e7001543", "a0c4e7001543", "00c4e7001543" ]
}
// matches radius_username
{
    "type": "match",
    "name": "VIP",
    "match": "radius_username",
    "values": [ "john@abc.com", "eric@abc.com" ]
}
// matches radius_group
{
    "type": "match",
    "name": "VIP",
    "match": "radius_group",
    "values": [ "vip" ]
}
// matches psk_name
{
    "type": "match",
    "name": "VIP",
    "match": "psk_name",
    "values": [ "test_key1", "test_key2" ]
}
// matches psk_role
{
    "type": "match",
    "name": "VIP",
    "match": "psk_role",
    "values": [ "test_role" ]
}

// resources

// automatically generated tag for discovered network resources
{
    "type": "resource",
    "name": "HP Officejet Pro 8620",
    "resource_mac": "6cc21715e025",
    "mac": "6cc21715e025",
    "services": [
        "printer"
    ],
    "last_ips": [
        "10.2.9.232"
    ]
}
// automatically generated tag for discovered ip subnet
{
    "type": "subnet",
    "name": "10.1.2.0/24",
    "subnet": "10.1.2.0/24"
}

// matches ip_range_subnets
{
    "type": "match",
    "name": "file-servers",
    "match": "ip_range_subnet",
    "values": [ "10.1.2.1", "10.2.3.4/24", "10.1.2.5-10.2.3.4" ]
}

// matches app
{
    "type": "match",
    "name": "match app",
    "match": "app",
    "values": [ "gmail", "dropbox" ]
}

// matches hostnames excluding http(s)://
{
    "type": "match",
    "name": "mist",
    "match": "hostname",
    "values": [ "mist.com" ]
}
// matches ports
{
    "type": "match",
    "name": "web-ports",
    "match": "port",
    "values": [ "80", "8000", "8080" ]
}
// matching traffic spec
{
    "type": "spec",
    "name": "protocol-subnet-port",
    "specs": [
        {
            "protocol": "tcp",  // tcp / udp / icmp / gre / any / ":protocol_number", `protocol_number` is between 1-254, default is `any`
            "subnets": ["10.1.2.0/24"],  // matched dst subnet, default is "0.0.0.0/0",
            "port_range": "80"  // matched dst port, "0" means any, default is "0"
        }
    ]
}
{
    "type": "spec",
    "name": "protocol-hostname-port",
    "specs": [
        {
            "protocol": "tcp",  // tcp / udp / icmp / gre / any / ":protocol_number", `protocol_number` is between 1-254, default is `any`
            "hostnames": ["www.abc.com"],  // matched hostnames
            "port_range": "2000-2400"  // matched dst port, "0" means any, default is "0"
        }
    ]
}
// vlan assignment
{
    "type": "vlan",
    "name": "vlan-assignment",
    "vlan_id": 1055
}
</code></pre>
<h3 id="parameters_62">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>the name</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>match / client / resource / subnet / spec / vlan</td>
</tr>
<tr>
<td><code>match</code></td>
<td><code>string</code></td>
<td>type of match, wlan_id / ap_id / client_mac / ip_range_subnet / radius_group / radius_username / radius_attr / hostname / app / port</td>
</tr>
<tr>
<td><code>op</code></td>
<td><code>string</code></td>
<td><code>in</code> / <code>not_in</code>, default is <code>in</code></td>
</tr>
<tr>
<td><code>values</code></td>
<td><code>list</code></td>
<td>list of values to match</td>
</tr>
<tr>
<td><code>vlan_id</code></td>
<td><code>int</code></td>
<td>vlan id for assignment</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p><code>type</code>:</p>
<ul>
<li><code>client</code>: created manually (e.g. on wireless client table, when they spot a device of interest, they can create an
  wxlan tag for it</li>
<li><code>resource</code>: created automatically when we discover a network resource</li>
<li><code>subnet</code>: create automatically when a subnet is discovered</li>
</ul>
</li>
<li>
<p><code>match</code>:</p>
<ul>
<li><code>wlan_id</code>, <code>ap_id</code>: values are a list of Wlan / Device ids</li>
<li><code>client_mac</code>: values are a list of MAC addresses</li>
</ul>
</li>
<li>
<p>radius_group: this is a smart tag that matches RADIUS-Filter-ID, Airespace-ACL-Name (VendorID=14179, VendorType=6) /
  Aruba-User-Role (VendorID=14823, VendorType=1)</p>
</li>
<li>radius_username: this matches the ATTR-User-Name(1)</li>
<li>radius_class: thie matches the ATTR-Class(25)</li>
<li>radius_attr: the values are [ “6=1”, “26=10.2.3.4” ], this support other RADIUS attributes where we know the type</li>
<li>radius_vendor: the values are [ “14179.10=1”, “14178.16=1.2.3.4” ], this matches vendor attributes and will be
  dynamically evaluated</li>
</ul>
<h2 id="get-application-list">Get Application List</h2>
<pre><code>GET /api/v1/sites/:site_id/wxtags/apps
</code></pre>
<h3 id="response_83">Response</h3>
<pre><code>[
    {
        "key": "gmail",
        "name": "Gmail - web/app",
        "group": "Emails"
    },
    ...
]
</code></pre>
<h2 id="wxlan-rules">WXLAN Rules</h2>
<h3 id="base-uri_10">Base URI</h3>
<pre><code>/api/v1/sites/:site_id/wxrules
</code></pre>
<h3 id="example_11">Example</h3>
<pre><code>// action = allow | block
{
    "name": "Guest",
    "order": 1
    "src_wxtags": [ "8bfc2490-d726-3587-038d-cb2e71bd2330", "3aa8e73f-9f46-d827-8d6a-567bb7e67fc9" ],
    "dst_allow_wxtags": [ "fff34466-eec0-3756-6765-381c728a6037", "eee2c7b0-d1d0-5a30-f349-e35fa43dc3b3" ],
    "dst_deny_wxtags": [ "aaa34466-eec0-3756-6765-381c728a6037", "bbb2c7b0-d1d0-5a30-f349-e35fa43dc3b3" ],
    "blocked_apps": ["mist", "all-videos"],
    "apply_tags": [ "c049dfcd-0c73-5014-1c64-062e9903f1e5" ],
    "action": "allow"
}
</code></pre>
<h3 id="parameters_63">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>The name of the rule</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>enabled or not, default is true</td>
</tr>
<tr>
<td><code>order</code></td>
<td><code>int</code></td>
<td>the order how rules would be looked up, &gt; 0 and bigger order got matched first, -1 means LAST, uniqueness not checked</td>
</tr>
<tr>
<td><code>src_wxtags</code></td>
<td><code>uuid</code></td>
<td>tag list to determine if this rule would match</td>
</tr>
<tr>
<td><code>dst_allow_wxtags</code></td>
<td><code>uuid</code></td>
<td>tag list to indicate these tags are allowed access</td>
</tr>
<tr>
<td><code>dst_deny_wxtags</code></td>
<td><code>uuid</code></td>
<td>tag list to indicate these tags are blocked access</td>
</tr>
<tr>
<td><code>blocked_apps</code></td>
<td><code>string</code></td>
<td>blocked apps (always blocking, ignoring <code>action</code>), the key of <a href="https://api.mist.com/api/v1/docs/Site#get-application-list">Get Application List</a></td>
</tr>
<tr>
<td><code>action</code></td>
<td><code>string</code></td>
<td>type of action, allow / block</td>
</tr>
</tbody>
</table>
<h2 id="get-derived-wxlan-rules-for-a-site">Get Derived WXLAN Rules for a Site</h2>
<p>There can be Wxlan Rule defined at Org level. When it happens, we’ll match Org rules first.</p>
<pre><code>GET /api/v1/sites/:site_id/wxrules/derived
</code></pre>
<h3 id="response_84">Response</h3>
<pre><code>[
    {
        "name": "VIP",
        "for_site": false,
        "template_id": "867860f2-dd82-3677-54a5-4d6b139c96ca",
        "template_name" "west coast",
        "order": 2
        ...
    },
    {
        "name": "Blacklist",
        "for_site": false,
        "template_id": "867860f2-dd82-3677-54a5-4d6b139c96ca",
        "template_name" "west coast",
        "order": 1
        ...
    },
    {
        "name": "Guest",
        "order": 1,
        "action": "allow"
        ...
    },
    {
        "name": "Default",
        "order": -1,
        "action": "allow"
        ...
    }
]

</code></pre>
<h2 id="get-derived-networks-for-site">Get derived Networks for site</h2>
<p>Retrieves the list of networks available for the Site</p>
<pre><code>GET /api/v1/sites/:site_id/networks/derived
</code></pre>
<h4 id="parameters_64">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>resolve</code></td>
<td>boolean</td>
<td>whether resolve the site variables</td>
</tr>
</tbody>
</table>
<h3 id="response_85">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h4 id="body">Body</h4>
<p>See <a href="https://api.mist.com/api/v1/docs/Org#get-update-delete-network">Org:Networks:Get:Example</a></p>
<h1 id="get-derived-services-for-site">Get derived Services for site</h1>
<p>Retrieves the list of Services available for the Site</p>
<pre><code>GET /api/v1/sites/:site_id/services/derived
</code></pre>
<h4 id="parameters_65">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>resolve</code></td>
<td>boolean</td>
<td>whether resolve the site variables</td>
</tr>
</tbody>
</table>
<h3 id="response_86">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h4 id="body_1">Body</h4>
<p>See <a href="https://api.mist.com/api/v1/docs/Org#services">Org:Services:Example</a></p>
<h1 id="get-derived-vpn-for-site">Get derived VPN for Site</h1>
<p>VPN object represents an overlay network where gateways can participate in and optionally expose routes to.</p>
<pre><code>GET /api/v1/sites/:site_id/vpns/derived
</code></pre>
<h4 id="parameters_66">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>resolve</code></td>
<td>boolean</td>
<td>whether resolve the site variables</td>
</tr>
</tbody>
</table>
<h3 id="response_87">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h4 id="body_2">Body</h4>
<p>See <a href="https://api.mist.com/api/v1/docs/Org#vpn">Org:VPN:Payload</a></p>
<h1 id="get-derived-service-policies-for-site">Get derived Service Policies for Site</h1>
<pre><code>GET /api/v1/sites/:site_id/servicepolicies/derived
</code></pre>
<h4 id="parameters_67">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>resolve</code></td>
<td>boolean</td>
<td>whether resolve the site variables</td>
</tr>
</tbody>
</table>
<h3 id="response_88">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h4 id="body_3">Body</h4>
<p>See <a href="https://api.mist.com/api/v1/docs/Org#service-policies">Org:Service Policies:Payload</a></p>
<h1 id="get-derived-device-profiles-for-site">Get derived Device Profiles for Site</h1>
<pre><code>GET /api/v1/sites/:site_id/deviceprofiles/derived
</code></pre>
<h4 id="parameters_68">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>resolve</code></td>
<td>boolean</td>
<td>whether resolve the site variables</td>
</tr>
</tbody>
</table>
<h3 id="response_89">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h4 id="body_4">Body</h4>
<p>See <a href="https://api.mist.com/api/v1/docs/Org#device-profile">Org:Device Profile:Schema</a></p>
<h1 id="get-derived-rf-templates-for-site">Get derived RF Templates for Site</h1>
<pre><code>GET /api/v1/sites/:site_id/rftemplates/derived
</code></pre>
<h4 id="parameters_69">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>resolve</code></td>
<td>boolean</td>
<td>whether resolve the site variables</td>
</tr>
</tbody>
</table>
<h3 id="response_90">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h4 id="body_5">Body</h4>
<p>See <a href="https://api.mist.com/api/v1/docs/Org#rf-template">Org:RF Template:Schema</a></p>
<h1 id="get-derived-ap-port-templates-for-site">Get derived AP Port Templates for Site</h1>
<pre><code>GET /api/v1/sites/:site_id/apporttemplates/derived
</code></pre>
<h4 id="parameters_70">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>resolve</code></td>
<td>boolean</td>
<td>whether resolve the site variables</td>
</tr>
</tbody>
</table>
<h3 id="response_91">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h1 id="get-derived-ap-templates-for-site">Get derived AP Templates for Site</h1>
<pre><code>GET /api/v1/sites/:site_id/aptemplates/derived
</code></pre>
<h4 id="parameters_71">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>resolve</code></td>
<td>boolean</td>
<td>whether resolve the site variables</td>
</tr>
</tbody>
</table>
<h3 id="response_92">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h4 id="body_6">Body</h4>
<p>See <a href="https://api.mist.com/api/v1/docs/Org#ap-template">Org:AP Template:Schema</a></p>
<h1 id="get-derived-network-templates-for-site">Get derived Network Templates for Site</h1>
<pre><code>GET /api/v1/sites/:site_id/networktemplates/derived
</code></pre>
<h4 id="parameters_72">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>resolve</code></td>
<td>boolean</td>
<td>whether resolve the site variables</td>
</tr>
</tbody>
</table>
<h3 id="response_93">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h4 id="body_7">Body</h4>
<p>See <a href="https://api.mist.com/api/v1/docs/Org#network-template">Org:Network Template:Schema</a></p>
<h1 id="get-derived-site-templates-for-site">Get derived Site Templates for Site</h1>
<pre><code>GET /api/v1/sites/:site_id/sitetemplates/derived
</code></pre>
<h4 id="parameters_73">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>resolve</code></td>
<td>boolean</td>
<td>whether resolve the site variables</td>
</tr>
</tbody>
</table>
<h3 id="response_94">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h4 id="body_8">Body</h4>
<p>See <a href="https://api.mist.com/api/v1/docs/Org#site-template">Org:Site Template:Schema</a></p>
<h1 id="get-derived-gateway-templates-for-site">Get derived Gateway Templates for Site</h1>
<pre><code>GET /api/v1/sites/:site_id/gatewaytemplates/derived
</code></pre>
<h4 id="parameters_74">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>resolve</code></td>
<td>boolean</td>
<td>whether resolve the site variables</td>
</tr>
</tbody>
</table>
<h3 id="response_95">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h4 id="body_9">Body</h4>
<p>See <a href="https://api.mist.com/api/v1/docs/Org#gateway-templates">Org:Gateway Templates:Schema</a></p>
<h1 id="get-derived-sky-atp-secintel-profiles-for-site">Get derived Sky-ATP secintel profiles for Site</h1>
<pre><code>GET /api/v1/sites/:site_id/secintelprofiles/derived
</code></pre>
<h4 id="parameters_75">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>resolve</code></td>
<td>boolean</td>
<td>whether resolve the site variables</td>
</tr>
</tbody>
</table>
<h3 id="response_96">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h4 id="body_10">Body</h4>
<p>See <a href="https://api.mist.com/api/v1/docs/Org#secintelprofiles">Org:Sky ATP Secintel Profile:Schema</a></p>
<h1 id="to-get-jse-info">To get JSE info</h1>
<p>Retrieves the list of JSE orgs associated with the account</p>
<pre><code>GET /api/v1/sites/:site_id/setting/jse/info
</code></pre>
<h3 id="response_97">Response</h3>
<pre><code>{
    "cloud_name": "devcentral.juniperclouds.net"
    "org_names": ["Mist-Sys", "Mist-Eng"]
}
</code></pre>
<h2 id="get-wxlan-rule-usage">Get Wxlan Rule usage</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/wxrules
</code></pre>
<h3 id="response_98">Response</h3>
<pre><code>[
    {
        "name": "Guest",
        "order": 1
        "src_wxtags": [ "8bfc2490-d726-3587-038d-cb2e71bd2330", "3aa8e73f-9f46-d827-8d6a-567bb7e67fc9" ],
        "dst_wxtags": [ "d4134466-eec0-3756-6765-381c728a6037", "1a42c7b0-d1d0-5a30-f349-e35fa43dc3b3" ],
        "dst_allow_wxtags": [ "fff34466-eec0-3756-6765-381c728a6037", "eee2c7b0-d1d0-5a30-f349-e35fa43dc3b3" ],
        "dst_deny_wxtags": [ "aaa34466-eec0-3756-6765-381c728a6037", "bbb2c7b0-d1d0-5a30-f349-e35fa43dc3b3" ],
        "client_mac": [ "3bbbf819bb6f", "bd96cbc4910f" ],
        "usage": {
            "d4134466-eec0-3756-6765-381c728a6037": {
                "num_flows": 60
            },
            "1a42c7b0-d1d0-5a30-f349-e35fa43dc3b3": {
                "num_flows": 60
            },
            "00000000-0000-0000-0000-000000000000": {
                "num_flows": 30
            }
        }
        "action": "allow"
    }
]
</code></pre>
<h2 id="get-wxlan-rule-currently-used-by-a-client">Get Wxlan Rule Currently used by a Client</h2>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#get-wireless-client-stat-with-more-details">Client Details</a></p>
<pre><code>GET /api/v1/sites/:site_id/stats/clients/:client_mac
</code></pre>
<h2 id="wxlan-tunnels">WXLAN Tunnels</h2>
<p>Tunnels can be used by a WXLAN rule or by a WLAN.</p>
<h3 id="base-uri_11">Base URI</h3>
<pre><code>/api/v1/sites/:site_id/wxtunnels
</code></pre>
<h3 id="example_12">Example</h3>
<pre><code>{
    "name": "HQ",
    "peers": ["63.3.2.4"],
    "use_udp": true,
    "udp_port": 1701,
    "mtu": 0,
    "for_mgmt": false, // whether this tunnel is for management (configured under Org)
    "hello_interval": 60,
    "hello_retries": 3,

    // non-static
    "is_static": false,
    "secret": "secret used for tunnel",

    "router_id": "0",
    "hostname": ""
    "sessions": [
        // ethertype == ethernet
        {
            "remote_id": "vpn1",
            "ethertype": "ethernet",
            "comment": "something about this session"
        },
        // ethertype == vlan
        {
            "remote_id": "vpn1",
            "ethertype": "vlan",
            "comment": "a vlan'ed session"
        },
        // Pseudo 802.1ad QinQ (ethertype == vlan)
        {
            "remote_id": "vpn1",
            "ethertype": "vlan",
            "pseudo_8021ad_enabled": true,
            "comment": "a vlan'ed session"
        }
        ...
    ],

    // static
    "is_static": true,
    "sessions": [
        // specify the remote_session_id and local_session_id
        {
            "remote_session_id": 3000,
            "local_session_id": 4000,
            "ethertype": "ethernet",
            "comment": "something about this session",

            // for some interoperability - rare
            // if enabled, 0x0000&lt;apmac&gt; will be used 
            "enable_cookie": false
        }

        // or alternatively, `use_ap_as_session_ids` can be used where it will
        // generate the remote_session_id/local_session based on the AP MAC (the last 4 bytes)
        // e.g. 5c-5b-00-00-01-02 -&gt; 257
        {
            "use_ap_as_session_ids": true,
            "ap_session_id": "apmac",
            "ethertype": "ethernet",
            "comment": "something about this session"
        }
        // or
        {
            "use_ap_as_session_ids": true,
            "ap_session_id": "apmac+0x01000000",
            "ethertype": "ethernet",
            "comment": "something about this session"
        }

        // Pseudo 802.1ad QinQ (ethertype == vlan)
        {
            "remote_session_id": 3000,
            "local_session_id": 4000,
            "ethertype": "vlan",
            "pseudo_8021ad_enabled": true,
            "comment": "something about this session"
        }
    ],

    // dynamic multi-point vpn
    "dmvpn": {
        "enabled": true,
        // optional
        "host_routes": ["10.1.1.1", "10.2.2.2"]
        "holding_time": 300
    },

    "ipsec": {
        "enabled": true,
        "psk": "cisco123"
    }
}
</code></pre>
<h3 id="definition_4">Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>The name of the tunnel</td>
</tr>
<tr>
<td><code>peers</code></td>
<td><code>list</code></td>
<td>list of remote peers’ IP or hostname</td>
</tr>
<tr>
<td><code>is_static</code></td>
<td><code>boolean</code></td>
<td>whether it’s static/unmanaged (i.e. no control session), default is False. As the session configurations are not compatible, cannot be toggled.</td>
</tr>
<tr>
<td><code>secret</code></td>
<td><code>string</code></td>
<td>secret, ‘’ if no auth is used</td>
</tr>
<tr>
<td><code>use_udp</code></td>
<td><code>boolean</code></td>
<td>whether to use UDP instead of IP (proto=115, which is default of L2TPv3). Default is false</td>
</tr>
<tr>
<td><code>udp_port</code></td>
<td><code>int</code></td>
<td>udp port if use_udp=true</td>
</tr>
<tr>
<td><code>hello_interval</code></td>
<td><code>float</code></td>
<td>in seconds, used as heartbeat to detect if a tunnel is alive. AP will try another peer after missing N hellos specified by <code>hello_retries</code>. between 1 and 300, default is 60 seconds</td>
</tr>
<tr>
<td><code>hello_retries</code></td>
<td><code>int</code></td>
<td>between 2 and 30, default is 7</td>
</tr>
<tr>
<td><code>mtu</code></td>
<td><code>int</code></td>
<td>0 to enable PMTU, 552-1500 to start PMTU with a lower MTU, default is 0</td>
</tr>
<tr>
<td><code>router_id</code></td>
<td><code>string</code></td>
<td>optional, overwrite the router-id in SCCRQ control message, default is “0” or null, can also be an IPv4 address</td>
</tr>
<tr>
<td><code>hostname</code></td>
<td><code>string</code></td>
<td>optional, overwrite the hostname in SCCRQ control message, default is “” or null, %H and %M can be used, which will be replace with corresponding values. %H: name of the ap if provided (and will be stripped so it can be used for hostname) and fallbacks to MAC, %M: MAC (e.g. 5c5b350e0060)</td>
</tr>
<tr>
<td><code>for_mgmt</code></td>
<td><code>boolean</code></td>
<td>default is false, determined during creation time and cannot be toggled. A management tunnel cannot be used by wxlan rule or by wlan</td>
</tr>
<tr>
<td><code>sessions</code></td>
<td><code>list</code></td>
<td>sessions to be established with the tunnel. Has to be &gt;= 1 in order for this tunnel to be useful. For management tunnel, it can only have 1</td>
</tr>
<tr>
<td><code>remote_id</code></td>
<td><code>string</code></td>
<td>remote-id of the session, has to be unique in the same tunnel</td>
</tr>
<tr>
<td><code>ethertype</code></td>
<td><code>string</code></td>
<td>ethernet / vlan, default is <code>ethernet</code></td>
</tr>
<tr>
<td><code>use_ap_as_session_ids</code></td>
<td><code>boolean</code></td>
<td>whether to use AP (last 4 bytes of MAC currently) as session ids, default is false.</td>
</tr>
<tr>
<td><code>ap_session_id</code></td>
<td><code>string</code></td>
<td>if use_ap_as_session_ids=true, only <code>apmac</code> is supported right now. This is the name WLAN should use for wxtunnel_remote_id</td>
</tr>
<tr>
<td><code>remote_session_id</code></td>
<td><code>int</code></td>
<td>1-4294967295</td>
</tr>
<tr>
<td><code>local_session_id</code></td>
<td><code>int</code></td>
<td>1-4294967295</td>
</tr>
<tr>
<td><code>pseudo_8021ad_enabled</code></td>
<td><code>boolean</code></td>
<td>optional, default is False. Enables the pseudo 802.1ad QinQ mode where the AP device drops the outer vlan tag (QinQ). This mode is useful when tunneling Mist AP’s to some aggregation routers.</td>
</tr>
<tr>
<td><code>comment</code></td>
<td><code>string</code></td>
<td>optional, user-specified string for display purpose</td>
</tr>
<tr>
<td><code>dmvpn</code></td>
<td><code>object</code></td>
<td>Dynamic Multipoint VPN configurations</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether DMVPN is enabled (default is false)</td>
</tr>
<tr>
<td><code>host_routes</code></td>
<td><code>list</code></td>
<td>optional; list of IPv4 DMVPN peer host ip-addresses to which traffic is forwarded</td>
</tr>
<tr>
<td><code>holding_time</code></td>
<td><code>int</code></td>
<td>optional; the holding time for NHRP ‘registration requests’ and ‘resolution replies’ sent from the Mist AP (in seconds); default 600</td>
</tr>
<tr>
<td><code>ipsec</code></td>
<td><code>object</code></td>
<td>IPSec-related configurations; requires DMVPN be enabled</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether ipsec is enabled (default is false); requires DMVPN be enabled</td>
</tr>
<tr>
<td><code>psk</code></td>
<td><code>boolean</code></td>
<td>ipsec pre-shared key</td>
</tr>
</tbody>
</table>
<h1 id="site_1">Site</h1>
<h2 id="get-site">Get Site</h2>
<pre><code>GET /api/v1/sites/:site_id
</code></pre>
<h3 id="response_99">Response</h3>
<pre><code>{
    "name": "Mist Office",
    "timezone": "America/Los_Angeles",
    "country_code": "US",

    "latlng": { "lat": 37.295833, "lng": -122.032946 },
    "address": "1601 S. Deanza Blvd., Cupertino, CA, 95014"
}
</code></pre>
<h3 id="parameters_76">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>. The name of the site</td>
</tr>
<tr>
<td><code>timezone</code></td>
<td><code>string</code></td>
<td>Timezone the site is at</td>
</tr>
<tr>
<td><code>country_code</code></td>
<td><code>string</code></td>
<td>country code for the site (for AP config generation), in <a href="http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">two-character</a></td>
</tr>
<tr>
<td><code>latlng</code></td>
<td><code>latlng</code></td>
<td>site location</td>
</tr>
<tr>
<td><code>address</code></td>
<td><code>string</code></td>
<td>full address of the site</td>
</tr>
<tr>
<td><code>lat</code></td>
<td><code>float</code></td>
<td>latitude</td>
</tr>
<tr>
<td><code>lng</code></td>
<td><code>float</code></td>
<td>longitude</td>
</tr>
</tbody>
</table>
<h1 id="site-setting">Site Setting</h1>
<h2 id="get-site-setting">Get Site Setting</h2>
<pre><code>GET /api/v1/sites/:site_id/setting
</code></pre>
<h2 id="update-site-setting">Update Site Setting</h2>
<pre><code>PUT /api/v1/sites/:site_id/setting
</code></pre>
<h2 id="example_13">Example</h2>
<pre><code>{
    "rtsa": {
        "enabled": false,
        "app_waking": false,
        "disable_pressure_sensor": false,
        "disable_dead_reckoning": false,

        // asset tracking related
        "track_asset": false
    },
    "wifi": {
        "enabled": true,
        "mesh_enabled": true,
        "mesh_allow_dfs": false,
        "mesh_enable_crm": false
        "cisco_enabled": true,
        "proxy_arp": "default",
        "enable_arp_spoof_check": false,
        "locate_connected": false,
        "locate_unconnected": false,
        "enable_shared_radio_scanning": false,
        "disable_11k": false,
        "disable_radios_when_power_constrained": false,
    },
    "vna": {
        // this applied to AP / Switch / Gateway
        "enabled": false
    },
    "wan_vna": {
        "enabled": false
    },
    "wired_vna": {
        "enabled": false
    },
    "srx_app": {
        "enabled": false
    },
    "persist_config_on_device": false,
    "device_updown_threshold": 0,
    // by default, device_updown_thresold, if set, will apply to all devices types
    // if different values for specific device type is desired, use the following
    "ap_updown_threshold": null,
    "gateway_updown_threshold": 10,
    "switch_updown_threshold": 0,
    "occupancy": {
        "clients_enabled": true,
        "sdkclients_enabled": true,
        "assets_enabled": true,
        "unconnected_clients_enabled": false
        "min_duration": 3000
    },
    "zone_occupancy_alert": {
        "enabled": true,
        "threshold": 5,
        "email_notifiers": [
            "foo@juniper.net",
            "bar@juniper.net"
        ]
    },
    "radio_config":  {
        "band_24": {
            "disabled": false,
            "channels": [ 1, 6, 11 ],
            "bandwidth": 20,
            "power": 16
        },
        "band_5": {
            "disabled": false,
            "channels": null,
            "bandwidth": 40,
            "power": 0,
            "preamble": "short",
            "power_min": 10,
            "power_max": 18
        },
        "band_6": {
            "disabled": false,
            "channels": null,
            "bandwidth": 40,
            "power": 0,
            "preamble": "short",
            "power_min": 10,
            "power_max": 18,
            // for 6G's standard-power operation, AFC (Automatic Frequency Coordination) will be performed
            // and we'll fallback to Low Power Indoor if AFC failed
            "standard_power": true  // default is false
        },
        "ant_gain_24": 7,
        "ant_gain_5": 4,
        "ant_gain_6": 6,

        "model_specific": {
            "AP61": {
                "band_5": {
                    "disabled": false,
                    "channels": [ 100, 104 ],
                    "bandwidth": 40,
                    "power": 0
                }
                "ant_gain_24": 4,
                "ant_gain_5": 5
            },
            "AP43": {
                "band_24_usage": "5"
            }
        },

        // let RRM control everything, only the `channels` and `ant_gain` will be honored (i.e. disabled/bandwidth/power/band_24_usage are all controlled by RRM)
        "full_automatic_rrm": true
    },
    "ap_port_config": {
        "model_specific": {
            "AP32": {
                "eth1,eth2": {
                    // see "port_config" in Device
                }
            }
        }
    },
    "enable_unii_4": true,  // default is false
    "rogue": {
        "enabled": false,
        "honeypot_enabled": true,
        "min_rssi": -80,
        "min_duration": 10,
        "min_rogue_rssi": -80,
        "min_rogue_duration": 10,
        "whitelisted_ssids": [ "NeighborSSID" ],
        "whitelisted_bssids": [ "cc:8e:6f:d4:bf:16", "cc-8e-6f-d4-bf-16", "cc-73-*", "cc:82:*" ],
        "allowed_vlan_ids": [ 10, 20, 105 ],
    },
    "led": {
        "enabled": true,
        "brightness": 255
    },
    "vars": {
        "RADIUS_SECRET": "11s64632d",
        "RADIUS_IP1": "172.31.2.5", 
        "DYNAMIC_VLANS": "{\"enabled\": true,\"type\": \"airespace-interface-name\",\"vlans\":{\"131\": \"default\",\"322\": \"fast,video\"}\"default_vlan_id\": 999,\"local_vlan_ids\": []}"
    },
    "auto_upgrade": {
        "enabled": true,
        "version": "beta",
        "time_of_day": "12:00",
        "day_of_week": "sun",
        "custom_versions": {
            "AP41": "0.1.5135",
            "AP61": "0.1.7215",
            "AP21": "stable"
        }
    },
    "auto_placement": {
        // if we're able to determine its x/y/orientation, this will be populated
        "x": 30,
        "y": 60,
        "orientation": 45
    },
    "config_push_policy": {

        // stop any new config from being pushed to the device
        "no_push": false,

        // if enabled, new config will only be pushed to device within the specified time window
        "push_window": {
            "enabled": true,
            "hours": {
                "mon": "09:00-17:00",
                "fri": "09:00-17:00"
            }
        },

        // mist also uses some heuristic rules to prevent destructive configs from being pushed 
    }
    "status_portal": {
        "enabled": true,
        "hostnames": ["my.misty.com"]
    },
    "remote_syslog": {
        "enabled": true,
        "send_to_all_servers": true
        "servers": [
            {
                "host": "syslogd.internal",
                "port": 514,
                "protocol": "udp",
                "facility": "config",
                "severity": "info"
                "tag": ""
            }
        ]
    },
    "engagement": {
        "dwell_tags": {
            "passerby": null,
            "bounce": null,
            "engaged": "300-14400",
            "stationed": "14400-43200"
        },
        "max_dwell": 43200,
        "hours": {
            "mon": "09:00-17:00",
            "fri": "09:00-17:00"
        },
        "dwell_tag_names": {
            "passerby": "Passer By",
            "bounce": "Bounce",
            "engaged": "Engaged",
            "stationed": "Stationed"
        }
    },
    "analytic": {
        "enabled": false
    },
    "flags": {
        "way1": 3,
        "way2": 0,
        "teleport": false
    },
    "ble_config": {
        "power_mode": "custom",
        "power": 10,
        "beacon_enabled": true,
        "beacon_rate_mode": "custom",
        "beacon_rate": 3,
        "beam_disabled": [ 1, 3, 6 ],

        // ibeacon
        "ibeacon_enabled": true,
        "ibeacon_uuid": "f3f17139-704a-f03a-2786-0400279e37c3",
        "ibeacon_major": 13,
        "ibeacon_minor": 138,
        "ibeacon_adv_power": -65,
        "ibeacon_beams": "2-4,7",  // or 'default' to auto-set

        // eddystone uid
        "eddystone_uid_enabled": false,
        "eddystone_uid_namespace": "2818e3868dec25629ede",
        "eddystone_uid_instance": "5c5b35000001",
        "eddystone_uid_freq_msec": 200,
        "eddystone_uid_adv_power": -65,
        "eddystone_uid_beams": "2-4,7",  // or 'default' to auto-set

        // eddystone url
        "eddystone_url_enabled": false,
        "eddystone_url_url": "https://www.abc.com",
        "eddystone_url_freq_msec": 1000,
        "eddystone_url_adv_power": -65,
        "eddystone_url_beams": "2-4,7",  // or 'default' to auto-set
    },
    "wids": {
        "repeated_auth_failures": {
            "threshold": 4,
            "duration": 60
        }
    },
    "proxy": {
        "url": "http://proxy.internal:8080/"
    },
    "ssh_keys": [
        "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAA...Wxa6p6UW0ZbcP john@host"
    ],
    "config_auto_revert": false,

    "ap_matching": {
        "enabled": true,

        "rules": [
            {
                "name": "AP12",
                "match_model": "AP12",

                "port_config": {
                    "eth1,eth2": {
                        // see Device Config's port_config
                    }
                }
            },
        }
    },


    "whitelist_url": "https://papi.s3.amazonaws.com/whitelist/xxx...",
    "blacklist_url": "https://papi.s3.amazonaws.com/blacklist/xxx...",
    "watched_station_url": "https://papi.s3.amazonaws.com/watched_station/xxx...",

    // a set of heuristic rules will be enabled when marvis subscription is not available
    // it triggers when, in a Z minute window (5&lt;=Z&lt;=60), there are more than Y distinct client encountring over
    // X failures
    "simple_alert": {
        "dhcp_failure": {
            "client_count": 10, // number of distinct clients having this failure, default is 10
            "incident_count": 20, // number of failures we've seen, default is 10
            "duration": 10 // failing within minutes, default is 10
        },
        "dns_failure": {
            "client_count": 20,
            "incident_count": 30,
            "duration": 10
        },
        "arp_failure": {
            "client_count": 10,
            "incident_count": 10,
            "duration": 20
        }
    },

    // SLE thresholds
    "sle_thresholds": {
        "time-to-connect": {
            "threshold": 5  // seconds, 2-10 in 2s increments, default is 4
        },
        "coverage": {
            "threshold": 66  // dBm, 60-90 in 6 dB increments, default is 72
        },
        "capacity": {
            "threshold": 30  // percentage, 10-50 in 10% increment, default is 20
        }
    },

    "synthetic_test": {
        "vlans": [
            {
                "vlan_ids": [10, 20],
                "custom_test_urls": [ "http://www.abc.com/", "https://10.3.5.1:8080/about" ]
            },
            {
                "vlan_ids": [30, 40],
                // for some vlans where we don't want this to run 
                "disabled": true
            }
        ],
        // to override org setting
        "wan_speedtest": {
            "enabled": false,  // default is false (i.e. disabled)

            // optional
            // by default, we'll look at the tarffic pattern and determine when to run automatically 
            "time_of_day": "02:00"
        }
    },

    // you can define some URLs that's critical to site operaitons
    // the latency will be captured and considered for site health
    "critical_url_monitoring": {
        "enabled": true,
        // up to 5 monitors can be defined
        "monitors: [
            {
                // currently only http and https are supported
                "url": "http://50.1.3.5:8080",
                "vlan_id": 3,  // default is 1
            },
            ...
        ]
    },

    //
    // switch related
    //

    "switch_mgmt": {
        "root_password": "asdfh61316saf",
        // the rollback timer for commit confirmed. Default is 10, valid range should be 1-30.
        "config_revert_timer" : 10,

        // use mxedge as proxy        
        "use_mxedge_proxy": true,
        "mxedge_proxy_host": "1.1.1.1",
        "mxedge_proxy_port": 2222,  // optional, default is 2222  

        // Enable to provide the FQDN with DHCP option 81. Default is false
        "dhcp_option_fqdn": false

        // Sets timeout for switches
        "cli_idle_timeout": 1-60 (minutes)

        // Set Banners for switches. Allows markup formatting
        "cli_banner": "\t\tWELCOME!"

        // Local user authentication
        "local_accounts": {
            "user1": {
                "role": "admin", // none (default) / admin / read / helpdesk
                "password": "Juniper123" // optional
            },
        }

        // restrict inbound-traffic to host  (draft)
        "protect_re": {
            "enabled": true
            // when enabled, all traffic that is not essential to our operation will be dropped
            // e.g. ntp / dns / traffic to mist will be allowed by default
            //      if dhcpd is enabled, we'll make sure it works
            "hit_count": false,  // whether to enable hit count for Protect_RE policy, default is false

            // optionally, host/subnets we'll allow traffic to/from
            "trusted_hosts": ["10.242.3.0/24"] 

            // optionally, services we'll allow
            "allowed_services": ["icmp", "ssh"],

            // optionally, custom acls
            "custom": [
                {
                    "subnets": ["10.1.2.0/24"],
                    "protocol": "tcp",  // tcp / udp / icmp / any (default)
                    "port_range": "80,1035-1040",  // matched dst port, "0" means any, default is "0"
                }
            ]
        }
        "ap_affinity_threshold": 10,

        "tacacs": {
            "enabled": true,
            "default_role": "admin", // admin / none (default) / read / helpdesk
            "tacplus_servers": [
                {
                    "host": "1.2.3.4",
                    "port": 49,
                    "secret": "testing123"
                },
                {
                    "host": "tacacs.internal",
                    "port": 49,
                    "secret": "testing123",
                    "timeout": 10 // by default is 10 seconds, timeout value from 1 - 90 seconds
                }
            ],
            "acct_servers": [
                {
                    "host": "1.2.3.4",
                    "port": 49,
                    "secret": "testing123"
                },
                {
                    "host": "tacacs.internal",
                    "port": 49,
                    "secret": "testing123",
                    "timeout": 10 // by default is 10 seconds, timeout value from 1 - 90 seconds
                }
            ],

            // which network the TACACS server resides
            "network": "default"
        },

        "radius": {
            "enabled": true,

            // by default, `radius_config` will be used

            // if a different one has to be used
            "use_different_radius": false,
            // if use_different_radius = true, provide payload same way as those under `radius_config`
        },

        "disable_oob_down_alarm": true,
        "fips_enabled": true, // default is false

        // by default, when we configure a device, we only clean up config we generates. we'll remove existing configs if enabled. default is false
        "remove_existing_configs": false
    },

    "port_mirroring": {
        "port_mirror": {
            "ingress_port_ids": ["ge-0/0/3", "ge-0/0/4"],
            "ingress_networks": ["corp", "analyze"],
            "output_port_id": "ge-0/0/5",
        },
        "port_mirror_test": {
            "ingress_port_ids": ["ge-0/0/23"],
            "egress_port_ids": ["ge-0/0/22", "ge-0/0/21"],
            "output_network": "analyze",
        }
    }

    "ntp_servers": [
        "pool.ntp.org"
    ],

    "dns_servers": [ "8.8.8.8", "4.4.4.4" ],
    "dns_suffix": [ ".mist.local", ".mist.com" ],

    // NOTE: if the site uses NetworkTemplate, NetworkTemplate takes precedence while this augments it
    //       i.e. only those not defined in network templates will be used
    "networks": {
        // default is assumed, cannot be changed
        "default": {
            "vlan_id": 1
        },

        // create more
        "corp": {
            "vlan_id": 60,
        },
        "guest": {
            "vlan_id": 70,

            // optional for pure switching, required when L3 / routing features are used
            "subnet": "192.168.70.0/24",

            // whether to stop clients to talk to each other, default is false (when enabled, a unique isolation_vlan_id is required)
            // NOTE: this features requires uplink device to also a be Juniper device and `inter_switch_link` to be set 
            //       on the connected ports
            // also see `inter_isolation_network_link` and `community_vlan_id` in port_usage
            "isolation": true,  // default is false
            "isolation_vlan_id": 3070
        },
        "mgmt": {
            "vlan_id": 500
        },
        "voip": {
            "vlan_id": 50,
            "subnet": "192.168.50.0/24",
            "gateway": "192.168.50.1"
        }
    },

    // NOTE: if the site uses NetworkTemplate, NetworkTemplate takes precedence while this augments it
    //       i.e. only those not defined in network templates will be used
    "port_usages": {
        "ap": {
            // the following parameter is assumed by default
            "mode": "trunk",
            "all_networks": true,
            "stp_edge": true,
            "port_network": "default",
            "mtu": 9192,

            // to limit networks it trunks
            "all_networks": false,
            "networks": [ "guest", "corp" ],

            // to change the native network
            "port_network": "mgmt",

            // to make the port disabled
            "disabled": true,

            // if alternative name is desired
            "description": "WAP",

            // to add voip
            "voip_network": "voip",

            "enable_qos": true,

            // if DHCP snooping is enabled, DHCP server is not allowed
            "allow_dhcpd": false,
        },
        "uplink": {
            // the following parameter is assumed by default
            "mode": "trunk",
            "all_networks": true,
            "stp_edge": false,
            "port_network": "default",
            "enable_qos": false,

            // inter_switch_link is used together with "isolation" under networks
            // NOTE: inter_switch_link works only between Juniper device. This has to be applied to both ports connected
            //       together            
            "inter_switch_link": false,  // default is false

            // inter_isolation_network_link is used together with "isolation" under networks
            // signaling that this port connects to the networks isolated
            "inter_isolation_network_link": false,  // default is false

            // if this is connected to a vstp network
            "use_vstp": true,  // default is false
        },
        "iot": {
            // the following parameter is assumed by default
            "mode": "access",
            "stp_edge": true,
            "port_network": "default",

            // if DHCP snooping is enabled, DHCP server is allowed
            "allow_dhcpd": true,

            // community_vlan_id is used together with "isolatin" under networks
            // signaling that this port connects to the networks isolated but wired clients belong to the same community can talk to each other
            "community_vlan_id": 3000
        },
        "default": {
            // the following parameter is assumed by default and cannot be changed
            "mode": "access",
            "stp_edge": false,  // we don't know how it will be connected at default state, not doing anything
            "port_network": "default"
        },
        "dynamic": {
            // this is a special mode where the actually usage is determined
            // by a set of rules
            // the port will start with `access` mode and isolated
            // depending on the rules, if resolved, the port will have
            // the resolved usage applied.
            //
            // if the port/link goes down, it goes back to the initial state
            "mode": "dynamic",

            // Control when the DPC port should be changed to the default port usage
            // Configuring to none will let the DPC port keep at the current port usage.
            // The default value is link_down
            "reset_default_when": "none",   // none or link_down. 

            // Control when the DPC port should be changed to the default port usage
            // Configuring to none will let the DPC port keep at the current port usage.
            // The default value is link_down
            "reset_default_when": "none",   // none or link_down. 

            "rules": [
                // use LLDP attributes
                {
                    "src": "lldp_system_name",  // or lldp_chassis_id
                    "expression": "[0:3]",           // "abcdef" -&gt; "abc"
                                  "split(.)[1]",     // "a.b.c" -&gt; "b"
                                  "split(-)[1][0:3], // "a1234-b5678-c90" -&gt; "b56"
                    "equals": "SENSOR",
                    "usage": "iot"
                },
                // use equals_any to match any item in a list
                {
                    "src": "lldp_chassis_id",
                    "expression": "[0:17]",
                    “equals_any”: [“00:11:22:33:44:55", “00:11:22:33:44:66”, “00:11:22:33:44:77"],
                    "usage": "iot"
                },
                // use RADIUS (WIP)
                {
                    "src": "radius_username",  // or radius_group
                    "expression": "[0:3]",           // "abcdef" -&gt; "abc"
                                  "split(.)[1]",     // "a.b.c" -&gt; "b"
                                  "split(-)[1][0:3], // "a1234-b5678-c90" -&gt; "b56"
                    "equals": "SENSOR"  
                    "usage": "iot"
                },
            ]
        },

        // additional usages can be defined
        "user": {
            "mode": "access",
            "stp_edge": true,
            "port_network": "default",

            // 802.1x
            "port_auth": "dot1x",
            "enable_mac_auth": false,
            "mac_auth_only": True, // False by default. This options is accessible when enable_mac_auth is set to true.
            "mac_auth_protocol": "eap-md5",  // eap-md5 (default) / pap / eap-peap 
            "guest_network": null,
            "server_reject_network": "net1"   
            "mac_auth_preferred": false,  // when enable_mac_auth=true and mac_auth_only=false, dot1x will be given priority then mac_auth. Enable this to prefer mac_auth over dot1x. 
            "server_fail_network": "net2" 
            "reauth_interval": 3600, // default is 3600, range: 10-65535
            "bypass_auth_when_server_down": false,
            "bypass_auth_when_server_down_for_unknown_client": false,
            "allow_multiple_supplicants": true // optional, default is false
            "stp_p2p": true // optional, default is false
            "stp_no_root_port": true // optional, default is false

            // other port settings
            "speed": "1g",
            "duplex": "full",
            "disable_autoneg": false,
            "mac_limit": 2,
            "poe_disabled": true,
            "storm_control": {
                "percentage": 80,
                "no_multicast": false,
                "no_unknown_unicast": true,
                "no_broadcast": true,
            },

            // if dynamic vlan is used, specify the possible networks/vlans RADIUS can return
            "dynamic_vlan_networks": ["corp", "user"],
        },
    },

    // if some system-default port usages are not desired - namely, ap / iot / uplink 
    "disabled_system_defined_port_usages": [ "ap", "iot" ],

    // by default, for any unassigned ports, `default` is assumed, to preserve the factory default behavior
    // you can change it to something else
    "default_port_usage": "disabled",  

    // by default, when we configure a device, we only clean up config we generates
    // we'll remove existing configs if enabled
    "remove_existing_configs": false,   // defualt is false

    "radius_config": {
        "auth_servers_timeout": 5,
        "auth_servers_retries": 3,
        "auth_servers": [
            {
                "host": "1.2.3.4",
                "port": 1812,
                "secret": "testing123"
            },
            {
                "host": "radius.internal",
                "port": 1812,
                "secret": "testing123"
            }
        ],
        "acct_servers": [
            {
                "host": "1.2.3.4",
                "port": 1812,
                "secret": "testing123"
            }
        ],
        "acct_interim_interval": 0,

        // Enable COA. Default is false. When coa_port is not specified, 3799 is the default value.
        “coa_enabled”: true,
        “coa_port”: 3799,

        // which network the RADIUS server resides, if there's static IP for this network,
        // we'd use it as source-ip
        "network": "default"

        // or specifiy "source_ip" directly
        "source_ip": "192.168.3.5"
    },

    "switch_matching": {
        "enabled": true,

        "rules": [
            {
                "name": "match by name",
                "match_name[0:3]": "abc",
                "match_model": "EX4300",

                "port_config": {
                    "ge-0/0/0": {
                        "usage": "uplink"
                    },
                    "ge-0/0/8-16,ge-1/0/0-47": {
                        "usage": "ap"
                    },

                    // this is assumed
                    "*": {
                        "usage": "default"
                    }
                },
                "port_mirroring": {
                    "port_mirror": {
                        "input_port_ids_ingress": ["ge-0/0/4"],
                        "input_networks_ingress": ["test"],
                        "input_port_ids_egress": ["ge-0/0/5", "ge-0/0/6"],
                        "output_port_id": "ge-0/0/3",
                    },
                    "port_mirror_test": {
                        "input_port_ids_ingress": ["ge-0/0/3"],
                        "input_networks_ingress": ["iot"],
                        "input_port_ids_egress": ["ge-0/0/22", "ge-0/0/21"],
                        "output_port_id": "ge-0/0/4",
                    }
                },

                // additional CLI commands to append if this rule matches
                // NOTE: no check is done
                "additional_config_cmds": [
                    "set snmp community public"
                ]
            },
            {
                "name": "match by role",
                "match_role": "access",

                "port_config": {
                    "ge-0/0/0": {
                        "usage": "uplink"
                    }
                },

                // additional CLI commands to append if this rule matches
                // NOTE: no check is done
                "additional_config_cmds": [
                    "set snmp community public2"
                ]
            }
        ]
    },

    // additional CLI commands to append to the generated config for switches
    // NOTE: no check is done   
    "additional_config_cmds": [
    ],

    // additional CLI commands to append to the generated config for gateways
    // NOTE: no check is done
    // for SRX
    "gateway_additional_config_cmds": [
    ]

    "ospf_areas": {
        "0": {
            "type": "default",  // default (default) / stub / nssa
            "include_loopback": false, // true / false
            "networks": {
                "corp": {
                    "interface_type": "broadcast",  // broadcast (default) / nbma / p2p / p2mp

                    // optional
                    // BFD is enabled when either bfd_minimum_interval or bfd_multiplier is configured
                    "bfd_minimum_interval": none,  // 1-255000 / 350 (default) when bfd_multiplier is configured alone
                    "bfd_multiplier": none,  // 1-255 / 3 (default) when bfd_minimum_interval_is_configured alone
                    "metric": 10000,   // none / 1-65535
                    "hello_interval": 10,  // none / 1-255
                    "dead_interval": 40,   // none / 1-65535
                    "auth_type": "md5",  // none (default) / md5 / password
                    // if auth_type=='md5'
                    "auth_keys": {"1": "auth-key-1"},
                    // if auth_type=='password                     
                    "auth_password": "simple"
                    // by default, we'll re-advertise all learned OSPF routes toward overlay
                    "no_readvertise_to_overlay": false
                    "export_policy": "export_policy",
                    "import_policy": "import_policy"
                },
                "iot": {
                },
                "guest": {
                    "passive": true
                }
            },
        }
    },

    "vrrp_groups": {
        "0": {
            "networks": {
                "data": {
                    "ip": "10.182.96.1", //ip(virtual address) need under the same interface 
                },
                "wap": {
                    "ip": "10.182.102.1",
                },
                "mgmt": {
                    "ip": "10.182.104.1",
                },
                "v10": {
                    "ip": "10.182.104.129",
                }
            },
            // optional
            "auth_type": "md5" / md5 / simple
            // if auth_type=='md5'
            "auth_key": "auth-key-1",
            // if auth_type=='simple'                     
            "auth_password": "simple"
        },
    },

    // vrf
    "vrf_instances": {
        "guest": {
            "networks": [ "guest" ],
            "evpn_auto_lookback_subnet": "100.101.0.0/24", 
            "extra_routes": {
                "0.0.0.0/0": {"via": "192.168.31.1"}
            },
            "aggregate_routes: {
                "192.168.0.0/16": {}
            }
        }
    },

    // remote syslog
    "remote_syslog": {
        "enabled": true,
        "send_to_all_servers": true,
        "network": "default",
        "time_format": "millisecond | year |  year millisecond",
        "archive": {
            "files": 111,
            "size": "5m"
        },
        "cacerts": [
            "-----BEGIN CERTIFICATE-----\nMIIFZjCCA06gAwIBAgIIP61/1qm/uDowDQYJKoZIhvcNAQELBQE\n-----END CERTIFICATE-----",
            "-----BEGIN CERTIFICATE-----\nBhMCRVMxFDASBgNVBAoMC1N0YXJ0Q29tIENBMSwwKgYDVn-----END CERTIFICATE-----"
        ],
        "files": [
            {
                "file": "file-name",
                "match": "!alarm|ntp|errors.crc_error[chan]",
                "contents": [
                    {
                        "facility": "any | authorization | conflict-log | change-log | daemon | dfc | kernel | interactive-commands | ftp | firewall | external | pfe | ntp | security | user",
                        "severity": "any | alert | emergency | critical | warning | info | notice | error"
                    }
                ],
                "archive": {
                    "files": 10,
                    "size": "5m"
                },
                "explicit_priority": true,
                "structured_data": true
            }
        ],
        "servers": [
            {
                "host": "syslogd.internal",
                "port": 514,
                "protocol": "udp",
                "facility": "config",
                "severity": "info",
                "tag": ""
                "match": "!alarm|ntp|errors.crc_error[chan]",
                "enable_tls": true,  // only when protocol is tcp
                "contents": [
                    {
                        "facility": "any | authorization | conflict-log | change-log | daemon | dfc | kernel | interactive-commands | ftp | firewall | external | pfe | ntp | security | user",
                        "severity": "any | alert | emergency | critical | warning | info | notice | error"
                    }
                ],
                "explicit_priority": true,
                "structured_data": true
            }
        ],
        "users": [
            {
                "user": "*",
                "match": "!alarm|ntp|errors.crc_error[chan]",
                "contents": [
                    {
                        "facility": "any | authorization | conflict-log | change-log | daemon | dfc | kernel | interactive-commands | ftp | firewall | external | pfe | ntp | security | user",
                        "severity": "any | alert | emergency | critical | warning | info | notice | error"
                    }
                ]
            }
        ],
        "console": {
            "contents": [
                {
                    "facility": "any | authorization | conflict-log | change-log | daemon | dfc | kernel | interactive-commands | ftp | firewall | external | pfe | ntp | security | user",
                    "severity": "any | alert | emergency | critical | warning | info | notice | error"
                }
            ]
        }
    },

    //
    // gateway related
    //

    // skyatp
    "skyatp": {
        "enabled": true,

        // optional
        "send_ip_mac_mapping": true,  // whether to send IP-MAC mapping to SkyATP 
    },

    // paloalto firewall config
    "paloalto_networks": {
        "send_mist_nac_user_info": true,
        "gateways": [
            {
                "api_url": "https://23.43.12.78:8443",
                "api_key": "5abf7c8a-1a1c-4398-ba2d-b0c297094d1a"
            }
        ]
    },

    // juniper srx firewall config
    "juniper_srx": {
        "send_mist_nac_user_info": true,
        "gateways": [
            {
                "api_url": "https://23.43.12.78:8443"
                "api_username": "john_doe",
                "api_password": "abc@123"
            }
        ]
    },

    // t128 ssr
    "ssr": {
        "conductor_hosts": [ "1.1.1.1", 2.2.2.2" ],
        "conductor_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwc2siOiIxMj",
        "disable_stats": false,
    },

    "gateway_mgmt": {
        // for SRX
        "root_password": "4Ww6r&amp;bzJQh#bm%uEU",

        // for SSR, as direct root access is not allowed
        "admin_sshkeys": [
            "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAA...Wxa6p6UW0ZbcP john@host"
        ],

        "disable_console": false,  // for both SSR and SRX disable console port
        "disable_oob": false,  // for both SSR and SRX disable management interface
        "disable_usb": false,  // for SSR and SRX3xx disable usb interface
        // consumes uplink bandwidth, requires WA license
        "app_usage": false,
        "security_log_source_address": "192.168.1.1",
        "security_log_source_interface":"ge-0/0/1.0",
        "probe_hosts": ["8.8.8.8"],
        "app_probing": {
            "enabled": true,
            "apps": [ "facebook" ],  // keys from /const/applications
            "custom_apps": [
                {
                    "name": "pos_app",
                    "protocol": "http", // http (default) / icmp
                    "hostnames": [ "www.abc.com" ], // when protocol is http, optional
                    "url": "www.abc.com", // when protocol is http, optional
                    "app_type": "",  // 
                    "address": "192.168.1.1", // when protocol is icmp
                    "network": "lan", // optional
                    "vrf_name": "lan" // optional
                }
            ]
        },

        # signauture update for 
        "auto_signature_update": {
            "enable": true,  // default is true
            "time_of_day": "11:30",  // optional, Mist will decide the timing
            "day_of_week": "sun"  // optional, daily if omitted
        },

        // the rollback timer for commit confirmed. Default is 10, valid range should be 1-30.
        "config_revert_timer" : 10,

        // restrict inbound-traffic to host  (draft)
        "protect_re": {
            "enabled": true
            // when enabled, all traffic that is not essential to our operation will be dropped
            // e.g. ntp / dns / traffic to mist will be allowed by default
            //      if dhcpd is enabled, we'll make sure it works

            // optionally, host/subnets we'll allow traffic to/from
            "trusted_hosts": ["10.242.3.0/24"] 

            // optionally, services we'll allow
            "allowed_services": ["icmp", "ssh"],

            // optionally, custom acls
            "custom": [
                {
                    "subnets": ["10.1.2.0/24"],
                    "protocol": "tcp",  // tcp / udp / icmp / any (default)
                    "port_range": "80,1035-1040",  // matched dst port, "0" means any, default is "0"
                }
            ]
        },
        "fips_enabled": true // default is false
    },    

    // when Templates are not used, Site Setting holds settings for multiple device types and they can differ
    // to set device-type specific configs, use this
    // whatever is defined under `switch/gateway` will overwrite/shadow the one at root-level
    "switch": {
        // same as above

        // auto_upgrade is only performed first time the device is onboarded for now
        "auto_upgrade": {
            "enabled": true,
            "snapshot": true, // default is false
            "custom_versions": {
                "QFX5130-32CD": "23.4R2-S2.3",
                "QFX5120-32C": "23.4R2-S2.1",
            }
        }
    },

    "gateway": {
        // same as above
    },


    //
    // mxedge/mxtunnel related related
    //

    "mxtunnel": {
        "enabled": false,

        // default mxtunnel
        "vlan_ids": [3, 5, 6, "7-9"],
        "ap_subnets": "0.0.0.0/0",  // optional, as this is hosted on-premises
        "protocol": "udp",
        "mtu": 1100,

        "hello_interval": 60,
        "hello_retries": 3,

        // for AP, how to connect to tunterm or radsecproxy
        "clusters": [
            {
                "name": "primary",
                "tunterm_hosts": ["mxedge1", "mxedge2.local"],
            }
        ],

        "auto_preemption": {
            "enabled": true,
            "time_of_day": "12:00",
            "day_of_week": "sun"
        },

        "additional_mxtunnels" {
            "guest": {
                "vlan_ids": [300, 310, 320],
                "protocol": "udp",
                "mtu": 1100,
                "clusters": [
                    {
                        "name": "primary",
                        "tunterm_hosts": ["mxedge_guest"],
                    }
                ],
                "hello_interval": 60,
                "hello_retries": 3,
            }
        }
    },

    "tunterm_multicast_config": {
        "mdns": {
            "enabled": true,
            "vlan_ids": [2, 3, 5]
        },
        "ssdp": {
            "enabled": true,
            "vlan_ids": [2, 3, 5]
        },
        "multicast_all": true
    },

    "mxedge": {
        "radsec": {
            // site mist edges form a cluster of radsecproxy servers
            // see "radsec" under api/v1/docs/Org#mist-edge-cluster for schema
            "additional_radsecs": {
                "guest": {
                    // see "radsec" under api/v1/docs/Org#mist-edge-cluster for schema
                }
            }
        },        

        "mist_das": {
            // site mist edges form a cluster of cloud-assisted dynamic authorization servers
            // see "mist_das" under api/v1/docs/Org#mist-edge-cluster for schema
        },

        // mist_nac
        "mist_nac": {
            "enabled": true,
            "secret": "testing123",

            "client_ips": {
                "10.0.3.0/24": {

                    // convention to be followed is : "&lt;vendor&gt;-&lt;variant&gt;"
                    // &lt;variant&gt; could be an os/platform/model/company
                    // for ex: for cisco vendor, there could variants wrt
                    // os (such as ios, nxos etc), platforms (asa etc),
                    // or acquired companies (such as meraki, airnonet) etc.
                    //
                    // currentluy supported vendor values are:
                    // generic, juniper, aruba, paloalto,
                    // cisco-aironet, cisco-ios, cisco-meraki

                    "vendor": "cisco-ios",
                    "secret": "alternative_one",  // optional, if different from above
                    // "site_id" is implicit
                }
            },
            "auth_server_port": 1812,  // optional, default is 1812
            "acct_server_port": 1813,  // optional, default is 1813
        },

        // nacedge
        "mist_nacedge": {
            "enabled": true,
            "auth_ttl": 86400,              // cache of last auth result; in seconds,
                                            // 60-2592000; default is 604800
            "default_vlan": "testVlan",     // Default vlan to assign for devices
                                            // not in the cache
            "default_dot1x_vlan": "20",     // default vlan for all dot1x devices,
                                            // if different from default_vlan
            "mxedge_hosts": ["mxedge1.local"] // list of NAC Edges in this site
        },
    },

    "mxedge_mgmt": {
        "mist_password": "MIST_PASSWORD",
        "root_password": "ROOT_PASSWORD",
        "fips_enabled": true, // default is false
        "oob_ip_type": "disabled",  // dhcp (default) / disabled
        "oob_ip_type6": "disabled", // autoconf (default) / dhcp / disabled
        "config_auto_revert": true, // default is false
    },

    "tunterm_monitoring_disabled": false,
    "tunterm_monitoring": [
        {
            "protocol": "ping",   // arp / ping / tcp
            "host": "10.2.8.15",  // can be ip, ipv6, hostname
            "timeout": 300,  // 60 - 3600, default is 300

            // when protocol==tcp
            "port": 80
        }
    ],

    // marvis
    "marvis": {
        "auto_operations": {
            // default are all false
            "bounce_port_for_abnormal_poe_client": false,
            "disable_port_when_rogue_dhcp_server_detected": false,
            "disable_port_when_ddos_protocol_violation": false
        }
    }
}
</code></pre>
<h2 id="get-site-setting-derived">Get Site Setting Derived</h2>
<pre><code>GET /api/v1/sites/:site_id/setting/derived
</code></pre>
<h2 id="response_100">Response</h2>
<pre><code>{
   // ... same as /setting


  // exposed from orgs

  "zoom_accounts": [
    {
      "last_sync": 1738119600,
      "last_status": "failed",
      "account_id": "123451111",
      "errors": ["OAuth token refresh failed, please re-link your account"]
    }
  ],
  "zoom_qss_accounts": [
    {
      "last_sync": 1738129500,
      "last_status": "success",
      "account_id": "123453333",
    }
  ],
  "teams_accounts": [
    {
      "last_sync": 1738119600,
      "last_status": "success",
      "account_id": "aaaaaaaa-1bed-4a49-9fd6-123456789012"
    }
  ],
  "prisma_accounts": [
      {
        "tsg_id": "1899598553",
        "account_id": "171be693-8cd4-41f2-bac8-93b77b6a9c39",
        "service_account_name": "mist-integration@18995xxxx",
        "region": "americas",
        "cloud_name": "api.sase.paloaltonetworks.com",
        "service_connections": ['sc1', 'sc2']
      }
  ]
}
</code></pre>
<h3 id="definitions_3">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>analytic.enabled</code></td>
<td><code>boolean</code></td>
<td>enable Advanced Analytic feature, default is false (using SUB-ANA license)</td>
</tr>
<tr>
<td><code>app_waking</code></td>
<td><code>boolean</code></td>
<td>default is false</td>
</tr>
<tr>
<td><code>auto_upgrade</code></td>
<td><code>object</code></td>
<td>auto upgrade</td>
</tr>
<tr>
<td><code>auto_upgrade_linecard</code></td>
<td><code>boolean</code></td>
<td>auto upgrade linecards (JUNOS), default is true</td>
</tr>
<tr>
<td><code>bandwidth</code></td>
<td><code>int</code></td>
<td>channel width for the band, 20 / 40 / 80 / 160, 80 is only applicable for band_5, 160 is only for band_6</td>
</tr>
<tr>
<td><code>ble_config</code></td>
<td><code>object</code></td>
<td>BLE config (see <a href="https://api.mist.com/api/v1/docs/Site#ble">Site:BLE Config</a>)</td>
</tr>
<tr>
<td><code>ble</code></td>
<td><code>object</code></td>
<td>BLE asset settings</td>
</tr>
<tr>
<td><code>brightness</code></td>
<td><code>int</code></td>
<td>0-255, default is 255</td>
</tr>
<tr>
<td><code>channel</code></td>
<td><code>int</code></td>
<td>(primary) channel for the band, 0 means auto</td>
</tr>
<tr>
<td><code>channels</code></td>
<td><code>list</code></td>
<td>list of channels, null or empty array means auto</td>
</tr>
<tr>
<td><code>occupancy</code></td>
<td><code>object</code></td>
<td>occupancy settings</td>
</tr>
<tr>
<td><code>zone-occupancy-alert</code></td>
<td><code>object</code></td>
<td>zone occupancy alert settings</td>
</tr>
<tr>
<td><code>device_updown_threshold</code></td>
<td><code>int</code></td>
<td>enable threshold-based device down delivery via 1) <code>device-updowns</code> webhooks topic, 2) Mist Alert Framework; e.g. send AP/SW/GW down event only if AP/SW/GW Up is not seen within the threshold in minutes; 0 - 240, default is 0 (trigger immediate)</td>
</tr>
<tr>
<td><code>ap_updown_threshold</code></td>
<td><code>int</code></td>
<td>enable threshold-based device down delivery for AP devices only. When configured it takes effect for AP devices and device_updown_threshold is ignored.</td>
</tr>
<tr>
<td><code>gateway_updown_threshold</code></td>
<td><code>int</code></td>
<td>enable threshold-based device down delivery for Gateway devices only. When configured it takes effect for GW devices and device_updown_threshold is ignored.</td>
</tr>
<tr>
<td><code>switch_updown_threshold</code></td>
<td><code>int</code></td>
<td>enable threshold-based device down delivery for Switch devices only. When configured it takes effect for SW devices and device_updown_threshold is ignored.</td>
</tr>
<tr>
<td><code>flags</code></td>
<td><code>list</code></td>
<td>name/val pair objects for location engine to use</td>
</tr>
<tr>
<td><code>hello_interval</code></td>
<td><code>float</code></td>
<td>in seconds, used as heartbeat to detect if a tunnel is alive. AP will try another peer after missing N hellos specified by <code>hello_retries</code>. between 1 and 300, default is 60 seconds</td>
</tr>
<tr>
<td><code>hello_retries</code></td>
<td><code>int</code></td>
<td>between 2 and 30, default is 7</td>
</tr>
<tr>
<td><code>led.enabled</code></td>
<td><code>boolean</code></td>
<td>whether to enable LED, default is true</td>
</tr>
<tr>
<td><code>led</code></td>
<td><code>object</code></td>
<td>LED control</td>
</tr>
<tr>
<td><code>model_specific</code></td>
<td><code>object</code></td>
<td>overwrites for a specific model. If a band is specified, it will shadow the default.</td>
</tr>
<tr>
<td><code>config_auto_revert</code></td>
<td><code>boolean</code></td>
<td>whether to enable ap auto config revert, default is false</td>
</tr>
<tr>
<td><code>mxtunnel.mtu</code></td>
<td><code>int</code></td>
<td>552-1500, default is 0</td>
</tr>
<tr>
<td><code>mxtunnel.auto_preemption</code></td>
<td><code>object</code></td>
<td>schedule to preempt ap’s which are not connected to preferred peer</td>
</tr>
<tr>
<td><code>tunterm_multicast_config</code></td>
<td><code>object</code></td>
<td>tunterm multicast configs</td>
</tr>
<tr>
<td><code>ntp_servers</code></td>
<td><code>list</code></td>
<td>list of NTP servers</td>
</tr>
<tr>
<td><code>persist_config_on_device</code></td>
<td><code>boolean</code></td>
<td>whether to store the config on AP, default is false</td>
</tr>
<tr>
<td><code>power_max</code></td>
<td><code>int</code></td>
<td>when power=0, min tx power to use, HW-specific values will be used if not set</td>
</tr>
<tr>
<td><code>power_min</code></td>
<td><code>int</code></td>
<td>when power=0, min tx power to use, HW-specific values will be used if not set</td>
</tr>
<tr>
<td><code>power</code></td>
<td><code>int</code></td>
<td>tx power of the radio, null or 0 means auto, when power_min=power_max=power=0 to indicate power=0</td>
</tr>
<tr>
<td><code>preamble</code></td>
<td><code>string</code></td>
<td>short / long / auto, default is short</td>
</tr>
<tr>
<td><code>proxy</code></td>
<td><code>object</code></td>
<td>Proxy Configuration for APs and Site Edges to talk to Mist</td>
</tr>
<tr>
<td><code>radio_config</code></td>
<td><code>object</code></td>
<td>site RF settings</td>
</tr>
<tr>
<td><code>remote_syslog</code></td>
<td><code>object</code></td>
<td>syslog parameters</td>
</tr>
<tr>
<td><code>report_gatt</code></td>
<td><code>boolean</code></td>
<td>default is false; whether AP should periodically connect to BLE devices and report GATT device info (device name, manufacturer name, serial number, battery %, temperature, humidity)</td>
</tr>
<tr>
<td><code>rogue</code></td>
<td><code>object</code></td>
<td>rogue detection parameters</td>
</tr>
<tr>
<td><code>rtsa</code></td>
<td><code>object</code></td>
<td>managed mobility</td>
</tr>
<tr>
<td><code>ssh_keys</code></td>
<td><code>list</code></td>
<td>when <code>limit_ssh_access</code> = true in Org Setting, list of SSH public keys provided by Mist Support to install onto APs (see <a href="https://api.mist.com/api/v1/docs/Org#setting">Org:Setting</a>)</td>
</tr>
<tr>
<td><code>track_anonymous_devices</code></td>
<td><code>boolean</code></td>
<td>default is false; whether to track anonymous BLE assets (requires ‘track_asset’ enabled)</td>
</tr>
<tr>
<td><code>track_asset</code></td>
<td><code>boolean</code></td>
<td>enable Asset Tracking, default is false (using SUB-AST license)</td>
</tr>
<tr>
<td><code>vars</code></td>
<td><code>object</code></td>
<td>a dictionary of name-&gt;value, values should only be strings. The vars can then be used for Device config generation</td>
</tr>
<tr>
<td><code>wifi</code></td>
<td><code>object</code></td>
<td>managed connectivity</td>
</tr>
</tbody>
</table>
<h3 id="occupancy-settings">Occupancy settings</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>assets_enabled</code></td>
<td><code>boolean</code></td>
<td>indicate whether named BLE assets should be included in the zone occupancy calculation, default is false</td>
</tr>
<tr>
<td><code>sdkclients_enabled</code></td>
<td><code>boolean</code></td>
<td>indicate whether SDK clients should be included in the zone occupancy calculation, default is false</td>
</tr>
<tr>
<td><code>clients_enabled</code></td>
<td><code>boolean</code></td>
<td>indicate whether connected WiFi clients should be included in the zone occupancy calculation, default is true</td>
</tr>
<tr>
<td><code>unconnected_clients_enabled</code></td>
<td><code>boolean</code></td>
<td>indicate whether unconnected WiFi clients should be included in the zone occupancy calculation, default is false</td>
</tr>
<tr>
<td><code>min_duration</code></td>
<td><code>int</code></td>
<td>minimum duration, default is 3000</td>
</tr>
</tbody>
</table>
<h3 id="zone-occupancy-alert-parameters">Zone Occupancy Alert Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>indicate whether zone occupancy alert is enabled for the site, default is false</td>
</tr>
<tr>
<td><code>threshold</code></td>
<td><code>int</code></td>
<td>sending zone-occupancy-alert webhook message only if a zone stays non-compliant (i.e. actual occupancy &gt; occupancy_limit) for a minimum duration specified in the threshold, in minutes, 0 - 30, default is 5 minutes</td>
</tr>
<tr>
<td><code>email_notifiers</code></td>
<td><code>array of strings</code></td>
<td>list of email addresses to send email notifications when the alert threshold is reached</td>
</tr>
</tbody>
</table>
<h3 id="wifi-settings">WiFi settings</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>enable WIFI feature, default is true (using SUB-MAN license)</td>
</tr>
<tr>
<td><code>enable_arp_spoof_check</code></td>
<td><code>boolean</code></td>
<td>when proxy_arp is enabled, check for arp spoofing. default is false</td>
</tr>
<tr>
<td><code>vna.enabled</code></td>
<td><code>boolean</code></td>
<td>enable Virtual Network Assistant, default is false (using SUB-VNA license)</td>
</tr>
<tr>
<td><code>proxy_arp</code></td>
<td><code>string</code></td>
<td>default / enabled / disabled</td>
</tr>
<tr>
<td><code>locate_unconnected</code></td>
<td><code>boolean</code></td>
<td>whether to locate unconnected clients, default is false</td>
</tr>
<tr>
<td><code>mesh_enabled</code></td>
<td><code>boolean</code></td>
<td>whether to enable Mesh feature for the site, default is false</td>
</tr>
<tr>
<td><code>mesh_allow_dfs</code></td>
<td><code>boolean</code></td>
<td>whether to allow Mesh to use DFS channels, default is false. For DFS channels, Remote Mesh AP would have to do CAC when scanning for new Base AP, which is slow and will distrupt the connection. If roaming is desired, keep it disabled.</td>
</tr>
<tr>
<td><code>mesh_enable_crm</code></td>
<td><code>boolean</code></td>
<td>used to enable/disable CRM</td>
</tr>
<tr>
<td><code>mesh_ssid</code></td>
<td><code>string</code></td>
<td>optional ssid of mesh networking, default is based on site_id</td>
</tr>
<tr>
<td><code>mesh_psk</code></td>
<td><code>string</code></td>
<td>optional passphrase of mesh networking, default is generated randomly</td>
</tr>
<tr>
<td><code>disable_11k</code></td>
<td><code>boolean</code></td>
<td>whether to disable 11k, default is false</td>
</tr>
<tr>
<td><code>enable_unii_4</code></td>
<td><code>boolean</code></td>
<td>whether to enable U-NII-4 band (channels 169, 173, 177), default is false</td>
</tr>
</tbody>
</table>
<h4 id="remote-syslog-parameters">Remote Syslog Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether or not remote syslog is enabled</td>
</tr>
<tr>
<td><code>send_to_all_servers</code></td>
<td><code>boolean</code></td>
<td>whether or not send syslog to all servers</td>
</tr>
<tr>
<td><code>servers</code></td>
<td><code>list</code></td>
<td>list of syslog servers</td>
</tr>
<tr>
<td><code>host</code></td>
<td><code>string</code></td>
<td>host to which syslog is sent</td>
</tr>
<tr>
<td><code>protocol</code></td>
<td><code>string</code></td>
<td>udp / tcp, protocol to use for remote syslog, default is <code>udp</code></td>
</tr>
<tr>
<td><code>port</code></td>
<td><code>int</code></td>
<td>port on which to connect to host for syslog, default is 514 if protocol=udp, 6514 if protocol=tcp</td>
</tr>
<tr>
<td><code>facility</code></td>
<td><code>string</code></td>
<td>kern / user / mail / daemon / auth / syslog / lpr / news / uucp / cron / authpriv / ftp / ntp / security / console / solaris-cron / local0 - local7, default is <code>config</code></td>
</tr>
<tr>
<td><code>severity</code></td>
<td><code>string</code></td>
<td>emerg / alert / crit / err / warning / notice / info / debug, default is <code>info</code></td>
</tr>
<tr>
<td><code>tag</code></td>
<td><code>string</code></td>
<td>optional, tag to attach to log record</td>
</tr>
</tbody>
</table>
<h4 id="rogue-detection-parameters">Rogue Detection Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether or not rogue detection is enabled</td>
</tr>
<tr>
<td><code>honeypot_enabled</code></td>
<td><code>boolean</code></td>
<td>whether or not honeypot detection is enabled</td>
</tr>
<tr>
<td><code>min_rssi</code></td>
<td><code>int</code></td>
<td>minimum RSSI for an AP to be considered neighbor (ignoring APs that’s far away), default is -80. Minimum allowed value is -85.</td>
</tr>
<tr>
<td><code>min_duration</code></td>
<td><code>int</code></td>
<td>minimum duration for a bssid to be considered neighbor, maximum is 59, default is 10</td>
</tr>
<tr>
<td><code>min_rogue_rssi</code></td>
<td><code>int</code></td>
<td>minimum RSSI for an AP to be considered rogue, default is -80. Minimum allowed value is -85.</td>
</tr>
<tr>
<td><code>min_rogue_duration</code></td>
<td><code>int</code></td>
<td>minimum duration for a bssid to be considered rogue, maximum is 59, default is 10</td>
</tr>
<tr>
<td><code>whitelisted_ssids</code></td>
<td><code>list</code></td>
<td>list of SSIDs to whitelist</td>
</tr>
<tr>
<td><code>whitelisted_bssids</code></td>
<td><code>list</code></td>
<td>list of BSSIDs to whitelist</td>
</tr>
<tr>
<td><code>allowed_vlan_ids</code></td>
<td><code>list</code></td>
<td>list of VLAN IDs on which rogue APs are ignored</td>
</tr>
</tbody>
</table>
<h4 id="auto-upgrade-parameters">Auto Upgrade Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether auto upgrade should happen, default is false (Note that Mist may auto-upgrade if the version is not supported)</td>
</tr>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>desired version, beta / stable / custom, default is stable</td>
</tr>
<tr>
<td><code>time_of_day</code></td>
<td><code>string</code></td>
<td>any / HH:MM (24-hour format), upgrade will happen within up to 1-hour from this time</td>
</tr>
<tr>
<td><code>day_of_week</code></td>
<td><code>string</code></td>
<td>any / mon / tue / wed / thu / fri / sat / sun</td>
</tr>
<tr>
<td><code>custom_versions</code></td>
<td><code>object</code></td>
<td>custome versions for different models</td>
</tr>
</tbody>
</table>
<h4 id="engagement-parameters">Engagement Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dwell_tags</code></td>
<td><code>object</code></td>
<td>add tags to visits within the duration (in seconds), available tags (passerby, bounce, engaged, stationed)</td>
</tr>
<tr>
<td><code>max_dwell</code></td>
<td><code>int</code></td>
<td>max time, default is 43200(12h), max is 68400 (18h)</td>
</tr>
<tr>
<td><code>min_dwell</code></td>
<td><code>int</code></td>
<td>min time, default is 0.</td>
</tr>
<tr>
<td><code>hours</code></td>
<td><code>object</code></td>
<td>hours of operation filter, the available days (mon, tue, wed, thu, fri, sat, sun). Note: If the dow is not defined then it’s treated as 00:00-23:59.</td>
</tr>
</tbody>
</table>
<p>NOTE: if <code>hours</code> does not exist, it’s treated as everyday of the week, 00:00-23:59. Currently we don’t allow multiple
ranges for the same day</p>
<p>NOTE: default values for <code>dwell_tags</code>: passerby (1,300) bounce (301, 14400) engaged (14401, 28800) stationed (28801,</p>
<p>42000)</p>
<p>NOTE: default values for <code>dwell_tag_names</code>: passerby = “Passerby”, bounce = “Visitor”, engaged = “Associates”, stationed
= “Assets”</p>
<h4 id="wids">WIDS</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>threshold</code></td>
<td><code>int</code></td>
<td>count of events to trigger</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>window where a trigger will be detected and action to be taken (in seconds)</td>
</tr>
</tbody>
</table>
<h4 id="mist-tunnel">Mist Tunnel</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>hosts</code></td>
<td><code>list</code></td>
<td>hostnames or IPs where a Mist Tunnel will use as the Peer (i.e. they are reachable from AP)</td>
</tr>
<tr>
<td><code>ap_subnets</code></td>
<td><code>list</code></td>
<td>list of subnets where we allow AP to establish Mist Tunnels from</td>
</tr>
<tr>
<td><code>protocol</code></td>
<td><code>list</code></td>
<td>udp / ip, default is udp</td>
</tr>
<tr>
<td><code>vlan_ids</code></td>
<td><code>list</code></td>
<td>list of vlan ids/ranges that will be used</td>
</tr>
<tr>
<td><code>hello_interval</code></td>
<td><code>float</code></td>
<td>in seconds, used as heartbeat to detect if a tunnel is alive. AP will try another peer after missing N hellos specified by <code>hello_retries</code>. between 1 and 300, default is 60 seconds</td>
</tr>
<tr>
<td><code>hello_retries</code></td>
<td><code>int</code></td>
<td>between 2 and 30, default is 7</td>
</tr>
</tbody>
</table>
<h4 id="auto-preemption-parameters">Auto Preemption Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether auto preemption should happen, default is false</td>
</tr>
<tr>
<td><code>time_of_day</code></td>
<td><code>string</code></td>
<td>any / HH:MM (24-hour format)</td>
</tr>
<tr>
<td><code>day_of_week</code></td>
<td><code>string</code></td>
<td>any / mon / tue / wed / thu / fri / sat / sun</td>
</tr>
</tbody>
</table>
<h4 id="switch-related">Switch Related</h4>
<p>Some important / cmmmon properties describing the network topology are captured in the following sections.</p>
<ul>
<li><code>networks</code> defines local network segments (think VLAN) that will be used for the site</li>
<li><code>port_usages</code> defines how physical ports can be used (access/trunk, networks, whether to do dot1x)</li>
<li><code>radius_config</code> defines the RADIUS server configurations if dot1x is being used</li>
<li><code>switch_matching</code> allows definitions of some rules to provision similar swithces with same settings (
  see <a href="https://api.mist.com/api/v1/docs/Site#switch-config">Switch Config</a>)</li>
<li><code>ap_affinity_threshold</code> ap_affinity_threshold can be added as a field under site/setting. By default this value is set to 12. If the field is set in both site/setting and org/setting, the value from site/setting will be used.</li>
<li><code>port_mirroring</code> port_mirroring can be added under site/settings. It takes interface and ports as input for ingress, interface as input for egress and can take interface and port as output.</li>
</ul>
<p>NOTE: names of <code>networks</code> or <code>port_usages</code> can only use a-z, 1-9, _, -, . and up to 32 characters</p>
<h5 id="networks_1">Networks</h5>
<p>A network represents a network segment. It can either represent a VLAN (then usually ties to a L3 subnet), optionally
associate it with a <code>subnet</code> which can later be used to create addition routes. Used for ports
doing <code>family ethernet-switching</code>
It can also be a pure L3-subnet that can then be used against a port that with <code>family inet</code>.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vlan_id</code></td>
<td><code>int</code></td>
<td>vlan the network is on. Usually used by port_usage that does switching</td>
</tr>
<tr>
<td><code>subnet</code></td>
<td><code>string</code></td>
<td>subnet in CIDR format for the network. Optional for a switch port.</td>
</tr>
</tbody>
</table>
<h5 id="port-usage">Port Usage</h5>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>description</code></td>
<td><code>string</code></td>
<td>description</td>
</tr>
<tr>
<td><code>mode</code></td>
<td><code>string</code></td>
<td>access (default) / trunk</td>
</tr>
<tr>
<td><code>disabled</code></td>
<td><code>bool</code></td>
<td>whether the port is disabled, default is false</td>
</tr>
<tr>
<td><code>all_networks</code></td>
<td><code>bool</code></td>
<td>if mode=trunk, whether to trunk all network/vlans, default is false</td>
</tr>
<tr>
<td><code>networks</code></td>
<td><code>list</code></td>
<td>if mode=trunk, the list of network/vlans</td>
</tr>
<tr>
<td><code>port_network</code></td>
<td><code>string</code></td>
<td>native network/vlan for untagged traffic</td>
</tr>
<tr>
<td><code>stp_edge</code></td>
<td><code>string</code></td>
<td>when enabled, the port is not expected to receive BPDU frames</td>
</tr>
<tr>
<td><code>server_reject_network</code></td>
<td><code>string</code></td>
<td>when radius server reject / fails</td>
</tr>
<tr>
<td><code>mac_auth_preferred</code></td>
<td><code>bool</code></td>
<td>sets the order of authenticator.</td>
</tr>
<tr>
<td><code>server_fail_network</code></td>
<td><code>string</code></td>
<td>sets server fail fallback vlan</td>
</tr>
<tr>
<td><code>voip_network</code></td>
<td><code>string</code></td>
<td>network/vlan for voip traffic, must also set <code>port_network</code>. to authenticate device, set <code>port_auth</code></td>
</tr>
<tr>
<td><code>port_auth</code></td>
<td><code>string</code></td>
<td>if dot1x is desired, set to <code>dot1x</code></td>
</tr>
<tr>
<td><code>enable_mac_auth</code></td>
<td><code>bool</code></td>
<td>if port_auth=dot1x, whether to enable MAC Auth</td>
</tr>
<tr>
<td><code>mac_auth_only</code></td>
<td><code>bool</code></td>
<td>if enable_mac_auth is set to True, this option is used to restrict authentication to use mac radius only. This will take priority over mac_auth_preferred.</td>
</tr>
<tr>
<td><code>mac_auth_protocol</code></td>
<td><code>bool</code></td>
<td>if enable_mac_auth is set to True, this enables users to choose an authentication protocol among pap, eap-peap, and eap-md5. This type is ignored if mist_nac is enabled.</td>
</tr>
<tr>
<td><code>guest_network</code></td>
<td><code>string</code></td>
<td>if port_auth=dot1x, which network to put the device into if the device cannot do dot1x. default is null (i.e. not allowed)</td>
</tr>
<tr>
<td><code>reauth_interval</code></td>
<td><code>int</code></td>
<td>if port_auth=dot1x, reauthentication interval range: 10-65535, default is 3600</td>
</tr>
<tr>
<td><code>bypass_auth_when_server_down</code></td>
<td><code>bool</code></td>
<td>if port_auth=dot1x, bypass auth for known clients if set to true when RADIUS server is down</td>
</tr>
<tr>
<td><code>bypass_auth_when_server_down_for_unknown_client</code></td>
<td><code>bool</code></td>
<td>if port_auth=dot1x, bypass auth for all (including unknown clients) if set to true when RADIUS server is down,</td>
</tr>
<tr>
<td><code>speed</code></td>
<td><code>string</code></td>
<td>speed, default is auto to automatically negotiate speed</td>
</tr>
<tr>
<td><code>duplex</code></td>
<td><code>string</code></td>
<td>link connection mode, choices are auto (default), full, and half</td>
</tr>
<tr>
<td><code>disable_autoneg</code></td>
<td><code>bool</code></td>
<td>if <code>speed</code> and <code>duplex</code> are specified, whether to disable autonegotiation, default is false</td>
</tr>
<tr>
<td><code>mac_limit</code></td>
<td><code>int</code></td>
<td>max number of mac addresses, default is 0 for unlimited, otherwise range is 1 or higher, with upper bound constrained by platform</td>
</tr>
<tr>
<td><code>persist_mac</code></td>
<td><code>bool</code></td>
<td>if mode=access and port_auth!=dot1x, whether the port should retain dynamically learned MAC addresses, default is false</td>
</tr>
<tr>
<td><code>poe_disabled</code></td>
<td><code>bool</code></td>
<td>whether PoE capabilities are disabled for a port, default is false</td>
</tr>
<tr>
<td><code>storm_control</code></td>
<td><code>object</code></td>
<td>storm-control-profile settings</td>
</tr>
<tr>
<td><code>mtu</code></td>
<td><code>int</code></td>
<td>media maximum transmission unit (MTU) is the largest data unit that can be forwarded without fragmentation. The default value is 1514.</td>
</tr>
<tr>
<td><code>enable_qos</code></td>
<td><code>bool</code></td>
<td>whether QoS is enabled, default is false. When QoS is enabled, the default QoS setting is applied.</td>
</tr>
<tr>
<td><code>allow_dhcpd</code></td>
<td><code>bool</code></td>
<td>whether DHCP server is allowed on the interfaces with. All the interfaces from</td>
</tr>
<tr>
<td>port configs using this port usage are effected. Please notice that allow_dhcpd is a tri-state.</td>
<td></td>
<td></td>
</tr>
<tr>
<td>When it is not defined, it means using the system’s default setting which depends on whether the port is a access or trunk port</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h6 id="storm-control">Storm Control</h6>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>percentage</code></td>
<td><code>int</code></td>
<td>bandwidth-percentage, configures the storm control level as a percentage of the available bandwidth, default is 80</td>
</tr>
<tr>
<td><code>no_broadcast</code></td>
<td><code>bool</code></td>
<td>whether to disable storm control on broadcast traffic, default is false</td>
</tr>
<tr>
<td><code>no_unknown_unicast</code></td>
<td><code>bool</code></td>
<td>whether to disable storm control on unknown unicast traffic, default is false</td>
</tr>
<tr>
<td><code>no_multicast</code></td>
<td><code>bool</code></td>
<td>whether to disable storm control on multicast traffic, default is false</td>
</tr>
<tr>
<td><code>no_registered_multicast</code></td>
<td><code>bool</code></td>
<td>whether to disable storm control on registered multicast traffic, default is false</td>
</tr>
</tbody>
</table>
<h5 id="switch-matching">Switch Matching</h5>
<p>In many scenarios, people have conventions like having port ge-0/0/0 as uplink, ge-0/0/5-42 for user devices, … for
many switches in the same site. While it’s achievable by doing Switch Config on each of them, switch_matching allows
them to use same setting by matching name/model/role.</p>
<p>Supported attributes: port_config, ip_config, oob_ip_config, uplink_port_config, additional_config_cmds</p>
<h5 id="dynamic-port-config-parameters">Dynamic Port Config Parameters</h5>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>lldp_chassis_id</code></td>
<td><code>string</code></td>
<td>MAC address of LLDP neighbor</td>
</tr>
<tr>
<td><code>lldp_system_name</code></td>
<td><code>string</code></td>
<td>system name of LLDP neighbor</td>
</tr>
<tr>
<td><code>lldp_serial_number</code></td>
<td><code>string</code></td>
<td>Serial number of LLDP neighbor</td>
</tr>
<tr>
<td><code>lldp_hardware_revision</code></td>
<td><code>string</code></td>
<td>Hardware revision of LLDP neighbor</td>
</tr>
<tr>
<td><code>lldp_manufacturer_name</code></td>
<td><code>string</code></td>
<td>The manufacturer of LLDP neighbor</td>
</tr>
<tr>
<td><code>lldp_oui</code></td>
<td><code>string</code></td>
<td>The OUI of LLDP neighbor</td>
</tr>
<tr>
<td><code>radius_username</code></td>
<td><code>string</code></td>
<td>The username of the connected supplicant.</td>
</tr>
<tr>
<td><code>radius_usermac</code></td>
<td><code>string</code></td>
<td>The MAC address of the connected supplicant.</td>
</tr>
<tr>
<td><code>radius_dynamicfilter</code></td>
<td><code>string</code></td>
<td>User policy filter sent by the RADIUS server.</td>
</tr>
<tr>
<td><code>link_peermac</code></td>
<td><code>string</code></td>
<td>MAC address of the device directly connected to a port.</td>
</tr>
</tbody>
</table>
<h5 id="switch-and-gateway-ospf-areas">Switch and Gateway OSPF Areas</h5>
<p>OSPF Areas can be configured both in Site Level (Switch/Gateway Template) or Device (Switch/Gateway) Level</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ospf_areas</code></td>
<td><code>object</code></td>
<td>OSPF areas, key is the area id</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>OSPF type, default (default) / stub / nssa</td>
</tr>
<tr>
<td><code>networks</code></td>
<td><code>object</code></td>
<td>networks to participate in an OSPF area, key is the network name</td>
</tr>
<tr>
<td><code>passive'</code></td>
<td><code>bool</code></td>
<td>whether to send OSPF-Hello, default is false</td>
</tr>
<tr>
<td><code>auth_type</code></td>
<td><code>string</code></td>
<td>auth type, none (default) / md5 / password</td>
</tr>
<tr>
<td><code>auth_keys</code></td>
<td><code>object</code></td>
<td>if auth_type==’md5’, the md5 keys</td>
</tr>
<tr>
<td><code>auth_password</code></td>
<td><code>string</code></td>
<td>if auth_type==’password’, the password, max length is 8</td>
</tr>
<tr>
<td><code>interface_type</code></td>
<td><code>string</code></td>
<td>interface type, broadcast / nbma (non-broadcast multi-access) / p2p / p2mp, default is <code>broadcast</code></td>
</tr>
</tbody>
</table>
<h2 id="create-site-whitelistblacklist-client-list">Create Site Whitelist/Blacklist Client List</h2>
<p>This endpoint is to provide list of client macs for annotation as whitelist, blacklist or watched station.</p>
<p>Retrieve the current clients list from ‘whitelist_url’, blacklist_url, or watched_station_url under <a href="https://api.mist.com/api/v1/docs/Site#site-setting">Site:Setting</a></p>
<pre><code>POST /api/v1/sites/:site_id/setting/blacklist
POST /api/v1/sites/:site_id/setting/whitelist
POST /api/v1/sites/:site_id/setting/watched_station
</code></pre>
<h3 id="example_14">Example</h3>
<pre><code>{
    "macs": [
        "18-65-90-de-f4-c6",
        "84-89-ad-5d-69-0d"
    ]
}
</code></pre>
<h2 id="delete-site-whitelistblacklistwatched-station-clients">Delete Site Whitelist/Blacklist/Watched Station Clients</h2>
<p>This is to remove the client annotation list</p>
<pre><code>DELETE /api/v1/sites/:site_id/setting/blacklist
DELETE /api/v1/sites/:site_id/setting/whitelist
DELETE /api/v1/sites/:site_id/setting/watched_station
</code></pre>
<h1 id="ui-setting">UI Setting</h1>
<p>Site UI settings</p>
<pre><code>GET /api/v1/sites/:site_id/uisettings
POST /api/v1/sites/:site_id/uisettings

GET /api/v1/sites/:site_id/uisettings/:uisetting_id
PUT /api/v1/sites/:site_id/uisettings/:uisetting_id
DELETE /api/v1/sites/:site_id/uisettings/:uisetting_id
</code></pre>
<h3 id="response_101">Response</h3>
<pre><code>{
    {
        "isScopeLinked": true,
        "defaultScopeId": "67970e46-4e12-11e6-9188-0242ad112847",
        "name": "New Databoard",
        "defaultScopeType": "site",
        "isCustomDataboard": true,
        "isTimeRangeLinked": true,
        "tiles": [
            {
                "sortedColumns": null,
                "rowspan": 2,
                "chartBand": "2.4 ghz",
                "name": "New Analysis",
                "column": 1,
                "colspan": 5,
                "metric": {
                    "apiName": "client-dhcp-latency"
                },
                "timeRange": {
                    "end": 1508823743,
                    "name": "Past 7 Days",
                    "interval": "1d",
                    "start": 1508223600,
                    "usePreset": true,
                    "endDate": "10/23/2017",
                    "shortName": "7d"
                },
                "chartDirection": "tx + rx",
                "chartRankBy": "",
                "scopeType": "client",
                "hideEmptyRows": true,
                "scopeId": "e0c767834b4c",
                "chartType": "timeSeries",
                "vizType": "averageTimeSeriesChart",
                "row": 1,
                "trendType": "line",
                "id": "7a9ab38c-cfc3-483d-b51a-0aec571fadc0-j956nurl",
                "chartColor": "#00B4AD"
            }
        ],
        "defaultTimeRange": {
            "end": 1508828400,
            "name": "This Week",
            "interval": "1d",
            "start": 1508655600,
            "usePreset": true,
            "endDate": "10/23/2017",
            "shortName": "thisWeek"
        },
        "description": "Description of the databoard",
        "id": "3bdcc7e8-c04d-4512-b4fc-093da9057eb0",
        "for_site": true,
        "site_id": "67970e46-4e12-11e6-9188-0242ad112847",
        "org_id": "6748cfa6-4e12-11e6-9188-0242asfad8365",
        "created_time": 1508823803,
        "modified_time": 1508823803,
        "purpose": "databoard"
    },

}
</code></pre>
<h2 id="get-derived-ui-setting">GET derived UI Setting</h2>
<p>Get both site UI settings(for_site=true) and org UI settings (for_site=false)</p>
<pre><code>GET /api/v1/sites/:site_id/uisettings/derived
</code></pre>
<h2 id="get-license-usage">Get License Usage</h2>
<p>This shows license usage (i.e. needed) based on the features enabled for the site.</p>
<pre><code>GET /api/v1/sites/:site_id/licenses/usages
</code></pre>
<h3 id="response_102">Response</h3>
<pre><code>{
    "usages": {
        "SUB-MAN": 60
        "SUB-LOC": 30
    },
    "org_entitled": {
        "SUB-MAN": 60
        "SUB-LOC": 30
    },
    "trial_enabled": false,
    "vna_ui": false,
    "vna_eligible": false,
    "svna_eligible": false,
    "wvna_eligible": false
}
</code></pre>
<h3 id="definitions_4">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>usages</code></td>
<td><code>object</code></td>
<td>subscriptions and their quantities</td>
</tr>
<tr>
<td><code>org_entitled</code></td>
<td><code>object</code></td>
<td>license entitlement for the entire org</td>
</tr>
<tr>
<td><code>vna_ui</code></td>
<td><code>object</code></td>
<td>if True, Conversational Assistant and Marvis Action available</td>
</tr>
<tr>
<td><code>vna_eligible</code></td>
<td><code>boolean</code></td>
<td>eligibility for the AP/Client SLE</td>
</tr>
<tr>
<td><code>svna_eligible</code></td>
<td><code>boolean</code></td>
<td>eligibility for the Switch SLE</td>
</tr>
<tr>
<td><code>wvna_eligible</code></td>
<td><code>boolean</code></td>
<td>eligibility for the WAN SLE</td>
</tr>
</tbody>
</table>
<h2 id="get-otherdevice">Get OtherDevice</h2>
<p>This API is called to view the other devices (3rd party devices) for a specific site.</p>
<pre><code>GET /api/v1/sites/:site_id/otherdevices?vendor=:vendor
</code></pre>
<h3 id="response_103">Response</h3>
<pre><code>[
    {
        "vendor" : "cradlepoint",
        "mac" : "5c5b35000018",
        "serial" : "FXLH2015150025",
        "model" : "AP41",
        "name" : "hallway",
        "site_id" : "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
        "device_mac" : "001122334455"
    }
]
</code></pre>
<h3 id="definitions_5">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vendor</code></td>
<td><code>string</code></td>
<td>the vendor</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>the mac address</td>
</tr>
<tr>
<td><code>serial</code></td>
<td><code>string</code></td>
<td>the device’s serial number</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>the model of the device</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>the name of the device</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>the site id where the device is located</td>
</tr>
<tr>
<td><code>device_mac</code></td>
<td><code>string</code></td>
<td>the device mac</td>
</tr>
</tbody>
</table>
<h1 id="webhooks">Webhooks</h1>
<p>Webhook defines a webhook, modeled after github’s model (https://developer.github.com/webhooks/)
See available webhook topic definitions in <code>GET /api/v1/const/webhook_topics</code></p>
<h3 id="base-uri_12">Base URI</h3>
<pre><code>/api/v1/sites/:site_id/webhooks
</code></pre>
<h3 id="example-of-http-post-webhook">Example of http-post Webhook</h3>
<pre><code>{
    "name": "analytic",
    "type": "http-post",
    "url": "https://username:password@hooks.abc.com/uri/...",
    "secret": "secret",
    "headers":{
        "x-custom-1": "your_custom_header_value1",
        "x-custom-2": "your_custom_header_value2"
    },
    "verify_cert": false,
    "enabled": true,
    "topics": [
        "alarms",
        "asset-raw",
        "asset-raw-rssi",
        "audits",
        "client-info",
        "client-join",
        "client-latency",
        "client-sessions",
        "device-events",
        "device-updowns",
        "guest-authorizations",
        "location",
        "location-asset",
        "location-client",
        "location-sdk",
        "location-unclient",
        "location-centrak"
        "mxedge-events",
        "nac-accounting",
        "nac-events",
        "occupancy-alerts",
        "rssizone",
        "sdkclient-scan-data",
        "site-sle",
        "vbeacon",
        "zone",
    ],
    "single_event_per_message": false,
    "assetfilter_ids": [
        "e06ecc2a-e75b-49bb-b9ea-b0e650cc8072",
        "0d04d6be-8a00-48c6-ae79-38ff14450098",
        "a73b4be2-66ea-4951-aa6c-9e63e1a3635f",
    ]
}
</code></pre>
<h3 id="example-of-splunk-webhook">Example of Splunk Webhook</h3>
<pre><code>{

    "name": "splunk-mist-alarms",
    "type": "splunk",
    "url": "https://my.splunk.host:8088/services/collector",
    "splunk_token": "7d34bcab-7d3d-49d8-adcf-67747e1f3704",
    "verify_cert": false,
    "enabled": true,
    "single_event_per_message": false,
    "topics": [ "location", "zone", "vbeacon", "rssizone", "asset-raw" ]
}
</code></pre>
<h3 id="parameters_77">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name of the webhook</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether webhook is enabled</td>
</tr>
<tr>
<td><code>topics</code></td>
<td><code>list</code></td>
<td>list of subscribed topics: alarms/asset-raw/audits/client-info/client-join/client-latency/client-sessions/device-events/device-updowns/guest-authorizations/location/mxedge-events/nac-accounting/nac-events/occupancy-alerts/rssizone/sdkclient-scan-data/vbeacon/zone</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>http-post (default) / splunk / oauth2</td>
</tr>
<tr>
<td><code>url</code></td>
<td><code>string</code></td>
<td>url</td>
</tr>
<tr>
<td><code>verify_cert</code></td>
<td><code>boolean</code></td>
<td>when <code>url</code> uses HTTPS, whether to verify the certificate, default is true</td>
</tr>
<tr>
<td><code>headers</code></td>
<td><code>object</code></td>
<td>optional, when type=http-post, if provided, additional custom HTTP headers will be added. the headers name and value must be string, total bytes of headers name and value must be less than 1000</td>
</tr>
<tr>
<td><code>secret</code></td>
<td><code>string</code></td>
<td>optional, when type=http-post, if provided, additional signature HTTP headers will be added (see note below)</td>
</tr>
<tr>
<td><code>splunk_token</code></td>
<td><code>string</code></td>
<td>splunk token, required when type=splunk (If splunk_token is not defined for a type Splunk webhook, it will not send, regardless if the webhook receiver is configured to accept it.)</td>
</tr>
<tr>
<td><code>oauth2_grant_type</code></td>
<td><code>string</code></td>
<td>client_credentials / password, required when type=oauth2 (see note below)</td>
</tr>
<tr>
<td><code>oauth2_token_url</code></td>
<td><code>string</code></td>
<td>required when type=oauth2</td>
</tr>
<tr>
<td><code>oauth2_client_id</code></td>
<td><code>string</code></td>
<td>required when oauth2_grant_type=client_credentials</td>
</tr>
<tr>
<td><code>oauth2_client_secret</code></td>
<td><code>string</code></td>
<td>required when oauth2_grant_type=client_credentials</td>
</tr>
<tr>
<td><code>oauth2_username</code></td>
<td><code>string</code></td>
<td>required when oauth2_grant_type=password</td>
</tr>
<tr>
<td><code>oauth2_password</code></td>
<td><code>string</code></td>
<td>required when oauth2_grant_type=password</td>
</tr>
<tr>
<td><code>oauth2_scopes</code></td>
<td><code>list</code></td>
<td>optional, when type=oauth2, if provided, will be used in the token request</td>
</tr>
<tr>
<td><code>single_event_per_message</code></td>
<td><code>boolean</code></td>
<td>optional. default is false. sometimes it’s not trivial/possible to parse multiple events from a single message (e.g. IBM Qradar, DSM), when enabled, only a single event will be sent per message. this feature is only available on certain topics - const/webhook_topics</td>
</tr>
<tr>
<td><code>assetfilter_ids</code></td>
<td><code>list</code></td>
<td>list of ids to associated asset filters. These filters will be applied to messages routed to a filtered-asset-rssi webhook</td>
</tr>
</tbody>
</table>
<p>NOTE:
* when <code>secret</code> is provided, two HTTP headers will be added:
    - <code>X-Mist-Signature-v2</code>: HMAC_SHA256(secret, body)
    - <code>X-Mist-Signature</code>: HMAC_SHA1(secret, body)
* If <code>headers</code> format is invalid, “X-Mist-Error”: “headers format invalid” will be sent.
* If total bytes of <code>headers</code> exceed 1000, “X-Mist-Error”: “headers too big” will be sent.
* If any header value is not <code>string</code>, “X-Mist-Error”: “header[%s] not a string” will be sent.
* For <code>oauth2_grant_type</code>, Client Credentials Grant (<code>client_credentials</code>) and Resource Owner Password Credentials Grant (<code>password</code>) are supported.
* <code>asset-raw</code> will be deprecated after 06/30/2024
* <code>client-latency</code> is supported only to customers who have sufficient SUB-VNA license.</p>
<h3 id="example-delivery-of-location-via-http-post">Example Delivery of Location via http-post</h3>
<pre><code>POST /uri/... HTTP/1.1

Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 615
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e

{
    "topic": "location",
    "events": [
        {
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
            "x": 13.5,
            "y": 3.2,
            "timestamp": 1461220784,

            // for SDK client
            "type": "sdk",
            "id": "de87bf9d-183f-e383-cc68-6ba43947d403",
            "name": "optional",

            // for WIFI
            "type": "wifi",
            "mac": "5684dae9ac8b",
            // Optional for wifi
            "wifi_beacon_extended_info": [
                {"frame_ctrl": 776, "seq_ctrl": 772, "payload": "............"},
            ]

            // for ASSET
            "type": "asset",
            "mac": "7fc2936fd243",
            "ibeacon_uuid": "f3f17139-704a-f03a-2786-0400279e37c3",
            "ibeacon_major": 13,
            "ibeacon_minor": 138,
            "eddystone_uid_namespace": "2818e3868dec25629ede",
            "eddystone_uid_instance": "5c5b35000001",
            "eddystone_url_url": "https://www.abc.com",
            "mfg_company_id": 935,
            "mfg_data": "648520a1020000",

            "battery_voltage": 3370
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>topic</code></td>
<td><code>string</code></td>
<td>topic subscribed to</td>
</tr>
<tr>
<td><code>events</code></td>
<td><code>list</code></td>
<td>list of events</td>
</tr>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>unique id of the client (a client would have different id for different org)</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map id</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>float</code></td>
<td>x, in meter</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>float</code></td>
<td>y, in meter</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name of the client, may be empty</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>int</code></td>
<td>timestamp of the event, epoch</td>
</tr>
<tr>
<td><code>mfg_company_id</code></td>
<td><code>int</code></td>
<td>optional, BLE manufacturing company ID</td>
</tr>
<tr>
<td><code>mfg_data</code></td>
<td><code>string</code></td>
<td>optional, BLE manufacturing data in hex byte-string format (ie: “112233AABBCC”)</td>
</tr>
<tr>
<td><code>wifi_beacon_extended_info</code></td>
<td><code>list</code></td>
<td>optional, list of extended beacon info packets heard from the client, frame and sequence control included with the payload</td>
</tr>
<tr>
<td><code>frame_ctrl</code></td>
<td><code>int</code></td>
<td>subfield of <code>wifi_beacon_extended_info</code>. frame control field of 802.11 header</td>
</tr>
<tr>
<td><code>seq_ctrl</code></td>
<td><code>int</code></td>
<td>subfield of <code>wifi_beacon_extended_info</code>. sequence control field of 802.11 header</td>
</tr>
<tr>
<td><code>payload</code></td>
<td><code>string</code></td>
<td>subfield of <code>wifi_beacon_extended_info</code>. Extended Info Payload associated with frame</td>
</tr>
</tbody>
</table>
<h3 id="example-delivery-of-location-asset-via-http-post">Example Delivery of Location Asset via http-post</h3>
<pre><code>POST /uri/... HTTP/1.1

Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 615
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e

{
    "topic": "location-asset",
    "events": [
        {
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
            "x": 13.5,
            "y": 3.2,
            "timestamp": 1461220784,

            // for ASSET
            "type": "asset",
            "mac": "7fc2936fd243",
            "ibeacon_uuid": "f3f17139-704a-f03a-2786-0400279e37c3",
            "ibeacon_major": 13,
            "ibeacon_minor": 138,
            "eddystone_uid_namespace": "2818e3868dec25629ede",
            "eddystone_uid_instance": "5c5b35000001",
            "eddystone_url_url": "https://www.abc.com",
            "mfg_company_id": 935,
            "mfg_data": "648520a1020000",

            "battery_voltage": 3370
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>topic</code></td>
<td><code>string</code></td>
<td>topic subscribed to</td>
</tr>
<tr>
<td><code>events</code></td>
<td><code>list</code></td>
<td>list of events</td>
</tr>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>unique id of the client (a client would have different id for different org)</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map id</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>float</code></td>
<td>x, in meter</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>float</code></td>
<td>y, in meter</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name of the client, may be empty</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>int</code></td>
<td>timestamp of the event, epoch</td>
</tr>
</tbody>
</table>
<h3 id="example-delivery-of-location-client-via-http-post">Example Delivery of Location Client via http-post</h3>
<pre><code>POST /uri/... HTTP/1.1

Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 615
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e

{
    "topic": "location-client",
    "events": [
        {
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
            "x": 13.5,
            "y": 3.2,
            "timestamp": 1461220784,

            // for WIFI
            "type": "wifi",
            "mac": "5684dae9ac8b",
            // Optional for wifi
            "wifi_beacon_extended_info": [
                {"frame_ctrl": 776, "seq_ctrl": 772, "payload": "............"},
            ]
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>topic</code></td>
<td><code>string</code></td>
<td>topic subscribed to</td>
</tr>
<tr>
<td><code>events</code></td>
<td><code>list</code></td>
<td>list of events</td>
</tr>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>unique id of the client (a client would have different id for different org)</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map id</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>float</code></td>
<td>x, in meter</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>float</code></td>
<td>y, in meter</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name of the client, may be empty</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>int</code></td>
<td>timestamp of the event, epoch</td>
</tr>
<tr>
<td><code>mfg_company_id</code></td>
<td><code>int</code></td>
<td>optional, BLE manufacturing company ID</td>
</tr>
<tr>
<td><code>mfg_data</code></td>
<td><code>string</code></td>
<td>optional, BLE manufacturing data in hex byte-string format (ie: “112233AABBCC”)</td>
</tr>
<tr>
<td><code>wifi_beacon_extended_info</code></td>
<td><code>list</code></td>
<td>optional, list of extended beacon info packets heard from the client, frame and sequence control included with the payload</td>
</tr>
<tr>
<td><code>frame_ctrl</code></td>
<td><code>int</code></td>
<td>subfield of <code>wifi_beacon_extended_info</code>. frame control field of 802.11 header</td>
</tr>
<tr>
<td><code>seq_ctrl</code></td>
<td><code>int</code></td>
<td>subfield of <code>wifi_beacon_extended_info</code>. sequence control field of 802.11 header</td>
</tr>
<tr>
<td><code>payload</code></td>
<td><code>string</code></td>
<td>subfield of <code>wifi_beacon_extended_info</code>. Extended Info Payload associated with frame</td>
</tr>
</tbody>
</table>
<h3 id="example-delivery-of-location-sdk-via-http-post">Example Delivery of Location SDK via http-post</h3>
<pre><code>POST /uri/... HTTP/1.1

Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 615
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e

{
    "topic": "location-sdk",
    "events": [
        {
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
            "x": 13.5,
            "y": 3.2,
            "timestamp": 1461220784,

            // for SDK client
            "type": "sdk",
            "id": "de87bf9d-183f-e383-cc68-6ba43947d403",
            "name": "optional",
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>topic</code></td>
<td><code>string</code></td>
<td>topic subscribed to</td>
</tr>
<tr>
<td><code>events</code></td>
<td><code>list</code></td>
<td>list of events</td>
</tr>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>unique id of the client (a client would have different id for different org)</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map id</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>float</code></td>
<td>x, in meter</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>float</code></td>
<td>y, in meter</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name of the client, may be empty</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>int</code></td>
<td>timestamp of the event, epoch</td>
</tr>
</tbody>
</table>
<h3 id="example-delivery-of-location-unconnected-client-via-http-post">Example Delivery of Location Unconnected Client via http-post</h3>
<pre><code>POST /uri/... HTTP/1.1

Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 615
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e

{
    "topic": "location-unclient",
    "events": [
        {
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
            "x": 13.5,
            "y": 3.2,
            "timestamp": 1461220784,

            // for WIFI
            "type": "wifi",
            "mac": "5684dae9ac8b",
            // Optional for wifi
            "wifi_beacon_extended_info": [
                {"frame_ctrl": 776, "seq_ctrl": 772, "payload": "............"},
            ]
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>topic</code></td>
<td><code>string</code></td>
<td>topic subscribed to</td>
</tr>
<tr>
<td><code>events</code></td>
<td><code>list</code></td>
<td>list of events</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map id</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>float</code></td>
<td>x, in meter</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>float</code></td>
<td>y, in meter</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>int</code></td>
<td>timestamp of the event, epoch</td>
</tr>
<tr>
<td><code>mfg_company_id</code></td>
<td><code>int</code></td>
<td>optional, BLE manufacturing company ID</td>
</tr>
<tr>
<td><code>mfg_data</code></td>
<td><code>string</code></td>
<td>optional, BLE manufacturing data in hex byte-string format (ie: “112233AABBCC”)</td>
</tr>
<tr>
<td><code>wifi_beacon_extended_info</code></td>
<td><code>list</code></td>
<td>optional, list of extended beacon info packets heard from the client, frame and sequence control included with the payload</td>
</tr>
<tr>
<td><code>frame_ctrl</code></td>
<td><code>int</code></td>
<td>subfield of <code>wifi_beacon_extended_info</code>. frame control field of 802.11 header</td>
</tr>
<tr>
<td><code>seq_ctrl</code></td>
<td><code>int</code></td>
<td>subfield of <code>wifi_beacon_extended_info</code>. sequence control field of 802.11 header</td>
</tr>
<tr>
<td><code>payload</code></td>
<td><code>string</code></td>
<td>subfield of <code>wifi_beacon_extended_info</code>. Extended Info Payload associated with frame</td>
</tr>
</tbody>
</table>
<h3 id="example-delivery-of-location-centrak-via-http-post">Example Delivery of Location Centrak via http-post</h3>
<pre><code>POST /uri/... HTTP/1.1

Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 615
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e

{
    "topic": "location-centrak",
    "events": [
        {
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
            "x": 13.5,
            "y": 3.2,
            "timestamp": 1461220784,

            // for WIFI
            "type": "wifi",
            "mac": "5684dae9ac8b",
            // Optional for wifi
            "wifi_beacon_extended_info": [
                {"frame_ctrl": 776, "seq_ctrl": 772, "payload": "............"},
            ]
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>topic</code></td>
<td><code>string</code></td>
<td>topic subscribed to</td>
</tr>
<tr>
<td><code>events</code></td>
<td><code>list</code></td>
<td>list of events</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map id</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>float</code></td>
<td>x, in meter</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>float</code></td>
<td>y, in meter</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>int</code></td>
<td>timestamp of the event, epoch</td>
</tr>
<tr>
<td><code>mfg_company_id</code></td>
<td><code>int</code></td>
<td>optional, BLE manufacturing company ID</td>
</tr>
<tr>
<td><code>mfg_data</code></td>
<td><code>string</code></td>
<td>optional, BLE manufacturing data in hex byte-string format (ie: “112233AABBCC”)</td>
</tr>
<tr>
<td><code>wifi_beacon_extended_info</code></td>
<td><code>list</code></td>
<td>optional, list of extended beacon info packets heard from the client, frame and sequence control included with the payload</td>
</tr>
<tr>
<td><code>frame_ctrl</code></td>
<td><code>int</code></td>
<td>subfield of <code>wifi_beacon_extended_info</code>. frame control field of 802.11 header</td>
</tr>
<tr>
<td><code>seq_ctrl</code></td>
<td><code>int</code></td>
<td>subfield of <code>wifi_beacon_extended_info</code>. sequence control field of 802.11 header</td>
</tr>
<tr>
<td><code>payload</code></td>
<td><code>string</code></td>
<td>subfield of <code>wifi_beacon_extended_info</code>. Extended Info Payload associated with frame</td>
</tr>
</tbody>
</table>
<h3 id="example-delivery-of-zone-via-http-post">Example Delivery of Zone via http-post</h3>
<pre><code>POST /uri/... HTTP/1.1

Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 615
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e

{
    "topic": "zone",
    "events": [
        {
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
            "zone_id": "8ac84899-32db-6327-334c-9b6d58544cfe",
            "trigger": "enter",
            "timestamp": 1461220784,

            // for SDK client
            "type": "sdk",
            "id": "de87bf9d-183f-e383-cc68-6ba43947d403",
            "name": "optional",

            // for WIFI
            "type": "wifi",
            "mac": "5684dae9ac8b",

            // for ASSET
            "type": "asset",
            "mac": "7fc2936fd243",
            "asset_id": "c180b858-8f39-11e7-a7a5-346895ed1b7d"
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>topic</code></td>
<td><code>string</code></td>
<td>topic subscribed to</td>
</tr>
<tr>
<td><code>events</code></td>
<td><code>list</code></td>
<td>list of events</td>
</tr>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>uuid of SDK-client</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name of the client, may be empty</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map id</td>
</tr>
<tr>
<td><code>zone_id</code></td>
<td><code>string</code></td>
<td>zone id</td>
</tr>
<tr>
<td><code>trigger</code></td>
<td><code>string</code></td>
<td>enter / exit</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>int</code></td>
<td>timestamp of the event, epoch</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>mac address of wifi client or asset</td>
</tr>
<tr>
<td><code>asset_id</code></td>
<td><code>string</code></td>
<td>uuid of named asset</td>
</tr>
</tbody>
</table>
<h3 id="example-delivery-of-asset-raw-via-http-post">Example Delivery of “asset-raw” via http-post</h3>
<h3 id="asset-raw-will-be-deprecated-after-06302024"><code>asset-raw</code> will be deprecated after 06/30/2024</h3>
<pre><code>POST /uri/... HTTP/1.1

Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 615
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e

{
    "topic": "asset-raw",
    "events": [
        {
            "asset_id": "b02c9cdb-6076-451a-b307-163d7d521c54",
            "beam": 1,
            "device_id": "00000000-0000-0000-1000-d420b012cc02",
            "ibeacon_major": 0,
            "ibeacon_minor": 0,
            "ibeacon_uuid": "0000fe6a-0000-1000-8000-00805f9b43bf",
            "mac": "fbc721cc3020",
            "map_id": "bd42f0c3-2e6a-4f8a-ac2d-d34e268c14812",
            "rssi": -74.5,
            "service_data_data": "020b0204310075754d572345",
            "service_data_last_rx_time": 1653003157,
            "service_data_rx_cnt": 20269,
            "service_data_uuid": "0000fe6a-0000-1000-8000-00805f9b35cb",
            "site_id": "2ebaff09-0fe6-1ebb-be1b-b8e3ce083d67",
            "timestamp": 1653003784
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>topic</code></td>
<td><code>string</code></td>
<td>topic subscribed to</td>
</tr>
<tr>
<td><code>events</code></td>
<td><code>list</code></td>
<td>list of events</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map id</td>
</tr>
<tr>
<td><code>device_id</code></td>
<td><code>string</code></td>
<td>device where the asset reading is from</td>
</tr>
<tr>
<td><code>beam</code></td>
<td><code>int</code></td>
<td>antenna index, from 1-8, clock-wise starting from the LED</td>
</tr>
<tr>
<td><code>rssi</code></td>
<td><code>float</code></td>
<td>signal strength</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>MAC of the beacon</td>
</tr>
<tr>
<td><code>asset_id</code></td>
<td><code>string</code></td>
<td>asset id</td>
</tr>
<tr>
<td><code>ibeacon_uuid</code></td>
<td><code>string</code></td>
<td>iBeacon UUID</td>
</tr>
<tr>
<td><code>ibeacon_major</code></td>
<td><code>string</code></td>
<td>iBeacon major</td>
</tr>
<tr>
<td><code>ibeacon_minor</code></td>
<td><code>string</code></td>
<td>iBeacon minor</td>
</tr>
<tr>
<td><code>mfg_company_id</code></td>
<td><code>int</code></td>
<td>optional, BLE manufacturing company ID</td>
</tr>
<tr>
<td><code>mfg_data</code></td>
<td><code>string</code></td>
<td>optional, BLE manufacturing data in hex byte-string format (ie: “112233AABBCC”)</td>
</tr>
<tr>
<td><code>service_data_data</code></td>
<td><code>string</code></td>
<td>optional, data from service data</td>
</tr>
<tr>
<td><code>service_data_last_rx_time</code></td>
<td><code>int</code></td>
<td>optional, last data transmit time from service data</td>
</tr>
<tr>
<td><code>service_data_rx_cnt</code></td>
<td><code>int</code></td>
<td>optional, data transmit count from service data</td>
</tr>
<tr>
<td><code>service_data_uuid</code></td>
<td><code>string</code></td>
<td>optional, UUID from service data</td>
</tr>
</tbody>
</table>
<h3 id="example-delivery-of-device-events">Example Delivery of device-events</h3>
<pre><code>POST /uri/... HTTP/1.1

Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 615
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e

{
    "topic": "device-events",
    "events": [
        {
            "audit_id": "a8ec4d8a-4da6-4ead-a486-d0f72e40dd08",
            "ap": "5c5b35000001",
            "ap_name": "AP41 Near Lab",
            "device_name": "AP41 Near Lab",
            "device_type": "ap/switch/gateway",
            "ev_type": "NOTICE",
            "mac": "5c5b35000001",
            "org_id": "2818e386-8dec-2562-9ede-5b8a0fbbdc71",
            "reason": "power_cycle",
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "site_name": "Site 1",
            "text": "event details",
            "timestamp": 1461220784,
            "type": "AP_RESTARTED"
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>topic</code></td>
<td><code>string</code></td>
<td>topic subscribed to</td>
</tr>
<tr>
<td><code>events</code></td>
<td><code>list</code></td>
<td>list of events</td>
</tr>
<tr>
<td><code>audit_id</code></td>
<td><code>string</code></td>
<td>(optional) audit id</td>
</tr>
<tr>
<td><code>ap</code></td>
<td><code>string</code></td>
<td>(will be deprecated soon; please use <code>mac</code> instead) ap mac</td>
</tr>
<tr>
<td><code>ap_name</code></td>
<td><code>string</code></td>
<td>(will be deprecated soon; please use <code>device_name</code> instead) ap name</td>
</tr>
<tr>
<td><code>device_name</code></td>
<td><code>string</code></td>
<td>device name</td>
</tr>
<tr>
<td><code>device_type</code></td>
<td><code>string</code></td>
<td>device type (ap/switch/gateway)</td>
</tr>
<tr>
<td><code>ev_type</code></td>
<td><code>string</code></td>
<td>(optional) event advisory (notice/warn)</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>device mac</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id</td>
</tr>
<tr>
<td><code>reason</code></td>
<td><code>string</code></td>
<td>(optional) event reason</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>site_name</code></td>
<td><code>string</code></td>
<td>site name</td>
</tr>
<tr>
<td><code>text</code></td>
<td><code>string</code></td>
<td>(optional) event description</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>int</code></td>
<td>time the event occurred e.g. 1565987313</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>event type</td>
</tr>
</tbody>
</table>
<h3 id="example-delivery-of-device-updowns">Example Delivery of device-updowns</h3>
<p><code>device-updowns</code> delivers subset of device-events as followin:</p>
<ul>
<li>AP_DISCONNECTED (from our perspective, the AP is disconnected)</li>
<li>AP_CONNECTED (AP is now connected, i.e. it was disconnected before)</li>
<li>AP_RESTARTED (AP was restarted where we observe the uptime being reset, e.g. manual restart, upgrade, switch port
  bounced)</li>
</ul>
<pre><code>POST /uri/... HTTP/1.1

Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 615
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e

{
    "topic": "device-updowns",
    "events": [
        {
            "org_id": "2818e386-8dec-2562-9ede-5b8a0fbbdc71",
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "type": "AP_RESTARTED",
            "ap": "5c5b35000001",
            "ap_name": "AP01",
            "site_name": "SJ1"
            "timestamp": 1461220784
        }
    ]
}
</code></pre>
<h3 id="example-delivery-of-alarms">Example Delivery of alarms</h3>
<p>For delivery examples for different alarms, please see <code>GET /api/v1/const/alarm_defs</code></p>
<pre><code>POST /uri/... HTTP/1.1

Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 615
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e

{
    "topic": "alarms",
    "events": [
        {
            "aps": [
                "5c5b350e1003"
            ],
            "bssids": [
                "00024a00310c",
                "5c5b3500e10f",
                "000f24090ff1",
                "c03f0e76fe91",
                "e091f512eda2",
                "e894f6258a3f",
                "40169f1157a4",
                "40169f1151b2",
                "c03f0e7aba91",
                "5c5b35090ff3"
            ],
            "count": 16,
            "id": "95193bda-1fef-4ea6-9e5b-97c9f5e0655a",
            "last_seen": 1549068720,
            "ssids": [
                "qwerty",
                "A-Dot",
                "xfinity",
                "alpha"
            ],
            "timestamp": 1549068202,
            "type": "rogue-ap-detected",
            "update": true,
            "org_id": "2818e386-8dec-2562-9ede-5b8a0fbbdc71",
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>topic</code></td>
<td><code>string</code></td>
<td>topic subscribed to</td>
</tr>
<tr>
<td><code>events</code></td>
<td><code>list</code></td>
<td>list of events</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id</td>
</tr>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>event id</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>event type</td>
</tr>
<tr>
<td><code>count</code></td>
<td><code>string</code></td>
<td>If present, represents number of events of given type occurred in current interval, default=1</td>
</tr>
<tr>
<td><code>update</code></td>
<td><code>boolean</code></td>
<td>If presents, represents that this is an update to event with given id sent earlier. default=false</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>If present, represents the name of cluster node</td>
</tr>
</tbody>
</table>
<p><strong>N.B.</strong>: Fields like <code>aps</code>, <code>bssids</code>, <code>ssids</code> are event specific. They are relevant to this event type (
rogue-ap-detected). For a different event type, different fields may be sent. These don’t contain all affected entities
and are representative samples of entities (capped at 10). For marvis action related events, we expose <code>details</code> to include
more event specific details.</p>
<p>Events specific fields for other alarm event type can be found with API /api/v1/const/alarm_defs,
under “fields” array of /alarm_defs response object.</p>
<h3 id="example-delivery-of-audits">Example Delivery of audits</h3>
<pre><code>POST /uri/... HTTP/1.1

Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 615
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e

{
    "topic": "audits",
    "events": [
        {
            "admin_name": "Chris Dao chris.dao@yahoo.com",
            "device_id": "00000000-0000-0000-1000-5c5b350e01c7",
            "id": "8e00dd48-b918-4d9b-b40d-b98989ac76a7",
            "message": "Update Device \"Reception\"",
            "org_id": "2818e386-8dec-2562-9ede-5b8a0fbbdc71",
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "src_ip": "73.92.124.103",
            "timestamp": 1549047906.201053
        }
    ]
}
</code></pre>
<h3 id="example-delivery-of-client-join">Example Delivery of client-join</h3>
<pre><code>POST /uri/... HTTP/1.1

Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 382
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e

{
    "topic": "client-join",
    "events": [
    {
            "ap": “5c5b35d01338",
            "ap_name": “AP43 Test",
            "band": "5",
            "bssid": "5c5b35df18a1",
            "connect": 1592333828,
            "connect_float": 1592333828.324,
            "mac": "70ef0071535f",
            "org_id": "6748cfa6-4e12-11e6-9188-0242ac110007",
            "rssi": -54,
            "site_id": "d761985e-49b1-4506-88e9-e0368a05c301",
            "site_name": "Test",
            "ssid": "Maui",
            "timestamp": 1592333828,
            "version": 2
            "wlan_id": "6c0c0b07-0d77-44d1-9ab2-610aee9ce711",
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ap</code></td>
<td><code>string</code></td>
<td>mac address of the AP the client connected to</td>
</tr>
<tr>
<td><code>ap_name</code></td>
<td><code>string</code></td>
<td>user-friendly name of the AP the client connected to.</td>
</tr>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>5GHz or 2.4GHz band</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>ESSID</td>
</tr>
<tr>
<td><code>connect</code></td>
<td><code>int</code></td>
<td>time when the user connects</td>
</tr>
<tr>
<td><code>connect_float</code></td>
<td><code>float</code></td>
<td>floating point connect timestamp with millisecond precision</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>the client’s mac</td>
</tr>
<tr>
<td><code>rssi</code></td>
<td><code>int</code></td>
<td>RSSI when the client associated</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>Org ID</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>Site ID</td>
</tr>
<tr>
<td><code>site_name</code></td>
<td><code>string</code></td>
<td>name of site</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>int</code></td>
<td>time the message is sent. E.g. 1565987313</td>
</tr>
<tr>
<td><code>version</code></td>
<td><code>int</code></td>
<td>schema version of this message</td>
</tr>
<tr>
<td><code>wlan_id</code></td>
<td><code>string</code></td>
<td>WLAN ID</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>ip address of client (optional, may be absent if not available)</td>
</tr>
</tbody>
</table>
<h3 id="example-delivery-of-client-sessions">Example Delivery of client-sessions</h3>
<pre><code>POST /uri/... HTTP/1.1

Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 596
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e

{
    "topic": "client-sessions",
    "events": [
        {
            "ap": “5c5b352f587e",
            "ap_name": “AP41 Test",
            "band": "5",
            "bssid": "5c5b352b51b4",
            "client_family": "iPhone",
            "client_manufacture": "Apple",
            "client_model": "8+",
            "client_os": "13.4.1",
            "connect": 1592333548,
            "connect_float": 1592333548.117,
            "disconnect": 1592333828,
            "disconnect_float": 1592333828.589,
            "duration": 279.835049793,
            "mac": "70ef0071535f",
            "next_ap": "5c5b35d01338",
            "org_id": "6748cfa6-4e12-11e6-9188-0242ac110007",
            "rssi": -87,
            "site_id": "d761985e-49b1-4506-88e9-e0368a05c301",
            "site_name": "Test",
            "ssid": "Maui",
            "termination_reason": 3,
            "timestamp": 1592333828,
            "version": 2
            "wlan_id": "6c0c0b07-0d77-44d1-9ab2-610aee9ce711",
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ap</code></td>
<td><code>string</code></td>
<td>mac address of the AP the client roamed or disconnected from</td>
</tr>
<tr>
<td><code>ap_name</code></td>
<td><code>string</code></td>
<td>user-friendly name of the AP the client roamed or disconnected from.</td>
</tr>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>5GHz or 2.4GHz band</td>
</tr>
<tr>
<td><code>client_family</code></td>
<td><code>string</code></td>
<td>device family E.g. “Mac”, “iPhone”, “Apple watch”</td>
</tr>
<tr>
<td><code>client_manufacture</code></td>
<td><code>string</code></td>
<td>device manufacturer E.g. “Apple”</td>
</tr>
<tr>
<td><code>client_model</code></td>
<td><code>string</code></td>
<td>device model E.g. “8+”, “XS”</td>
</tr>
<tr>
<td><code>client_os</code></td>
<td><code>string</code></td>
<td>device operating system E.g. “Mojave”, “Windows 10”, “Linux”</td>
</tr>
<tr>
<td><code>connect</code></td>
<td><code>int</code></td>
<td>time when the user connects</td>
</tr>
<tr>
<td><code>connect_float</code></td>
<td><code>float</code></td>
<td>floating point connect timestamp with millisecond precision</td>
</tr>
<tr>
<td><code>disconnect</code></td>
<td><code>int</code></td>
<td>time when the user disconnects</td>
</tr>
<tr>
<td><code>disconnect_float</code></td>
<td><code>float</code></td>
<td>floating point disconnect timestamp with millisecond precision</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>float</code></td>
<td>the duration of the roamed or complete session indicated by termination_reason field.</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>the client’s mac</td>
</tr>
<tr>
<td><code>rssi</code></td>
<td><code>int</code></td>
<td>latest average RSSI before the user disconnects</td>
</tr>
<tr>
<td><code>next_ap</code></td>
<td><code>string</code></td>
<td>the AP the client has roamed to.</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>Org ID</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>Site ID</td>
</tr>
<tr>
<td><code>site_name</code></td>
<td><code>string</code></td>
<td>name of site</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>ESSID</td>
</tr>
<tr>
<td><code>termination_reason</code></td>
<td><code>int</code></td>
<td>1 disassociate - when the client disassociates. 2 inactive - when the client is timeout. 3 roamed - when the client is roamed between APs</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>int</code></td>
<td>time the message is sent. E.g. 1565987313</td>
</tr>
<tr>
<td><code>version</code></td>
<td><code>int</code></td>
<td>schema version of this message</td>
</tr>
<tr>
<td><code>wlan_id</code></td>
<td><code>string</code></td>
<td>WLAN ID</td>
</tr>
</tbody>
</table>
<h3 id="example-delivery-of-client-info">Example Delivery of client-info</h3>
<pre><code>POST /uri/... HTTP/1.1
Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 191
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e
{
    "topic": "client-info",
    "events": [
        {
            "ip": "21.0.128.151",
            "mac": "6ebaa47a3fd4",
            "org_id": "0c160b7f-1027-4cd1-923b-744534c4b070",
            "site_id": "6e77a2ea-d579-471c-9056-5ff5b4ed70ed",
            "hostname": "service.company.net",  // extracted from DHCP Option 12
            "timestamp": 1703003296
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>IP address of client</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>the client’s mac</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>Org ID</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>Site ID</td>
</tr>
<tr>
<td><code>hostname</code></td>
<td><code>string</code></td>
<td>Hostname of client</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>float</code></td>
<td>time at which IP address was assigned E.g. 1703003956</td>
</tr>
</tbody>
</table>
<h2 id="client-raw-data-webhooks">Client Raw Data Webhooks</h2>
<p>Raw data webhooks are a special subset of webhooks that provide insight into raw data packets emitted by a client, identified by their advertising MAC address (assets, discovered ble, connected wifi, unconnected wifi). The data that client raw data webhooks encompasses are <em>reporting AP information</em>, <em>RSSI Data</em>, and any <em>special packets/telemetry packets</em> that the client may emit. 
Note that client raw webhooks are the raw data coming from the client and do not contain the X,Y location data of the client. In order to get the location data for a client please see our location webhooks. Clients can be identified uniquely across these client raw data topics and location webhook topic using MAC address as the Unique identifier (client identifier).</p>
<h3 id="client-raw-data-webhooks-topics">Client Raw Data Webhooks Topics</h3>
<p>Topics that correspond to client raw data for different client types. To be included in the <code>http-post</code> message for <code>/api/v1/sites/:site_id/webhooks</code> API.
1. <code>asset-raw-rssi</code> - Raw data from packets emitted by named and filtered assets
2. <code>discovered-raw-rssi</code> - Raw data from packets emitted by passive BLE devices
3. <code>wifi-conn-raw</code> - Raw data from packets emitted by connected devices
4. <code>wifi-unconn-raw</code> - Raw data from packets emitted by unconnected devices (passive)</p>
<h3 id="rules-for-configuring-client-raw-data-webhooks">Rules for configuring client raw data webhooks</h3>
<pre><code>1. Only one instance of a webhook object containing a client raw data webhook topic is allowed. (a site level entry will override an org level entry for the client raw data webhook topic in question)
2. Only one client raw data webhook topic is allowed per `http-post` message to webhooks api
</code></pre>
<h3 id="example-of-valid-http-post-webhook-for-configuring-client-raw-data-webhooks">Example of valid http-post Webhook for configuring client raw data webhooks</h3>
<pre><code>POST /api/v1/sites/:site_id/webhooks

{
    "name": "test-asset-raw",
    "url": "https://xyz.abc",
    "enabled": true,
    "topics": [ "asset-raw-rssi"]
}
</code></pre>
<p>Response</p>
<pre><code>HTTP 200 OK
Allow: GET, OPTIONS, POST
Content-Type: application/json
Vary: Accept

{
    "name": "test-asset-raw",
    "url": "https://eoipjcp8ktxjo8p.m.pipedream.net",
    "enabled": true,
    "topics": [
        "asset-raw-rssi"
    ],
    "verify_cert": true,
    "id": "f1ff49e8-9f77-420a-9854-c7de46d7cf80",
    "for_site": true,
    "site_id": "site_id",
    "org_id": "org_id",
    "created_time": 1661300255,
    "modified_time": 1661300255
}
</code></pre>
<h3 id="example-of-invalid-http-post-webhook-for-configuring-client-raw-webhooks">Example of invalid http-post Webhook for configuring client raw webhooks</h3>
<p>Example of creating a second webhook integration for a raw client data topic when one already exists will return an error</p>
<pre><code>POST /api/v1/sites/:site_id/webhooks

{
    "name": "test-asset-raw-duplicate",
    "url": "https://xyz.abc",
    "enabled": true,
    "topics": [ "asset-raw-rssi"]
}
</code></pre>
<pre><code>HTTP 400 Bad Request
Allow: GET, OPTIONS, POST
Content-Type: application/json
Vary: Accept

{
    "detail": "Webhook already configured for special location topic",
    "webhook_id": "f1ff49e8-9f77-420a-9854-c7de46d7cf80"
}
</code></pre>
<p>Example of creating webhook integration for raw client data topic with multiple topic names in request</p>
<pre><code>POST /api/v1/sites/:site_id/webhooks

{
    "name": "invalid multiple topic names",
    "url": "https://xyz.abc",
    "enabled": true,
    "topics": [ "discovered-raw-rssi", "wifi-conn-raw"]
}
</code></pre>
<pre><code>HTTP 400 Bad Request
Allow: GET, OPTIONS, POST
Content-Type: application/json
Vary: Accept

{
    "detail": "Only one location topic can be configured per URL"
}
</code></pre>
<h3 id="example-delivery-of-asset-raw-rssi-webhook-using-http-post">Example delivery of asset-raw-rssi webhook using http-post</h3>
<pre><code>{
  "topic": "asset-raw-rssi",
  "events": [
    {
      "ap_loc": [
        36.03303862386182,
        43.57022468463291,
        2.75
      ],
      "beam": 8,
      "device_id": "00000000-0000-0000-1000-ac2316eca70b",
      "ibeacon_major": 2,
      "ibeacon_minor": 2121,
      "ibeacon_uuid": "ac950d7b-af31-42d2-be7c-e15639fab2cd",
      "is_asset": true,
      "mac": "ed2cc53f2770",
      "service_packets": [
        {
          "service_uuid": "UUID",
          "service_data": "010441060606fe3d35700601cecbd902512f000001"
        }
      ],
      "map_id": "bd42f0c3-2e6a-4f8a-ac2d-d34e268c1418",
      "org_id": "9c3e516c-397d-11e6-ae35-0242ac110008",
      "rssi": -79,
      "site_id": "27ea2f07-6fe6-4eab-be1b-b8e3ce083d67",
      "timestamp": 1661300746
    },
    {
      "ap_loc": [
        36.03303862386182,
        43.57022468463291,
        2.75
      ],
      "beam": 7,
      "device_id": "00000000-0000-0000-1000-ac2316eca70b",
      "mfg_company_id": 243,
      "mfg_data": "00000000000000000000000000"
      "is_asset": true,
      "mac": "ed2cc53f2771",
      "map_id": "bd42f0c3-2e6a-4f8a-ac2d-d34e268c1418",
      "org_id": "9c3e516c-397d-11e6-ae35-0242ac110008",
      "rssi": -74,
      "site_id": "27ea2f07-6fe6-4eab-be1b-b8e3ce083d67",
      "timestamp": 1661300746
    }
  ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>topic</code></td>
<td><code>string</code></td>
<td>topic subscribed to</td>
</tr>
<tr>
<td><code>events</code></td>
<td><code>list</code></td>
<td>list of events</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map id</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id</td>
</tr>
<tr>
<td><code>device_id</code></td>
<td><code>string</code></td>
<td>device id of the reporting AP</td>
</tr>
<tr>
<td><code>ap_loc</code></td>
<td><code>list</code></td>
<td>optional, coordinates (if any) of reporting AP (updated once in 60s per client)</td>
</tr>
<tr>
<td><code>beam</code></td>
<td><code>int</code></td>
<td>antenna index, from 1-8, clock-wise starting from the LED</td>
</tr>
<tr>
<td><code>rssi</code></td>
<td><code>float</code></td>
<td>signal strength</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>MAC of the asset/ beacon</td>
</tr>
<tr>
<td><code>asset_id</code></td>
<td><code>string</code></td>
<td>asset id</td>
</tr>
<tr>
<td><code>ibeacon_uuid</code></td>
<td><code>string</code></td>
<td>iBeacon UUID</td>
</tr>
<tr>
<td><code>ibeacon_major</code></td>
<td><code>string</code></td>
<td>iBeacon major</td>
</tr>
<tr>
<td><code>ibeacon_minor</code></td>
<td><code>string</code></td>
<td>iBeacon minor</td>
</tr>
<tr>
<td><code>mfg_company_id</code></td>
<td><code>int</code></td>
<td>optional, BLE manufacturing company ID</td>
</tr>
<tr>
<td><code>mfg_data</code></td>
<td><code>string</code></td>
<td>optional, BLE manufacturing data in hex byte-string format (ie: “112233AABBCC”)</td>
</tr>
<tr>
<td><code>service_packets</code></td>
<td><code>list</code></td>
<td>optional, list of service data packets heard from the asset/ beacon</td>
</tr>
<tr>
<td><code>service_data</code></td>
<td><code>string</code></td>
<td>optional, data from service data</td>
</tr>
<tr>
<td><code>service_uuid</code></td>
<td><code>string</code></td>
<td>optional, UUID from service data</td>
</tr>
</tbody>
</table>
<h3 id="example-delivery-of-discovered-raw-rssi-webhook-using-http-post">Example delivery of discovered-raw-rssi webhook using http-post</h3>
<pre><code>{
  "topic": "discovered-raw-rssi",
  "events": [
    {
      "beam": 8,
      "device_id": "00000000-0000-0000-1000-ac2316eca70b",
      "ibeacon_major": 2,
      "ibeacon_minor": 2121,
      "ibeacon_uuid": "ac950d7b-af31-42d2-be7c-e15639fab2cd",
      "is_asset": false,
      "mac": "ed2cc53f2770",
      "map_id": "bd42f0c3-2e6a-4f8a-ac2d-d34e268c1418",
      "org_id": "9c3e516c-397d-11e6-ae35-0242ac110008",
      "rssi": -79,
      "site_id": "27ea2f07-6fe6-4eab-be1b-b8e3ce083d67",
      "timestamp": 1661300746
    },
    {
      "ap_loc": [
        36.03303862386182,
        43.57022468463291,
        2.75
      ],
      "beam": 7,
      "device_id": "00000000-0000-0000-1000-ac2316eca70b",
      "service_packets": [
        {
          "service_uuid": "UUID",
          "service_data": "010441060606fe3d35700601cecbd902512f000001"
        }
      ],
      "is_asset": false,
      "mac": "ed2cc53f2771",
      "map_id": "bd42f0c3-2e6a-4f8a-ac2d-d34e268c1418",
      "org_id": "9c3e516c-397d-11e6-ae35-0242ac110008",
      "rssi": -74,
      "site_id": "27ea2f07-6fe6-4eab-be1b-b8e3ce083d67",
      "timestamp": 1661300746
    }
  ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>topic</code></td>
<td><code>string</code></td>
<td>topic subscribed to</td>
</tr>
<tr>
<td><code>events</code></td>
<td><code>list</code></td>
<td>list of events</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map id</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id</td>
</tr>
<tr>
<td><code>device_id</code></td>
<td><code>string</code></td>
<td>device id of the reporting AP</td>
</tr>
<tr>
<td><code>ap_loc</code></td>
<td><code>list</code></td>
<td>optional, coordinates (if any) of reporting AP (updated once in 60s per client)</td>
</tr>
<tr>
<td><code>beam</code></td>
<td><code>int</code></td>
<td>antenna index, from 1-8, clock-wise starting from the LED</td>
</tr>
<tr>
<td><code>rssi</code></td>
<td><code>float</code></td>
<td>signal strength</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>MAC of the asset/ beacon</td>
</tr>
<tr>
<td><code>asset_id</code></td>
<td><code>string</code></td>
<td>asset id</td>
</tr>
<tr>
<td><code>ibeacon_uuid</code></td>
<td><code>string</code></td>
<td>iBeacon UUID</td>
</tr>
<tr>
<td><code>ibeacon_major</code></td>
<td><code>string</code></td>
<td>iBeacon major</td>
</tr>
<tr>
<td><code>ibeacon_minor</code></td>
<td><code>string</code></td>
<td>iBeacon minor</td>
</tr>
<tr>
<td><code>mfg_company_id</code></td>
<td><code>int</code></td>
<td>optional, BLE manufacturing company ID</td>
</tr>
<tr>
<td><code>mfg_data</code></td>
<td><code>string</code></td>
<td>optional, BLE manufacturing data in hex byte-string format (ie: “112233AABBCC”)</td>
</tr>
<tr>
<td><code>service_packets</code></td>
<td><code>list</code></td>
<td>optional, list of service data packets heard from the asset/ beacon</td>
</tr>
<tr>
<td><code>service_data</code></td>
<td><code>string</code></td>
<td>optional, data from service data</td>
</tr>
<tr>
<td><code>service_uuid</code></td>
<td><code>string</code></td>
<td>optional, UUID from service data</td>
</tr>
</tbody>
</table>
<h3 id="example-delivery-of-wifi-conn-raw-webhook-using-http-post">Example delivery of wifi-conn-raw webhook using http-post</h3>
<pre><code>{
  "topic": "wifi-conn-raw",
  "events": [
    {
      "ap_id": "ac-23-16-ec-a7-0b",
      "ap_loc": [
        36.03303862386182,
        43.57022468463291,
        2.75
      ],
      "client_id": "28-f0-76-2d-22-1e",
      "connected_site": false,
      "mapid": "bd42f0c3-2e6a-4f8a-ac2d-d34e268c1418",
      "orgid": "9c3e516c-397d-11e6-ae35-0242ac110008",
      "packets": [
        {
          "band": "5GHz",
          "rssi": -92
        }
      ],
      "siteid": "27ea2f07-6fe6-4eab-be1b-b8e3ce083d67"
    },
    {
      "ap_id": "ac-23-16-ec-a7-0b",
      "ap_loc": [
        36.03303862386182,
        43.57022468463291,
        2.75
      ],
      "client_id": "38-f9-d3-99-08-6e",
      "connected_site": false,
      "mapid": "bd42f0c3-2e6a-4f8a-ac2d-d34e268c1418",
      "orgid": "9c3e516c-397d-11e6-ae35-0242ac110008",
      "packets": [
        {
          "band": "5GHz",
          "rssi": -94.333336
        }
      ],
      "extended_info_list": [
        {
          "frame_ctrl": 776,
          "sequence_ctrl": 8432,
          "payload": "010441060606fe3d35700601cecbd902512f000001"
        }
      ],
      "siteid": "27ea2f07-6fe6-4eab-be1b-b8e3ce083d67"
    }
  ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>topic</code></td>
<td><code>string</code></td>
<td>topic subscribed to</td>
</tr>
<tr>
<td><code>events</code></td>
<td><code>list</code></td>
<td>list of events</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map id</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id</td>
</tr>
<tr>
<td><code>ap_id</code></td>
<td><code>string</code></td>
<td>MAC address of the reporting AP</td>
</tr>
<tr>
<td><code>ap_loc</code></td>
<td><code>list</code></td>
<td>optional, coordinates (if any) of reporting AP (updated once in 60s per client)</td>
</tr>
<tr>
<td><code>client_id</code></td>
<td><code>string</code></td>
<td>MAC of the wifi device</td>
</tr>
<tr>
<td><code>connected_site</code></td>
<td><code>bool</code></td>
<td>connected wifi client or passive wifi device</td>
</tr>
<tr>
<td><code>packets</code></td>
<td><code>list</code></td>
<td>band-wise average rssi reported by Wifi device</td>
</tr>
<tr>
<td><code>rssi</code></td>
<td><code>float</code></td>
<td>signal strength</td>
</tr>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>band associated with RSSI</td>
</tr>
<tr>
<td><code>extended_info_list</code></td>
<td><code>list</code></td>
<td>optional, list of specific telemetry packets emited by certain wifi tags (Eg. Centrak)</td>
</tr>
<tr>
<td><code>frame_ctrl</code></td>
<td><code>int</code></td>
<td>optional, Frame Control</td>
</tr>
<tr>
<td><code>sequence_ctrl</code></td>
<td><code>int</code></td>
<td>optional, Sequence control</td>
</tr>
<tr>
<td><code>payload</code></td>
<td><code>string</code></td>
<td>optional, payload from the wifi beacon</td>
</tr>
</tbody>
</table>
<h3 id="example-delivery-of-wifi-unconn-raw-webhook-using-http-post">Example delivery of wifi-unconn-raw webhook using http-post</h3>
<pre><code>{
  "topic": "wifi-unconn-raw",
  "events": [
    {
      "ap_id": "ac-23-16-ec-a7-0b",
      "ap_loc": [
        36.03303862386182,
        43.57022468463291,
        2.75
      ],
      "client_id": "28-f0-76-2d-22-1e",
      "connected_site": false,
      "mapid": "bd42f0c3-2e6a-4f8a-ac2d-d34e268c1418",
      "orgid": "9c3e516c-397d-11e6-ae35-0242ac110008",
      "packets": [
        {
          "band": "5GHz",
          "rssi": -92
        }
      ],
      "siteid": "27ea2f07-6fe6-4eab-be1b-b8e3ce083d67"
    },
    {
      "ap_id": "ac-23-16-ec-a7-0b",
      "ap_loc": [
        36.03303862386182,
        43.57022468463291,
        2.75
      ],
      "client_id": "38-f9-d3-99-08-6e",
      "connected_site": false,
      "mapid": "bd42f0c3-2e6a-4f8a-ac2d-d34e268c1418",
      "orgid": "9c3e516c-397d-11e6-ae35-0242ac110008",
      "packets": [
        {
          "band": "5GHz",
          "rssi": -94.333336
        }
      ],
      "siteid": "27ea2f07-6fe6-4eab-be1b-b8e3ce083d67"
    }
  ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>topic</code></td>
<td><code>string</code></td>
<td>topic subscribed to</td>
</tr>
<tr>
<td><code>events</code></td>
<td><code>list</code></td>
<td>list of events</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map id</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id</td>
</tr>
<tr>
<td><code>ap_id</code></td>
<td><code>string</code></td>
<td>MAC address of the reporting AP</td>
</tr>
<tr>
<td><code>ap_loc</code></td>
<td><code>list</code></td>
<td>optional, coordinates (if any) of reporting AP (updated once in 60s per client)</td>
</tr>
<tr>
<td><code>client_id</code></td>
<td><code>string</code></td>
<td>MAC of the wifi device</td>
</tr>
<tr>
<td><code>connected_site</code></td>
<td><code>bool</code></td>
<td>connected wifi client or passive wifi device</td>
</tr>
<tr>
<td><code>packets</code></td>
<td><code>list</code></td>
<td>band-wise average rssi reported by Wifi device</td>
</tr>
<tr>
<td><code>rssi</code></td>
<td><code>float</code></td>
<td>signal strength</td>
</tr>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>band associated with RSSI</td>
</tr>
<tr>
<td><code>extended_info_list</code></td>
<td><code>list</code></td>
<td>optional, list of specific telemetry packets emited by certain wifi tags (Eg. Centrak)</td>
</tr>
<tr>
<td><code>frame_ctrl</code></td>
<td><code>int</code></td>
<td>optional, Frame Control</td>
</tr>
<tr>
<td><code>sequence_ctrl</code></td>
<td><code>int</code></td>
<td>optional, Sequence control</td>
</tr>
<tr>
<td><code>payload</code></td>
<td><code>string</code></td>
<td>optional, payload from the wifi beacon</td>
</tr>
</tbody>
</table>
<h3 id="asset-filtering-for-client-raw-data-webhooks">Asset Filtering for Client Raw Data Webhooks</h3>
<p>The <code>asset-raw-rssi</code> webhook topic supports filtering of raw data by incorporating asset filters in the webhook payload.  </p>
<p>The filter topic allows multiple Webhooks to receive a subset of the <code>asset-raw-rssi</code> data by assigning asset filters to a given webhook.
The <code>asset-raw-rssi</code> filter topic is <code>filtered-asset-rssi</code>.</p>
<p>A webhook assigned to a filter topic can take a list of <strong>AssetFilter IDs</strong>, which act as inclusive filters to determine which named asset and filtered asset data is sent to the assigned filter topic.
Filters can be applied to multiple webhooks, and the same data can be sent to multiple filter topics.</p>
<h3 id="rules-for-configuring-client-raw-data-webhooks_1">Rules for Configuring Client Raw Data Webhooks</h3>
<ol>
<li>Only <strong>four instances</strong> of a webhook object can contain a specific filter topic.
   - A <strong>site-level entry</strong> will override an <strong>org-level entry</strong> for the same client raw data webhook topic.</li>
<li>An assigned asset filter <strong>must exist</strong> and belong to the <strong>same site</strong> as the webhook it is assigned to.</li>
</ol>
<h3 id="example-of-valid-http-post-webhook-for-configuring-asset-raw-webhook-with-filters">Example of valid http-post Webhook for configuring asset raw webhook with filters.</h3>
<pre><code>POST /api/v1/sites/:site_id/webhooks

{
    "name": "test-filtered-asset-rssi",
    "url": "https://xyz.abc",
    "enabled": true,
    "topics": [ "filtered-asset-rssi"],
    "assetfilter_ids": [
        "e06ecc2a-e75b-49bb-b9ea-b0e650cc8072",
        "0d04d6be-8a00-48c6-ae79-38ff14450098",
        "a73b4be2-66ea-4951-aa6c-9e63e1a3635f",
    ]
}
</code></pre>
<p>Response</p>
<pre><code>HTTP 200 OK
Allow: GET, OPTIONS, POST
Content-Type: application/json
Vary: Accept

{
    "name": "test-filtered-asset-rssi",
    "url": "https://eoipjcp8ktxjo8p.m.pipedream.net",
    "enabled": true,
    "topics": [
        "filtered-asset-rssi"
    ],
    "verify_cert": true,
    "id": "f1ff49e8-9f77-420a-9854-c7de46d7cf80",
    "for_site": true,
    "site_id": "site_id",
    "org_id": "org_id",
    "assetfilter_id": [
    "e06ecc2a-e75b-49bb-b9ea-b0e650cc8072",
    "0d04d6be-8a00-48c6-ae79-38ff14450098",
    "a73b4be2-66ea-4951-aa6c-9e63e1a3635f",
    ],
    "created_time": 1661300255,
    "modified_time": 1661300255
}
</code></pre>
<h3 id="example-of-invalid-http-post-webhook-for-configuring-asset-raw-webhook">Example of invalid http-post Webhook for configuring asset raw webhook.</h3>
<p>Example of adding an malformed assetfilter_id to a webhook</p>
<pre><code>POST /api/v1/sites/:site_id/webhooks

{
    "name": "test-asset-raw-malformed-assetfilter-id",
    "url": "https://xyz.abc",
    "enabled": true,
    "topics": [ "filtered-asset-rssi"],
    "assetfilter_ids": [
        "non_existant_assetfilter_id",
    ]
}
</code></pre>
<pre><code>HTTP 400 Bad Request
Allow: GET, OPTIONS, POST
Content-Type: application/json
Vary: Accept

{
    "detail": "invalid field: assetfilter_ids"
}
</code></pre>
<h3 id="example-of-invalid-http-post-webhook-for-configuring-asset-raw-webhook_1">Example of invalid http-post Webhook for configuring asset raw webhook.</h3>
<p>Example of adding an invalid assetfilter_id to a webhook</p>
<pre><code>POST /api/v1/sites/:site_id/webhooks

{
    "name": "test-asset-raw-non-existant-assetfilter-id",
    "url": "https://xyz.abc",
    "enabled": true,
    "topics": [ "filtered-asset-rssi"],
    "assetfilter_ids": [
        "00000000-0000-0000-0000-000000000000",
    ]
}
</code></pre>
<pre><code>HTTP 400 Bad Request
Allow: GET, OPTIONS, POST
Content-Type: application/json
Vary: Accept

{
    "detail": "invalid field: assetfilter_ids"
}
</code></pre>
<h3 id="example-of-invalid-http-post-webhook-for-configuring-asset-raw-webhook_2">Example of invalid http-post Webhook for configuring asset raw webhook.</h3>
<p>Example of adding a duplicate assetfilter_id to a webhook</p>
<pre><code>POST /api/v1/sites/:site_id/webhooks

{
    "name": "test-asset-raw-duplicate-assetfilter-ids",
    "url": "https://xyz.abc",
    "enabled": true,
    "topics": [ "filtered-asset-rssi"],
    "assetfilter_ids": [
        "e06ecc2a-e75b-49bb-b9ea-b0e650cc8072",
        "e06ecc2a-e75b-49bb-b9ea-b0e650cc8072",
    ]
}
</code></pre>
<pre><code>HTTP 400 Bad Request
Allow: GET, OPTIONS, POST
Content-Type: application/json
Vary: Accept

{
    "detail": "invalid field: assetfilter_ids",
    "reason": "contains duplicate uuids"
}
</code></pre>
<h3 id="example-of-invalid-http-post-webhook-for-configuring-asset-raw-webhook_3">Example of invalid http-post Webhook for configuring asset raw webhook.</h3>
<p>Example of attempting to create a filter webhook at an org level</p>
<pre><code>POST /api/v1/orgs/:org_id/webhooks

{
    "name": "test-asset-raw-org-level-filter-webhook",
    "url": "https://xyz.abc",
    "enabled": true,
    "topics": [ "filtered-asset-rssi"],
    "assetfilter_ids": [
        "e06ecc2a-e75b-49bb-b9ea-b0e650cc8072",
    ]
}
</code></pre>
<pre><code>HTTP 400 Bad Request
Allow: GET, OPTIONS, POST
Content-Type: application/json
Vary: Accept

{
    "detail": "invalid field: topics",
    "reason": "filtered asset webhooks must be associated with a site"
}
</code></pre>
<h2 id="ping-webhook">Ping Webhook</h2>
<p>send a Ping event to the webhook</p>
<pre><code>POST /api/v1/sites/:site_id/webhooks/:webhook_id/ping
</code></pre>
<h3 id="example-delivery-via-http-post">Example Delivery via http-post</h3>
<pre><code>{
    "topic": "ping",
    "events": [
        {
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "id": "18ff1f91-a9e0-c3b7-74ea-2ce4ea372f72",
            "name": "my webhook",
            "timestamp": 1461220784
        }
    ]
}
</code></pre>
<h3 id="example-delivery-of-occupancy-alerts">Example Delivery of occupancy-alerts</h3>
<pre><code>{
    "topic": "occupancy-alerts",
    "events": [
        {
            "alert_events": [
                {
                    "current_occupancy": 10,
                    "map_id": "f5d26c7f-1670-4921-a79d-09f887f46b44",
                    "occupancy_limit": 5,
                    "org_id": "6748cfa6-4e12-11e6-9188-0242ac110007",
                    "timestamp": 1594861457,
                    "type": "COMPLIANCE-VIOLATION",
                    "zone_id": "b83312a7-7269-4ae1-bea8-e7cfe0e3073c",
                    "zone_name": "PLM and Leadership"
                },
                {
                    "current_occupancy": 20,
                    "map_id": "f5d26c7f-1670-4921-a79d-09f887f46b44",
                    "occupancy_limit": 10,
                    "org_id": "6748cfa6-4e12-11e6-9188-0242ac110007",
                    "timestamp": 1594861457,
                    "type": "COMPLIANCE-VIOLATION",
                    "zone_id": "80acf542-e863-43cf-9efd-9295468585e7",
                    "zone_name": "CSQA"
                },
                {
                    "current_occupancy": 9,
                    "map_id": "f5d26c7f-1670-4921-a79d-09f887f46b44",
                    "occupancy_limit": 4,
                    "org_id": "6748cfa6-4e12-11e6-9188-0242ac110007",
                    "timestamp": 1594861457,
                    "type": "COMPLIANCE-VIOLATION",
                    "zone_id": "a4c7a7c2-880e-4a0e-9626-02e5a9471f86",
                    "zone_name": "Marketing &amp; Sales Ops"
                }
            ],
            "site_id": "67970e46-4e12-11e6-9188-0242ac110007",
            "site_name": "TRUE MIST OFFICE [STAGING]"
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>Site ID</td>
</tr>
<tr>
<td><code>site_name</code></td>
<td><code>string</code></td>
<td>user-friendly name of site</td>
</tr>
<tr>
<td><code>alert_events</code></td>
<td><code>array</code></td>
<td>list of occupancy alerts for non-compliance zones within the site detected around the same time</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>Org ID</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>event type (COMPLIANCE-VIOLATION / COMPLIANCE-OK)</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>int</code></td>
<td>time the message is sent. E.g. 1565987313</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>Map ID of the zone the event type is reported</td>
</tr>
<tr>
<td><code>zone_id</code></td>
<td><code>string</code></td>
<td>Zone ID of the zone the event type is reported</td>
</tr>
<tr>
<td><code>zone_name</code></td>
<td><code>string</code></td>
<td>user-friendly name of zone if it exists</td>
</tr>
<tr>
<td><code>occupancy_limit</code></td>
<td><code>int</code></td>
<td>occupancy limit of the zone the event type is reported</td>
</tr>
<tr>
<td><code>current_occupancy</code></td>
<td><code>int</code></td>
<td>Actual occupancy of the zone the event type is reported</td>
</tr>
</tbody>
</table>
<h3 id="example-delivery-of-sdkclient-scan-data">Example Delivery of sdkclient-scan-data</h3>
<pre><code>POST /uri/... HTTP/1.1

Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 596
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e

{
    "topic": "sdkclient-scan-data",
    "events": [
        {
            "connection_ap": “5c5b352f587e",
            "connection_band": "2.4",
            "connection_channel": 11,
            "connection_bssid": "5c5b352b51b4",
            "mac": "70ef0071535f",
            "connection_rssi": -87,
            "site_id": "d761985e-49b1-4506-88e9-e0368a05c301",
            "last_seen": 1592333828,
            "scan_data": [
                {
                    "ap": “5c5b352f587e",
                    "bssid": "5c5b352b51b4",
                    "band": "2.4",
                    "channel": 11,
                    "rssi": -87
                    "ssid": "mist-wifi",
                    "timestamp": 1592333828
                },
                {
                    "ap": “5c5b352f587e",
                    "bssid": "5c5b352b51b8",
                    "band": "5",
                    "channel": 36,
                    "rssi": -75
                    "ssid": "mist-wifi",
                    "timestamp": 1592333828
                }
            ]
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>connection_ap</code></td>
<td><code>string</code></td>
<td>mac address of the AP the client is connected to</td>
</tr>
<tr>
<td><code>connection_band</code></td>
<td><code>string</code></td>
<td>5GHz or 2.4GHz band, of the BSSID the client is connected to</td>
</tr>
<tr>
<td><code>connection_channel</code></td>
<td><code>int</code></td>
<td>channel of the band the client is connected to</td>
</tr>
<tr>
<td><code>connection_bssid</code></td>
<td><code>string</code></td>
<td>BSSID of the AP the client is connected to</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>the client’s mac</td>
</tr>
<tr>
<td><code>connection_rssi</code></td>
<td><code>int</code></td>
<td>RSSI of the client’s connection to the AP/BSSID</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>Site ID</td>
</tr>
<tr>
<td><code>last_seen</code></td>
<td><code>int</code></td>
<td>time client last seen with scan data</td>
</tr>
<tr>
<td><code>ap</code></td>
<td><code>string</code></td>
<td>mac address of the AP associated with the BSSID scanned</td>
</tr>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>5GHz or 2.4GHz band, associated with the BSSID scanned</td>
</tr>
<tr>
<td><code>channel</code></td>
<td><code>int</code></td>
<td>channel of the band found in the scan</td>
</tr>
<tr>
<td><code>bssid</code></td>
<td><code>string</code></td>
<td>BSSID found during client’s background scan for wifi</td>
</tr>
<tr>
<td><code>rssi</code></td>
<td><code>int</code></td>
<td>client’s RSSI relative to the BSSID scanned</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>ESSID containing the BSSID scanned</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>int</code></td>
<td>time the scan of the particular BSSID occurred</td>
</tr>
</tbody>
</table>
<h3 id="example-delivery-of-site-sle">Example delivery of site-sle</h3>
<pre><code>POST /uri/... HTTP/1.1

Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 596
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e

{
    "topic": "site-sle",
    "events": [
        {
            "timestamp": 1694620800,
            "org_id": “2818e386-8dec-2562-9ede-5b8a0fbbdc71",
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "sle": {
                "ap-availability": 0.6,
                "time-to-connect": 0.9,
                "successful-connect": 0.7,
                ...
            } 
        }
    ]
}
</code></pre>
<h3 id="example-webhook-delivery-of-client-latency">Example webhook delivery of client-latency</h3>
<pre><code>POST /uri/... HTTP/1.1

Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 596
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e

{
    "topic":"client-latency",
    "events": [
        {
            "avg_auth": 0.17170219,
            "avg_dhcp": 0.017828934,
            "avg_dns": 0.024532124,
            "min_auth": 0.16050219,
            "min_dhcp": 0.015828934,
            "min_dns": 0.022532124,
            "max_auth": 0.18170219,
            "max_dhcp": 0.027828934,
            "max_dns": 0.029532124,
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "org_id": "2818e386-8dec-2562-9ede-5b8a0fbbdc71",
            "timestamp": 1696401600
        }
    ]
}
</code></pre>
<h3 id="example-delivery-of-guest-authorizations">Example delivery of guest-authorizations</h3>
<pre><code>POST /uri/... HTTP/1.1
Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 596
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e
{
    "topic": "guest-authorizations",
    "events": [
        {
            "ap":"5c5b350e55c8",
            "auth_method": "passphrase",
            "authorized_expiring_time":1677076639,
            "authorized_time":1677076519,
            "carrier": "docomo",
            "client": "ac2316eca70a",
            "company": "MIST",
            "email": ""abcd@abcd.com",
            "field1": "field1 value",
            "field2": "field2 value",
            "field3": "field3 value",
            "field4": "field4 value",
            "mobile": "+0123456789",
            "name": "Dr Strange",
            "org_id":"1688605f-916a-47a1-8c68-f19618300a08",
            "site_id":"ec3b5624-73f1-4ed3-b3fd-5ba3ee40368a",
            "sms_gateway": "Telstra",
            "sponsor_email": "sponsor@gmail.com",
            "ssid":"Portal Auth",
            "wlan_id":"7681be9a-044a-4622-90cf-3accde5ad853",
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ap</code></td>
<td><code>string</code></td>
<td>mac address of the AP the guest is connected to</td>
</tr>
<tr>
<td><code>auth_method</code></td>
<td><code>string</code></td>
<td>authentication method used</td>
</tr>
<tr>
<td><code>authorized_expiring_time</code></td>
<td><code>int</code></td>
<td>expiry time for guest</td>
</tr>
<tr>
<td><code>authorized_time</code></td>
<td><code>int</code></td>
<td>time of authorization of guest</td>
</tr>
<tr>
<td><code>carrier</code></td>
<td><code>string</code></td>
<td>carrier used when authentication by free cell provider</td>
</tr>
<tr>
<td><code>client</code></td>
<td><code>string</code></td>
<td>client mac</td>
</tr>
<tr>
<td><code>email</code></td>
<td><code>string</code></td>
<td>guest email</td>
</tr>
<tr>
<td><code>field1</code></td>
<td><code>string</code></td>
<td>field1 value</td>
</tr>
<tr>
<td><code>field2</code></td>
<td><code>string</code></td>
<td>field2 value</td>
</tr>
<tr>
<td><code>field3</code></td>
<td><code>string</code></td>
<td>field3 value</td>
</tr>
<tr>
<td><code>field4</code></td>
<td><code>string</code></td>
<td>field4 value</td>
</tr>
<tr>
<td><code>mobile</code></td>
<td><code>string</code></td>
<td>mobile number</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>guest name</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>sms_gateway</code></td>
<td><code>string</code></td>
<td>sms gateway used via text auth paid service</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>ssid</td>
</tr>
<tr>
<td><code>wlan_id</code></td>
<td><code>string</code></td>
<td>wlan id</td>
</tr>
</tbody>
</table>
<h2 id="searchcount-webhooks-deliveries">Search/Count Webhooks Deliveries</h2>
<p>Topics Supported:</p>
<pre><code>- alarms
- audits
- device-updowns
- occupancy-alerts
- ping
</code></pre>
<h3 id="search-webhooks-deliveries">Search webhooks deliveries</h3>
<pre><code>GET /api/v1/sites/:site_id/webhooks/:webhook_id/events/search?status=success&amp;topic=device-updowns&amp;limit=10
</code></pre>
<h4 id="request_76">Request</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org ID</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site ID</td>
</tr>
<tr>
<td><code>webhook_id</code></td>
<td><code>string</code></td>
<td>webhook object ID</td>
</tr>
<tr>
<td><code>status</code></td>
<td><code>string</code></td>
<td>optional, success / failure</td>
</tr>
<tr>
<td><code>status_code</code></td>
<td><code>int</code></td>
<td>optional, HTTP response status code</td>
</tr>
<tr>
<td><code>topic</code></td>
<td><code>string</code></td>
<td>optional, webhook topic</td>
</tr>
</tbody>
</table>
<h4 id="example-responses">Example Responses</h4>
<pre><code>{
    "results": [
        {
            "id" : "47ea9366-bf66-427a-886a-153104bbf355",
            "org_id" : "929e52a7-9edc-4e2f-a836-1af577b043ed",
            "site_id" : "21134243-0667-44ae-8f58-42b640ad39bb",
            "webhook_id" : "6b0b5d05-430a-4414-86ca-eb081aff03e8",
            "status_code" : 200,
            "status": "success",
            "topic" : "ping",
            "req_headers" : "{"Content-Type":["application/json"],"User-Agent":["Mist-webhook"]}",
            "req_url" : "http://example.com",
            "req_payload" : "{"topic":"ping","events":[{"id":"6b0b5d05-430a-4414-86ca-eb081aff03e8","name":"webhook event delivery test","site_id":"21134243-0667-44ae-8f58-42b640ad39bb","timestamp":1685985159.0102212}]}",
            "resp_headers" : "{"Access-Control-Allow-Credentials":["true"],"Access-Control-Allow-Methods":["OPTIONS, HEAD, GET, POST, PUT, DELETE"],"Access-Control-Allow-Origin":["*"],"Access-Control-Expose-Headers":["Date, Server, X-Frame-Options"],"Access-Control-Max-Age":["3600"],"Content-Length":["3"],"Content-Type":["text/html; charset=utf-8"],"Date":["Mon, 05 Jun 2023 17:12:39 GMT"],"Server":["Apache/2.4.18 (Ubuntu)"],"X-Frame-Options":["SAMEORIGIN"]}",
            "resp_body" : "Ok"
        },
        {
            "id" : "55b0f02f-ebf6-4ad2-8b10-200508a97581",
            "org_id" : "fc7e2967-e7ef-41e6-b007-1217713de05a",
            "site_id" : "256c3a35-9cb7-436e-bc6d-314972645d95",
            "webhook_id" : "7a11b901-f719-4c91-8aef-deb8699a6364",
            "status_code" : 200,
            "status": "success",
            "topic" : "audits",
            "req_headers" : "{"Content-Type":["application/json"],"User-Agent":["Mist-webhook"]}",
            "req_url" : "http://example.com",
            "req_payload" : "{"topic":"audits","events":[{"admin_name":"John Doe john.doe@juniper.net","after":"{\"radio_config\": {\"band_24\": {\"disabled\": false, \"allow_rrm_disable\": false, \"power_min\": null, \"power_max\": null, \"power\": 10, \"preamble\": \"short\", \"channels\": [1, 10], \"bandwidth\": 20}}}","before":"{\"radio_config\": {\"band_24\": {\"disabled\": false, \"allow_rrm_disable\": false, \"power_min\": 8, \"power_max\": 18, \"power\": null, \"preamble\": \"long\", \"channels\": [1, 10], \"bandwidth\": 20}}}","id":"737909a2-04ff-4aeb-b9da-cc924e74a4dd","message":"Update Site Settings","org_id":"fc7e2967-e7ef-41e6-b007-1217713de05a","site_id":"256c3a35-9cb7-436e-bc6d-314972645d95","site_name":"Test Site","src_ip":"1.2.3.4","timestamp":1685956576.923601,"user_agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36"}]}",
            "resp_headers" : "{"Access-Control-Allow-Credentials":["true"],"Access-Control-Allow-Methods":["OPTIONS, HEAD, GET, POST, PUT, DELETE"],"Access-Control-Allow-Origin":["*"],"Access-Control-Expose-Headers":["Date, Server, X-Frame-Options"],"Access-Control-Max-Age":["3600"],"Content-Length":["3"],"Content-Type":["text/html; charset=utf-8"],"Date":["Mon, 05 Jun 2023 09:16:17 GMT"],"Server":["Apache/2.4.18 (Ubuntu)"],"X-Frame-Options":["SAMEORIGIN"]}",
            "resp_body" : "Ok"
        }
    ]
}
</code></pre>
<p><strong>Additional Response fields:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>delivery ID</td>
</tr>
<tr>
<td><code>req_headers</code></td>
<td><code>object</code></td>
<td>HTTP request headers</td>
</tr>
<tr>
<td><code>req_url</code></td>
<td><code>string</code></td>
<td>HTTP request URL</td>
</tr>
<tr>
<td><code>req_payload</code></td>
<td><code>object</code></td>
<td>HTTP request payload</td>
</tr>
<tr>
<td><code>resp_headers</code></td>
<td><code>object</code></td>
<td>HTTP response headers</td>
</tr>
<tr>
<td><code>resp_body</code></td>
<td><code>string</code></td>
<td>HTTP response body</td>
</tr>
<tr>
<td><code>error</code></td>
<td><code>string</code></td>
<td>error message, if there is one</td>
</tr>
</tbody>
</table>
<h3 id="count-webhooks-deliveries">Count webhooks deliveries</h3>
<pre><code>GET /api/v1/sites/:site_id/webhooks/:webhook_id/events/count?distinct=status&amp;topic=device-updowns&amp;limit=10
</code></pre>
<h4 id="request_77">Request</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org ID</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site ID</td>
</tr>
<tr>
<td><code>webhook_id</code></td>
<td><code>string</code></td>
<td>webhook object ID</td>
</tr>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>optional, status / topic / status_code / webhook_id (default)</td>
</tr>
<tr>
<td><code>status</code></td>
<td><code>string</code></td>
<td>optional, success / failure</td>
</tr>
<tr>
<td><code>status_code</code></td>
<td><code>int</code></td>
<td>optional, HTTP response status code</td>
</tr>
<tr>
<td><code>topic</code></td>
<td><code>string</code></td>
<td>optional, webhook topic</td>
</tr>
</tbody>
</table>
<h4 id="example-responses_1">Example Responses</h4>
<pre><code>{
    "results": [
        {
            "status": "success",
            "count": 20
        },
        {
            "status": "failure",
            "count": 1
        }
    ],
    "limit": 10,
    "start": 1712085924,
    "end": 1712172324,
    "distinct": "status",
    "total": 2
}
</code></pre>
<h1 id="subscriptions">Subscriptions</h1>
<p>Subscriptions define how Site Alerts/Reports are delivered to whom</p>
<h2 id="subscribe">Subscribe</h2>
<pre><code>POST /api/v1/sites/:site_id/subscriptions
</code></pre>
<h2 id="unsubscribe">Unsubscribe</h2>
<pre><code>DELETE /api/v1/sites/:site_id/subscriptions
</code></pre>
<h2 id="get-all-the-subscriptions">Get all the subscriptions</h2>
<pre><code>GET /api/v1/self/subscriptions
</code></pre>
<h1 id="device-stats">Device Stats</h1>
<p>To improve performance and reduce response size, please use paginated requests. We strongly recommend specifying pagination parameters when calling these endpoints. Even though a call without pagination parameters will return the full list of device stats, this behavior is temporary. In the future, paginated responses (with default values of <code>limit=100</code> and <code>page=1</code>) will be enforced.</p>
<p><strong>Query Parameters for Pagination:</strong></p>
<ul>
<li><strong><code>limit</code></strong>: The maximum number of items to return per page (default is 100).</li>
<li><strong><code>page</code></strong>: The page number to return (default is 1).</li>
</ul>
<p>When you include these parameters in your request, the response will also contain the following HTTP headers:
- <code>X-Page-Page</code>: The current page number.
- <code>X-Page-Limit</code>: The limit per page.
- <code>X-Page-Total</code>: The total number of items in the result set.</p>
<h2 id="get-device-current-stats">Get Device Current Stats</h2>
<p><code>/stats</code> returns a combined view of the device which includes configs and stats.</p>
<pre><code>GET /api/v1/sites/:site_id/stats/devices?limit=100&amp;page=1
</code></pre>
<h3 id="request_78">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>ap, switch, gateways, all. Default is ap</td>
</tr>
<tr>
<td><code>status</code></td>
<td><code>string</code></td>
<td>all, connected, disconnected. Default is all</td>
</tr>
</tbody>
</table>
<h3 id="response_104">Response</h3>
<pre><code>[
    {
        # information from manufacturing, immutable
        "mac": "5c5b35000010",
        "model": "AP200",
        "type": "ap",
        "serial": "FXLH2015170017",
        "last_seen": 1470417522,

        # configurations
        "name": "conference room",
        "map_id": "63eda950-c6da-11e4-a628-60f81dd250cc",
        "x": 53.5,
        "y": 173.1,
        "radio_config": {
            "band_24": {
                "channel": 0,
                "bandwidth": 20,
                "power": 0,
                "dynamic_chaining_enabled": false,
                "tx_chain": 4,
                "rx_chain": 4
            },
            "band_5": {
                "channel": 0,
                "bandwidth": 40,
                "power": 0,
                "dynamic_chaining_enabled": false,
                "tx_chain": 1,
                "rx_chain": 4
            },
            "band_6": {
                "channel": 0,
                "bandwidth": 40,
                "power": 0,
                "tx_chain": 1,
                "rx_chain": 4
            },
            "scanning_enabled": true
        },
        "ip_config": {
            "type": "static",
            "ip": "10.2.1.1",
            "netmask": "255.255.255.0",
            "gateway": "10.2.1.254",
            "dns": [ "8.8.8.8", "4.4.4.4" ],
            "dns_suffix": [ ".mist.local", ".mist.com" ]
        },
        "ble_config": {
            "power_mode": "custom",
            "power": 10,
            "beacon_rate_model": "custom",
            "beacon_rate": 3,
            "beam_disabled": [ 1, 3, 6 ]
        },
        "led": {
            "enabled": true,
            "brightness": 255
        },

        # current stat
        "status": "connected",
        "version": "1.0.0",
        "ip": "10.2.9.159", // first IP
        "ext_ip": "73.92.124.103",
        "num_clients": 10,
        "num_wlans": 2,
        "uptime": 13500,
        "tx_bps": 634301,
        "rx_bps": 60003,
        "tx_bytes": 211217389682,
        "tx_pkts": 812204062,
        "rx_bytes": 8515104416,
        "rx_pkts": 57770567,

        "locating": false,

        "radio_stat": {
            "band_24": {
                "mac": "5c5b350004a0"
                "channel": 6,
                "bandwidth": 20,
                "power": 19,
                "num_wlans": 1,
                "num_clients": 6,
                "tx_bytes": 211166512114,
                "tx_pkts": 812058566,
                "rx_bytes": 8504737800,
                "rx_pkts": 57731964
            },
            "band_5": {
                "mac": "5c5b350004b0"
                "channel": 44,
                "bandwidth": 80,
                "power": 15,
                "num_wlans": 1,
                "num_clients": 4,
                "tx_bytes": 50877568,
                "tx_pkts": 145496,
                "rx_bytes": 10366616,
                "rx_pkts": 38603
            }
        },
        "port_stat": {
            "eth0": {
                "up": true,
                "speed": 1000,
                "full_duplex": true,
                "tx_bytes": 2056,
                "tx_pkts": 670,
                "rx_bytes": 2056,
                "rx_pkts": 670,
                "rx_errors": 0,
            },
            "eth1": {
                "up": false
            },
            "module": {
                "up": false
            }
        },
        "ip_stat": {
            "ip": "10.2.1.1",
            "netmask": "255.255.255.0",
            "gateway": "10.2.1.254",
            "ip6": "2607:f8b0:4005:808::2004",
            "netmask6": "/32",
            "gateway6": "2607:f8b0:4005:808::1",
            "dns": [ "8.8.8.8", "4.4.4.4" ],
            "dns_suffix": [ ".mist.local", ".mist.com" ],
            "ips": {
                "vlan1": "10.2.1.1/24,2607:f8b0:4005:808::1/32",
                "vlan193": "10.73.1.31/16",
                "vlan3157": "10.72.11.14/24"
            }
        },
        "ble_stat": {
            "power": 10,
            "beacon_rate": 3,
            "uuid": "ada72f8f-1643-e5c6-94db-f2a5636f1a64",
            "major": 12345,
            "minors": [ 201, 202, 203, 204, 205, 206, 207, 208 ],
            "tx_pkts": 135135135,
            "tx_bytes": 5231513353,
            "tx_resets": 0,
            "rx_pkts": 135,
            "rx_bytes": 135,

            "ibeacon_enabled": true,
            "ibeacon_uuid": "f3f17139-704a-f03a-2786-0400279e37c3",
            "ibeacon_major": 13,
            "ibeacon_minor": 138,

            "eddystone_uid_enabled": false,
            "eddystone_uid_namespace": "2818e3868dec25629ede",
            "eddystone_uid_instance": "5c5b35000001",
            "eddystone_uid_freq_msec": 200,

            "eddystone_url_enabled": true,
            "eddystone_url_url": "https://www.abc.com",
            "eddystone_url_freq_msec": 100
        },
        "l2tp_stat": {
            "7dae216d-7c98-a51b-e068-dd7d477b7216": {
                "wxtunnel_id": "7dae216d-7c98-a51b-e068-dd7d477b7216",
                "state": "established_with_sessions",
                "uptime": 135,
                "sessions: [
                    {
                        "remote_id": "vpn1",
                        "state": "established",
                        "remote_sid": 13,
                        "local_sid": 31
                    }
                ]
            }
        },
        "lldp_stat": {
            "system_name": "TC2-OWL-Stack-01",
            "system_desc": "HP J9729A 2920-48G-POE+ Switch",
            "mgmt_addr": "10.1.5.2",
            "mgmt_addrs": ["10.1.5.2", "2002:A01:203:0:0:0:0:0"],
            "lldp_med_supported": false,
            "port_desc": "2/26",
            "port_id": "port1",
            "chassis_id": "63:68:61:73:73:69",
            "lldp_med_supported": false,
            "power_request_count": 3,
            "power_allocated": 15500,
            "power_requested": 25500,
            "power_draw": 15000
        },
        "lldp_stats": {
            "eth0": {
                "system_name": "TC2-OWL-Stack-01",
                "system_desc": "HP J9729A 2920-48G-POE+ Switch",
                "mgmt_addr": "10.1.5.2",
                "mgmt_addrs": ["10.1.5.2", "2002:A01:203:0:0:0:0:0"],
                "lldp_med_supported": false,
                "port_desc": "2/26",
                "port_id": "port1",
                "chassis_id": "63:68:61:73:73:69",
                "lldp_med_supported": false,
                "power_request_count": 3,
                "power_allocated": 15500,
                "power_requested": 25500,
                "power_draw": 15000
            },
            "eth1": {
                "system_name": "TC2-OWL-Stack-02",
                "system_desc": "HP J9728A 2920-24G-POE+ Switch",
                "mgmt_addr": "10.1.5.3",
                "mgmt_addrs": ["10.1.5.3"],
                "lldp_med_supported": true,
                "port_desc": "1/12",
                "port_id": "port2",
                "chassis_id": "chassis2",
                "power_request_count": 2,
                "power_allocated": 15400,
                "power_draw": 14000,
                "power_requested": 15400
            }
        },
        "power_src": "PoE 802.3at",
        "power_srcs": ["PoE 802.3at", "PoE 802.3af"],
        "power_budget": -12000,
        "power_constrained": true,
        "power_opmode": "[20] 6GHz(2x2) 5GHz(4x4) 2.4GHz(2x2).",

        "switch_redundancy": {
            "num_redundant_aps": 1,
        },

        "ant_mode": "external",  // if AP supported

        // IoT stats
        "iot_stat": {
            "DI2": {
                "value": 0
            }
        },

        // Environment stats
        "env_stat": {
            "cpu_temp": 51,
            "ambient_temp": 39,
            "humidity": 11,
            "attitude": 0,
            "pressure": 1015
            "accel_x": -0.012,
            "accel_y": 0.004,
            "accel_z": -1.012,
            "magne_x": 0.0,
            "magne_y": 1.3,
            "magne_z": 0.0,
            "vcore_voltage": 0
        }，
        "mount": 'faceup',


        // ESL Stats
        "esl_stat": {
            "up": true,
            "type": "imagotag",  // if up

            // following are type-dependent
            "connected": true,
            "channel": 3,
        },

        // for a base AP
        "mesh_downlinks": {
            "00000000-0000-0000-1000-5c5b356be59f": {
                "site_id": "0e525da3-6033-428c-9a51-9f652f643baf",
                "band": "24",
                "proto": "a",
                "channel": 7,

                "last_seen": 1470417522,
                "idle_time": 3,

                "rssi": -65,
                "snr": 31,
                "tx_rate": 65,
                "rx_rate": 65,

                "tx_bytes": 175132,
                "tx_bps": 6,
                "tx_packets": 1566,
                "tx_retries": 500,
                "rx_bytes": 217416,
                "rx_bps": 12,
                "rx_packets": 2337,
                "rx_retries": 5
            }
        },

        // for a remote/relay AP
        "mesh_uplink": {
            "uplink_ap_id": "00000000-0000-0000-1000-5c5b35000010",
            "uplink_site_id": "1916d52a-4a90-11e5-8b45-1258369c38a9",
            "band": "24",
            "proto": "a",
            "channel": 7,

            "last_seen": 1470417522,
            "idle_time": 3,

            "rssi": -65,
            "snr": 31,
            "tx_rate": 65,
            "rx_rate": 65,

            "tx_bytes": 175132,
            "tx_bps": 6,
            "tx_packets": 1566,
            "tx_retries": 500,
            "rx_bytes": 217416,
            "rx_bps": 12,
            "rx_packets": 2337,
            "rx_retries": 5
        },
        "fwupdate": {
            "timestamp": 1428949501,
            "status": "inprogress",
            "status_id": 5,
            "progress": 10
        },

        "last_trouble": {
            "code": "03",
            "timestamp": 1428949501
        },

        // if RADSec is enabled, device certs will be automatically generated and managed
        // with the expiration time exposed
        "cert_expiry": 1534534392
        "expiring_certs": {
            "483412046338348876283259475264040058183366677871": 1534534392,  // serial_number -&gt; expiry timestamp
            "375895068012951219417723061830777179121567314483": 1535534392
        },
        "locked": false,
        "auto_placement": {
            "x": 53.5,
            "y": 173.1,
            "x_m": 5.35,
            "y_m": 17.31,
            "status": "localized",
            "status_detail": "localized",
            "recommended_anchor": false,
            "info": {
                "cluster_number": 0,
                "orientation_state": 0,
                "probability_surface": {
                    "radius": 2.1,
                    "x": 5.65,
                    "y": 17.10
                }
            },
            "_id": "5c5b35000010"
        },
        "gps_stat": {
            "altitude": 99.939,
            "latitude": 37.29548,
            "longitude": -122.03304,
            "src": "gps",
            "timestamp": 1428949501,
            "accuracy": 12.5
        }
    }
]
</code></pre>
<h3 id="switch-stats">Switch Stats</h3>
<pre><code>{
    "mac": "dc38e1dbf3cd",
    "model": "EX4600",
    "type": "switch",
    "serial": "TC3714190003",
    "last_seen": 1553203563,

    # configurations
    "name": "xg50b",  // configured

    # current stat
    "hostname": "sj-sw1",  //reported
    "status": "connected",
    "version": "18.4R1.8",
    "ip": "10.2.11.137", // first IP

    "uptime": 13500,
    "ip_stat": {
        "ip": "10.2.11.137",
        "netmask": "255.255.192.0",
        "gateway": "10.2.1.1",
        "ip6": "2607:f8b0:4005:808::2004",
        "netmask6": "/32",
        "gateway6": "2607:f8b0:4005:808::1",
        "dns": [ "8.8.8.8", "4.4.4.4" ],
        "dns_suffix": [ ".mist.local", ".mist.com" ],
        "ips": {
            "vlan1": "10.2.1.1/24,2607:f8b0:4005:808::1/32",
            "vlan193": "10.73.1.31/16",
            "vlan3157": "10.72.11.14/24"
        }
    },
    "cpu_stat": {
        "interrupt": 8,
        "idle": 28,
        "user": 23,
        "system": 41,
        "load_avg": [
            0.9700000286102295,
            1.0499999523162842,
            1.0199999809265137
        ],
    },
    "memory_stat": {
        "usage": 35
    },
    "if_stat": {
        "ge-0/0/9.0": {
            "tx_pkts": 3625,
            "rx_pkts": 3630,
            "rx_bytes": 1255980,
            "port_id": "ge-0/0/9",
            "up": true,
            "tx_bytes": 1511602
        },
        "irb.125": {
            "tx_pkts": 10971,
            "vlan": 125,
            "rx_pkts": 8683,
            "rx_bytes": 695212,
            "port_id": "irb",
            "up": false,
            "ips": [
                "80.80.80.1/24"
            ],
            "tx_bytes": 1061466
        },
        "me0.0": {
            "tx_pkts": 939805,
            "rx_pkts": 720490,
            "rx_bytes": 75544938,
            "port_id": "me0",
            "up": true,
            "ips": [
                "60.60.60.5/24"
            ],
            "tx_bytes": 248394725
        }
     },
    "module_stat": [
        {
            "vc_role": "master",
            "model": "EX4300-48P",
            "serial": "PX8716230021",
            "fans": [
                {
                    "name": "Fan 0"
                    "status": "absent",
                },
                {
                    "name": "Fan 1"
                    "airflow": "out",
                    "status": "ok"
                }
            ],
            "temperatures": [
                {
                    "name": "CPU",
                    "status": "ok",
                    "celsius": 45.0
                }
            ],
            "psus": [
                {
                    "name": "Power Supply 0",
                    "status": "ok"
                },
                {
                    "name": "Power Supply 1",
                    "status": "failed"
                }
            ],
            "poe": {
                "max_power": 250.0,
                "power_draw": 120.3
            },
            "vc_links": [
                {
                    "port_id": "vcp-255/1/0",
                    "neighbor_module_idx": 1,
                    "neighbor_port_id": "vcp-255/1/0"
                }
            ],
            "pics": [
                {
                    "idx": 0,
                    "port_groups": [
                        {
                            "type": "sfp+", "count": 12
                        }
                    ]
                }
            ]
        }
    ],
    "clients": [
        {
            "port_id": "eth-0/0/0,ge-0/0/1",
            "mac": "b0c4e7001544",
            "hostname": "test-sw1",
            "device_mac": "dc38e1dbf3cd",
        }
    ],
    "num_clients": {
        "total": {
            "num_clients": 5,
            "num_aps": 3,
        },
        "0": {
            "num_clients": 2,
            "num_aps": 1,
        }
    },
    "last_trouble": {
        "code": "110",
        "timestamp": 1666258858685
    },
    "has_pcap": true
}
</code></pre>
<h3 id="gateway-stats">Gateway Stats</h3>
<pre><code>{
    "mac": "dc38e1dbf3cd",
    "model": "SRX320",
    "type": "gateway",
    "serial": "TC3714190003",
    "last_seen": 1553203563,

    # configurations
    "name": "sj1",  // configured

    # current stat
    "hostname": "sj1",  // reported
    "status": "connected",
    "version": "18.4R1.8",
    "ip": "10.2.11.137", // first IP

    "uptime": 13500,
    "ip_stat": {
        "ip": "10.2.11.137",
        "netmask": "255.255.192.0",
        "gateway": "10.2.1.1",
        "ip6": "2607:f8b0:4005:808::2004",
        "netmask6": "/32",
        "gateway6": "2607:f8b0:4005:808::1",
        "dns": [ "8.8.8.8", "4.4.4.4" ],
        "dns_suffix": [ ".mist.local", ".mist.com" ],
        "ips": {
            "vlan1": "10.2.1.1/24,2607:f8b0:4005:808::1/32",
            "vlan193": "10.73.1.31/16",
            "vlan3157": "10.72.11.14/24"
        }
    },
    "dhcpd_stat": {
        "LAN-network-name-here": {
            "num_ips": 100,
            "num_leased": 20
        }
    },
    "cpu_stat": {
        "interrupt": 8,
        "idle": 28,
        "user": 23,
        "system": 41,
        "load_avg": [
            0.9700000286102295,
            1.0499999523162842,
            1.0199999809265137
        ],
    },
    "memory_stat": {
        "usage": 35
    },

    // for a Gateway, the SPU (Services Processing Unit) stats
    "spu_stat": {
        "cpu": 15,
        "memory": 32,
        "sessions": {
            "current": 41,
            "valid": 15,
            "pending": 12,
            "max": 65535
        }  
    },

    "module_stat": [
        {
            "vc_role": "master",
            "model": "EX4300-48P",
            "serial": "PX8716230021",
            "fans": [
                {
                    "name": "Fan 0"
                    "status": "absent",
                },
                {
                    "name": "Fan 1"
                    "airflow": "out",
                    "status": "ok"
                }
            ],
            "temperatures": [
                {
                    "name": "CPU",
                    "status": "ok",
                    "celsius": 45.0
                }
            ],
            "psus": [
                {
                    "name": "Power Supply 0",
                    "status": "ok"
                },
                {
                    "name": "Power Supply 1",
                    "status": "failed"
                }
            ],
            "poe": {
                "max_power": 250.0,
                "power_draw": 120.3
            },
            "vc_links": [
                {
                    "port_id": "vcp-255/1/0",
                    "neighbor_module_idx": 1,
                    "neighbor_port_id": "vcp-255/1/0"
                }
            ],

            // `errors` array in `module{,2}_stat` is used to report all error states the device node is running into
            "errors": [
                // An error should always have `type` and `since` fields, and could have some other fields specific to that type.

                // FW_UPGRADE_REQUIRED_BY_FEATURE error: generated when SSR is running an non-compliance firmware version.
                {
                    "type": "FW_UPGRADE_REQUIRED_BY_FEATURE",
                    "since": 1657497600,

                    "feature": "Mist-Management",
                    "minimum_version": "128T-6.0.0-1"
                },

                // INACTIVE error: generated when SSR 128T service is stopped
                {
                    "type": "INACTIVE",
                    "since": 1657497600
                },

                // HA_FW_MISMATCH error: generated when SSR cluster node firmware versions do not match
                {
                    "type": "HA_FW_MISMATCH",
                    "since": 1658244424
                },

                // HA_FORMATION_FAILED / HA_DISSOLUTION_FAILED error: generated when HA formation / dissolution failed
                {
                    "type": "HA_FORMATION_FAILED",  // HA_FORMATION_FAILED or HA_DISSOLUTION_FAILED
                    "since": 1658277429,

                    "reason": "config invalid"
                },

                // HA_DOWN error: generated when HA formed but not working properly
                {
                    "type": "HA_DOWN",
                    "since": 1658277429
                },

                // CONFIG_OUT_OF_SYNC / CONFIG_REVERTED error: generated when config out-of-sync / reverted is detected
                {
                    "type": "CONFIG_OUT_OF_SYNC",                   // CONFIG_OUT_OF_SYNC or CONFIG_REVERTED
                    "since": 1684825000.123456
                },

                // UNABLE_TO_CONNECT_TO_LOG_SERVER error: generated when srx device not connected with Mist srx-log-term service
                {
                    "type": "UNABLE_TO_CONNECT_TO_LOG_SERVER",
                    "since": 1709203262
                },

                // REBOOT_REQUIRED error: generated when some config change requires SSR device to be rebooted
                {
                    "type": "REBOOT_REQUIRED",
                    "since": 1720403426
                }
            ]
        }
    ],

    // for HA, all above stats are for node0
    // node1 stats are expressed in
    "ip2_stat": ...
    "dhcpd2_stat": ...
    "cpu2_stat": ...
    "memory2_stat": ...
    "spu2_stat": ...
    "module2_stat": ...

    "cluster_stat": {
        "
        "node0": {
            "status": "
        },
        "node1": {
            ...
        }
    },

    // redundancy
    "ap_redundancy": {
        "num_aps": 15,
        "num_aps_with_switch_redundancy": 8,

        # for a VC / stacked switches
        "modules": {
            "1": {
                "num_aps": 15,
                "num_aps_with_switch_redundancy": 8
            },
            ...
        }
    }
}
</code></pre>
<h3 id="device-stat-definition">Device Stat Definition</h3>
<p>Also see <a href="https://api.mist.com/api/v1/docs/Site#device-config">Device Config</a></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>device mac</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>device model</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>device type, ap / ble</td>
</tr>
<tr>
<td><code>serial</code></td>
<td><code>string</code></td>
<td>serial</td>
</tr>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>firmware version</td>
</tr>
<tr>
<td><code>last_seen</code></td>
<td><code>long</code></td>
<td>last seen timestamp</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>device name if configured</td>
</tr>
<tr>
<td><code>hostname</code></td>
<td><code>string</code></td>
<td>hostname reported by the device</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>IP address</td>
</tr>
<tr>
<td><code>ext_ip</code></td>
<td><code>string</code></td>
<td>External / Public IP</td>
</tr>
<tr>
<td><code>status</code></td>
<td><code>string</code></td>
<td>connected / disconnected / restarting / upgrading</td>
</tr>
<tr>
<td><code>uptime</code></td>
<td><code>long</code></td>
<td>how long, in seconds, has the device been up (or rebooted)</td>
</tr>
<tr>
<td><code>num_clients</code></td>
<td><code>int</code></td>
<td>how many wireless clients are currently connected</td>
</tr>
<tr>
<td><code>num_wlans</code></td>
<td><code>int</code></td>
<td>how many WLANs are applied to the device</td>
</tr>
<tr>
<td><code>tx_bps</code></td>
<td><code>float</code></td>
<td>rate of transmitting traffic to the clients, bits/seconds, last known</td>
</tr>
<tr>
<td><code>rx_bps</code></td>
<td><code>float</code></td>
<td>rate of receiving traffic from the clients, bits/seconds, last known</td>
</tr>
<tr>
<td><code>tx_bytes</code></td>
<td><code>float</code></td>
<td>amount of transmitting traffic to the clients, since reboot</td>
</tr>
<tr>
<td><code>rx_bytes</code></td>
<td><code>float</code></td>
<td>amount of receiving traffic from the clients, since reboot</td>
</tr>
<tr>
<td><code>tx_pkts</code></td>
<td><code>float</code></td>
<td>amount of transmitting traffic to the clients, since reboot</td>
</tr>
<tr>
<td><code>rx_pkts</code></td>
<td><code>float</code></td>
<td>amount of receiving traffic from the clients, since reboot</td>
</tr>
<tr>
<td><code>locating</code></td>
<td><code>boolean</code></td>
<td>whether the device is in locating mode (LED blinking)</td>
</tr>
<tr>
<td><code>ip_config</code></td>
<td><code>object</code></td>
<td>IP config, see Device Config</td>
</tr>
<tr>
<td><code>ip_stat</code></td>
<td><code>object</code></td>
<td>current IP information, see Device Config</td>
</tr>
<tr>
<td><code>module_stat</code></td>
<td><code>array</code></td>
<td>device chassis stats, member index == array index (e.g. member 0 is at index 0)</td>
</tr>
<tr>
<td><code>if_stat</code></td>
<td><code>object</code></td>
<td>a map of interface stats</td>
</tr>
<tr>
<td><code>memory_stat</code></td>
<td><code>object</code></td>
<td>memory usage stat (for virtual chassis, memory usage of master RE)</td>
</tr>
<tr>
<td><code>cpu_stat</code></td>
<td><code>object</code></td>
<td>a map of CPU usage stat</td>
</tr>
<tr>
<td><code>module_stat.vc_role</code></td>
<td><code>string</code></td>
<td>device chassis stack role (e.g. master/backup)</td>
</tr>
<tr>
<td><code>ips</code></td>
<td><code>object</code></td>
<td>all IPs the devices has, internal interface name -&gt; CIDR mapping</td>
</tr>
<tr>
<td><code>radio_config</code></td>
<td><code>object</code></td>
<td>a map of radio config, see Device Config</td>
</tr>
<tr>
<td><code>led</code></td>
<td><code>object</code></td>
<td>device LED control, see Device Config</td>
</tr>
<tr>
<td><code>env_stat</code></td>
<td><code>object</code></td>
<td>device environment, including CPU temperature, Ambient temperature, Humidity, Attitude, Pressure, Accelerometers, Magnetometers and vCore Voltage</td>
</tr>
<tr>
<td><code>locked</code></td>
<td><code>boolean</code></td>
<td>whether this AP is considered locked (placement / orientation has been vetted)</td>
</tr>
<tr>
<td><code>last_trouble</code></td>
<td><code>object</code></td>
<td>last trouble code of switch</td>
</tr>
<tr>
<td><code>auto_placement</code></td>
<td><code>object</code></td>
<td>auto placement stats</td>
</tr>
<tr>
<td><code>gps_stat</code></td>
<td><code>object</code></td>
<td>gps stats</td>
</tr>
<tr>
<td><code>has_pcap</code></td>
<td><code>boolean</code></td>
<td>whether the switch supports packet capture</td>
</tr>
<tr>
<td><code>expiring_certs</code></td>
<td><code>object</code></td>
<td>a map of certificate serial numbers to their expiry timestamps (in epoch) for certificates expiring within 30 days</td>
</tr>
<tr>
<td><code>ant_mode</code></td>
<td><code>string</code></td>
<td>internal / external antenna for AP which supports selectable antennas</td>
</tr>
</tbody>
</table>
<h4 id="radio-config-status">Radio Config / Status</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>radio_stat</code></td>
<td><code>object</code></td>
<td>a map of radio stats, key can be band_24 / band_5</td>
</tr>
<tr>
<td><code>band_24</code></td>
<td><code>object</code></td>
<td>radio stat of 2.4G radio</td>
</tr>
<tr>
<td><code>band_5</code></td>
<td><code>object</code></td>
<td>radio stat of 5G radio</td>
</tr>
<tr>
<td><code>band_6</code></td>
<td><code>object</code></td>
<td>radio stat of 6G radio</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>radio (base) mac, it can have 16 bssids (e.g. 5c5b350001a0-5c5b350001af)</td>
</tr>
<tr>
<td><code>channel</code></td>
<td><code>int</code></td>
<td>current channel the radio is running on</td>
</tr>
<tr>
<td><code>bandwidth</code></td>
<td><code>int</code></td>
<td>current channel bandwidth, 20 / 40 / 80 / 160</td>
</tr>
<tr>
<td><code>power</code></td>
<td><code>int</code></td>
<td>transmit power (in dBm)</td>
</tr>
<tr>
<td><code>util_all</code></td>
<td><code>int</code></td>
<td>all utilization in percentage</td>
</tr>
<tr>
<td><code>util_tx</code></td>
<td><code>int</code></td>
<td>transmission utilization in percentage</td>
</tr>
<tr>
<td><code>util_rx_in_bss</code></td>
<td><code>int</code></td>
<td>reception of “In BSS” utilization in percentage, only frames that are received from AP/STAs within the BSS</td>
</tr>
<tr>
<td><code>util_rx_other_bss</code></td>
<td><code>int</code></td>
<td>reception of “Other BSS” utilization in percentage, all frames received from AP/STAs that are outside the BSS</td>
</tr>
<tr>
<td><code>util_unknown_wifi</code></td>
<td><code>int</code></td>
<td>reception of “No Category” utilization in percentage, all 802.11 frames that are corrupted at the receiver</td>
</tr>
<tr>
<td><code>util_non_wifi</code></td>
<td><code>int</code></td>
<td>reception of “No Packets” utilization in percentage, received frames with invalid PLCPs and CRC glitches as noise</td>
</tr>
<tr>
<td><code>util_undecodable_wifi</code></td>
<td><code>int</code></td>
<td>reception of “UnDecodable Wifi” utilization in percentage, only Preamble, PLCP header is decoded, Rest is undecodable in this radio</td>
</tr>
<tr>
<td><code>dynamic_chaining_enabled</code></td>
<td><code>boolean</code></td>
<td>Use dynamic chaining for downlink</td>
</tr>
<tr>
<td><code>tx_chain</code></td>
<td><code>int</code></td>
<td>number of chains to use for tx. This is only used when dynamic chaining is not enabled</td>
</tr>
<tr>
<td><code>rx_chain</code></td>
<td><code>int</code></td>
<td>number of chains to use for rx. This is only used when dynamic chaining is not enabled</td>
</tr>
<tr>
<td><code>num_wlans</code></td>
<td><code>int</code></td>
<td>how many WLANs are applied to the device</td>
</tr>
</tbody>
</table>
<h4 id="port-status">Port Status</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>port_stat</code></td>
<td><code>objects</code></td>
<td>ports status</td>
</tr>
<tr>
<td><code>eth0</code></td>
<td><code>object</code></td>
<td>port status of eth0 (eth0+PoE)</td>
</tr>
<tr>
<td><code>eth1</code></td>
<td><code>object</code></td>
<td>port status of eth1</td>
</tr>
<tr>
<td><code>eth2</code></td>
<td><code>object</code></td>
<td>port status of eth2</td>
</tr>
<tr>
<td><code>eth3</code></td>
<td><code>object</code></td>
<td>port status of eth3</td>
</tr>
<tr>
<td><code>module</code></td>
<td><code>object</code></td>
<td>port status of module port</td>
</tr>
<tr>
<td><code>up</code></td>
<td><code>boolean</code></td>
<td>whether the port is up, default is false (down)</td>
</tr>
<tr>
<td><code>speed</code></td>
<td><code>int</code></td>
<td>10 / 100 / 1000 / 2500, Mbps (mega bits per second)</td>
</tr>
<tr>
<td><code>full_duplex</code></td>
<td><code>boolean</code></td>
<td>true / false</td>
</tr>
</tbody>
</table>
<ul>
<li><code>port_stat</code>: different type/model of devices may have different number of ports</li>
</ul>
<h4 id="l2tp-status">L2TP Status</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>l2tp_stat</code></td>
<td><code>objects</code></td>
<td>l2tp tunnel status (key is the wxtunnel_id)</td>
</tr>
<tr>
<td><code>wxtunnel_id</code></td>
<td><code>string</code></td>
<td>WxlanTunnel ID</td>
</tr>
<tr>
<td><code>state</code></td>
<td><code>string</code></td>
<td>idle / wait-ctrl-reply / wait-ctrl-conn / established / established_with_sessions</td>
</tr>
<tr>
<td><code>uptime</code></td>
<td><code>int</code></td>
<td>uptime</td>
</tr>
<tr>
<td><code>sessions</code></td>
<td><code>list</code></td>
<td>list of sessions</td>
</tr>
<tr>
<td><code>remote_id</code></td>
<td><code>string</code></td>
<td>WxlanTunnel Remote ID (user-configured)</td>
</tr>
<tr>
<td><code>remote_sid</code></td>
<td><code>int</code></td>
<td>remote sessions id (dynamically unless Tunnel is said to be static)</td>
</tr>
<tr>
<td><code>local_sid</code></td>
<td><code>int</code></td>
<td>remote sessions id (dynamically unless Tunnel is said to be static)</td>
</tr>
</tbody>
</table>
<h4 id="lldp-status">LLDP Status</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>lldp_stat</code></td>
<td><code>object</code></td>
<td>LLDP neighbor information and power negotiations. For backward compatibility, when multiple neighbors exist, only information from the first neighbor is displayed.</td>
</tr>
<tr>
<td><code>lldp_stats</code></td>
<td><code>object</code></td>
<td>Map of ethernet ports (“eth0”, “eth1”, etc.) to their respective LLDP neighbor information and power negotiations. Only present when multiple neighbors exist.</td>
</tr>
<tr>
<td><code>system_name</code></td>
<td><code>string</code></td>
<td>Name of the switch, e.g. “TC2-OWL-Stack-01”</td>
</tr>
<tr>
<td><code>system_desc</code></td>
<td><code>string</code></td>
<td>Description provided by switch, e.g. “HP J9729A 2920-48G-POE+ Switch”</td>
</tr>
<tr>
<td><code>mgmt_addr</code></td>
<td><code>string</code></td>
<td>Management IP address of the switch</td>
</tr>
<tr>
<td><code>mgmt_addrs</code></td>
<td><code>string[]</code></td>
<td>List of management IP addresses (IPv4 and IPv6)</td>
</tr>
<tr>
<td><code>port_desc</code></td>
<td><code>string</code></td>
<td>Port description, e.g. “2/20”, “Port 2 on Switch0”</td>
</tr>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>Port identifier</td>
</tr>
<tr>
<td><code>chassis_id</code></td>
<td><code>string</code></td>
<td>Chassis identifier</td>
</tr>
<tr>
<td><code>lldp_med_supported</code></td>
<td><code>boolean</code></td>
<td>Whether LLDP-MED is supported</td>
</tr>
<tr>
<td><code>power_request_count</code></td>
<td><code>int</code></td>
<td>Number of power negotiations</td>
</tr>
<tr>
<td><code>power_allocated</code></td>
<td><code>int</code></td>
<td>In mW, power allocated by PSE</td>
</tr>
<tr>
<td><code>power_requested</code></td>
<td><code>int</code></td>
<td>In mW, power requested by PD</td>
</tr>
<tr>
<td><code>power_draw</code></td>
<td><code>int</code></td>
<td>In mW, total power needed by PD</td>
</tr>
<tr>
<td><code>power_src</code></td>
<td><code>string</code></td>
<td>Single power source (DC Input / PoE 802.3at / PoE 802.3af / PoE 802.3bt / MULTI-PD / LLDP / ? (unknown)).</td>
</tr>
<tr>
<td><code>power_srcs</code></td>
<td><code>string</code></td>
<td>A list of multiple power sources. (DC Input / PoE 802.3at / PoE 802.3af / PoE 802.3bt / MULTI-PD / LLDP / ? (unknown) / NONE (no power on the port))</td>
</tr>
<tr>
<td><code>power_avail</code></td>
<td>`int</td>
<td>In mW, total Power Avail at AP from pwr source</td>
</tr>
<tr>
<td><code>pwr_needed</code></td>
<td><code>int</code></td>
<td>In mW, total Power needed incl Peripherals</td>
</tr>
<tr>
<td><code>power_budget</code></td>
<td><code>int</code></td>
<td>In mW, surplus if positive or deficit if negative</td>
</tr>
<tr>
<td><code>power_constrained</code></td>
<td><code>boolean</code></td>
<td>Whether power is insufficient</td>
</tr>
<tr>
<td><code>power_opmode</code></td>
<td><code>string</code></td>
<td>Constrained mode</td>
</tr>
</tbody>
</table>
<h4 id="ble-stat">BLE Stat</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ble_stat</code></td>
<td><code>objects</code></td>
<td>BLE stats</td>
</tr>
<tr>
<td><code>tx_pkts</code></td>
<td><code>float</code></td>
<td>TxBytes</td>
</tr>
<tr>
<td><code>tx_bytes</code></td>
<td><code>float</code></td>
<td>TxCommands</td>
</tr>
<tr>
<td><code>tx_resets</code></td>
<td><code>float</code></td>
<td>resets due to tx hung</td>
</tr>
<tr>
<td><code>rx_pkts</code></td>
<td><code>float</code></td>
<td>RxEvents</td>
</tr>
<tr>
<td><code>rx_bytes</code></td>
<td><code>float</code></td>
<td>RxBytes</td>
</tr>
<tr>
<td><code>ibeacon_enabled</code></td>
<td><code>boolean</code></td>
<td>Whether iBeacon is Enabled</td>
</tr>
<tr>
<td><code>ibeacon_uuid</code></td>
<td><code>string</code></td>
<td>UUID value for iBeacon</td>
</tr>
<tr>
<td><code>ibeacon_major</code></td>
<td><code>int</code></td>
<td>Major number for iBeacon</td>
</tr>
<tr>
<td><code>ibeacon_minor</code></td>
<td><code>int</code></td>
<td>Minor number for iBeacon</td>
</tr>
<tr>
<td><code>eddystone_uid_enabled</code></td>
<td><code>boolean</code></td>
<td>Whether Eddystone-UID beacon is enabled</td>
</tr>
<tr>
<td><code>eddystone_uid_namespace</code></td>
<td><code>string</code></td>
<td>Eddystone-UID namespace</td>
</tr>
<tr>
<td><code>eddystone_uid_instance</code></td>
<td><code>string</code></td>
<td>Eddystone-UID instance for the device</td>
</tr>
<tr>
<td><code>eddystone_uid_freq_msec</code></td>
<td><code>int</code></td>
<td>Frequency (msec) of data emmit by Eddystone-UID beacon</td>
</tr>
<tr>
<td><code>eddystone_url_enabled</code></td>
<td><code>boolean</code></td>
<td>Whether Eddystone-URL beacon is enabled</td>
</tr>
<tr>
<td><code>eddystone_url_url</code></td>
<td><code>string</code></td>
<td>URL pointed by Eddystone-URL beacon</td>
</tr>
<tr>
<td><code>eddystone_url_freq_msec</code></td>
<td><code>int</code></td>
<td>Frequency (msec) of data emmit by Eddystone-UID beacon</td>
</tr>
</tbody>
</table>
<h4 id="firmware-upgrade-status">Firmware Upgrade Status</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>fwupdate</code></td>
<td><code>object</code></td>
<td>last firmware update status</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>float</code></td>
<td>timestamp</td>
</tr>
<tr>
<td><code>status</code></td>
<td><code>string</code></td>
<td>starting / inprogress / success / error</td>
</tr>
<tr>
<td><code>status_id</code></td>
<td><code>int</code></td>
<td>the internal status id</td>
</tr>
<tr>
<td><code>progress</code></td>
<td><code>int</code></td>
<td>progress of upgrading expressed in percentage</td>
</tr>
</tbody>
</table>
<h4 id="interface-stat">Interface Stat</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>interface name</td>
</tr>
<tr>
<td><code>tx_pkts</code></td>
<td><code>int</code></td>
<td>Output packets</td>
</tr>
<tr>
<td><code>rx_pkts</code></td>
<td><code>int</code></td>
<td>Input packets</td>
</tr>
<tr>
<td><code>tx_bytes</code></td>
<td><code>int</code></td>
<td>Output bytes</td>
</tr>
<tr>
<td><code>rx_bytes</code></td>
<td><code>int</code></td>
<td>Input bytes</td>
</tr>
<tr>
<td><code>up</code></td>
<td><code>boolean</code></td>
<td>whether the port is up, default is false (down)</td>
</tr>
</tbody>
</table>
<h4 id="cpu-stat">CPU Stat</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>system</code></td>
<td><code>int</code></td>
<td>Percentage of CPU time being used by system processes</td>
</tr>
<tr>
<td><code>idle</code></td>
<td><code>int</code></td>
<td>Percentage of CPU time that is idle</td>
</tr>
<tr>
<td><code>interrupt</code></td>
<td><code>int</code></td>
<td>Percentage of CPU time being used by interrupts</td>
</tr>
<tr>
<td><code>user</code></td>
<td><code>int</code></td>
<td>Percentage of CPU time being used by user processes</td>
</tr>
<tr>
<td><code>load_avg</code></td>
<td><code>array</code></td>
<td>Load averages for the last 1, 5, and 15 minutes</td>
</tr>
</tbody>
</table>
<h4 id="last-trouble">Last Trouble</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>code</code></td>
<td><code>enum</code></td>
<td>last trouble code of the switch reported by lldp neighbors</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>long</code></td>
<td>timestamp of last trouble code reported</td>
</tr>
</tbody>
</table>
<h5 id="trouble-code-possible-values">Trouble Code Possible Values</h5>
<table>
<thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>102</code></td>
<td>No DHCP lease received on any interface</td>
</tr>
<tr>
<td><code>103</code></td>
<td>No default gateway</td>
</tr>
<tr>
<td><code>104</code></td>
<td>Gateway unreachable</td>
</tr>
<tr>
<td><code>105</code></td>
<td>No DNS server</td>
</tr>
<tr>
<td><code>106</code></td>
<td>DNS lookup failed</td>
</tr>
<tr>
<td><code>108</code></td>
<td>Agent cannot connect to controller</td>
</tr>
<tr>
<td><code>109</code></td>
<td>Authentication failed</td>
</tr>
<tr>
<td><code>110</code></td>
<td>Underlying service (i.e. Netconf/SSH/HTTPS) is down</td>
</tr>
<tr>
<td><code>113</code></td>
<td>DNS failure with Mist cloud</td>
</tr>
<tr>
<td><code>114</code></td>
<td>Empty DNS response with Mist cloud</td>
</tr>
</tbody>
</table>
<h4 id="autoplacement-stats">Autoplacement Stats</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>x</code></td>
<td><code>float</code></td>
<td>X Autoplaced Position in pixels</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>float</code></td>
<td>Y Autoplaced Position in pixels</td>
</tr>
<tr>
<td><code>x_m</code></td>
<td><code>float</code></td>
<td>X Autoplaced Position in meters</td>
</tr>
<tr>
<td><code>y_m</code></td>
<td><code>float</code></td>
<td>Y Autoplaced Position in meters</td>
</tr>
<tr>
<td><code>status</code></td>
<td><code>string</code></td>
<td>Basic Placement Status</td>
</tr>
<tr>
<td><code>status_detail</code></td>
<td><code>string</code></td>
<td>Additional info about placement status</td>
</tr>
<tr>
<td><code>recommended_anchor</code></td>
<td><code>boolean</code></td>
<td>Flag to represent if AP is recommended as an anchor by auto placement service</td>
</tr>
<tr>
<td><code>info</code></td>
<td><code>object</code></td>
<td>Additional information about auto placements AP data</td>
</tr>
</tbody>
</table>
<h5 id="auto-placement-info">Auto Placement Info</h5>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>cluster_number</code></td>
<td><code>int</code></td>
<td>All APs sharing a given cluster number can be placed relative to each other</td>
</tr>
<tr>
<td><code>orientation_state</code></td>
<td><code>int</code></td>
<td>The orientation of an AP</td>
</tr>
<tr>
<td><code>probability_surface</code></td>
<td><code>object</code></td>
<td>Coordinates representing a circle where the AP is most likely exists in the event of an inaccurate placement result</td>
</tr>
</tbody>
</table>
<h5 id="auto-placement-probability-surface">Auto Placement Probability Surface</h5>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>radius</code></td>
<td><code>float</code></td>
<td>The radius representing placement uncertainty, measured in pixels</td>
</tr>
<tr>
<td><code>radius_m</code></td>
<td><code>float</code></td>
<td>The radius representing placement uncertainty, measured in meters</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>float</code></td>
<td>X-coordinate of the potential placement’s center, measured in pixels</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>float</code></td>
<td>Y-coordinate of the potential placement’s center, measured in pixels</td>
</tr>
</tbody>
</table>
<h4 id="gps-stat">GPS Stat</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>altitude</code></td>
<td><code>float</code></td>
<td>The elevation of the AP above sea level, measured in meters.</td>
</tr>
<tr>
<td><code>latitude</code></td>
<td><code>float</code></td>
<td>The geographic latitude of the AP, measured in degrees.</td>
</tr>
<tr>
<td><code>longitude</code></td>
<td><code>float</code></td>
<td>The geographic longitude of the AP, measured in degrees.</td>
</tr>
<tr>
<td><code>src</code></td>
<td><code>string</code></td>
<td>The origin of the GPS data, either <code>gps</code> from this device’s GPS estimates or <code>other_ap</code> from neighboring device GPS estimates.</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>long</code></td>
<td>The unix timestamp when the GPS data was recorded.</td>
</tr>
<tr>
<td><code>accuracy</code></td>
<td><code>float</code></td>
<td>The estimated accuracy or accuracy of the GPS coordinates, measured in meters.</td>
</tr>
</tbody>
</table>
<h4 id="mesh-downlinks">Mesh Downlinks</h4>
<p>Attributes are similar to a client Name|Type| Description ----|----|------------
<code>mesh_downlinks</code>|<code>object</code>| mesh downlinks established</p>
<h2 id="import-information-for-multiple-devices">Import Information for Multiple Devices</h2>
<pre><code>POST /api/v1/sites/:site_id/devices/import
</code></pre>
<h3 id="upload-via-csv-file_1">Upload via CSV file</h3>
<p>A multi-part POST</p>
<pre><code>"file": CSV File
</code></pre>
<h3 id="device-import-csv-file-format_1">Device Import CSV File Format</h3>
<pre><code>mac,name,map_id,x,y,height,orientation,labels,band_24.power,band_24.bandwidth,band_24.channel,band_24.disabled,band_5.power,band_5.bandwidth,band_5.channel,band_5.disabled,band_6.power,band_6.bandwidth,band_6.channel,band_6.disabled
5c5b53010101,"AP 1",845a23bf-bed9-e43c-4c86-6fa474be7ae5,30,10,2.3,45,"guest, campus, vip",1,20,0,false,0,40,0,false,17,80,0,false
</code></pre>
<h3 id="parameters_78">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>device mac</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name / label of the device</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map where the device belongs to</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>float</code></td>
<td>x in pixel</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>float</code></td>
<td>y in pixel</td>
</tr>
<tr>
<td><code>orientation</code></td>
<td><code>int</code></td>
<td>orientation, 0-359, in degrees, up is 0, right is 90.</td>
</tr>
<tr>
<td><code>height</code></td>
<td><code>float</code></td>
<td>height, in meters</td>
</tr>
<tr>
<td><code>labels</code></td>
<td><code>list</code></td>
<td>list of comma-separated strings</td>
</tr>
<tr>
<td><code>band_24.power</code></td>
<td><code>int</code></td>
<td>band 2.4G power</td>
</tr>
<tr>
<td><code>band_24.bandwidth</code></td>
<td><code>int</code></td>
<td>band 2.4G bandwidth</td>
</tr>
<tr>
<td><code>band_24.channel</code></td>
<td><code>int</code></td>
<td>band 2.4G channel</td>
</tr>
<tr>
<td><code>band_24.disabled</code></td>
<td><code>boolean</code></td>
<td>if band 2.4G is disabled</td>
</tr>
<tr>
<td><code>band_5.power</code></td>
<td><code>int</code></td>
<td>band 5G power</td>
</tr>
<tr>
<td><code>band_5.bandwidth</code></td>
<td><code>int</code></td>
<td>band 5G bandwidth</td>
</tr>
<tr>
<td><code>band_5.channel</code></td>
<td><code>int</code></td>
<td>band 5G channel</td>
</tr>
<tr>
<td><code>band_5.disabled</code></td>
<td><code>boolean</code></td>
<td>if band 5G is disabled</td>
</tr>
<tr>
<td><code>band_6.power</code></td>
<td><code>int</code></td>
<td>band 6G power</td>
</tr>
<tr>
<td><code>band_6.bandwidth</code></td>
<td><code>int</code></td>
<td>band 6G bandwidth</td>
</tr>
<tr>
<td><code>band_6.channel</code></td>
<td><code>int</code></td>
<td>band 6G channel</td>
</tr>
<tr>
<td><code>band_6.disabled</code></td>
<td><code>boolean</code></td>
<td>if band 6G is disabled</td>
</tr>
</tbody>
</table>
<h3 id="post-via-json">POST via JSON</h3>
<p>Alternatively, you can POST it via a equivalent JSON</p>
<pre><code>[
    {
        "mac": "5c5b53010101",
        "name": "AP 1",
        "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
        "x": 30,
        "y": 10,
        "height": 2,3,
        "orientation": 45,
        "labels": "guest, campus, vip"
    },
    ...
]
</code></pre>
<h3 id="response_105">Response</h3>
<pre><code>{
    "updated": [ "5c5b53010101" ],
    "errors": [
        "Device[2c47d2c7b2a2] does not exist",
        "Map[845a23bf-bed9-e43c-4c86-6fa474be7ae5] does not exist"
    ]
}
</code></pre>
<h2 id="export-device-information">Export Device Information</h2>
<p>To download the exported device information</p>
<pre><code>GET /api/v1/sites/:site_id/devices/export
</code></pre>
<h3 id="response_106">Response</h3>
<pre><code>mac,name,map_id,x,y,height,orientation,labels,type
5c5b53010101,"AP 1",845a23bf-bed9-e43c-4c86-6fa474be7ae5,30,10,2.3,45,"guest, campus, vip","ap"
</code></pre>
<h2 id="get-stat-for-a-single-device">Get stat for a single device</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/devices/:device_id
</code></pre>
<h3 id="request_79">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>fields</code></td>
<td><code>list</code></td>
<td>list of comma-separated strings. E.g.: ports,tunnels,vpn_peers,bgp_peers</td>
</tr>
</tbody>
</table>
<h3 id="response_107">Response</h3>
<pre><code>{
    # This object is like object returned by `GET /api/v1/sites/:site_id/stats/devices` array,
    # but can also include the following optional fields if specified in the `fields` parameter.

    # `ports` -- only present when included in `fields` parameter
    # `ports` is like `port_stat` but is an array.
    # This array can be converted to a dict using (port_id, node) as key.
    "ports": [
        // Each port object is same as `GET /api/v1/sites/:site_id/stats/ports/search` result object,
        // except that org_id, site_id, mac, model are removed
        {
            "port_id": "ge-0/0/1",
            "node": "node0",        // Absent if this device is standalone
            .
            .
            .
        }            
    ],

    # `tunnels` -- only present when included in `fields` parameter
    "tunnels": [
        // Each port object is same as `GET /api/v1/orgs/:org_id/stats/tunnels/search` result object,
        // except that org_id, site_id, mac, model are removed
        {
            "node": "node0",
            "tunnel_name": "SECHub1",
            "protocol": "ipsec",
            "ike_version": "2",
            "auth_algo": "AES_GCM_16_128-HMAC_SHA2_256-MODP2048",
            "priority": "primary",
            "wan_name": ...,
            "ip": ...,
            "peer_ip": ...,
            "peer_host": ...,
            "rx_bytes": ...,
            "tx_bytes": ...,
            "rx_pkts": ...,
            "tx_pkts": ...,
            "up": false,
            "uptime": 0,
            "last_event": "No response from peer. Negotiation failed",
            "last_seen":1723072157.123456
        }
    ],

    # `vpn_peers` -- only present when included in `fields` parameter
    "vpn_peers": [
        // Each port object is same as `GET /api/v1/orgs/:org_id/stats/vpn_peers/search` result object,
        // except that org_id, site_id, mac, model are removed
        {
            "node": "node0"
            "vpn_name": ...,
            "type": "svr",
            "vpn_role": "spoke",
            "router_name": ...,
            "wan_name": ...,
            "port_id": ...,
            "network_interface": ...,
            "peer_mac": ...,
            "peer_router_name": ...,
            "peer_site_id": ...,
            "peer_port_id": ...,
            "latency": 6.0,
            "mos": 440.0,
            "loss": 0.0,
            "jitter": 0.0,
            "mtu": 1500,
            "is_active": true,
            "up": true,
            "uptime": 61975,
            "last_seen": 1723072157.123456
        }
    ],

    # `bgp_peers` -- only present when included in `fields` parameter
    "bgp_peers": [
        // Each port object is same as `GET /api/v1/sites/:site_id/stats/bgp_peers/search` result object,
        // except that org_id, site_id, mac, model are removed
        {
            "node": "node0",
            "neighbor_as": 65010,
            "local_as": 65012,
            "evpn_overlay": false,
            "evpn_underlay": true,
            "vrf_name": "default",
            "neighbor": ...,
            "neighbor_mac": ...,
            "state": "established",
            "rx_pkts": 2363,
            "tx_pkts": 2350,
            "rx_routes": 9,
            "tx_routes": 3,
            "up": true,
            "uptime": 63908,
            "timestamp": 1723072157.290559
        }
    ],
}
</code></pre>
<h1 id="client-stats">Client Stats</h1>
<h2 id="get-wireless-client-stat">Get wireless client stat</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/clients
GET /api/v1/sites/:site_id/stats/maps/:map_id/clients
GET /api/v1/sites/:site_id/stats/devices/:device_id/clients
</code></pre>
<h3 id="response_108">Response</h3>
<pre><code>[
    {
        "mac": "5684dae9ac8b",
        "last_seen": 1470417522,

        "username": "david@mist.com",
        "hostname": "David-Macbook",
        "os": "OS X 10.10.2",
        "manufacture": "Apple",
        "family": "iPhone",
        "model": "6S",

        "ip": "192.168.1.8",
        "ip6": "2001:db8:3333:4444:5555:6666:7777:8888",

        "ap_mac": "5c5b35000010",
        "ap_id": "0000000-0000-0000-1000-5c5b35000010",
        "ssid": "corporate",
        "wlan_id": "be22bba7-8e22-e1cf-5185-b880816fe2cf",
        "psk_id": "732daf4e-f51e-8bba-06f9-b25cd0e779ea",

        "uptime": 3568,
        "idle_time": 3,
        "power_saving": true,
        "band": "24",
        "proto": "a",
        "key_mgmt": "WPA2-PSK/CCMP",
        "dual_band": false,

        "channel": 7,
        "vlan_id": "",
        "airespace_ifname": "",
        "rssi": -65,
        "snr": 31,
        "tx_rate": 65,
        "rx_rate": 65,

        "tx_bytes": 175132,
        "tx_bps": 6,
        "tx_packets": 1566,
        "tx_retries": 500,
        "rx_bytes": 217416,
        "rx_bps": 12,
        "rx_packets": 2337,
        "rx_retries": 5,

        "map_id": "63eda950-c6da-11e4-a628-60f81dd250cc",
        "x": 53.5,
        "y": 173.1,
        "x_m": 5.35
        "y": 17.31
        "num_locating_aps": 3,

        "is_guest": true,
        "guest": {
            "authorized": True,
            "authorized_time": 1428939300,
            "authorized_expiring_time": 1429109300

            "name": "John",
            "email": "john@abc.com",
            "company": "ABC",
            "field1": "whatever",
            "cross_site": True
        },
        "airwatch": {
            "authorized": True
        },
        "_ttl": 250
    }
]

</code></pre>
<h3 id="client-stat-definition">Client Stat Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>client mac</td>
</tr>
<tr>
<td><code>hostname</code></td>
<td><code>string</code></td>
<td>hostname that we learned from sniffing DHCP</td>
</tr>
<tr>
<td><code>username</code></td>
<td><code>string</code></td>
<td>username that we learned from 802.1X exchange or Per-user PSK or User Portal</td>
</tr>
<tr>
<td><code>manufacture</code></td>
<td><code>string</code></td>
<td>device manufacture, through fingerprinting or OUI</td>
</tr>
<tr>
<td><code>os</code></td>
<td><code>string</code></td>
<td>device os, through fingerprinting</td>
</tr>
<tr>
<td><code>family</code></td>
<td><code>string</code></td>
<td>device family, through fingerprinting. iPod / Nexus Galaxy / Windows Mobile or CE …</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>device model, may be available if we can identify them</td>
</tr>
<tr>
<td><code>ap_mac</code></td>
<td><code>string</code></td>
<td>AP the client is connected to</td>
</tr>
<tr>
<td><code>ap_id</code></td>
<td><code>string</code></td>
<td>AP ID the client is connected to</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>SSID the client is connected to</td>
</tr>
<tr>
<td><code>wlan_id</code></td>
<td><code>string</code></td>
<td>WLAN ID the client is connected to</td>
</tr>
<tr>
<td><code>psk_id</code></td>
<td><code>string</code></td>
<td>PSK id (if multi-psk is used)</td>
</tr>
<tr>
<td><code>uptime</code></td>
<td><code>long</code></td>
<td>how long, in seconds, has the client been connected</td>
</tr>
<tr>
<td><code>idle_time</code></td>
<td><code>long</code></td>
<td>how long, in seconds, has the client been idle (since the last RX packet)</td>
</tr>
<tr>
<td><code>last_seen</code></td>
<td><code>long</code></td>
<td>last seen timestamp</td>
</tr>
<tr>
<td><code>power_saving</code></td>
<td><code>boolean</code></td>
<td>if it’s currently in power-save mode</td>
</tr>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>“24” or “5”</td>
</tr>
<tr>
<td><code>proto</code></td>
<td><code>string</code></td>
<td>b / g / n / a / ac</td>
</tr>
<tr>
<td><code>key_mgmt</code></td>
<td><code>string</code></td>
<td>e.g. WPA2-PSK/CCMP</td>
</tr>
<tr>
<td><code>dual_band</code></td>
<td><code>boolean</code></td>
<td>whether the client is dual-band capable (determined by whether we’ve seen probe requests from both bands)</td>
</tr>
<tr>
<td><code>channel</code></td>
<td><code>int</code></td>
<td>current channel</td>
</tr>
<tr>
<td><code>vlan_id</code></td>
<td><code>string</code></td>
<td>vlan id, could be empty (from older AP)</td>
</tr>
<tr>
<td><code>rssi</code></td>
<td><code>int</code></td>
<td>signal strength</td>
</tr>
<tr>
<td><code>snr</code></td>
<td><code>int</code></td>
<td>signal over noise</td>
</tr>
<tr>
<td><code>tx_rate</code></td>
<td><code>float</code></td>
<td>TX Rate, Mbps</td>
</tr>
<tr>
<td><code>rx_rate</code></td>
<td><code>float</code></td>
<td>RX Rate, Mbps</td>
</tr>
<tr>
<td><code>tx_bps</code></td>
<td><code>float</code></td>
<td>rate of transmitting traffic to the clients, bits/seconds, last known</td>
</tr>
<tr>
<td><code>rx_bps</code></td>
<td><code>float</code></td>
<td>rate of receiving traffic from the clients, bits/seconds, last known</td>
</tr>
<tr>
<td><code>tx_bytes</code></td>
<td><code>float</code></td>
<td>amount of traffic sent to client since client connects</td>
</tr>
<tr>
<td><code>rx_bytes</code></td>
<td><code>float</code></td>
<td>amount of traffic received from client  since client connects</td>
</tr>
<tr>
<td><code>tx_pkts</code></td>
<td><code>float</code></td>
<td>amount of traffic sent to client since client connects</td>
</tr>
<tr>
<td><code>rx_pkts</code></td>
<td><code>float</code></td>
<td>amount of traffic received from client  since client connects</td>
</tr>
<tr>
<td><code>tx_retries</code></td>
<td><code>float</code></td>
<td>amount of tx retries</td>
</tr>
<tr>
<td><code>rx_retries</code></td>
<td><code>float</code></td>
<td>amount of rx retries</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>estimated client location - map_id</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>int</code></td>
<td>estimated client location in pixels</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>int</code></td>
<td>estimated client location in pixels</td>
</tr>
<tr>
<td><code>x_m</code></td>
<td><code>int</code></td>
<td>estimated client location in meter</td>
</tr>
<tr>
<td><code>y_m</code></td>
<td><code>int</code></td>
<td>estimated client location in meter</td>
</tr>
<tr>
<td><code>num_locating_aps</code></td>
<td><code>int</code></td>
<td>number of APs used to locate this client</td>
</tr>
<tr>
<td><code>accuracy</code></td>
<td><code>int</code></td>
<td>estimated client location accuracy, in meter</td>
</tr>
<tr>
<td><code>is_guest</code></td>
<td><code>boolean</code></td>
<td>whether this is a guest, default is false</td>
</tr>
<tr>
<td><code>guest</code></td>
<td><code>object</code></td>
<td>information about this portal</td>
</tr>
<tr>
<td><code>authorized</code></td>
<td><code>boolean</code></td>
<td>whether this guest is authorized, default is false</td>
</tr>
<tr>
<td><code>authorized_time</code></td>
<td><code>int</code></td>
<td>when the guest is authorized</td>
</tr>
<tr>
<td><code>authorized_expiring_time</code></td>
<td><code>int</code></td>
<td>when the guest authorization will expire</td>
</tr>
<tr>
<td><code>cross_site</code></td>
<td><code>boolean</code></td>
<td>whether this guest is authorized for cross site, default is false</td>
</tr>
<tr>
<td><code>airwatch</code></td>
<td><code>object</code></td>
<td>information if airwatch enabled</td>
</tr>
<tr>
<td><code>_ttl</code></td>
<td><code>int</code></td>
<td>TTL of the validity of the stat</td>
</tr>
</tbody>
</table>
<h2 id="get-wireless-client-stat-with-more-details">Get Wireless Client Stat with More Details</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/clients/:client_mac
</code></pre>
<h3 id="response_109">Response</h3>
<pre><code>{
    ...
    // in addition to the same information as provided from GET /api/v1/sites/:site_id/stats/clients
    // it also has

    "zones": [
        {
            "id": "8ac84899-32db-6327-334c-9b6d58544cfe",
            "since": 1428939600
        }
    ],
    "vbeacons": [
        {
            "id": "d379d29d-24b4-96c5-5dd4-6f2a2dc5aaeb",
            "since": 1428939300
        }
    ],

    "rssizones": [
        {
            "id": "b49390de-f124-4854-9404-0e59d63e6b99",
            "since": 1428939400
        }
    ],

    "wxrule_id": "ac3f89d3-15ad-685a-7c1e-cc5c5f1df07a",
    "wxrule_usage" [
        {
            "tag_id": "dfc6d6e0-8411-45a9-833a-9cbf21a311b2",
            "usage": 20
        },
        {
            "tag_id": "00000000-0000-0000-0000-000000000000",
            "usage": 4
        }
    ]
}
</code></pre>
<h3 id="client-stat-definition_1">Client Stat Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>zones</code></td>
<td><code>list</code></td>
<td>list of zone_id’s where client is in and since when (if known)</td>
</tr>
<tr>
<td><code>vbeacons</code></td>
<td><code>list</code></td>
<td>list of beacon_id’s where the client is in and since when (if known)</td>
</tr>
<tr>
<td><code>rssizones</code></td>
<td><code>list</code></td>
<td>list of rssizone_id’s where client is in and since when (if known)</td>
</tr>
<tr>
<td><code>wxrule_id</code></td>
<td><code>string</code></td>
<td>current WxlanRule using for a Client or an authorized Guest (portal user). null if default rule is matched.</td>
</tr>
<tr>
<td><code>wxrule_usage</code></td>
<td><code>list</code></td>
<td>current WxlanRule usage per tag_id</td>
</tr>
<tr>
<td><code>predictive</code></td>
<td><code>object</code></td>
<td>derived information from backend</td>
</tr>
<tr>
<td><code>client_dl</code></td>
<td><code>float</code></td>
<td>estimated wireless client download throughput, in Mbps</td>
</tr>
<tr>
<td><code>wan_dl</code></td>
<td><code>float</code></td>
<td>estimated WAN download throughput, in Mbps</td>
</tr>
</tbody>
</table>
<h2 id="subscribe-to-client-stats-updates">Subscribe to Client Stats Updates</h2>
<pre><code>WS /api-ws/v1/stream
</code></pre>
<h3 id="request_80">Request</h3>
<pre><code>{
    "subscribe": "/sites/:site_id/stats/clients"
}
</code></pre>
<h3 id="response_110">Response</h3>
<pre><code>{
    "event": "data",
    "channel": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/stats/clients",
    "data": {
        "mac": "5684dae9ac8b",
        ...
        // same as above
    }
}
</code></pre>
<h2 id="get-ap-wired-client-stat">Get AP wired client stat</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/clients?wired=true
GET /api/v1/sites/:site_id/stats/clients/:mac?wired=true
GET /api/v1/sites/:site_id/stats/clients/:ap_id?wired=true
</code></pre>
<h3 id="response_111">Response</h3>
<pre><code>[
    {
        "mac": "e45f01319a43",
        "site_id": "1916d52a-4a90-11e5-8b45-1258369c38a9",
        "ap_id": "00000000-0000-0000-1000-d420b085fdff",
        "rx_pkts": 0,
        "tx_pkts": 0,
        "rx_bytes": 0,
        "tx_bytes": 0,
        "eth_port": "eth1",
        "auth_state": "authorizedForCompleteAccess",
        "vlan_id": 70,
        "last_seen": 1645060912.0751352,
        "uptime": 8723766
        "_ttl": 277,
        "_id": "003ee1bec926"
    }
]
</code></pre>
<h3 id="client-stat-definition_2">Client Stat Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>client mac</td>
</tr>
<tr>
<td><code>ap_id</code></td>
<td><code>string</code></td>
<td>AP ID the client is connected to</td>
</tr>
<tr>
<td><code>last_seen</code></td>
<td><code>long</code></td>
<td>time when last Tx/Rx observed</td>
</tr>
<tr>
<td><code>vlan_id</code></td>
<td><code>string</code></td>
<td>vlan id, could be empty (from older AP)</td>
</tr>
<tr>
<td><code>tx_bytes</code></td>
<td><code>float</code></td>
<td>amount of traffic sent to client since client connects</td>
</tr>
<tr>
<td><code>rx_bytes</code></td>
<td><code>float</code></td>
<td>amount of traffic received from client  since client connects</td>
</tr>
<tr>
<td><code>tx_pkts</code></td>
<td><code>float</code></td>
<td>amount of traffic sent to client since client connects</td>
</tr>
<tr>
<td><code>rx_pkts</code></td>
<td><code>float</code></td>
<td>amount of traffic received from client  since client connects</td>
</tr>
<tr>
<td><code>_ttl</code></td>
<td><code>int</code></td>
<td>TTL of the validity of the stat</td>
</tr>
<tr>
<td><code>auth_state</code></td>
<td><code>string</code></td>
<td>client authorization status</td>
</tr>
<tr>
<td><code>uptime</code></td>
<td><code>long</code></td>
<td>how long, in seconds, has the client been connected</td>
</tr>
<tr>
<td><code>eth_port</code></td>
<td><code>string</code></td>
<td>port on AP where the wired client is connected</td>
</tr>
</tbody>
</table>
<h2 id="subscribe-to-locations-for-clients-on-a-map">Subscribe to locations for clients on a map</h2>
<pre><code>WS /api-ws/v1/stream
</code></pre>
<h3 id="request_81">Request</h3>
<pre><code>{
    "subscribe": "/sites/:site_id/stats/maps/:map_id/clients"
}
</code></pre>
<h3 id="response_112">Response</h3>
<pre><code>{
    "event": "data",
    "channel": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/stats/maps/63eda950-c6da-11e4-a628-60f81dd250cc/clients",
    "data": {
        "mac": "5684dae9ac8b",
        "map_id": "63eda950-c6da-11e4-a628-60f81dd250cc",
        "x": 53.5,
        "y": 173.1,
        "num_locating_aps": 3
    }
}
</code></pre>
<h2 id="disconnect-a-client">Disconnect a Client</h2>
<p>This disconnect a client (and it’s likely to connect back)</p>
<pre><code>POST /api/v1/sites/:site_id/clients/:client_mac/disconnect
</code></pre>
<h2 id="reauth-a-8021x-client">Reauth a 802.1x Client</h2>
<p>Trigger a CoA (change of authorization) against a client</p>
<pre><code>POST /api/v1/sites/:site_id/clients/:client_mac/coa
</code></pre>
<h2 id="disconnect-multiple-clients">Disconnect Multiple Clients</h2>
<p>To unauthorize multiple clients, use</p>
<pre><code>POST /api/v1/sites/:site_id/clients/disconnect
</code></pre>
<h3 id="request_82">Request</h3>
<pre><code>[
    "683b679ac024",
    ...
]
</code></pre>
<h2 id="unauthorize-a-client">Unauthorize a Client</h2>
<p>This unauthorize a client (if it’s a guest) and disconnect it. From the guest’s perspective, s/he will see the splash
page again and go through the flow (e.g. Terms of Use) again.</p>
<pre><code>POST /api/v1/sites/:site_id/clients/:client_mac/unauthorize
</code></pre>
<h2 id="unauthorize-multiple-clients">Unauthorize Multiple Clients</h2>
<p>To unauthorize multiple clients, use</p>
<pre><code>POST /api/v1/sites/:site_id/clients/unauthorize
</code></pre>
<h3 id="request_83">Request</h3>
<pre><code>[
    "683b679ac024",
    ...
]
</code></pre>
<h2 id="search-wireless-clients">Search Wireless Clients</h2>
<pre><code>GET /api/v1/sites/:site_id/clients/search?hostname=john&amp;limit=10
</code></pre>
<h3 id="request_84">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>partial / full MAC address</td>
</tr>
<tr>
<td><code>hostname</code></td>
<td><code>string</code></td>
<td>partial / full hostname</td>
</tr>
<tr>
<td><code>device</code></td>
<td><code>string</code></td>
<td>device type, e.g. Mac, Nvidia, iPhone</td>
</tr>
<tr>
<td><code>os</code></td>
<td><code>string</code></td>
<td>os, e.g. Sierra, Yosemite, Windows 10</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>model, e.g. “MBP 15 late 2013”, 6, 6s, “8+ GSM”</td>
</tr>
<tr>
<td><code>ap</code></td>
<td><code>string</code></td>
<td>AP mac where the client has connected to</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>SSID</td>
</tr>
<tr>
<td><code>text</code></td>
<td><code>string</code></td>
<td>partial / full MAC address, hostname, username, psk_name or ip</td>
</tr>
<tr>
<td><code>psk_id</code></td>
<td><code>string</code></td>
<td>PSK ID</td>
</tr>
<tr>
<td><code>psk_name</code></td>
<td><code>string</code></td>
<td>PSK name</td>
</tr>
<tr>
<td><code>nacrule_id</code></td>
<td><code>string</code></td>
<td>nacrule_id</td>
</tr>
</tbody>
</table>
<p>NOTE: fuzzy logic can be used with ‘*’, supported filters: mac, hostname, device, os, model.
E.g. <code>/clients/search?device=Mac*&amp;hostname=jerry</code></p>
<h3 id="response_113">Response</h3>
<pre><code>{
    "results": [
        {
            "hostname": [
                "jerry"
            ],
            "ap": [
                "5c5b350e0492",
                "5c5b350eb39d",
                "5c5b350e03c0"
            ],
            "ip": [
                "192.168.5.43",
                "192.168.20.125"
            ],
            "vlan": [
                1
            ],
            "mac": "60f81dd250cc",
            "device": [
                "Mac"
            ],
            "os": [
                "Sierra",
                "High Sierra"
            ],
            "model": [
                "",
                "MBP 15\" late 2013"
            ],
            "ssid": [
                "Guest"
            ],
            "psk_id": [
                "9d31efe6-e205-47eb-9f1d-dd66d8ef66bd"
            ],
            "psk_name": [
                "test key"
            ],
        }
        ...
    ]
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-clients">Count by Distinct Attributes of Clients</h2>
<pre><code>GET /api/v1/sites/:site_id/clients/count?distinct=hostname
</code></pre>
<h3 id="request_85">Request</h3>
<p>In addition to the filters that you can have in the search</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>ssid, ap, ip, vlan, hostname, os, model, device, default is device</td>
</tr>
</tbody>
</table>
<p>NOTE: the filters from /clients/search can also be used. E.g. <code>/clients/count?distinct=device&amp;ssid=Guest</code></p>
<h3 id="response_114">Response</h3>
<pre><code>{
    "start": 1511967600,
    "end": 1513177200,
    "limit": 10,
    "distinct": "device",

    "total": 2,
    "results": [
        {
            "device": "Mac",
            "count": 61
        },
        {
            "device": "iPhone",
            "count": 44
        }
    ]
}
</code></pre>
<h2 id="search-client-events">Search Client Events</h2>
<pre><code>GET /api/v1/sites/:site_id/clients/events/search
</code></pre>
<h3 id="request_86">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>event type, e.g. MARVIS_EVENT_CLIENT_FBT_FAILURE</td>
</tr>
<tr>
<td><code>reason_code</code></td>
<td><code>int</code></td>
<td>for assoc/disassoc events</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>SSID</td>
</tr>
<tr>
<td><code>ap</code></td>
<td><code>string</code></td>
<td>AP MAC</td>
</tr>
<tr>
<td><code>proto</code></td>
<td><code>string</code></td>
<td>b / g / n / a / ac</td>
</tr>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>5 / 24</td>
</tr>
<tr>
<td><code>wlan_id</code></td>
<td><code>string</code></td>
<td>wlan_id</td>
</tr>
</tbody>
</table>
<h3 id="response_115">Response</h3>
<pre><code>{
    "start": 1512572151,
    "end": 1513176951,
    "limit": 10,

    "total": 1,
    "results": [
        {
            "ap": "5c5b350eb31b",
            "ssid": "Guest",
            "bssid": "5c5b350918f1",
            "proto": "ac",
            "timestamp": 1513358874.667,
            "band": "5",
            "type_code": 15,
            "type": "CLIENT_DNS_OK",
            "text": "Status code 0 \"Successful\" ",
            "channel": 149,
            "wlan_id": "be22bba7-8e22-e1cf-5185-b880816fe2cf"
        }
    ]
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-client-events">Count by Distinct Attributes of Client-Events</h2>
<pre><code>GET /api/v1/sites/:site_id/clients/events/count?distinct=type
</code></pre>
<h3 id="request_87">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>type / proto / band / channel / wlan_id / ssid</td>
</tr>
</tbody>
</table>
<p>NOTE: the filters from /clients/:mac/events can also be used. E.g. <code>/clients/events/count?distinct=device&amp;ssid=Guest</code></p>
<h3 id="response_116">Response</h3>
<pre><code>{
    "start": 1513276353,
    "end": 1513362753,
    "limit": 3,

    "total": 3,
    "results": [
        {
            "count": 580,
            "type": "CLIENT_AUTHENTICATED"
        },
        {
            "count": 536,
            "type": "CLIENT_GW_ARP_OK"
        },
        {
            "count": 519,
            "type": "CLIENT_ASSOCIATION"
        }
    ]
}
</code></pre>
<h2 id="search-client-sessions">Search Client Sessions</h2>
<pre><code>GET /api/v1/sites/:site_id/clients/sessions/search
</code></pre>
<h3 id="request_88">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ap</code></td>
<td><code>string</code></td>
<td>AP MAC</td>
</tr>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>5 / 24</td>
</tr>
<tr>
<td><code>client_family</code></td>
<td><code>string</code></td>
<td>E.g. “Mac”, “iPhone”, “Apple watch”</td>
</tr>
<tr>
<td><code>client_manufacture</code></td>
<td><code>string</code></td>
<td>E.g. “Apple”</td>
</tr>
<tr>
<td><code>client_model</code></td>
<td><code>string</code></td>
<td>E.g. “8+”, “XS”</td>
</tr>
<tr>
<td><code>client_os</code></td>
<td><code>string</code></td>
<td>E.g. “Mojave”, “Windows 10”, “Linux”</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>SSID</td>
</tr>
<tr>
<td><code>wlan_id</code></td>
<td><code>string</code></td>
<td>wlan_id</td>
</tr>
<tr>
<td><code>psk_id</code></td>
<td><code>string</code></td>
<td>PSK ID</td>
</tr>
<tr>
<td><code>psk_name</code></td>
<td><code>string</code></td>
<td>PSK name</td>
</tr>
</tbody>
</table>
<h3 id="response_117">Response</h3>
<pre><code>{
    "start": 1511967600,
    "end": 1513177200,
    "limit": 10,
    "total": 100,
    "results": [
        {
            "ap": "5c5b350e0262",
            "disconnect": 1565208448.662,
            "ssid": "Dummy WLAN 2",
            "tags": [
                "disassociate"
            ],
            "org_id": "3139f2c2-fac6-11e5-8156-0242ac110006",
            "site_id": "70e0f468-fc13-11e5-85ad-0242ac110008",
            "mac": "b019c66c8348",
            "connect": 1565208388.568,
            "band": "5",
            "timestamp": 1565208448.662,
            "duration": 60.09423865,
            "client_manufacture": "Apple",
            "wlan_id": "99bb4c74-f954-4f36-b844-6b030faffabc",
            "psk_id": "8a4a134b-210a-4908-a6be-105dca78e226",
            "psk_name": "test key"
        },
        ...
    ]
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-client-sessions">Count by Distinct Attributes of Client Sessions</h2>
<pre><code>GET /api/v1/sites/:site_id/clients/sessions/count
</code></pre>
<h3 id="request_89">Request</h3>
<p>In addition to the filters that you can have in the search</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>ssid, wlan_id, ap, mac, client_family, client_manufacture, client_model, client_os, default is mac</td>
</tr>
</tbody>
</table>
<p>NOTE: the filters from /clients/sessions/search can also be used. (
E.g. <code>/clients/sessions/count?distinct=client_manufacture</code>)</p>
<h3 id="response_118">Response</h3>
<pre><code>{
    "start": 1511967600,
    "end": 1513177200,
    "limit": 100,
    "distinct": "client_manufacture",
    "total": 20,
    "results": [
        {
            "count": 217,
            "client_manufacture": "Apple"
        },
        {
            "count": 35,
            "client_manufacture": "Intel Corporate"
        },
        ...
    ]
}
</code></pre>
<h2 id="get-events-for-a-wireless-client">Get Events for a Wireless Client</h2>
<pre><code>GET /api/v1/sites/:site_id/clients/:client_mac/events
</code></pre>
<h2 id="count-by-distinct-attributes-of-skyatp-events-wip">Count by Distinct Attributes of Skyatp Events (WIP)</h2>
<pre><code>GET /api/v1/sites/:site_id/skyatp/events/count?distinct=type
</code></pre>
<h3 id="request_90">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>type, mac, device_mac, threat_level, default is type</td>
</tr>
</tbody>
</table>
<h3 id="response_119">Response</h3>
<pre><code>{
    "start": 1511967600,
    "end": 1513177200,
    "limit": 10,
    "distinct": "type",

    "total": 2,
    "results": [
        {
            "type": "mw",
            "count": 6
        },
        {
            "device": "fs",
            "count": 3
        }
    ]
}
</code></pre>
<h2 id="search-skyatp-events-wip">Search Skyatp Events (WIP)</h2>
<pre><code>GET /api/v1/sites/:site_id/skyatp/events/search
</code></pre>
<h3 id="request_91">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>event type, e.g. cc, fs, mw</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>client MAC</td>
</tr>
<tr>
<td><code>device_mac</code></td>
<td><code>string</code></td>
<td>device MAC</td>
</tr>
<tr>
<td><code>threat_level</code></td>
<td><code>int</code></td>
<td>threat level</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>client ip</td>
</tr>
</tbody>
</table>
<h3 id="response_120">Response</h3>
<pre><code>{
    "start": 1512572151,
    "end": 1513176951,
    "limit": 10,

    "total": 1,
    "results": [
        {
            "mac": "b019c66c8348",
            "threat_level": 7,
            "device_mac": "658279bb1fa4",
            "timestamp": 1592524478,
            "org_id": "3139f2c2-fac6-11e5-8156-0242ac110006",
            "site_id": "70e0f468-fc13-11e5-85ad-0242ac110008",
            "type": "cc",
            "ip": "172.16.0.11"
        }
    ]
}
</code></pre>
<h2 id="get-guest-authorizations">Get Guest Authorizations</h2>
<pre><code>GET /api/v1/sites/:site_id/guests
</code></pre>
<h4 id="parameters_79">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>In</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>wlan_id</code></td>
<td>string</td>
<td>query</td>
<td>(optional) UUID of single or multiple (Comma separated) WLAN under Site <code>site_id</code> (to filter by WLAN)</td>
</tr>
</tbody>
</table>
<h3 id="response_121">Response</h3>
<pre><code>[
    {
        "mac": "5684dae9ac8b",
        "authorized": true,
        "authorized_time": 1480704355,
        "authorized_expiring_time": 1480704955,
        "name": "John Smith",
        "email": "john@abc.com",
        "company": "abc",
        "field1": "xxx"
    }
]
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>mac</td>
</tr>
<tr>
<td><code>authorized</code></td>
<td><code>boolean</code></td>
<td>whether the guest is current authorized</td>
</tr>
<tr>
<td><code>authorized_time</code></td>
<td><code>long</code></td>
<td>when the guest was authorized</td>
</tr>
<tr>
<td><code>authorized_expiring_time</code></td>
<td><code>long</code></td>
<td>when the authorization would expire</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>optional, the info provided by user</td>
</tr>
<tr>
<td><code>email</code></td>
<td><code>string</code></td>
<td>optional, the info provided by user</td>
</tr>
<tr>
<td><code>company</code></td>
<td><code>string</code></td>
<td>optional, the info provided by user</td>
</tr>
<tr>
<td><code>field1</code></td>
<td><code>string</code></td>
<td>optional, the info provided by user</td>
</tr>
</tbody>
</table>
<h2 id="get-guest-authorization">Get Guest Authorization</h2>
<pre><code>GET /api/v1/sites/:site_id/guests/:guest_mac
</code></pre>
<h3 id="response_122">Response</h3>
<pre><code>[
    {
        "mac": "5684dae9ac8b",
        "authorized": true,
        "authorized_time": 1480704355,
        "authorized_expiring_time": 1480704955,
        "name": "John Smith",
        "email": "john@abc.com",
        "company": "abc",
        "field1": "xxx"
    }
]
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>mac</td>
</tr>
<tr>
<td><code>authorized</code></td>
<td><code>boolean</code></td>
<td>whether the guest is current authorized</td>
</tr>
<tr>
<td><code>authorized_time</code></td>
<td><code>long</code></td>
<td>when the guest was authorized</td>
</tr>
<tr>
<td><code>authorized_expiring_time</code></td>
<td><code>long</code></td>
<td>when the authorization would expire</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>optional, the info provided by user</td>
</tr>
<tr>
<td><code>email</code></td>
<td><code>string</code></td>
<td>optional, the info provided by user</td>
</tr>
<tr>
<td><code>company</code></td>
<td><code>string</code></td>
<td>optional, the info provided by user</td>
</tr>
<tr>
<td><code>field1</code></td>
<td><code>string</code></td>
<td>optional, the info provided by user</td>
</tr>
</tbody>
</table>
<h2 id="update-guest-authorization">Update Guest Authorization</h2>
<pre><code>PUT /api/v1/sites/:site_id/guests/:guest_mac
</code></pre>
<h3 id="request_92">Request</h3>
<pre><code>{
    "name": "guest1",
    "email": "guest1@email.com",
    "company":"companyXYZ",
    "minutes": 60,
    "field1": "value1",
    ......
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>minutes</code></td>
<td><code>int</code></td>
<td>minutes, the maximum is 259200 (180 days)</td>
</tr>
</tbody>
</table>
<h2 id="delete-guest-authorization">Delete Guest Authorization</h2>
<pre><code>DELETE /api/v1/sites/:site_id/guests/:guest_mac
</code></pre>
<h2 id="search-authorized-guest">Search Authorized Guest</h2>
<pre><code>GET /api/v1/sites/:site_id/guests/search?wlan_id=88ffe630-95b8-11e8-b294-346895ed1b7d&amp;limit=2
</code></pre>
<h3 id="response_123">Response</h3>
<pre><code>{
    "end": 1531862583.0,
    "results": [
        {
            "ssid": "openNet",
            "timestamp": 1531782218,
            "company": "mistsystems",
            "auth_method": "passphrase",
            "ap": "5c5b350e0001",
            "authorized_expiring_time": 1531810258.186273,
            "authorized_time": 1531782218,
            "email": "user@mistsys.com",
            "name": "john"
        },
        {
            "ssid": "openNet",
            "timestamp": 1531782632,
            "company": "xyz inc.",
            "auth_method": "facebook",
            "ap": "5c5b350e0001",
            "authorized_expiring_time": 1531810821.145,
            "authorized_time": 1531782632,
            "email": "cool_user@yahoo.com",
            "name": "John White"
        }
    ],
    "next": "/api/v1/sites/8aaba0aa-09cc-44bd-9709-33b98040550c/guests/search?wlan_id=88ffe630-95b8-11e8-b294-346895ed1b7d&amp;end=1531855849.000&amp;limit=2&amp;start=1531776183.0",
    "start": 1531776183.0,
    "limit": 2,
    "total": 14
}
</code></pre>
<h2 id="count-authorized-guest">Count Authorized Guest</h2>
<pre><code>GET /api/v1/sites/:site_id/guests/count?distinct=auth_method
</code></pre>
<h3 id="response_124">Response</h3>
<pre><code>{
    "end": 1531862583.0,
    "results": [
        {
            "auth_method": "passphrase",
            "count": 2
        },
        {
            "auth_method": "facebook",
            "count": 4
        }
    ],
    "start": 1531776183.0,
    "total": 2
}
</code></pre>
<h1 id="zone-stats">Zone Stats</h1>
<h2 id="get-zone-stats">Get Zone Stats</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/zones?map_id=845a23bf-bed9-e43c-4c86-6fa474be7ae5
</code></pre>
<h3 id="response_125">Response</h3>
<pre><code>[
    {
        "id": "8ac84899-32db-6327-334c-9b6d58544cfe",
        "name": "Board Room",
        "map_id": "63eda950-c6da-11e4-a628-60f81dd250cc",
        "num_assets": 0,
        "assets_waits": {
            "max": 0,
            "min": 0,
            "avg": 0,
            "p95": 0
        }
        "num_sdkclients": 10,
        "sdkclients_waits": {
            "max": 3610,
            "min": 600,
            "avg": 1200,
            "p95": 2800
        }
        "num_clients": 80,
        "clients_waits": {
            "max": 3610,
            "min": 600,
            "avg": 1200,
            "p95": 2800
        }
    }
]
</code></pre>
<h3 id="zone-stat-definition">Zone Stat Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>id of the zone</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name of the zone</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map_id of the zone</td>
</tr>
<tr>
<td><code>sdkclient_waits</code></td>
<td><code>object</code></td>
<td>sdkclient wait time right now</td>
</tr>
<tr>
<td><code>client_waits</code></td>
<td><code>object</code></td>
<td>client wait time right now</td>
</tr>
<tr>
<td><code>asset_waits</code></td>
<td><code>object</code></td>
<td>ble asset wait time right now</td>
</tr>
<tr>
<td><code>num_assets</code></td>
<td><code>int</code></td>
<td>number of assets</td>
</tr>
<tr>
<td><code>num_clients</code></td>
<td><code>int</code></td>
<td>number of wifi clients (unconnected + connected)</td>
</tr>
<tr>
<td><code>num_sdkclients</code></td>
<td><code>int</code></td>
<td>number of sdk clients</td>
</tr>
<tr>
<td><code>max</code></td>
<td><code>int</code></td>
<td>longest wait time in seconds</td>
</tr>
<tr>
<td><code>min</code></td>
<td><code>int</code></td>
<td>shortest wait time in seconds</td>
</tr>
<tr>
<td><code>avg</code></td>
<td><code>int</code></td>
<td>average wait time in seconds</td>
</tr>
<tr>
<td><code>p95</code></td>
<td><code>int</code></td>
<td>95th percentile of all the wait time(s)</td>
</tr>
</tbody>
</table>
<h2 id="get-detail-zone-stats">Get Detail Zone Stats</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/&lt;zones|rssizones&gt;/:zone_id
</code></pre>
<h3 id="response_126">Response</h3>
<pre><code>{
    "id": "8ac84899-32db-6327-334c-9b6d58544cfe",
    "name": "Board Room",
    "map_id": "63eda950-c6da-11e4-a628-60f81dd250cc",
    "num_sdkclients": 0,
    "num_clients": 80,
    "client_waits": {
        "max": 3610,
        "min": 600,
        "avg": 1200,
        "p95": 2800
    },
    "sdkclients": [
        "7e2b463d-c91c-ff7d-f3c0-6eccc6949ff8"
        ...
    ],
    "clients": [
        "5684dae9ac8b",
    ]
}
</code></pre>
<h3 id="zone-stat-definition_1">Zone Stat Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>id of the zone</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name of the zone</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map_id of the zone</td>
</tr>
<tr>
<td><code>sdkclient_waits</code></td>
<td><code>object</code></td>
<td>sdkclient wait time right now</td>
</tr>
<tr>
<td><code>client_waits</code></td>
<td><code>object</code></td>
<td>client wait time right now</td>
</tr>
<tr>
<td><code>sdkclients</code></td>
<td><code>list</code></td>
<td>list of sdkclients currently in the zone and when they entered</td>
</tr>
<tr>
<td><code>clients</code></td>
<td><code>list</code></td>
<td>list of clients currently in the zone and when they entered</td>
</tr>
<tr>
<td><code>assets</code></td>
<td><code>list</code></td>
<td>list of ble assets currently in the zone and when they entered</td>
</tr>
<tr>
<td><code>max</code></td>
<td><code>int</code></td>
<td>longest wait time in seconds</td>
</tr>
<tr>
<td><code>min</code></td>
<td><code>int</code></td>
<td>shortest wait time in seconds</td>
</tr>
<tr>
<td><code>avg</code></td>
<td><code>int</code></td>
<td>average wait time in seconds</td>
</tr>
<tr>
<td><code>p95</code></td>
<td><code>int</code></td>
<td>95th percentile of all the wait time(s)</td>
</tr>
</tbody>
</table>
<h2 id="search-zone-sessions">Search Zone Sessions</h2>
<p>Recent Zone Visits (7-days) are searchable via the following APIs</p>
<pre><code>GET /api/v1/sites/:site_id/zones/visits/search?user_type=asset&amp;scope_id=85fbba9e-4e12-11e6-9188-0242ac110007&amp;limit=2
GET /api/v1/sites/:site_id/rssizones/visits/search?user_type=asset&amp;scope_id=85fbba9e-4e12-11e6-9188-0242ac110007&amp;limit=2
</code></pre>
<h3 id="request_93">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>user_type</code></td>
<td><code>string</code></td>
<td>user type, client (default) / sdkclient / asset</td>
</tr>
<tr>
<td><code>user</code></td>
<td><code>string</code></td>
<td>client MAC / Asset MAC / SDK UUID</td>
</tr>
<tr>
<td><code>scope_id</code></td>
<td><code>string</code></td>
<td>if scope == map/zone/rssizone, the scope id</td>
</tr>
<tr>
<td><code>scope</code></td>
<td><code>string</code></td>
<td>scope, site (default) / map / zone / rssizone</td>
</tr>
<tr>
<td><code>tags</code></td>
<td><code>string</code></td>
<td>tags</td>
</tr>
</tbody>
</table>
<h3 id="response_127">Response</h3>
<pre><code>{
    "end": 1541705289.769911,
    "results": [
        {
            "scope": "map",
            "enter": 1541705254,
            "user": "c4b301c81166",
            "timestamp": 1541705254
        },
        {
            "scope": "map",
            "enter": 1541705247,
            "user": "c57bbb6a1277",
            "timestamp": 1541705247
        }
    ],
    "next": "/api/v1/sites/67970e46-4e12-11e6-9188-0242ac110007/zones/visits/search?limit=2&amp;end=1541705247.000&amp;scope_id=85fbba9e-4e12-11e6-9188-0242ac110007&amp;user_type=asset&amp;start=1541618889.77",
    "start": 1541618889.769886,
    "limit": 2,
    "total": 5892
}
</code></pre>
<h2 id="count-zone-sessions">Count Zone Sessions</h2>
<pre><code>GET /api/v1/sites/:site_id/zones/visits/count?distinct=scope_id
GET /api/v1/sites/:site_id/rssizones/visits/count?distinct=scope_id
</code></pre>
<h3 id="request_94">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>user_type</code></td>
<td><code>string</code></td>
<td>user type, client (default) / sdkclient / asset</td>
</tr>
<tr>
<td><code>user</code></td>
<td><code>string</code></td>
<td>client MAC / Asset MAC / SDK UUID</td>
</tr>
<tr>
<td><code>scope_id</code></td>
<td><code>string</code></td>
<td>if scope == map/zone/rssizone, the scope id</td>
</tr>
<tr>
<td><code>scope</code></td>
<td><code>string</code></td>
<td>scope, site (default) / map / zone / rssizone</td>
</tr>
</tbody>
</table>
<h3 id="response_128">Response</h3>
<pre><code>{
    "end": 1531862583.0,
    "results": [
        {
            "scope_id": "f0c38357-9370-4506-84f9-0f94a63faddd",
            "count": 18
        },
        {
            "scope_id": "a002eb82-6d08-4556-b8c5-2f2547a7c7f8",
            "count": 7
        },
        {
            "scope_id": "85fbba9e-4e12-11e6-9188-0242ac110007",
            "count": 5
        }
    ],
    "start": 1531776183.0,
    "total": 3
}
</code></pre>
<h1 id="location">Location</h1>
<h2 id="get-sdkclient-stats">Get SdkClient Stats</h2>
<p>This has information about</p>
<pre><code>GET /api/v1/sites/:site_id/stats/maps/:map_id/sdkclients
</code></pre>
<h3 id="response_129">Response</h3>
<pre><code>[
    {
        "id": "de87bf9d-183f-e383-cc68-6ba43947d403",
        "uuid": "ada72f8f-1643-e5c6-94db-f2a5636f1a64",
        "name": "John's iPhone",

        "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
        "last_seen": 1428939600,
        "x": 60,
        "y": 80,

        "network_connection": {
            "type": "WiFi",
            "rssi": -75,
            "mac": "c3-b6-e5-af-41-15",
            "signal_level": 3
        }
    },
    ...
]
</code></pre>
<h3 id="sdk-client-definition">SDK Client Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>uuid</code></td>
<td><code>string</code></td>
<td>uuid of the sdk client</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name of the sdk client (if provided)</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map_id of the sdk client (if known), or null</td>
</tr>
<tr>
<td><code>last_seen</code></td>
<td><code>long</code></td>
<td>last seen timestamp</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>int</code></td>
<td>x (in pixels) of user location on the map (if known)</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>int</code></td>
<td>y (in pixels) of user location on the map (if known)</td>
</tr>
<tr>
<td><code>network_connection</code></td>
<td><code>object</code></td>
<td>various network connection info for the SDK client (if known, else omitted), with RSSI in dBm, and signal level as # of bars/signal indicator of signal strength</td>
</tr>
</tbody>
</table>
<h2 id="get-detail-stats-of-a-sdkclient">Get Detail Stats of a SdkClient</h2>
<p>This has information about</p>
<pre><code>GET /api/v1/sites/:site_id/stats/sdkclients/:sdkclient_uuid
</code></pre>
<h3 id="response_130">Response</h3>
<pre><code>{
    "id": "de87bf9d-183f-e383-cc68-6ba43947d403",
    "uuid": "ada72f8f-1643-e5c6-94db-f2a5636f1a64",
    "name": "John's iPhone",

    "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
    "zones": [
        {
            "id": "8ac84899-32db-6327-334c-9b6d58544cfe",
            "since": 1428939600
        }
    ],
    "vbeacons": [
        {
            "id": "d379d29d-24b4-96c5-5dd4-6f2a2dc5aaeb",
            "since": 1428939300
        }
    ],

    "last_seen": 1428939600,
    "x": 60,
    "y": 80,

    "network_connection": {
        "type": "WiFi",
        "rssi": -75,
        "mac": "c3-b6-e5-af-41-15",
        "signal_level": 3
    }
}
</code></pre>
<h3 id="sdk-client-definition_1">SDK Client Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>uuid</code></td>
<td><code>string</code></td>
<td>uuid of the sdk client</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name of the sdk client (if provided)</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map_id of the sdk client (if known), or null</td>
</tr>
<tr>
<td><code>zones</code></td>
<td><code>list</code></td>
<td>list of zone_id’s of the sdk client is in and since when (if known)</td>
</tr>
<tr>
<td><code>vbeacons</code></td>
<td><code>list</code></td>
<td>list of beacon_id’s of the sdk client is in and since when (if known)</td>
</tr>
<tr>
<td><code>last_seen</code></td>
<td><code>long</code></td>
<td>last seen timestamp</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>int</code></td>
<td>x (in pixels) of user location on the map (if known)</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>int</code></td>
<td>y (in pixels) of user location on the map (if known)</td>
</tr>
<tr>
<td><code>network_connection</code></td>
<td><code>object</code></td>
<td>various network connection info for the SDK client (if known, else omitted), with RSSI in dBm, and signal level as # of bars/signal indicator of signal strength</td>
</tr>
</tbody>
</table>
<h2 id="subscribe-to-sdkclients-stream">Subscribe to sdkclients Stream</h2>
<pre><code>WS /api-ws/v1/stream
</code></pre>
<h3 id="request_95">Request</h3>
<pre><code>{
    "subscribe": "/sites/:site_id/stats/maps/:map_id/sdkclients"
}
</code></pre>
<h3 id="response_131">Response</h3>
<pre><code>{
    "event": "data",
    "channel": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/stats/maps/845a23bf-bed9-e43c-4c86-6fa474be7ae5/sdkclients",
    "data": {
        "id": "de87bf9d-183f-e383-cc68-6ba43947d403",
        "uuid": "ada72f8f-1643-e5c6-94db-f2a5636f1a64",
        "name": "John's iPhone",

        "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",

        "last_seen": 1428939600,
        "x": 60,
        "y": 80
    }
}
</code></pre>
<h1 id="unconnected-client-location">Unconnected Client Location</h1>
<pre><code>GET /api/v1/sites/:site_id/stats/maps/:map_id/unconnected_clients
</code></pre>
<h3 id="response_132">Response</h3>
<pre><code>[
    {
        "mac": "5684dae9ac8b",
        "ap_mac": "5c5b350e0410",
        "map_id": "ea77be98-ab51-4ff8-a863-ac3c8e1b1c3a",
        "x": 60,
        "y": 80,
        "rssi": -75.0,
        "manufacture": "Apple",
        "last_seen": 1428939600
    }
]
</code></pre>
<h3 id="definitions_6">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>mac address of the (unconnected) client</td>
</tr>
<tr>
<td><code>ap_mac</code></td>
<td><code>string</code></td>
<td>mac address of the AP that heard the client</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map_id of the client (if known), or null</td>
</tr>
<tr>
<td><code>x</code></td>
<td><code>int</code></td>
<td>x (in pixels) of user location on the map (if known)</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>int</code></td>
<td>y (in pixels) of user location on the map (if known)</td>
</tr>
<tr>
<td><code>rssi</code></td>
<td><code>int</code></td>
<td>client RSSI observered by the AP that heard the client (in dBm)</td>
</tr>
<tr>
<td><code>manufacture</code></td>
<td><code>string</code></td>
<td>device manufacture, through fingerprinting or OUI</td>
</tr>
<tr>
<td><code>last_seen</code></td>
<td><code>long</code></td>
<td>last seen timestamp</td>
</tr>
</tbody>
</table>
<h2 id="subscribe-to-unconnected-clients-stream">Subscribe to Unconnected clients Stream</h2>
<pre><code>WS /api-ws/v1/stream
</code></pre>
<h3 id="request_96">Request</h3>
<pre><code>{
    "subscribe": "/sites/:site_id/stats/maps/:map_id/unconnected_clients"
}
</code></pre>
<h3 id="response_133">Response</h3>
<pre><code>{
    "event": "data",
    "channel": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/stats/maps/63eda950-c6da-11e4-a628-60f81dd250cc/unconnected_clients",
    "data": {
         "mac": "5684dae9ac8b",
         "ap_mac": "5c5b350e0410",
         "map_id": "63eda950-c6da-11e4-a628-60f81dd250cc",
         "x": 60,
         "y": 80,
         "rssi": -75.0,
         "manufacture": "Apple",
         "last_seen": 1480715946,
         "num_locating_aps": 0
    }
}
</code></pre>
<h1 id="rf-glass">RF Glass</h1>
<pre><code>WS /api-ws/v1/stream
</code></pre>
<h2 id="subscribe-rfglass-information">subscribe RFGlass information</h2>
<pre><code>// for SDK Client
{
    "subscribe": "/sites/:site_id/sdkclients/:sdkclient_id/diag"
}

// WIFI Client
{
    "subscribe": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/clients/112233445566/diag"
}

// BLE Asset
{
    "subscribe": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/assets/7beb14fc-dc99-d51a-bc9e-9c7360db8520/diag"
}
</code></pre>
<h3 id="event-if-subscription-is-successful">Event if subscription is successful</h3>
<pre><code>{
    "event": "channel_subscribed",
    "channel": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/sdkclients/de87bf9d-183f-e383-cc68-6ba43947d403/diag"
}
</code></pre>
<h3 id="event-if-something-is-wrong">Event if something is wrong</h3>
<pre><code>{
    "event": "subscribe_failed",
    "channel": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/sdkclients/de87bf9d-183f-e383-cc68-6ba43947d403/diag",
    "detail": "permission denied"
}
</code></pre>
<h3 id="rf-glass-data">RF Glass Data</h3>
<pre><code>//For SDK Client
{
    "event": "data",
    "channel": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/sdkclients/de87bf9d-183f-e383-cc68-6ba43947d403/diag",
    "data": {
        "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
        "grid": {
            "topleft_x_m": -0.86,
            "topleft_y_m": 9.2486,
            "size_m": 0.5,
            "width": 40,
            "height": 40,
            "data": "&lt;base-64 encoded data intended to be interpreted by atob() in JS&gt;",
        },
        "motion": true,

        "avg_duration": 3,
        "vbles": [
            {
                "type": "device",
                "id": "00000000-0000-0000-1000-5c5b350e0060",
                "orientation": 90,
                "xyz_m": [ 5.79, 4.33, 3.04 ],
                "rssis": [ -52.32, -53, -55, -57, -60.25, null, null, -62, null ]
            },
            {
                "type": "beacon",
                "id": "00000000-0000-0000-1000-e74489000052",
                "xyz_m": [ 8.79, 10.33, 3.04 ],
                "rssi": -59.5
            }
        ],
        "peak": {
            "vble_id": "00000000-0000-0000-1000-e74489000052",
            "max_rssi": -53.428,
            "plf": -73,
            "ple": -21,
            "intercept": -52
        },

        // estimates based on probability surface, we'll always have this
        "raw_xyz_m": [ 18.7486, 10.13269, 0 ],
        "smoothed_xyz_m": [ 18.7486, 10.13269, 0 ],

        // available only if present
        "app_xyz_m": [18.714, 10.1102, 0],
        "dead_reckoning_xyz_m": [18.791, 10.1613, 0],
        "dead_reckoning_raw_xyz_m": [18.157, 10.110, 0],

        "model": "iPod7",
        "os": "",
        "version": "10.2.1",
        "beams_count": 12,
        "beams_mean": 4,
        "missing_beams": 16,
        "speed": 1,
        "direction": 235,
        "timestamp": 1501113999.758902,

        // the loudest mote estimate
        "closest_mote_xyz_m": [ 8.79, 10.33, 3.04 ],
        // 3 past consecutive mote estimates
        "adjusted_mote_xyz_m": [ 8.79, 10.33, 3.04 ],
        // another algorithm, more sophisticated
        "vector_mote_xyz_m": [ 8.79, 10.33, 3.04 ]

        //particle reset flags
        "pf_reset": false,
        "pf_hard_reset": false

        "latency": 123
    }
}

// WIFI locations from 3 or more APs
{
    "event": "data",
    "channel": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/clients/112233445566/diag",
    "data": {
        "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
        "grid": {
            "topleft_x_m": -0.86,
            "topleft_y_m": 9.2486,
            "size_m": 0.5,
            "width": 40,
            "height": 40,
            "data": "&lt;base-64 encoded data intended to be interpreted by atob() in JS&gt;",
        },
        "vbles": [
            {
                "type": "beacon",
                "id": "00000000-0000-0000-1000-5c5b350e0060",
                "xyz_m": [ 5.79, 4.33, 3.04 ],
                "rssi": -52.32
            }
        ],
        "peak": {
            "vble_id": "00000000-0000-0000-1000-e74489000052",
            "max_rssi": -53.428,
            "plf": -73,
            "ple": -21,
            "intercept": -52
        },

        // estimates based on probability surface, we'll always have this
        "raw_xyz_m": [ 18.7486, 10.13269, 0 ],
        "smoothed_xyz_m": [ 18.7486, 10.13269, 0 ],
        "model": "",
        "speed": null,
        "direction": null,
        "timestamp": 1501113989.754602,

        //particle reset flags
        "pf_reset": false,
        "pf_hard_reset": false

    }
}
// WIFI locations from &lt;3 AP
{
    "event": "data",
    "channel": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/clients/6ba43947d403/diag",
    "data": {
        "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
        "grid": null,
        "vbles": [
            {
                "type": "beacon",
                "id": "00000000-0000-0000-1000-5c5b350e0060",
                "xyz_m": [ 5.79, 4.33, 3.04 ],
                "rssi": -52.32
            }
        ],
        "peak": {
            "vble_id": "00000000-0000-0000-1000-e74489000052",
            "max_rssi": -53.428,
            "plf": -73,
            "ple": -21,
            "intercept": -52
        },

        // estimates based on probability surface, we'll always have this
        "raw_xyz_m": [ 18.7486, 10.13269, 0 ],
        "smoothed_xyz_m": [ 18.7486, 10.13269, 0 ],
        "model": "",
        "speed": null,
        "direction": null,
        "timestamp": 1501113912.759202,

        //particle reset flags
        "pf_reset": false,
        "pf_hard_reset": false

    }
}

// For BLE ASSET Client
{
    "event": "data",
    "channel": "/sites/4ac1dcf4-9d8b-7211-65c4-057819f0862b/assets/115825352113/diag",
    "data": {
        "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
        "grid": {
            "topleft_x_m": -0.86,
            "topleft_y_m": 9.2486,
            "size_m": 0.5,
            "width": 40,
            "height": 40,
            "data": "&lt;base-64 encoded data intended to be interpreted by atob() in JS&gt;",
        },
        "motion": false,

        "vbles": [
            {
                "type": "device",
                "id": "00000000-0000-0000-1000-5c5b350e0060",
                "orientation": 90,
                "xyz_m": [ 5.79, 4.33, 3.04 ],
                "rssis": [ -52.32, -53, -55, -57, -60.25, null, null, -62, null ]
            },
            {
                "type": "beacon",
                "id": "00000000-0000-0000-1000-e74489000052",
                "xyz_m": [ 8.79, 10.33, 3.04 ],
                "rssi": -59.5
            }
        ],
        "peak": {
            "vble_id": "00000000-0000-0000-1000-e74489000052",
            "max_rssi": -53.428,
            "plf": -73,
            "ple": -21,
            "intercept": -52
        },

        // estimates based on probability surface, we'll always have this
        "raw_xyz_m": [ 18.7486, 10.13269, 0 ],
        "smoothed_xyz_m": [ 18.7486, 10.13269, 0 ],

        "model": "asset",
        "speed": null,
        "direction": null,
        "timestamp": 1501113197.768402,


        // the loudest mote estimate
        "closest_mote_xyz_m": [ 8.79, 10.33, 3.04 ],
        // 3 past consecutive mote estimates
        "adjusted_mote_xyz_m": [ 8.79, 10.33, 3.04 ],
        // another algorithm, more sophisticated
        "vector_mote_xyz_m": [ 8.79, 10.33, 3.04 ]

        //particle reset flags
        "pf_reset": false,
        "pf_hard_reset": false
    }
}
</code></pre>
<h3 id="definition_5">Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map id</td>
</tr>
<tr>
<td><code>vbles</code></td>
<td><code>list</code></td>
<td>list of vble devices we used to calculate the estimates</td>
</tr>
<tr>
<td><code>avg_duration</code></td>
<td><code>int</code></td>
<td>duration over which rssis are averaged</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>device (our VBLE device) / beacon (3rd party beacon)</td>
</tr>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>device or beacon id</td>
</tr>
<tr>
<td><code>orientation</code></td>
<td><code>int</code></td>
<td>orientation if type==device, 0 for beacon</td>
</tr>
<tr>
<td><code>xyz_m</code></td>
<td><code>list</code></td>
<td>location of the vble</td>
</tr>
<tr>
<td><code>rssis</code></td>
<td><code>list</code></td>
<td>9 rssi values array if type==device, value is null if such beam not used, last/9th entry is for the omni antenna while the rest are for the directional ones</td>
</tr>
<tr>
<td><code>rssi</code></td>
<td><code>float</code></td>
<td>rssi if type==beacon</td>
</tr>
<tr>
<td><code>grid</code></td>
<td><code>object</code></td>
<td>the grid intended to be renderred</td>
</tr>
<tr>
<td><code>topleft_x_m</code></td>
<td><code>float</code></td>
<td>grid’s top-left x position on map, in meter, can be negative</td>
</tr>
<tr>
<td><code>topleft_y_m</code></td>
<td><code>float</code></td>
<td>grid’s top-left y position on map, in meter, can be negative</td>
</tr>
<tr>
<td><code>size_m</code></td>
<td><code>float</code></td>
<td>size of the grid, in meter</td>
</tr>
<tr>
<td><code>width</code></td>
<td><code>int</code></td>
<td>number of grids on x-axis</td>
</tr>
<tr>
<td><code>height</code></td>
<td><code>int</code></td>
<td>number of grids on y-axis</td>
</tr>
<tr>
<td><code>data</code></td>
<td><code>string</code></td>
<td>base64 encoded byte array with size == width*height, value is from 0-250, confidence level</td>
</tr>
<tr>
<td><code>motion</code></td>
<td><code>bool</code></td>
<td>whether sdk client is moving</td>
</tr>
<tr>
<td><code>raw_xyz_m</code></td>
<td><code>list</code></td>
<td>raw client location in meter</td>
</tr>
<tr>
<td><code>smoothed_xyz_m</code></td>
<td><code>list</code></td>
<td>smoothed client location in meter</td>
</tr>
<tr>
<td><code>app_xyz_m</code></td>
<td><code>list</code></td>
<td>client location in meter from app</td>
</tr>
<tr>
<td><code>dead_reckoning_xyz_m</code></td>
<td><code>list</code></td>
<td>dead reckoning based client location in meter</td>
</tr>
<tr>
<td><code>dead_reckoning_raw_xyz_m</code></td>
<td><code>list</code></td>
<td>raw dead reckoning based client location in meter</td>
</tr>
<tr>
<td><code>closest_mote_xyz_m</code></td>
<td><code>list</code></td>
<td>raw client location in meter</td>
</tr>
<tr>
<td><code>adjusted_mote_xyz_m</code></td>
<td><code>list</code></td>
<td>smoothed client location in meter</td>
</tr>
<tr>
<td><code>vector_mote_xyz_m</code></td>
<td><code>list</code></td>
<td>mote</td>
</tr>
<tr>
<td><code>peak</code></td>
<td><code>object</code></td>
<td>peak metrics, as each vble-ap has its own ple+int, we use the strongest beam (RSSI-wise, excluding the omni) to identify the location</td>
</tr>
<tr>
<td><code>device_id</code></td>
<td><code>string</code></td>
<td>device id</td>
</tr>
<tr>
<td><code>max_rssi</code></td>
<td><code>int</code></td>
<td>max rssi (across beams in all vbles, excluding the omnis)</td>
</tr>
<tr>
<td><code>plf</code></td>
<td><code>float</code></td>
<td>PLE + INT from machine learning</td>
</tr>
<tr>
<td><code>ple</code></td>
<td><code>float</code></td>
<td>PLE from machine learning</td>
</tr>
<tr>
<td><code>intercept</code></td>
<td><code>float</code></td>
<td>INT from machine learning</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>model name of the client</td>
</tr>
<tr>
<td><code>beam_count</code></td>
<td><code>int</code></td>
<td>number of beams as seen by client</td>
</tr>
<tr>
<td><code>beam_mean</code></td>
<td><code>float</code></td>
<td>avg beacons per beam</td>
</tr>
<tr>
<td><code>missing_beams</code></td>
<td><code>int</code></td>
<td>difference between expected beams and actual heard beam count</td>
</tr>
<tr>
<td><code>speed</code></td>
<td><code>float</code></td>
<td>speed of the client in metres/second (available only for SDK Client when particle algorithm is enabled). Otherwise, null.</td>
</tr>
<tr>
<td><code>direction</code></td>
<td><code>int</code></td>
<td>direction of client in degrees, 0 means up is north, 90 means up is east. (available only for SDK Client when particle algorithm is enabled). Otherwise, null.</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>float</code></td>
<td>timestamp</td>
</tr>
<tr>
<td><code>os</code></td>
<td><code>string</code></td>
<td>os information of the client if available</td>
</tr>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>os version information of the client if available</td>
</tr>
<tr>
<td><code>latency</code></td>
<td><code>int</code></td>
<td>Round trip time (rtt) latency</td>
</tr>
</tbody>
</table>
<h2 id="unsubscribe-sdkclient-rfglass-information">unsubscribe SdkClient RFGlass information</h2>
<pre><code>{
    "unsubscribe": "/sites/:site_id/stats/sdkclients/:sdkclient_id/diag"
}
</code></pre>
<h1 id="rf-glass-recording">RF Glass Recording</h1>
<h2 id="start-recording">Start recording</h2>
<pre><code>POST /api/v1/sites/:site_id/rfdiags
</code></pre>
<h3 id="request_97">Request</h3>
<pre><code>{
    "name": "Troubleshooting",
    "type": "sdkclient",
    "sdkclient_id": "de87bf9d-183f-e383-cc68-6ba43947d403",
    "duration": 120
}
</code></pre>
<h3 id="parameters_80">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name of the recording, the name of the sdk client would be a good default choice</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>sdkclient / client/ asset</td>
</tr>
<tr>
<td><code>sdkclient_id</code></td>
<td><code>string</code></td>
<td>if type==sdkclient, sdkclient_id of this recording</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>if type==client or asset, mac of the device</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>recording length in seconds, max is 180. Default value is also 180.</td>
</tr>
</tbody>
</table>
<h2 id="stop-recording">Stop Recording</h2>
<pre><code>POST /api/v1/sites/:site_id/rfdiags/:rfdiag_id/stop
</code></pre>
<p>If the recording session is active for the given <code>rfdiag_id</code>, it will finish the recording.
<code>duration</code> and <code>end_time</code> will be updated to reflect the correct values.</p>
<h2 id="list-recordings">List Recordings</h2>
<pre><code>GET /api/v1/sites/:site_id/rfdiags
</code></pre>
<h3 id="response_134">Response</h3>
<pre><code>[
    {
        "id": "8b944030-04cd-4f91-d61c-3557bb088cad",
        "name": "Troubleshooting",
        "type": "sdkclient",
        "sdkclient_id": "de87bf9d-183f-e383-cc68-6ba43947d403",
        "sdkclient_name": "app-client",
        "sdkclient_uuid": "5b3ee6be-5b7c-11e7-b288-346895ed1b7d",
        "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
        "url": "https://s3.amazon.com/.../frames.json",
        "raw_events": "https://s3.amazon.com/.../raw-events.json",
        "start_time": 1476990144,
        "end_time": 1476990204,
        "duration": 60,
        "frame_count": 12,
        "ready": True,
        "next": "8b944179-04cd-4f91-d61c-3557bb08813d"
    }
]
</code></pre>
<h3 id="definitions_7">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>sdkclient / client / asset</td>
</tr>
<tr>
<td><code>sdkclient_id</code></td>
<td><code>string</code></td>
<td>if type==sdkclient, sdkclient_id of this recording</td>
</tr>
<tr>
<td><code>sdkclient_uuid</code></td>
<td><code>string</code></td>
<td>if type==sdkclient, device_id of sdkclient</td>
</tr>
<tr>
<td><code>asset_id</code></td>
<td><code>string</code></td>
<td>if type==asset, id of the asset</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>if type==client or type==asset, mac of the device</td>
</tr>
<tr>
<td><code>start_time</code></td>
<td><code>int</code></td>
<td>timestamp of the recording (the start)</td>
</tr>
<tr>
<td><code>end_time</code></td>
<td><code>int</code></td>
<td>timestamp of end of recording</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>recording length in seconds, max is 120</td>
</tr>
<tr>
<td><code>ready</code></td>
<td><code>boolean</code></td>
<td>whether it’s ready for playback</td>
</tr>
<tr>
<td><code>url</code></td>
<td><code>string</code></td>
<td>URL to a JSON file that contains an array of frames, each frame is the same format</td>
</tr>
<tr>
<td><code>raw_events</code></td>
<td><code>string</code></td>
<td>URL to a JSON file that contains array of raw location diag events</td>
</tr>
<tr>
<td><code>frame_count</code></td>
<td><code>int</code></td>
<td>Number of frames in the output</td>
</tr>
<tr>
<td><code>sdkclient_name</code></td>
<td><code>string</code></td>
<td>if type==sdkclient, name of the sdkclient</td>
</tr>
<tr>
<td><code>client_name</code></td>
<td><code>string</code></td>
<td>if type==client, hostname of the client</td>
</tr>
<tr>
<td><code>asset_name</code></td>
<td><code>string</code></td>
<td>if type==asset, name of the asset</td>
</tr>
<tr>
<td><code>next</code></td>
<td><code>string</code></td>
<td>Optional. id of the next recoding if present. Only valid for site survey.</td>
</tr>
</tbody>
</table>
<h2 id="update-recording">Update Recording</h2>
<pre><code>PUT /api/v1/sites/:site_id/rfdiags/:rfdiag_id
</code></pre>
<h3 id="request_98">Request</h3>
<pre><code>{
    "name": "Trouble-Shoot"
}
</code></pre>
<h2 id="delete-recording">Delete Recording</h2>
<pre><code>DELETE /api/v1/sites/:site_id/rfdiags/:rfdiag_id
</code></pre>
<h2 id="download-recording">Download Recording</h2>
<p>Download <code>raw_events</code> blob</p>
<pre><code>GET /api/v1/sites/:site_id/rfdiags/:rfdiag_id/download
</code></pre>
<h2 id="export-json-document-as-csv-file">Export Json document as CSV file</h2>
<p>Allows downloading provided json content as csv file</p>
<pre><code>POST /api/v1/utils/json_to_csv
</code></pre>
<h3 id="request_99">Request</h3>
<pre><code>{"json": "{
    \"filename\": \"content.txt\",
    \"rows\": [
        {
            \"plf\": -77,
            \"loc_err\": 0.112,
            \"way2\": 5,
        },
        {
            \"plf\": -74,
            \"loc_err\": 1.192,
            \"way1\": 1,
            \"way2\": 7
        }
    ],
    \"headers\": [\"plf\", \"loc_err\", \"way1\", \"way2\"]
    }"
}
</code></pre>
<h3 id="response_135">Response</h3>
<p>A file called <code>content.txt</code> will be downloaded with following content</p>
<pre><code>plf,loc_err,way1,way2
-77,0.112,,5
-74,1.192,1,7
</code></pre>
<h1 id="machine-learning">Machine Learning</h1>
<h2 id="get-beam-coverage-overview">Get Beam Coverage Overview</h2>
<pre><code>GET /api/v1/sites/:site_id/location/coverage?map_id=845a23bf-bed9-e43c-4c86-6fa474be7ae5
</code></pre>
<h3 id="request_100">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>duration</code></td>
<td><code>string</code></td>
<td>1d, 30m, 5h, where the start time will be calculated (with end time is now), default is 1h</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>sdkclient / client / asset, default is sdkclient</td>
</tr>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map_id (filter by map_id)</td>
</tr>
<tr>
<td><code>resolution</code></td>
<td><code>string</code></td>
<td>default / fine</td>
</tr>
<tr>
<td><code>client_type</code></td>
<td><code>string</code></td>
<td>client_type (as filter. optional)</td>
</tr>
</tbody>
</table>
<h3 id="response_136">Response</h3>
<pre><code>{
    "start": 1428939600,
    "end": 1428954000,
    "beams_means": [
        [ 1, 3, 3.2 ],
        [ 6, 10, 6.5 ],
        ...
    ],
    "gridsize": 1.0,
    "result_def": [
        'x', 'y', 'beams_mean', 'beacons_mean', 'max_rssi', 'avg_rssi'
    ],
    "results": [
        [ 1, 3, 3.2, 18.5, -68, -70 ],
        [ 6, 10, 6.5, 30,1, -72.5, -75 ],
        ...
    ]
}
</code></pre>
<h3 id="response-definitions_1">Response Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>beams_means</code></td>
<td><code>list</code></td>
<td>list of [x, y, mean]s, x/y are in meters (UI would need to use map.ppm to calulate the pixel location from top-left).</td>
</tr>
<tr>
<td><code>gridsize</code></td>
<td><code>float</code></td>
<td>the size of grid, in meter</td>
</tr>
<tr>
<td><code>results</code></td>
<td><code>list</code></td>
<td>list of results, see result_def.</td>
</tr>
<tr>
<td><code>result_def</code></td>
<td><code>list</code></td>
<td>list of names annotating the fields in results</td>
</tr>
</tbody>
</table>
<h2 id="get-machine-learning-current-stat">Get Machine Learning Current Stat</h2>
<p>For each VBLE AP, it has ML model parameters (e.g. Path-loss-estimate, Intercept) as well as completion indicators
(Level and PercentageComplete). For the completeness, ML takes N sample to finish its first level and use N*0.25 samples
to complete each successive level. When a device is moved, the completeness will be reset as it has to re-learn.</p>
<pre><code>GET /api/v1/sites/:site_id/location/ml/current?map_id=:map_id
</code></pre>
<h3 id="request_101">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>map_id</code></td>
<td><code>string</code></td>
<td>map_id (as filter, optional)</td>
</tr>
</tbody>
</table>
<h3 id="response_137">Response</h3>
<pre><code>[
    {
        "device_id": "b069b358-4c97-5319-1f8c-7c5ca64d6ab1",
        "current": {
            "iOS": {"ple": -3, "level": 6, "int": -6, "completed": 16, "src": "default", "quality": "2", "timestamp": 1442854704},
            "Android": {"ple": -3, "level": 3, "int": -6, "completed": 36,  "src": "device", "quality": "4", "timestamp": 1442854794},
            "iPod": {"ple": -5, "int": -10, "src": "overwrite", "overwrite": true}
        }
    },
    {
        "beacon_id": "7913f032-aab4-c3ae-e83e-5a2756ef4d40",
        "current": {
            "iOS": {"ple": -3, "level": 6, "int": -6, "completed": 16, "src": "device", "quality": "last", "timestamp": 1442854704},
        }
    }
    ...
]
</code></pre>
<h3 id="response-definition_1">Response Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>device_id</code></td>
<td><code>stirng</code></td>
<td>id of device if this ML is for Mist AP</td>
</tr>
<tr>
<td><code>beacon_id</code></td>
<td><code>string</code></td>
<td>id of beacon if this ML is for 3rd party beacon</td>
</tr>
<tr>
<td><code>current</code></td>
<td><code>object</code></td>
<td>ml stats, per client_type</td>
</tr>
<tr>
<td><code>level</code></td>
<td><code>int</code></td>
<td>level of learning</td>
</tr>
<tr>
<td><code>completed</code></td>
<td><code>int</code></td>
<td>learning completeness to the next level</td>
</tr>
<tr>
<td><code>ple</code></td>
<td><code>float</code></td>
<td>internal</td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>float</code></td>
<td>internal</td>
</tr>
<tr>
<td><code>quality</code></td>
<td><code>int</code></td>
<td>from 0 - 4, 4 being most accurate</td>
</tr>
<tr>
<td><code>src</code></td>
<td><code>string</code></td>
<td>where the PLF comes from. <code>machine</code> (PLF from last learning) / <code>device</code> (last learnt PLF from this device) / <code>model</code> (model of the client device) / <code>overwrite</code> (from ML overwrite)</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>long</code></td>
<td>epoch, last updated</td>
</tr>
</tbody>
</table>
<h2 id="get-default-plf-for-models">Get Default PLF for Models</h2>
<pre><code>GET /api/v1/sites/:site_id/location/ml/defaults
</code></pre>
<h3 id="response_138">Response</h3>
<pre><code>{
    "iOS": {"ple": -3, "int": -6, "completed": 16,"quality": "2"},
    "Android": {"ple": -3,"int": -6, "completed": 36, "quality": "4"}
}
</code></pre>
<h3 id="response-definition_2">Response Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ple</code></td>
<td><code>float</code></td>
<td>internal</td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>float</code></td>
<td>internal</td>
</tr>
<tr>
<td><code>quality</code></td>
<td><code>int</code></td>
<td>from 0 - 4, 4 being most accurate</td>
</tr>
</tbody>
</table>
<h2 id="overwrite-ml-for-device">Overwrite ML For Device</h2>
<pre><code>PUT /api/v1/sites/:site_id/location/ml/device/:device_id
</code></pre>
<h3 id="request_102">Request</h3>
<pre><code>{
    "iOS": { "ple": -3, "int": 6 },
    "iPod": { "ple": -5, "int": -10 }
}
</code></pre>
<p>To clear ML overwrite for a certain model, call above api with plf value as null.</p>
<p><code>{
    "iOS": null
}</code></p>
<h2 id="clear-ml-overwrite-for-device">Clear ML Overwrite for Device</h2>
<pre><code>DELETE /api/v1/sites/:site_id/location/ml/device/:device_id
</code></pre>
<h2 id="overwrite-ml-for-map">Overwrite ML For Map</h2>
<pre><code>PUT /api/v1/sites/:site_id/location/ml/map/:map_id
</code></pre>
<h3 id="request_103">Request</h3>
<p>See above</p>
<h2 id="clear-ml-overwrite-for-map">Clear ML Overwrite for Map</h2>
<pre><code>DELETE /api/v1/sites/:site_id/location/ml/map/:map_id
</code></pre>
<h2 id="reset-ml-stats-by-map">Reset ML Stats by Map</h2>
<pre><code>POST /api/v1/sites/:site_id/location/ml/reset/map/:map_id
</code></pre>
<h3 id="request_104">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>map_id</code></td>
<td><code>stirng</code></td>
<td>id of map, all devices on the map will have ML reset</td>
</tr>
</tbody>
</table>
<h1 id="insights">Insights</h1>
<h2 id="get-available-insight-metrics">Get Available Insight Metrics</h2>
<pre><code>GET /api/v1/const/insight_metrics
</code></pre>
<h3 id="response_139">Response</h3>
<pre><code>{
    // as timeseries
    "num_clients": {
        "description": "number of client over time",
        "type": "timeseries",
        "unit": "",
        "scopes": ["site", "ap"],
        "intervals": {
            "10m": {"interval": 600, "max_age": 86400},
            "1h": {"interval": 3600, "max_age": 1209600}
        },
        "report_scopes": ["site"],
        "report_intervals": {
            "1d": {"interval": 86400}
        },
        "example": [ 18, null, 15 ]
    },

    // as key value
    "top-client": {
        "description": "top clients",
        "type": "keyvalues",
        "key": {"mac": {"hint": "client"}},
        "values": {"bytes": {"unit": "bytes"}},
        "scopes": ["site", "ap"],
        "intervals": {
            "10m": {"interval": 600, "max_age": 86400},
            "1h": {"interval": 3600, "max_age": 1209600}
        },
        "report_scopes": ["site"],
        "report_intervals": {
            "1d": {"interval": 86400}
        },
        "example": [
            {
                "mac": "5684dae9ac8b",
                "bytes": 1232333
            }
        ]
    },

}
</code></pre>
<h2 id="get-insight-metrics">Get Insight Metrics</h2>
<p>There can be more detailed metrics in different scopes.</p>
<pre><code>GET /api/v1/sites/:site_id/insights/:metric
GET /api/v1/sites/:site_id/insights/device/:mac/:metric
GET /api/v1/sites/:site_id/insights/client/:mac/:metric
</code></pre>
<h3 id="parameters_81">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>wlan_id</code></td>
<td><code>string</code></td>
<td>UUID of the wlan. This parameter is supported only for site scope.</td>
</tr>
</tbody>
</table>
<h3 id="response_140">Response</h3>
<pre><code>{
    "start": 1428939600,
    "end":   1428954000,
    "interval": 3600,

    // data
    "results": [
        {
            // results depends on :metric
        },
        ...
    ],
}
</code></pre>
<h2 id="get-anomaly-events">Get Anomaly Events</h2>
<p>Some metrics has anomaly derection built in (if sle_baselined is true in Insight Metric Definitions)
If supported , SLE anomaly events can get retrieved from</p>
<pre><code>GET /api/v1/sites/:site_id/anomaly/:metric
GET /api/v1/sites/:site_id/anomaly/device/:mac/:metric
GET /api/v1/sites/:site_id/anomaly/client/:mac/:metric
</code></pre>
<h3 id="response_141">Response</h3>
<p>The format is the similar to Insights with additional info.</p>
<pre><code>{
    "start": 1428939600,
    "end":   1428954000,
    "limit": 100,
    "page": 1,
    "results": [
        {
            "timestamp": 1431384000,
            "sle_baseline": 0.5,
            "sle_deviation": -0.15,
            "events": ["config_update"],

            // supported by some anomalies
            "since": 1431380400
        }
    ]
}
</code></pre>
<h1 id="rogue-detection-and-mitigation">Rogue Detection and Mitigation</h1>
<h2 id="get-neighbor-aps">Get Neighbor APs</h2>
<pre><code>GET /api/v1/sites/:site_id/insights/rogues?limit=100&amp;duration=1h
</code></pre>
<h3 id="parameters_82">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>duration</code></td>
<td><code>string</code></td>
<td>1d / 1h, default is 1d</td>
</tr>
<tr>
<td><code>limit</code></td>
<td><code>int</code></td>
<td>max number of results, default = 100</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>honeypot (honeypots) / lan (wired rogue) / spoof / others, default is others</td>
</tr>
</tbody>
</table>
<h3 id="response_142">Response</h3>
<pre><code>{
    "start": 1428939600,
    "end":   1428954000,
    "limit": 100,
    "next": /api/v1/sites/a3eda150-ab3f-11e4-aa18-13e21dd250cc/rogues?start=1498482000&amp;end=1498485600&amp;limit=10&amp;interval=1h&amp;type=others&amp;token="003600100000002e00080000015ce445d20000000657656566656500001162632d36342d34622d33382d39642d31620000036f7267007fffff9bed6131885196aa1b76969c4411,
    "results": [
        {
            "ssid": "xfinitywifi",
            "bssid": "d8-97-ba-76-b5-aa",
            "num_aps": 4,
            "ap_mac": "5c5b350e021c",
            "channel": "11",
            "avg_rssi": -72.0,
            "times_heard": 8
        },
        ..........
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>next</code></td>
<td><code>string</code></td>
<td>link to next set of results. If more results aren’t present, <code>next</code> is null.</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>ssid of the network detected as threat</td>
</tr>
<tr>
<td><code>bssid</code></td>
<td><code>string</code></td>
<td>bssid of the network detected as threat</td>
</tr>
<tr>
<td><code>num_aps</code></td>
<td><code>int</code></td>
<td>num of aps that heard the ssid/bssid pair</td>
</tr>
<tr>
<td><code>ap_mac</code></td>
<td><code>string</code></td>
<td>mac of the device that had strongest signal strength for ssid/bssid pair</td>
</tr>
<tr>
<td><code>channel</code></td>
<td><code>string</code></td>
<td>channel over which <code>ap_mac</code> heard ssid/bssid pair</td>
</tr>
<tr>
<td><code>avg_rssi</code></td>
<td><code>float</code></td>
<td>average signal strength of <code>ap_mac</code> for ssid/bssid pair</td>
</tr>
<tr>
<td><code>times_heard</code></td>
<td><code>int</code></td>
<td>represents number of times the pair was heard in the interval. Each count roughly corresponds to a minute.</td>
</tr>
<tr>
<td><code>seen_on_lan</code></td>
<td><code>boolean</code></td>
<td>whether the reporting AP see a wireless client (on LAN) connecting to it</td>
</tr>
</tbody>
</table>
<h2 id="deauth-clients-connected-to-a-rogue">Deauth Clients connected to a Rogue</h2>
<p>Send Deauth frame to clients connected to a Rogue AP</p>
<pre><code>POST /api/v1/sites/:site_id/rogues/:rogue_bssid/deauth_clients
</code></pre>
<h2 id="get-rogue-clients">Get Rogue Clients</h2>
<pre><code>GET /api/v1/sites/:site_id/insights/rogues/clients?limit=100&amp;duration=1h
</code></pre>
<h3 id="parameters_83">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>duration</code></td>
<td><code>string</code></td>
<td>1d / 1h, default is 1d</td>
</tr>
<tr>
<td><code>limit</code></td>
<td><code>int</code></td>
<td>max number of results, default = 100</td>
</tr>
</tbody>
</table>
<h3 id="response_143">Response</h3>
<pre><code>{
    "start": 1428939600,
    "end":   1428954000,
    "limit": 100,
    "next": /api/v1/sites/a3eda150-ab3f-11e4-aa18-13e21dd250cc/rogues/clients?start=1498482000&amp;end=1498485600&amp;limit=10&amp;interval=1h&amp;token="00d400100000125e00080000015ce44512000000065765656666500001162632d36342d34622d33382d39642d31620000036f7267007fffff9bed6131885196aa1b76969c4411,
    "results": [
        {
            "bssid": "d8-97-ba-76-b5-aa",
            "ap_mac": "5c-5b-35-0e-02-1c",
            "client_mac": "34-f8-32-13-57-c2"
            "num_aps": 2,
            "band": "5",
            "avg_rssi": -63.9,
            "annotation": "whitelist"
        },
        ..........
    ]
}
</code></pre>
<h2 id="get-rogue-ap-details">Get Rogue AP Details</h2>
<pre><code>GET /api/v1/sites/:site_id/rogues/:rogue_bssid
</code></pre>
<h3 id="response_144">Response</h3>
<pre><code>{
    "seen_as_client": true,
    "manufacture": "Intel Corporate"
}
</code></pre>
<h2 id="search-rogue-events">Search Rogue Events</h2>
<pre><code>GET /api/v1/sites/:site_id/rogues/events/search?type=honeypot
</code></pre>
<h3 id="response_145">Response</h3>
<pre><code>{
    "results": [
        {
            "ssid": "MyHomeNetwork",
            "bssid": "38ff363c8c4c",
            "timestamp": 1538074612,
            "ap": "5c5b350e10030",
            "rssi": -54.0,
            "channel": 136
        },
        {
            "ssid": "Home-Office",
            "bssid": "60d02c2394cc",
            "timestamp": 1538074612,
            "ap": "5c5b350e10030",
            "rssi": -59.0,
            "channel": 11
        }
    ],
    "start": 1538071200,
    "end": 1538074800,
    "limit": 10,
    "total": 2
}
</code></pre>
<h2 id="count-rogue-events">Count Rogue Events</h2>
<pre><code>GET /api/v1/sites/:site_id/rogues/events/count?distinct=bssid
</code></pre>
<h3 id="response_146">Response</h3>
<pre><code>{
    "results": [
        {
            "count": 1,
            "bssid": "38ff363c8c4c"
        },
        {
            "count": 1
            "bssid": "60d02c2394cc"
        }
    ],
    "start": 1538071200,
    "end": 1538074800,
    "limit": 10,
    "total": 2
}
</code></pre>
<h2 id="get-system-level-changes-per-site-for-comparison-with-service-level-experience-sle-impact">Get system level changes per site for comparison with Service Level Experience (SLE) impact</h2>
<pre><code>GET /api/v1/sites/:site_id/events/system?start=1431384000&amp;end=1431298000&amp;limit=10
</code></pre>
<h2 id="query">Query</h2>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>start</code></td>
<td><code>long</code></td>
<td>start time, in epoch,</td>
</tr>
<tr>
<td><code>end</code></td>
<td><code>long</code></td>
<td>start time, default is now()</td>
</tr>
<tr>
<td><code>limit</code></td>
<td><code>long</code></td>
<td>number of events</td>
</tr>
</tbody>
</table>
<h3 id="response_147">Response</h3>
<pre><code>{
    "start": 1428939600,
    "end":   1428954000,
    "results": [
        {
            "change_cat": "admin_action",
            "type": "config_update"
            "timestamp": 1431384000,
            "message": "WLAN config was updated"
        },
        {
            "change_cat": "rrm_update",
            "type": "interference",
            "timestamp": 1431384001,
            "message": " Power on Channel 40 was reduced on AP aa-bb-cc-dd-ee-ff"
        },
        ...
    ]
}


</code></pre>
<h3 id="response-definitions_2">Response definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>change_cat</code></td>
<td><code>string</code></td>
<td>event name used as an identifier. The string is typically a human understandable string with all lower case letters and snake-cased if there are multiple words</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>long</code></td>
<td>time since epoch</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>Additional subtype of the event, where applicable. For RRM, 3 types will be Interference,Reboot,Periodic. For admin action, 3  types will be manual_reboot,fw_update and config_change.Not all events might have associated types.</td>
</tr>
<tr>
<td><code>message</code></td>
<td><code>string</code></td>
<td>All metadata associated with the event as string.</td>
</tr>
</tbody>
</table>
<h2 id="get-system-level-changes-per-site-per-device-for-comparison-with-service-level-experience-sle-impact">Get system level changes per site per device for comparison with  Service Level Experience (SLE) impact</h2>
<pre><code>GET /api/v1/sites/:site_id/devices/:device_id/events/system?start=1496256371&amp;end=1496259837&amp;limit=10
</code></pre>
<h2 id="query_1">Query</h2>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>start</code></td>
<td><code>long</code></td>
<td>start time, in epoch,</td>
</tr>
<tr>
<td><code>end</code></td>
<td><code>long</code></td>
<td>start time, default is now()</td>
</tr>
<tr>
<td><code>limit</code></td>
<td><code>long</code></td>
<td>number of events</td>
</tr>
</tbody>
</table>
<h3 id="response_148">Response</h3>
<pre><code>{
  "page": "",
  "sys_change_per_ap_data": [
    {
      "metadata": "{\"ap\": \"5c-5b-35-0e-02-b7\", \"update\": \"Mist engineering is aware of the software issue &amp; working to resolve it\"}",
      "change_cat": "ap_health",
      "type": "software-panic",
      "timestamp": 1496259837
    },
    {
      "metadata": "{\"ap\": \"5c-5b-35-0e-02-b7\", \"update\": \"Mist engineering is aware of the software issue &amp; working to resolve it\"}",
      "change_cat": "ap_health",
      "type": "software-panic",
      "timestamp": 1496256965
    },
    {
      "metadata": "{\"ap\": \"5c-5b-35-0e-02-b7\", \"update\": \"Mist engineering is aware of the software issue &amp; working to resolve it\"}",
      "change_cat": "ap_health",
      "type": "software-panic",
      "timestamp": 1496256373
    }
  ]
}
</code></pre>
<h3 id="response-definitions_3">Response definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>change_cat</code></td>
<td><code>string</code></td>
<td>event name used as an identifier. The string is typically a human understandable string with all lower case letters and snake-cased if there are multiple words</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>long</code></td>
<td>time since epoch</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>Additional subtype of the event, where applicable. For RRM, 3 types will be Interference,Reboot,Periodic. For admin action, 3  types will be manual_reboot,fw_update and config_change.Not all events might have associated types.</td>
</tr>
<tr>
<td><code>metadata</code></td>
<td><code>string</code></td>
<td>All metadata associated with the event as JSON.</td>
</tr>
</tbody>
</table>
<h1 id="alarms">Alarms</h1>
<h2 id="alarm-definitions">Alarm definitions</h2>
<p>Get the definitions of alarms you’d seen from our backend and example. HA cluster node names will be
specified in the ‘node’ field, if applicable.</p>
<pre><code>GET /api/v1/const/alarm_defs
</code></pre>
<h2 id="ack-an-alarm">Ack An alarm</h2>
<p>Acknowledge an alarm.</p>
<pre><code>POST /api/v1/sites/:site_id/alarms/:alarm_id/ack
</code></pre>
<h4 id="body_11">Body</h4>
<pre><code>{
    "note": "maintenance window"
}
</code></pre>
<h4 id="parameters_84">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>In</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>site_id</code></td>
<td>string</td>
<td>path</td>
<td>UUID of the site</td>
</tr>
<tr>
<td><code>alarm_id</code></td>
<td>string</td>
<td>path</td>
<td>UUID of the alarm</td>
</tr>
<tr>
<td><code>note</code></td>
<td>string</td>
<td>body</td>
<td>(optional) Some text note describing the intent</td>
</tr>
</tbody>
</table>
<h2 id="unack-an-alarm">Unack An alarm</h2>
<p>Unacknowledge an alarm.</p>
<pre><code>POST /api/v1/sites/:site_id/alarms/:alarm_id/unack
</code></pre>
<h4 id="body_12">Body</h4>
<pre><code>{
    "note": "maintenance window"
}
</code></pre>
<h4 id="parameters_85">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>In</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>site_id</code></td>
<td>string</td>
<td>path</td>
<td>UUID of the site</td>
</tr>
<tr>
<td><code>alarm_id</code></td>
<td>string</td>
<td>path</td>
<td>UUID of the alarm</td>
</tr>
<tr>
<td><code>note</code></td>
<td>string</td>
<td>body</td>
<td>(optional) Some text note describing the intent</td>
</tr>
</tbody>
</table>
<h2 id="ack-multiple-alarms">Ack multiple alarms</h2>
<p>Acknowledge multiple alarms at once.</p>
<pre><code>POST /api/v1/sites/:site_id/alarms/ack
</code></pre>
<h4 id="body_13">Body</h4>
<pre><code>{
    "alarm_ids": ["ccb8c94d-ca56-4075-932f-1f2ab444ff2c", "98ff4a3d-ec9b-4138-a42e-54fc3335179d"],
    "note": "maintenance window"
}
</code></pre>
<h4 id="parameters_86">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>In</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>site_id</code></td>
<td>string</td>
<td>path</td>
<td>UUID of the site</td>
</tr>
<tr>
<td><code>alarm_ids</code></td>
<td>list</td>
<td>body</td>
<td>List of UUIDs of the alarms to ack</td>
</tr>
<tr>
<td><code>note</code></td>
<td>string</td>
<td>body</td>
<td>(optional) Some text note describing the intent</td>
</tr>
</tbody>
</table>
<h2 id="unack-multiple-alarms">UnAck multiple alarms</h2>
<p>Unacknowledge multiple alarms at once.</p>
<pre><code>POST /api/v1/sites/:site_id/alarms/unack
</code></pre>
<h4 id="body_14">Body</h4>
<pre><code>{
    "alarm_ids": ["ccb8c94d-ca56-4075-932f-1f2ab444ff2c", "98ff4a3d-ec9b-4138-a42e-54fc3335179d"],
    "note": "maintenance window"
}
</code></pre>
<h4 id="parameters_87">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>In</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>site_id</code></td>
<td>string</td>
<td>path</td>
<td>UUID of the site</td>
</tr>
<tr>
<td><code>alarm_ids</code></td>
<td>list</td>
<td>body</td>
<td>List of UUIDs of the alarms to unack</td>
</tr>
<tr>
<td><code>note</code></td>
<td>string</td>
<td>body</td>
<td>(optional) Some text note describing the intent</td>
</tr>
</tbody>
</table>
<h2 id="ack-all-alarms">Ack all alarms</h2>
<p>Acknowledge all the alarms of a site at once.</p>
<pre><code>POST /api/v1/sites/:site_id/alarms/ack_all
</code></pre>
<h4 id="body_15">Body</h4>
<pre><code>{
    "note": "maintenance window"
}
</code></pre>
<h4 id="parameters_88">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>In</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>site_id</code></td>
<td>string</td>
<td>path</td>
<td>UUID of the site</td>
</tr>
<tr>
<td><code>note</code></td>
<td>string</td>
<td>body</td>
<td>(optional) Some text note describing the intent</td>
</tr>
</tbody>
</table>
<h2 id="unack-all-alarms">Unack all alarms</h2>
<p>Unacknowledge all the alarms of a site at once.</p>
<pre><code>POST /api/v1/sites/:site_id/alarms/unack_all
</code></pre>
<h4 id="body_16">Body</h4>
<pre><code>{
    "note": "maintenance window"
}
</code></pre>
<h4 id="parameters_89">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>In</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>site_id</code></td>
<td>string</td>
<td>path</td>
<td>UUID of the site</td>
</tr>
<tr>
<td><code>note</code></td>
<td>string</td>
<td>body</td>
<td>(optional) Some text note describing the intent</td>
</tr>
</tbody>
</table>
<p>N.B.: Batch size for multiple alarm ack and unack has to be less or or equal to 1000.</p>
<h2 id="get-alarms">Get Alarms</h2>
<p>List or Search alarms within a site.</p>
<pre><code>GET /api/v1/sites/:site_id/alarms/search
</code></pre>
<h4 id="parameters_90">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>In</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>site_id</code></td>
<td>string</td>
<td>path</td>
<td>UUID of the site</td>
</tr>
<tr>
<td><code>type</code></td>
<td>string</td>
<td>query</td>
<td>Key-name of the alarms; accepts multiple values separated by comma</td>
</tr>
<tr>
<td><code>ack_admin_name</code></td>
<td>string</td>
<td>query</td>
<td>Name of the admins who have acked the alarms; accepts multiple values separated by comma</td>
</tr>
<tr>
<td><code>acked</code></td>
<td>boolean</td>
<td>query</td>
<td></td>
</tr>
<tr>
<td><code>group</code></td>
<td>string</td>
<td>query</td>
<td>Alarm group name; accepts multiple values separated by comma</td>
</tr>
<tr>
<td><code>severity</code></td>
<td>string</td>
<td>query</td>
<td>Alarm severity; accepts multiple values separated by comma</td>
</tr>
<tr>
<td><code>status</code></td>
<td>string</td>
<td>query</td>
<td>Alarm status; accepts multiple values separated by comma</td>
</tr>
</tbody>
</table>
<h3 id="response_149">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h4 id="body_17">Body</h4>
<pre><code>{
    "results": [
        {
            "id": "8a93ab2d-b745-a093-7936-80d7922559b5",
            "timestamp": 1431382121,
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "type": "device-down"

            "count": 3,
            "acked": true,
            "acked_time": 1431388121,
            "ack_admin_name": "FirstName LastName first.last@someorg.com",
            "ack_admin_id": "ab6fdaa0-e7c4-428b-9259-7d7a603afa8a",
            "note": "upgrade switch",

            // additional information per alarm type defined under `fields` in API: GET /api/v1/const/alarm_defs (see "Additional Information" section)
        }
    ]
}
</code></pre>
<h4 id="definition_6">Definition</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>results</code></td>
<td>list</td>
<td>List of result objects</td>
</tr>
<tr>
<td><code>id</code></td>
<td>list</td>
<td>UUID of the alarm</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td>string</td>
<td>UUID of the site</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td>string</td>
<td>UUID of the org</td>
</tr>
<tr>
<td><code>type</code></td>
<td>string</td>
<td>Key-name of the alarm type</td>
</tr>
<tr>
<td><code>group</code></td>
<td>string</td>
<td>Group of the alarm</td>
</tr>
<tr>
<td><code>severity</code></td>
<td>string</td>
<td>Severity of the alarm</td>
</tr>
<tr>
<td><code>count</code></td>
<td>int</td>
<td>Number of incident within an alarm window</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td>long</td>
<td>Epoch (seconds) of the first incident/alarm</td>
</tr>
<tr>
<td><code>last_seen</code></td>
<td>long</td>
<td>Epoch (seconds) of the last incident/alarm within an alarm window</td>
</tr>
<tr>
<td><code>acked</code></td>
<td>boolean</td>
<td>(optional)Whether the alarm is acked or not</td>
</tr>
<tr>
<td><code>acked_time</code></td>
<td>long</td>
<td>(optional)Epoch (seconds) when the alarm was acked</td>
</tr>
<tr>
<td><code>ack_admin_name</code></td>
<td>string</td>
<td>(optional)Name &amp; Email ID of the admin who acked the alarm</td>
</tr>
<tr>
<td><code>ack_admin_id</code></td>
<td>string</td>
<td>(optional)UUID of the admin who acked the alarm</td>
</tr>
<tr>
<td><code>note</code></td>
<td>string</td>
<td>(optional)Text describing the alarm</td>
</tr>
<tr>
<td><code>component</code></td>
<td>string</td>
<td>(optional)Component of the alarm</td>
</tr>
<tr>
<td><code>status</code></td>
<td>string</td>
<td>(optional)Status of the alarm (open/resolved)</td>
</tr>
<tr>
<td><code>resolved_time</code></td>
<td>long</td>
<td>(optional)Epoch (seconds) of the resolved_time for the alarm</td>
</tr>
</tbody>
</table>
<h4 id="additional-information">Additional Information</h4>
<p>Additional information per alarm type.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>aps</code></td>
<td>list</td>
<td>List of MACs of the APs e.g. [“ffeeddccbbaa”, “ffeeddccbbab”]</td>
</tr>
<tr>
<td><code>switches</code></td>
<td>list</td>
<td>List of MACs of the switches e.g. [“ffeeddccbbaa”, “ffeeddccbbab”]</td>
</tr>
<tr>
<td><code>gateways</code></td>
<td>list</td>
<td>List of MACs of the gateways e.g. [“ffeeddccbbaa”, “ffeeddccbbab”]</td>
</tr>
<tr>
<td><code>hostnames</code></td>
<td>string</td>
<td>List of Hostnames of the devices (AP/Switch/Gateway)</td>
</tr>
<tr>
<td><code>ssids</code></td>
<td>list</td>
<td>List of SSIDs</td>
</tr>
<tr>
<td><code>bssids</code></td>
<td>list</td>
<td>List of BSSIDs</td>
</tr>
</tbody>
</table>
<h2 id="count-alarms">Count Alarms</h2>
<p>Count alarms within a site.</p>
<pre><code>GET /api/v1/sites/:site_id/alarms/count
</code></pre>
<h4 id="parameters_91">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>In</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>site_id</code></td>
<td>string</td>
<td>path</td>
<td>UUID of the site</td>
</tr>
<tr>
<td><code>type</code></td>
<td>string</td>
<td>query</td>
<td>Key-name of the alarms; accepts multiple values separated by comma</td>
</tr>
<tr>
<td><code>ack_admin_name</code></td>
<td>string</td>
<td>query</td>
<td>Name of the admins who have acked the alarms; accepts multiple values separated by comma</td>
</tr>
<tr>
<td><code>acked</code></td>
<td>boolean</td>
<td>query</td>
<td></td>
</tr>
<tr>
<td><code>group</code></td>
<td>string</td>
<td>query</td>
<td>Alarm group name; accepts multiple values separated by comma</td>
</tr>
<tr>
<td><code>severity</code></td>
<td>string</td>
<td>query</td>
<td>Alarm severity; accepts multiple values separated by comma</td>
</tr>
<tr>
<td><code>distinct</code></td>
<td>string</td>
<td>query</td>
<td>(optional)Group by and count the alarms by some distinct field (e.g. <code>type</code>, <code>group</code>, <code>severity</code> etc.); default=<code>type</code></td>
</tr>
</tbody>
</table>
<h3 id="response_150">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h4 id="body_18">Body</h4>
<pre><code>{
    "results": [
        {
            "type": "switch_restarted", // here `type` is a value (&lt;group-by&gt;) to parameter `distinct`
            "count": 2
        },
        {
            "type": "device_down",
            "count": 1
        },
        {
            "type": "device_restarted",
            "count": 1
        }    
    ],
    "start": 1625477727.0,
    "end": 1625566540.9141023,
    "limit": 10,
    "distinct": "group",
    "total": 1,
}
</code></pre>
<h4 id="definition_7">Definition</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>results</code></td>
<td>list</td>
<td>List of result objects</td>
</tr>
<tr>
<td><code>&lt;group-by&gt;</code></td>
<td>string</td>
<td>A field based on which alarms are grouped &amp; counted</td>
</tr>
<tr>
<td><code>count</code></td>
<td>int</td>
<td>Number of alarms grouped by <code>distinct</code> parameter value</td>
</tr>
</tbody>
</table>
<h1 id="adopted-switches">Adopted Switches</h1>
<p>Get version compliance metrics for managed or monitored switches</p>
<pre><code>GET /api/v1/sites/:site_id/stats/switches/metrics
</code></pre>
<h3 id="request-default">Request (Default)</h3>
<p>No input parameter is required for default</p>
<h3 id="request-switch-level">Request (Switch Level)</h3>
<p>For switch level, the following parameters can be used.
Switch level query is applicable only for metric type: active_ports_summary</p>
<pre><code>{
    "type": "active_ports_summary",
    "scope": 'switch',
    "switch_mac": "fc334262ef00"
}
</code></pre>
<h3 id="parameters_92">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>scope</code></td>
<td><code>string</code></td>
<td>metric scope, site/switch</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>metric type, only active_ports_summary metric type is supported</td>
</tr>
<tr>
<td><code>switch_mac</code></td>
<td><code>string</code></td>
<td>switch mac, used only with metric type active_ports_summary</td>
</tr>
</tbody>
</table>
<h3 id="response-default">Response (Default)</h3>
<pre><code>{
    "version_compliance": {
        "total_switch_count": 2,
        "score": 100.0,
        "details": {
            "major_versions": [
                {
                    "major_version": "21.4R3.5",
                    "system_names": [],
                    "model": "EX2300-C-12P",
                    "major_count": 1
                },
                {
                    "major_version": "6.0.4-11",
                    "system_names": [],
                    "model": "SSR120",
                    "major_count": 1
                }
            ]
        }
    },
    "config_success": {
        "total_switch_count": 2,
        "score": 100.0,
        "details": {
            "config_success_count": 2
        }
    },
    "active_ports_summary": {
        "total_switch_count": 2,
        "score": 100.0,
        "details": {
            "total_port_count": 4, 
            "active_port_count": 4
        }
    }
}
</code></pre>
<h3 id="response-switch-level">Response (Switch Level)</h3>
<pre><code>    "active_ports_summary": {
        "total_switch_count": 1,
        "score": 50.0,
        "switch_id": "67970e46-4e12-11e6-9188-0242ac110007_fc334262ef00",  // site_id + switch_mac
        "details": {
            "total_port_count": 2,
            "active_port_count": 1
        }
    }
}
</code></pre>
<h1 id="discovered-switches">Discovered Switches</h1>
<p>Get a list of switches that we discovered, with connected AP list</p>
<h2 id="get-discovered-switches">Get Discovered Switches</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/discovered_switches/search
GET /api/v1/sites/:site_id/stats/discovered_switches/count
</code></pre>
<h3 id="response_151">Response</h3>
<pre><code>{
    "results": [
        {
            "system_name": "mist-lab-ex2300c",
            "hostname": "mist-lab-ex2300c",
            "mgmt_addr": "10.1.1.1",
            "vendor": "Juniper Networks",
            "org_id": "6748cfa6-4e12-11e6-9188-0242ac110007",
            "aps": [
                {
                    "inactive_wired_vlans": [],
                    "hostname": "ap41nearlab",
                    "when": "2019-06-13T19:53:16.870+0000",
                    "mac": "5c5b352e2001",
                    "poe_status": true
                }
            ],
            "site_id": "67970e46-4e12-11e6-9188-0242ac110007",
            "system_desc": "Juniper Networks, Inc. ex2300-c-12p Ethernet Switch, kernel JUNOS 18.2R2.6, Build date: 2018-12-07 13:19:04 UTC Copyright (c) 1996-2018 Juniper Networks, Inc.",
            "version": "18.2R2.6",
            "timestamp": 1560457177.037,
            "model": "EX2300-C-12P",
            "ap_redundancy": {
                "num_aps": 15,
                "num_aps_with_switch_redundancy": 8,

                # for a VC / stacked switches
                "modules": {
                    "1": {
                        "num_aps": 15,
                        "num_aps_with_switch_redundancy": 8
                    }
                    ...
                }
            }
        }
    ]
}
</code></pre>
<h2 id="get-discovered-switches-metrics">Get Discovered Switches Metrics</h2>
<p>Discovered switches related metrics, lists related switch system names &amp; details if not compliant</p>
<pre><code>GET /api/v1/sites/:site_id/stats/discovered_switches/metrics
</code></pre>
<h3 id="response_152">Response</h3>
<pre><code>{
    "version_compliance": {
        "score": 75,
        "details": {
            "major_versions": [
                {
                    "model": "EX2300-C-12P",
                    "major_count": 2,
                    "system_names": [
                        "switch1",
                        "mist-lab-ex2300c"
                    ]
                },
                {
                    "model": "EX4300-48P",
                    "major_count": 1,
                    "system_names": []
                },
            ],
            "total_switch_count": 5
        }
    },
    "switch_ap_affinity": {
        "score": 33.3333,
        "details": {
            "threshold": 12,
            "system_name": [
                "mist-lab-ex2300c",
                "switch1"
            ]
        }
    },
    "inactive_wired_vlans": {
        "score": 100.0,
        "details": {}
    },
    "poe_compliance": {
        "score": 100.0,
        "details": {
            "total_power": 981500.0,
            "total_aps": 63
        }
    }
}

</code></pre>
<h3 id="parameters_93">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>threshold</code></td>
<td><code>string</code></td>
<td>configurable # ap per switch threshold, default 12</td>
</tr>
<tr>
<td><code>system_name</code></td>
<td><code>string</code></td>
<td>system name for switch level metrics, optional</td>
</tr>
</tbody>
</table>
<h1 id="discovered-switch-metrics-search">Discovered Switch Metrics Search</h1>
<p>Get a list of wired assurance metrics, lists related switch system names &amp; details if not compliant</p>
<h2 id="search-discovered-switch-metrics">Search Discovered Switch Metrics</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/discovered_switch_metrics/search
</code></pre>
<h3 id="response_153">Response</h3>
<pre><code>{
    "results": [
        {
            "details": {
                "system_names": [
                    "CORP-D-SW-2"
                ]
            },
            "site_id": "c1698122-c14c-11e5-8e81-1258369c38a9",
            "org_id": "c168ddee-c14c-11e5-8e81-1258369c38a9",
            "timestamp": 1568917200,
            "scope": "site",
            "score": 95,
            "type": "inactive_wired_vlans"
        },
        {
            "timestamp": 1568917200,
            "site_id": "c1698122-c14c-11e5-8e81-1258369c38a9",
            "org_id": "c168ddee-c14c-11e5-8e81-1258369c38a9",
            "scope": "site",
            "type": "poe_compliance",
            "score": 100.0,
            "details": {
                "total_power": 78000.0,
                "total_aps": 4
            }
        },
        {
            "timestamp": 1568917201,
            "site_id": "c1698122-c14c-11e5-8e81-1258369c38a9",
            "org_id": "c168ddee-c14c-11e5-8e81-1258369c38a9",
            "scope": "site",
            "total_switch_count": 1,
            "type": "version_compliance",
            "score": 100.0,
            "details": {
                "major_versions": [
                    {
                        "major_version": "18.2R3-S6.5",
                        "system_names": [],
                        "model": "EX2300-48P",
                        "major_count": 1
                    }
                ]
            }
        },
        {
            "timestamp": 1568917201,
            "site_id": "c1698122-c14c-11e5-8e81-1258369c38a9",
            "org_id": "c168ddee-c14c-11e5-8e81-1258369c38a9",
            "scope": "site",
            "type": "switch_ap_affinity",
            "score": 100.0,
            "details": {
                "threshold": 12
            }
        }
    ]
}

</code></pre>
<h3 id="parameters_94">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>scope</code></td>
<td><code>string</code></td>
<td>metric scope, site/switch, default is site, optional</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>metric type, inactive_wired_vlans/switch_ap_affinity/poe_compliance/version_compliance, optional</td>
</tr>
</tbody>
</table>
<h2 id="search-switch-gateway-ports">Search Switch / Gateway Ports</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/ports/search
</code></pre>
<h3 id="request_105">Request</h3>
<p>The following fields are available for searching.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>full_duplex</code></td>
<td><code>boolean</code></td>
<td>indicates full or half duplex</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>device identifier</td>
</tr>
<tr>
<td><code>device_type</code></td>
<td><code>string</code></td>
<td>device type, ap / ble / switch / gateway / mxedge / nac</td>
</tr>
<tr>
<td><code>port_usage</code></td>
<td><code>string</code></td>
<td>gateway port usage, wan / lan</td>
</tr>
<tr>
<td><code>neighbor_mac</code></td>
<td><code>string</code></td>
<td>Chassis identifier of the chassis type listed</td>
</tr>
<tr>
<td><code>neighbor_port_desc</code></td>
<td><code>string</code></td>
<td>Description supplied by the system on the interface E.g. “GigabitEthernet2/0/39”</td>
</tr>
<tr>
<td><code>neighbor_system_name</code></td>
<td><code>string</code></td>
<td>Name supplied by the system on the interface E.g. neighbor system name  E.g. “Kumar-Acc-SW.mist.local”</td>
</tr>
<tr>
<td><code>poe_disabled</code></td>
<td><code>boolean</code></td>
<td>whether PoE capabilities are disabled for a port, default is false</td>
</tr>
<tr>
<td><code>poe_mode</code></td>
<td><code>string</code></td>
<td>PoE mode depending on class. 802.3af / 802.3at / 802.3bt</td>
</tr>
<tr>
<td><code>poe_on</code></td>
<td><code>boolean</code></td>
<td>is the device attached to POE</td>
</tr>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>interface name</td>
</tr>
<tr>
<td><code>port_mac</code></td>
<td><code>string</code></td>
<td>interface mac address</td>
</tr>
<tr>
<td><code>power_draw</code></td>
<td><code>float</code></td>
<td>Amount of power being used by the interface at the time the command is executed. Unit in watts.</td>
</tr>
<tr>
<td><code>tx_pkts</code></td>
<td><code>int</code></td>
<td>Output packets</td>
</tr>
<tr>
<td><code>rx_pkts</code></td>
<td><code>int</code></td>
<td>Input packets</td>
</tr>
<tr>
<td><code>tx_bytes</code></td>
<td><code>int</code></td>
<td>Output bytes</td>
</tr>
<tr>
<td><code>rx_bytes</code></td>
<td><code>int</code></td>
<td>Input bytes</td>
</tr>
<tr>
<td><code>tx_bps</code></td>
<td><code>int</code></td>
<td>Output rate</td>
</tr>
<tr>
<td><code>rx_bps</code></td>
<td><code>int</code></td>
<td>Input rate</td>
</tr>
<tr>
<td><code>tx_errors</code></td>
<td><code>int</code></td>
<td>Output errors</td>
</tr>
<tr>
<td><code>rx_errors</code></td>
<td><code>int</code></td>
<td>Input errors</td>
</tr>
<tr>
<td><code>tx_mcast_pkts</code></td>
<td>int</td>
<td>Multicast output packets</td>
</tr>
<tr>
<td><code>tx_bcast_pkts</code></td>
<td>int</td>
<td>Broadcast output packets</td>
</tr>
<tr>
<td><code>rx_mcast_pkts</code></td>
<td>int</td>
<td>Multicast input packets</td>
</tr>
<tr>
<td><code>rx_bcast_pkts</code></td>
<td>int</td>
<td>Broadcast input packets</td>
</tr>
<tr>
<td><code>speed</code></td>
<td><code>int</code></td>
<td>port speed</td>
</tr>
<tr>
<td><code>mac_limit</code></td>
<td><code>int</code></td>
<td>Limit on number of dynamically learned macs</td>
</tr>
<tr>
<td><code>mac_count</code></td>
<td><code>int</code></td>
<td>Number of mac addresses in the forwarding table</td>
</tr>
<tr>
<td><code>up</code></td>
<td><code>boolean</code></td>
<td>indicates if interface is up</td>
</tr>
<tr>
<td><code>stp_state</code></td>
<td><code>string</code></td>
<td>if up == true, forwarding / blocking / learning / listening / disabled</td>
</tr>
<tr>
<td><code>stp_role</code></td>
<td><code>string</code></td>
<td>if up == true, designated / backup / alternate / root / root-prevented</td>
</tr>
<tr>
<td><code>xcvr_part_number</code></td>
<td><code>string</code></td>
<td>Optic Slot Partnumber, Check for null/empty</td>
</tr>
<tr>
<td><code>xcvr_serial</code></td>
<td><code>string</code></td>
<td>Optic Slot SerialNumber, Check for null/empty</td>
</tr>
<tr>
<td><code>xcvr_model</code></td>
<td><code>string</code></td>
<td>Optic Slot ModelName, Check for null/empty</td>
</tr>
<tr>
<td><code>auth_state</code></td>
<td><code>string</code></td>
<td>if up == true &amp;&amp; has Authenticator role, init / authenticated / authenticating / held</td>
</tr>
<tr>
<td><code>lte_imsi</code></td>
<td><code>string</code></td>
<td>LTE IMSI value, Check for null/empty</td>
</tr>
<tr>
<td><code>lte_iccid</code></td>
<td><code>string</code></td>
<td>LTE ICCID value, Check for null/empty</td>
</tr>
<tr>
<td><code>lte_imei</code></td>
<td><code>string</code></td>
<td>LTE IMEI value, Check for null/empty</td>
</tr>
<tr>
<td><code>active</code></td>
<td><code>boolean</code></td>
<td>Indicates if interface is active/inactive</td>
</tr>
<tr>
<td><code>jitter</code></td>
<td><code>float</code></td>
<td>Last sampled jitter of the interface</td>
</tr>
<tr>
<td><code>loss</code></td>
<td><code>float</code></td>
<td>Last sampled loss of the interface</td>
</tr>
<tr>
<td><code>latency</code></td>
<td><code>float</code></td>
<td>Last sampled latency of the interface</td>
</tr>
<tr>
<td><code>unconfigured</code></td>
<td><code>boolean</code></td>
<td>indicates if interface is unconfigured</td>
</tr>
<tr>
<td><code>disabled</code></td>
<td><code>boolean</code></td>
<td>indicates if interface is disabled</td>
</tr>
<tr>
<td><code>last_flapped</code></td>
<td><code>float</code></td>
<td>indicates when the port was last flapped</td>
</tr>
</tbody>
</table>
<p>E.g. /api/v1/sites/:site_id/stats/ports/search?mac=001122334455</p>
<h3 id="response_154">Response</h3>
<pre><code>E.g.

{
    "start": 1511967600,
    "end": 1513177200,
    "limit": 10,
    "total": 100,
    "results": [
         {
            "rx_bytes": 4563443626,
            "rx_pkts": 30360265,
            "xcvr_part_number":"740-021487",
            "xcvr_serial":"N6AA9HT",
            "xcvr_model":"SFP+-10G-SR",
            "site_id": "c1698122-c14c-11e5-8e81-1258369c38a9",
            "neighbor_system_name": "CORP-D-SW-2",
            "org_id": "c168ddee-c14c-11e5-8e81-1258369c38a9",
            "up": true,
            "port_mac": "5c4527a96580",
            "neighbor_port_desc": "GigabitEthernet1/0/21",
            "tx_pkts": 14610886,
            "mac": "5c4527a96580",
            "tx_bytes": 11299516780,
            "neighbor_mac": "64d814353400",
            "poe_disabled": true,
            "speed": 1000,
            "port_id": "me0"
        },
        {
            "rx_bps": 1176,
            "rx_bytes": 2628451,
            "rx_pkts": 11829,
            "org_id": "c168ddee-c14c-11e5-8e81-1258369c38a9",
            "full_duplex": true,
            "site_id": "c1698122-c14c-11e5-8e81-1258369c38a9",
            "up": true,
            "poe_mode": "802.3at",
            "port_mac": "0c8126c6ff6f",
            "mac": "0c8126c6ff6c",
            "tx_pkts": 492176,
            "neighbor_port_desc": "ETH0",
            "tx_bps": 14264,
            "port_id": "ge-0/0/0",
            "tx_bytes": 96810192,
            "neighbor_mac": "5c5b350eb361",
            "neighbor_system_name": "kevinsap",
            "speed": 1000,
            "poe_on": true,
            "power_draw": 5.4,
            "last_flapped": 1571174567.807,
        },
        ...
    ]
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-switch-ports">Count by Distinct Attributes of Switch Ports</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/ports/count
</code></pre>
<h3 id="request_106">Request</h3>
<p>In addition to the filters that you can have in the search</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>port_id, port_mac, full_duplex, mac, neighbor_mac, neighbor_port_desc, neighbor_system_name, poe_disabled, poe_mode, poe_on, speed, up</td>
</tr>
</tbody>
</table>
<p>NOTE: the filters from /stats/ports/search can also be used. (E.g. <code>/stats/ports/count?distinct=mac</code>)</p>
<h3 id="response_155">Response</h3>
<pre><code>{
    "start": 1511967600,
    "end": 1513177200,
    "limit": 100,
    "distinct": "mac",
    "total": 20,
    "results": [
        {
            "count": 217,
            "mac": "112233445566"
        },
        {
            "count": 35,
            "mac": "001122334455"
        },
        ...
    ]
}
</code></pre>
<h1 id="gateway-metrics">Gateway Metrics</h1>
<p>Gateway related metrics, lists scores for version compliance and config success for gateway devices in a site.</p>
<pre><code>GET /api/v1/sites/:site_id/stats/gateways/metrics
</code></pre>
<h3 id="response_156">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h3 id="body_19">Body</h3>
<pre><code>{
    "version_compliance": {
        "score": 100.0,
        "major_versions": {
            "SRX320": {

                "major_version": "19.4R2-S1.2",

                "major_count": 1
            }
        },

        "type": "gateway"
    },
    "config_success": 100.0
}
</code></pre>
<h4 id="parameters_95">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>In</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>site_id</code></td>
<td>string</td>
<td>path</td>
<td>UUID of the site</td>
</tr>
<tr>
<td><code>version_compliance</code></td>
<td>object</td>
<td>body</td>
<td>version compliance score, major versions for gateway, type</td>
</tr>
</tbody>
</table>
<p><code>config_success</code>|float|body|config success score</p>
<h2 id="search-wired-clients">Search Wired Clients</h2>
<pre><code>GET /api/v1/sites/:site_id/wired_clients/search
</code></pre>
<h3 id="request_107">Request</h3>
<p>The following fields are available for searching.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>device_mac</code></td>
<td><code>string</code></td>
<td>device mac</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>client mac</td>
</tr>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>port id</td>
</tr>
<tr>
<td><code>vlan</code></td>
<td><code>int</code></td>
<td>vlan</td>
</tr>
<tr>
<td><code>nacrule_id</code></td>
<td><code>string</code></td>
<td>nacrule_id</td>
</tr>
<tr>
<td><code>dhcp_hostname</code></td>
<td><code>string</code></td>
<td>dhcp hostname</td>
</tr>
<tr>
<td><code>dhcp_fqdn</code></td>
<td><code>string</code></td>
<td>dhcp full qualified domain name</td>
</tr>
<tr>
<td><code>dhcp_client_identifier</code></td>
<td><code>string</code></td>
<td>dhcp client identifier</td>
</tr>
<tr>
<td><code>dhcp_vendor_class_identifier</code></td>
<td><code>string</code></td>
<td>dhcp vendor class identifier</td>
</tr>
<tr>
<td><code>dhcp_request_params</code></td>
<td><code>string</code></td>
<td>dhcp request parameters</td>
</tr>
<tr>
<td><code>auth_state</code></td>
<td><code>string</code></td>
<td>authentication state</td>
</tr>
<tr>
<td><code>auth_method</code></td>
<td><code>string</code></td>
<td>authentication method</td>
</tr>
<tr>
<td><code>source</code></td>
<td><code>string</code></td>
<td>source from where the client was learned (lldp, mac)</td>
</tr>
</tbody>
</table>
<p>E.g. /api/v1/sites/:site_id/wired_clients/search?client=001122334455</p>
<h3 id="response_157">Response</h3>
<pre><code>{
    "results": [
        {
            "device_mac": [
                "001122334455"
            ],
            "org_id": "c168ddee-c14c-11e5-8e81-1258369c38a9",
            "vlan": [
                0,
                1001
            ],
            "site_id": "c168ddee-c14c-11e5-8e81-1258369c38a9",
            "mac": "112233445566",
            "timestamp": 1571174567.807,
            "port_id": [
                "et-0/0/1"
            ],
            "device_mac_port": [
              {
                "device_mac": "9c5a80414500",
                "port_id": "ge-0/0/33",
                "start": "2025-04-18T11:12:25.806+0000",
                "when": "2025-05-13T18:33:11.565+0000",
                "ip": "10.204.34.209",
                "ip6": "",
                "port_parent": "",
                "node": ""
                "source": "lldp"
              }
            ],
            "dhcp_hostname": "ITS-VMMT0-D1N02",
            "dhcp_fqdn": "ITS-VMMT0-D1N02.mgthub.local",
            "dhcp_client_identifier": "MAC address 00155df6d500",
            "dhcp_vendor_class_identifier": "MSFT 5.0",
            "dhcp_request_params": "1 3 6 15 31 33 43 44 46 47 119 121 249 252",
            "dhcp_client_options": [
                {
                    "code": "DHO_DHCP_MESSAGE_TYPE(53)", 
                    "data": "DHCPREQUEST"
                }, {
                    "code": "DHO_DHCP_CLIENT_IDENTIFIER(61)",
                    "data": "MAC address 00155df6d500",  
                }, {
                    "code": "DHO_DHCP_REQUESTED_ADDRESS(50)",
                    "data": "172.17.10.255",
                }, {
                    "code": "DHO_DHCP_SERVER_IDENTIFIER(54)",
                    "data": "172.17.8.1"
                }, {
                    "code": "DHO_DHCP_MAX_MESSAGE_SIZE(57)",
                    "data": "1280"
                }, {
                    "code": "DHO_DHCP_PARAMETER_REQUEST_LIST(55)",
                    "data": " 1 3 6 12 15 28 43 180"
                }, {
                    "code": "DHO_VENDOR_CLASS_IDENTIFIER(60)",
                    "data": "MSFT 5.0"
                }, {
                    "code": "DHO_HOST_NAME(12)",
                    "data": "ITS-VMMT0-D1N02"
                }
            ]
        }
    ],
    "start": 1538071200,
    "end": 1538074800,
    "limit": 10,
    "total": 1
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-wired-clients">Count by Distinct Attributes of Wired Clients</h2>
<pre><code>GET /api/v1/sites/:site_id/wired_clients/count
</code></pre>
<h3 id="request_108">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>port_id, vlan, mac, default is mac</td>
</tr>
</tbody>
</table>
<h3 id="response_158">Response</h3>
<pre><code>{
    "start": 1511967600,
    "end": 1513177200,
    "limit": 100,
    "distinct": "",
    "total": 20,
    "results": [
        {
            "count": 217,
            "vlan": 0
        },
        {
            "count": 35,
            "vlan": 1
        },
        ...
    ]
}
</code></pre>
<h2 id="doing-coa-against-a-wired-client">Doing CoA against a wired client</h2>
<pre><code>POST /api/v1/sites/:site_id/wired_clients/:mac/coa
</code></pre>
<h3 id="request_109">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>wired_client mac</td>
</tr>
</tbody>
</table>
<h3 id="response_159">Response</h3>
<pre><code>{
    "device_mac": "5c5b35000002",
    "port_id": "ge-0/0/0",
    "session": "0a2a11b8-4b30-40d8-a6d1-e91ea540d86f"
}
</code></pre>
<h1 id="packet-capture">Packet Capture</h1>
<h2 id="get-a-list-of-captures">Get a list of captures</h2>
<pre><code>GET /api/v1/sites/:site_id/pcaps?start=1461099816&amp;end=1461089816&amp;limit=100
</code></pre>
<h3 id="request_110">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>start</code></td>
<td><code>int</code></td>
<td>start time</td>
</tr>
<tr>
<td><code>end</code></td>
<td><code>int</code></td>
<td>end time</td>
</tr>
<tr>
<td><code>client_mac</code></td>
<td><code>string</code></td>
<td>optional client mac filter</td>
</tr>
</tbody>
</table>
<h3 id="response_160">Response</h3>
<pre><code>{
    "start": 1461099816,
    "end": 1461089816,
    "limit": 100,
    "next": "/api/v1/sites/67970e46-4e12-11e6-9188-0242ac110007/pcaps?start=1461099816&amp;search_after=%5B1694537121217%5D&amp;limit=100&amp;end=1461089816

    "results": [
        {
            "type": "new_assoc",
            "timestamp": 1461869041,
            "ap_macs": ["5c5b35000010"],
            "url": "https://..."
        },
        {
          "last_seen": 1694055531.513,
            "aps": [
                "5c5b35000010"
            ],
            "format": "stream",
            "termination_reason": "default",
            "type": "scan",
            "max_num_packets": 1024.0,
            "duration": 600.0,
            "timestamp": 1694098696.981433,
            "org_id": "00000000-0000-0000-0000-000000000000",
            "site_id": "00000000-0000-0000-0000-000000000000",
            "id": "12981770-dd35-4111-9f2f-ae54c26b3e2a",
            "pcap_url": "https://...",
            "pcap_aps": {
                "5c5b35000010": {
                    "band": "6",
                    "bandwidth": "20",
                    "channel": 133,
                    "tcpdump_expression": null
                }
            }
            "num_packets": 1024.0
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pcap_aps</code></td>
<td><code>dict</code></td>
<td>contains AP specific configuration selected by user during scan pcap.</td>
</tr>
<tr>
<td>similar to below response.</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="get-capturing-status">Get Capturing status</h2>
<pre><code>GET /api/v1/sites/:site_id/pcaps/capture
</code></pre>
<h3 id="response_161">Response</h3>
<pre><code>{
    // from the initiation of the packet capture
    "type": "radiotap",
    "max_pkt_len": 128,
    "includes_mcast": false,
    "ssid": null,
    "ap_mac": null,
    "client_mac": "60a10a773412",
    "max_num_packets": 1000,
    "num_packets" : 999,
    "duration": 300,   
    "id": "87093aed-94d6-4310-83a9-d7248c9e2d93"
    "tcpdump_expression" : "vlan and icmp"
    // what's actually being done
    "started_time": 1435080709
    "aps": ["5c5b350e001c","5c5b350e001b"],
    "ok": ["5c5b350e001c","5c5b350e001b"],"
    "failed": []
    "pcap_aps": {
        "5c5b35000010": {
            "band": "6",
            "bandwidth": "20",
            "channel": 133,
            "tcpdump_expression": null
        }
    }
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>packet capture type, for example: new_assoc, client, wired, wireless, radiotap, gateway</td>
</tr>
<tr>
<td><code>aps</code></td>
<td><code>[]string</code></td>
<td>List of target APs to capture packets</td>
</tr>
<tr>
<td><code>ok</code></td>
<td><code>[]string</code></td>
<td>List of target APs successfully configured to capture packets</td>
</tr>
<tr>
<td><code>failed</code></td>
<td><code>[]string</code></td>
<td>List of APs where configuration attempt failed</td>
</tr>
<tr>
<td><code>gateways</code></td>
<td><code>dict</code></td>
<td>Information on gateways to capture packets on if a gateway capture type is specified</td>
</tr>
<tr>
<td><code>switches</code></td>
<td><code>dict</code></td>
<td>Information on switches to capture packets on if a switch capture type is specified. <code>irb</code> port interface is automatically added to capture as needed to ensure all desired packets are captured.</td>
</tr>
<tr>
<td><code>mxedges</code></td>
<td><code>dict</code></td>
<td>Information on mxedges to capture packets on if a mxedge capture type is specified</td>
</tr>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>unique id for the capture</td>
</tr>
<tr>
<td><code>max_num_packets</code></td>
<td><code>int</code></td>
<td>max number of packets configured by user</td>
</tr>
<tr>
<td><code>num_packets</code></td>
<td><code>int</code></td>
<td>total number of packets captured by all AP, not applicable for type [client, new_assoc]</td>
</tr>
<tr>
<td><code>tcpdump_expression</code></td>
<td><code>string</code></td>
<td>tcpdump expression provided by the user (common)</td>
</tr>
<tr>
<td><code>wired_tcpdump_expression</code></td>
<td><code>string</code></td>
<td>wired_tcpdump_expression provided by the user when type = ‘wired’</td>
</tr>
<tr>
<td><code>radiotap_tcpdump_expression</code></td>
<td><code>string</code></td>
<td>radiotap_tcpdump_expression expression provided by the user when type = ‘rdiotap’</td>
</tr>
<tr>
<td><code>scan_tcpdump_expression</code></td>
<td><code>string</code></td>
<td>scan_tcpdump_expression provided by the user when type = ‘scan’</td>
</tr>
<tr>
<td><code>wireless_tcpdump_expression</code></td>
<td><code>string</code></td>
<td>wireless_tcpdump_expression provided by the user when type = ‘wireless’</td>
</tr>
<tr>
<td><code>pcap_aps</code></td>
<td><code>dict</code></td>
<td>contains AP specific configuration selected by user during scan pcap.</td>
</tr>
</tbody>
</table>
<h2 id="initiate-a-client-packet-capture">Initiate a Client Packet Capture</h2>
<pre><code>POST /api/v1/sites/:site_id/pcaps/capture
</code></pre>
<h3 id="request_111">Request</h3>
<pre><code>{
    "type": "client",
    "client_mac": "60a10a773412",
    "num_packets": 1000,
    "duration": 300,

    "max_pkt_len": 128,
    "includes_mcast": false,
    "ssid": null,
    "ap_mac": null
}
</code></pre>
<h3 id="parameters_96">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>client_mac</code></td>
<td><code>string</code></td>
<td>client mac, required if type==<code>client</code>; optional otherwise</td>
</tr>
<tr>
<td><code>num_packets</code></td>
<td><code>int</code></td>
<td>number of packets to capture, 0 for unlimited, default is 1024, maximum is 10000</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>duration of the capture, in seconds, default is 600, minimum is 60 and maximum is 86400</td>
</tr>
<tr>
<td><code>max_pkt_len</code></td>
<td><code>int</code></td>
<td>max_len of each packet to capture, default is 512, minimum is 64 and maximum is 2048</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>optional filter by ssid</td>
</tr>
<tr>
<td><code>ap_mac</code></td>
<td><code>string</code></td>
<td>optional filter by ap_mac</td>
</tr>
</tbody>
</table>
<h2 id="initiate-a-packet-capture-for-new-wireless-client-associations">Initiate a packet Capture for New Wireless Client Associations</h2>
<pre><code>POST /api/v1/sites/:site_id/pcaps/capture
</code></pre>
<h3 id="request_112">Request</h3>
<pre><code>{
    "type": "new_assoc",
    "num_packets": 100,
    "duration": 600,

    "max_pkt_len": 128,
    "includes_mcast": false,
    "ssid": null,
    "ap_mac": null,
    "client_mac": "60a10a773412"
}
</code></pre>
<h3 id="parameters_97">Parameters</h3>
<p>see above</p>
<h2 id="initiate-a-wired-packet-capture">Initiate a Wired Packet Capture</h2>
<pre><code>POST /api/v1/sites/:site_id/pcaps/capture
</code></pre>
<h3 id="request_113">Request</h3>
<pre><code>{
    "type": "wired",
    "num_packets": 100,
    "duration": 600,
    "max_pkt_len": 512,
    "tcpdump_expression": "tcp port 80",
    "ap_mac": null
}
</code></pre>
<h3 id="parameters_98">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>num_packets</code></td>
<td><code>int</code></td>
<td>number of packets to capture, 0 for unlimited, default is 1024, maximum is 10000</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>duration of the capture, in seconds, default is 600, minimum is 60 and maximum is 86400</td>
</tr>
<tr>
<td><code>max_pkt_len</code></td>
<td><code>int</code></td>
<td>max_len of each packet to capture, default is 512, minimum is 64 and maximum is 2048</td>
</tr>
<tr>
<td><code>tcpdump_expression</code></td>
<td><code>string</code></td>
<td>tcpdump expression</td>
</tr>
<tr>
<td><code>ap_mac</code></td>
<td><code>string</code></td>
<td>optional filter by ap_mac</td>
</tr>
<tr>
<td><code>format</code></td>
<td><code>string</code></td>
<td>pcap format, pcap / stream, default is pcap</td>
</tr>
</tbody>
</table>
<h2 id="initiate-a-wireless-packet-capture">Initiate a Wireless Packet Capture</h2>
<pre><code>POST /api/v1/sites/:site_id/pcaps/capture
</code></pre>
<h3 id="request_114">Request</h3>
<pre><code>{
    "type": "wireless",
    "num_packets": 100,
    "duration": 600,
    "max_pkt_len": 512,
    "ap_mac": null,
    "band": "24"
}
</code></pre>
<h3 id="parameters_99">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>num_packets</code></td>
<td><code>int</code></td>
<td>number of packets to capture, 0 for unlimited, default is 1024, maximum is 10000</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>duration of the capture, in seconds, default is 600, minimum is 60 and maximum is 86400</td>
</tr>
<tr>
<td><code>max_pkt_len</code></td>
<td><code>int</code></td>
<td>max_len of each packet to capture, default is 512, minimum is 64 and maximum is 2048</td>
</tr>
<tr>
<td><code>ap_mac</code></td>
<td><code>string</code></td>
<td>optional filter by ap_mac</td>
</tr>
<tr>
<td><code>format</code></td>
<td><code>string</code></td>
<td>pcap format, pcap / stream, default is pcap</td>
</tr>
<tr>
<td><code>wlan_id</code></td>
<td><code>string</code></td>
<td>WLAN ID</td>
</tr>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>24 / 5 / 6, default is 24</td>
</tr>
</tbody>
</table>
<h2 id="initiate-a-radiotap-packet-capture">Initiate a Radiotap Packet Capture</h2>
<pre><code>POST /api/v1/sites/:site_id/pcaps/capture
</code></pre>
<h3 id="request_115">Request</h3>
<pre><code>{
    "type": "radiotap",
    "num_packets": 100,
    "duration": 600,
    "max_pkt_len": 512,
    "ap_mac": null,
    "band": "24",
    "format": "stream"
    "tcpdump_expression": "tcp port 80",
    "ssid": "atest"
    "wlan_id": "fac8e973-feb9-421a-b381-aabbc4b61f5a"
    "client_mac": "38f9d3972ff1"
}
</code></pre>
<h3 id="parameters_100">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>num_packets</code></td>
<td><code>int</code></td>
<td>number of packets to capture, 0 for unlimited, default is 1024, maximum is 10000</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>duration of the capture, in seconds, default is 600, minimum is 60 and maximum is 86400</td>
</tr>
<tr>
<td><code>max_pkt_len</code></td>
<td><code>int</code></td>
<td>max_len of each packet to capture, default is 512, minimum is 64 and maximum is 2048</td>
</tr>
<tr>
<td><code>ap_mac</code></td>
<td><code>string</code></td>
<td>optional filter by ap_mac</td>
</tr>
<tr>
<td><code>format</code></td>
<td><code>string</code></td>
<td>pcap format, pcap / stream, default is pcap</td>
</tr>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>24,5,6 / 24 / 5 / 6, default is 24</td>
</tr>
<tr>
<td><code>tcpdump_expression</code></td>
<td><code>string</code></td>
<td>tcpdump expression specific to radiotap</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>optional filter by ssid</td>
</tr>
<tr>
<td><code>wlan_id</code></td>
<td><code>string</code></td>
<td>wlan id associated with the respective ssid.</td>
</tr>
<tr>
<td><code>client_mac</code></td>
<td><code>string</code></td>
<td>optional filter by client mac</td>
</tr>
</tbody>
</table>
<h2 id="initiate-a-scan-radio-packet-capture">Initiate a scan radio Packet Capture</h2>
<pre><code>POST /api/v1/sites/:site_id/pcaps/capture
</code></pre>
<h3 id="request_116">Request</h3>
<pre><code>{
    "type": "scan",
    "num_packets": 100,
    "duration": 600,
    "max_pkt_len": 512,
    "ap_mac": null,
    "band": "24", 
    "format": "stream"
    "tcpdump_expression": "tcp port 80",
    "client_mac": "38f9d3972ff1",
    "band": "24",     // 24  / 5 (default) / 6
    "bandwidth": 20,  // 20 (default) / 40
    "channel": 1,     // 1 (default), if band == 5 then default value of channel is 7.

    // optional, if specified, `ap_mac` is ignored and only specified APs will be used. If not specified, all APs in the site will be used
    "aps": {
          "5c5b35000001": {
                 // all optional, if not specified, parent one will be used
                 "channel": 7,
                 "band": "5",
                 "bandwidth": 20,
                 "tcpdump_expression": "..."
          },
         ...
    }    
}
</code></pre>
<h3 id="parameters_101">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>num_packets</code></td>
<td><code>int</code></td>
<td>number of packets to capture, 0 for unlimited, default is 1024, maximum is 10000</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>duration of the capture, in seconds, default is 600, minimum is 60 and maximum is 86400</td>
</tr>
<tr>
<td><code>max_pkt_len</code></td>
<td><code>int</code></td>
<td>max_len of each packet to capture, default is 512, minimum is 64 and maximum is 2048</td>
</tr>
<tr>
<td><code>ap_mac</code></td>
<td><code>string</code></td>
<td>optional filter by ap_mac</td>
</tr>
<tr>
<td><code>format</code></td>
<td><code>string</code></td>
<td>pcap format, pcap / stream, default is pcap</td>
</tr>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>24 / 5 / 6, default is 5 (for scan) and 24 (for other). Only Single value allowed, default value gets applied when user provides wrong values</td>
</tr>
<tr>
<td><code>tcpdump_expression</code></td>
<td><code>string</code></td>
<td>tcpdump expression specific to radiotap</td>
</tr>
<tr>
<td><code>client_mac</code></td>
<td><code>string</code></td>
<td>optional filter by client mac</td>
</tr>
<tr>
<td><code>channel</code></td>
<td><code>int</code></td>
<td>specify the channel value where scan PCAP has to be started, default value gets applied when user provides wrong values</td>
</tr>
<tr>
<td><code>bandwidth</code></td>
<td><code>int</code></td>
<td>channel width for the band, 20 / 40 / 80 / 160, 80 is only applicable for band_5 and 160 is only for band_6, defaults to ‘20’ when user provides wrong values</td>
</tr>
<tr>
<td><code>aps</code></td>
<td><code>dict</code></td>
<td>dictionary key is AP mac and value is a dictionary which contains key “band”, “bandwidth”, “channel” and “tcpdump_expression”. In case keys are missed we will take parent value if parent values are not set we will use default value.</td>
</tr>
</tbody>
</table>
<h2 id="initiate-a-radiotap-packet-capture-and-wired-packet-capture">Initiate a Radiotap Packet Capture and Wired Packet Capture</h2>
<pre><code>POST /api/v1/sites/:site_id/pcaps/capture
</code></pre>
<h3 id="request_117">Request</h3>
<pre><code>{
    "type": "radiotap,wired",
    "num_packets": 100,
    "duration": 600,
    "max_pkt_len": 512,
    "tcpdump_expression":&lt;common&gt;,
    "wired_tcpdump_expression": "tcp port 80",
    "radiotap_tcpdump_expression": "type data",
    "wireless_tcpdump_expression": ""
    "ap_mac": null,
    "format": "stream",
    "band": "24",
    "ssid": "atest"
    "wlan_id": "fac8e973-feb9-421a-b381-aabbc4b61f5a"
    "client_mac": "38f9d3972ff1"
}
</code></pre>
<h3 id="parameters_102">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>packet capture type, currently supported value is radiotap,wired.</td>
</tr>
<tr>
<td><code>num_packets</code></td>
<td><code>int</code></td>
<td>number of packets to capture, 0 for unlimited, default is 1024, maximum is 10000</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>duration of the capture, in seconds, default is 600, minimum is 60 and maximum is 86400</td>
</tr>
<tr>
<td><code>max_pkt_len</code></td>
<td><code>int</code></td>
<td>max_len of each packet to capture, default is 512, minimum is 64 and maximum is 2048</td>
</tr>
<tr>
<td><code>tcpdump_expression</code></td>
<td><code>string</code></td>
<td>tcpdump expression common for wired,radiotap</td>
</tr>
<tr>
<td><code>wired_tcpdump_expression</code></td>
<td><code>string</code></td>
<td>tcpdump expression for wired interface</td>
</tr>
<tr>
<td><code>wireless_tcpdump_expression</code></td>
<td><code>string</code></td>
<td>tcpdump expression for wireless interface (802.11)</td>
</tr>
<tr>
<td><code>radiotap_tcpdump_expression</code></td>
<td><code>string</code></td>
<td>tcpdump expression for radiotap interface (802.11 + radio headers)</td>
</tr>
<tr>
<td><code>ap_mac</code></td>
<td><code>string</code></td>
<td>optional filter by ap_mac</td>
</tr>
<tr>
<td><code>format</code></td>
<td><code>string</code></td>
<td>pcap format, pcap / stream, default is pcap</td>
</tr>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>24,5,6 / 24 / 5 / 6, default is 24, config used only for radiotap</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>optional filter by ssid</td>
</tr>
<tr>
<td><code>wlan_id</code></td>
<td><code>string</code></td>
<td>wlan ID associated with the respective ssid, only used for configuring radiotap</td>
</tr>
<tr>
<td><code>client_mac</code></td>
<td><code>string</code></td>
<td>optional filter by client mac, only used for configuring radiotap</td>
</tr>
</tbody>
</table>
<h2 id="initiate-a-gateway-ssrsrx-packet-capture">Initiate a gateway (SSR/SRX) Packet Capture</h2>
<pre><code>POST /api/v1/sites/:site_id/pcaps/capture
</code></pre>
<h3 id="request_118">Request</h3>
<pre><code>{
    "type": "gateway",
    "num_packets": 100,
    "duration": 600,
    "max_pkt_len": 1500,
    "gateways": {
        "001122334455": {
            "ports": {"ge-0/0/0": {"tcpdump_expression": "tcp"},
                      "ge-0/0/1": {"tcpdump_expression": "port 443"},
                      "ge-1/0/0": {"tcpdump_expression": "tcp"},
                      "ge-1/0/1": {"tcpdump_expression": "port 443"}}
        },
        "001122334466": {
            "ports": {"ge-0/0/0": {"tcpdump_expression": "udp"},
                      "ge-0/0/1": {"tcpdump_expression": "port 32768"}}
        },
    },
    "format": "stream"
}
</code></pre>
<h3 id="parameters_103">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>num_packets</code></td>
<td><code>int</code></td>
<td>number of packets to capture, 0 for unlimited, default is 1024, maximum is 10000</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>duration of the capture, in seconds, default is 600, minimum is 60 and maximum is 86400 (24h)</td>
</tr>
<tr>
<td><code>max_pkt_len</code></td>
<td><code>int</code></td>
<td>max_len of each packet to capture in bytes, default is 512, minimum is 64 (SSR) / 68 (SRX) maximum is 10240 (SSR) / 1520 (SRX).</td>
</tr>
<tr>
<td><code>gateways</code></td>
<td><code>dict</code></td>
<td>dict of gateways which uses mac as the key</td>
</tr>
<tr>
<td><code>ports</code></td>
<td><code>list</code></td>
<td>dict of port which uses port id as the key</td>
</tr>
<tr>
<td><code>tcpdump_expression</code></td>
<td><code>string</code></td>
<td>tcpdump expression per port</td>
</tr>
<tr>
<td><code>format</code></td>
<td><code>string</code></td>
<td>pcap format: stream (default, the only supported option)</td>
</tr>
</tbody>
</table>
<h2 id="initiate-a-switch-junos-packet-capture">Initiate a switch (Junos) Packet Capture</h2>
<pre><code>POST /api/v1/sites/:site_id/pcaps/capture
</code></pre>
<h3 id="request_119">Request</h3>
<pre><code>{
    "type": "switch",
    "num_packets": 100,
    "duration": 600,
    "max_pkt_len": 1500,
    "switches": {
        "001122334455": {            
            "ports": {"irb": {"tcpdump_expression": "udp"}, // irb port auto-included (with no tcpdump filter) if not provided in request
                      "ge-0/0/1": {},
                      "ge-1/0/0": null}
                      // 6 ports max per switch supported, or 5 max with irb port auto-included into capture request
        },
        "001122334466": {
            "ports": {"ge-0/0/0": {}}
        },
    },
    "tcpdump_expression": "port 443",
    "format": "stream"
}
</code></pre>
<h3 id="parameters_104">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>num_packets</code></td>
<td><code>int</code></td>
<td>number of packets to capture, 0 for unlimited, default is 1024, maximum is 10000</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>duration of the capture, in seconds, default is 600, minimum is 60 and maximum is 10800</td>
</tr>
<tr>
<td><code>max_pkt_len</code></td>
<td><code>int</code></td>
<td>max_len of each packet to capture, default is 512, minimum is 64 and maximum is 2048</td>
</tr>
<tr>
<td><code>switches</code></td>
<td><code>dict</code></td>
<td>dict of switches which uses mac as the key</td>
</tr>
<tr>
<td><code>ports</code></td>
<td><code>dict</code></td>
<td>dict of port which uses port id as the key; 6 ports max per switch supported, or 5 max with <code>irb</code> port auto-included into capture request</td>
</tr>
<tr>
<td><code>tcpdump_expression</code></td>
<td><code>string</code></td>
<td>tcpdump expression, port specific if specified under ports dict, otherwise applicable across ports if specified at top level of payload. Port specific value overrides top level value when both exist.</td>
</tr>
<tr>
<td><code>format</code></td>
<td><code>string</code></td>
<td>pcap format: stream (default, the only supported option)</td>
</tr>
</tbody>
</table>
<h2 id="initiate-a-mist-edge-packet-capture">Initiate a Mist Edge Packet Capture</h2>
<pre><code>POST /api/v1/sites/:site_id/pcaps/capture
</code></pre>
<h3 id="request_120">Request</h3>
<pre><code>{
    "type": "mxedge",
    "num_packets": 100,
    "duration": 600,
    "max_pkt_len": 1500,
    "mxedges": {
        "00000000-0000-0000-1000-001122334455": {
            "interfaces": {"port1": {"tcpdump_expression": "udp port 67 or udp port 68"},
                      }
        },
    },
    "tcpdump_expression": "vlan 999",
    "format": "tzsp",
    "tzsp_host": "192.168.1.2",
    "tzsp_port": 37008
}
</code></pre>
<h3 id="parameters_105">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>num_packets</code></td>
<td><code>int</code></td>
<td>number of packets to capture, default is 1024, maximum of 10000</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>duration of the capture, in seconds, default is 600, maximum is 10800</td>
</tr>
<tr>
<td><code>max_pkt_len</code></td>
<td><code>int</code></td>
<td>max_len of each packet to capture, default is 512, maximum is 2048</td>
</tr>
<tr>
<td><code>mxedges</code></td>
<td><code>dict</code></td>
<td>dict of mxedges which uses mxedge_id as the key, currently limited to one mxedge per site capture session</td>
</tr>
<tr>
<td><code>interfaces</code></td>
<td><code>dict</code></td>
<td>dict of interfaces to capture for, for given mxedge (examples: port1, kni0, lacp0, ipsec, drop, oobm), currently limited to specifying one interface per mxedge</td>
</tr>
<tr>
<td><code>tcpdump_expression</code></td>
<td><code>string</code></td>
<td>tcpdump expression, interface specific if specified under interfaces dict, otherwise applicable across interfaces if specified at top level of payload. Interface specific value overrides top level value when both exist.</td>
</tr>
<tr>
<td><code>format</code></td>
<td><code>string</code></td>
<td>pcap format: <code>stream</code> (default, to Mist cloud), <code>tzsp</code> (stream packets (over UDP as TZSP packets) to a remote host (typically running Wireshark) instead of Mist cloud)</td>
</tr>
<tr>
<td><code>tzsp_host</code></td>
<td><code>string</code></td>
<td>remote host accessible to mxedges over the network for receiving the captured packets. Required when <code>format</code> is <code>tzsp</code>.</td>
</tr>
<tr>
<td><code>tzsp_port</code></td>
<td><code>int</code></td>
<td>optional port on remote host for receiving the captured packets, default (if not provided) 37008 (TZSP).</td>
</tr>
</tbody>
</table>
<h2 id="stop-current-capture">Stop current capture</h2>
<pre><code>DELETE /api/v1/sites/:site_id/pcaps/capture
</code></pre>
<h3 id="update-or-add-notes-to-a-completed-packet-capture">Update or add notes to a completed packet capture</h3>
<pre><code>PUT /api/v1/sites/:site_id/pcaps/:pcap_id
</code></pre>
<h3 id="example_15">Example</h3>
<pre><code>    {
         "notes": "wired pcap test", //Empty allowed
    }
</code></pre>
<h1 id="rrm">RRM</h1>
<p>The main design goals of RRM are</p>
<ul>
<li>there are hundreds of APs and individual configs (i.e. overrides) per AP should be minimized</li>
<li>AP always needs a channel - if they’re not specified, it’s AUTO / RRM</li>
</ul>
<h4 id="from-site-setting">From Site Setting</h4>
<ul>
<li>It specifies how RRM is performed, not if</li>
<li>you can disable 2.4G for the site, the <code>disabled</code> per band governs this</li>
<li>you can pick selected channels (e.g. for this site, only channel 48, 52 should be used) that RRM should use,
  otherwise, we/Mist will determine it. <code>channels</code> governs this</li>
<li>you can fix the power (e.g. for this site, do 11dBm) or 0 for auto</li>
<li>bandwidth is required user setting, no auto is allowed (for now, we need to have at least some constraints, otherwise,
  the algorithm gets complicated and verification becomes difficult)</li>
</ul>
<h4 id="from-ap-settings">From AP Settings</h4>
<ul>
<li>AP can decide to use site settings or to override it</li>
<li>when AP overrides it, this AP will use its own settings, which completely shadows the site setting.</li>
</ul>
<p>Each AP derives their radio config from <a href="https://api.mist.com/api/v1/docs/Site#site-setting">Site Settings</a> if there’s no <a href="https://api.mist.com/api/v1/docs/Site#device">overwrite</a> on a
band.</p>
<h2 id="get-current-channel-planning">Get Current Channel Planning</h2>
<pre><code>GET /api/v1/sites/:site_id/rrm/current
</code></pre>
<h3 id="response_162">Response</h3>
<pre><code>Status: 200 OK

{
    "status": "ready",
    "timestamp": 1428949501,
    "band_24": {
        "00000000-0000-0000-1000-5c5b350e0024": {
            "curr_channel": 6,
            "curr_power": 18,
            "curr_bandwidht": 20,
            "curr_usage": "24"
            "channel": 1,
            "power": 19,
            "bandwidth": 20,
            "usage": "24"
        },
        ...
    },
    "band_5": {
        ...
    },
    "band_6": {
        ...
    },
    "band_24_metric": {
        "noise": -82.7,
        "cochannel_neighbors": 1.0,
        "neighbors": 3.0,
        "density": 1.0
    },
    "band_5_metric": {
        "noise": -82.7,
        "cochannel_neighbors": 1.0,
        "neighbors": 3.0,
        "density": 1.0,
        "interferences": {
            "149": {
                "radar": 0.3
            },
            "153": {
                "radar": 0.2
            },
        }
    },
    "band_6_metric": {
        ...
    },
    "rftemplate": {
        "id": "bb8a9017-1e36-5d6c-6f2b-551abe8a76a2",
        "name": "5G-Restricted",
        "country_code": "US",
        "band_24_usage": "24",
        "band_24": {
            "disabled": false,
            "channels": [ 1, 6, 11 ],
            "bandwidth": 20,
            "power": 16
        },
        "band_5": {
            "disabled": false,
            "channels": null,
            "bandwidth": 40,
            "power": 0
        },
        "band_6": {
            "disabled": false,
            "channels": null,
            "bandwidth": 65,
            "power": 0
        }
    }
}
</code></pre>
<h3 id="definitions_8">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>status</code></td>
<td><code>string</code></td>
<td>unknown / updating / ready</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>long</code></td>
<td>time where the status was updated</td>
</tr>
<tr>
<td><code>band_24</code></td>
<td><code>object</code></td>
<td>proposal on band 2.4G, key is ap_id, value is the proposal</td>
</tr>
<tr>
<td><code>band_5</code></td>
<td><code>object</code></td>
<td>proposal on band 5G, key is ap_id, value is the proposal</td>
</tr>
<tr>
<td><code>band_6</code></td>
<td><code>object</code></td>
<td>proposal on band 6G, key is ap_id, value is the proposal</td>
</tr>
<tr>
<td><code>curr_channel</code></td>
<td><code>int</code></td>
<td>current channel</td>
</tr>
<tr>
<td><code>curr_power</code></td>
<td><code>int</code></td>
<td>current tx power</td>
</tr>
<tr>
<td><code>curr_bandwidth</code></td>
<td><code>int</code></td>
<td>current  bandwidth</td>
</tr>
<tr>
<td><code>channel</code></td>
<td><code>int</code></td>
<td>proposed channel</td>
</tr>
<tr>
<td><code>power</code></td>
<td><code>int</code></td>
<td>proposed tx power</td>
</tr>
<tr>
<td><code>bandwidth</code></td>
<td><code>int</code></td>
<td>proposed bandwidth</td>
</tr>
<tr>
<td><code>band_24_metric</code></td>
<td><code>object</code></td>
<td>metric about 2.4G</td>
</tr>
<tr>
<td><code>band_5_metric</code></td>
<td><code>object</code></td>
<td>metric about 5G</td>
</tr>
<tr>
<td><code>band_6_metric</code></td>
<td><code>object</code></td>
<td>metric about 6G</td>
</tr>
<tr>
<td><code>noise</code></td>
<td><code>float</code></td>
<td>average noise in dBm</td>
</tr>
<tr>
<td><code>cochannel_neighbors</code></td>
<td><code>float</code></td>
<td>average number of co-channel neighbors</td>
</tr>
<tr>
<td><code>neighbors</code></td>
<td><code>float</code></td>
<td>average number of neighbors</td>
</tr>
<tr>
<td><code>density</code></td>
<td><code>float</code></td>
<td>defined by how APs can hear from one and another, 0 - 1 (everyone can hear everyone)</td>
</tr>
<tr>
<td><code>rftemplate</code></td>
<td><code>object</code></td>
<td>RF Template if used if it uses RFTemplate from Org</td>
</tr>
</tbody>
</table>
<h2 id="trigger-synthetic-testing">Trigger Synthetic Testing</h2>
<pre><code>POST /api/v1/sites/:site_id/synthetic_test
</code></pre>
<h3 id="request_121">Request</h3>
<pre><code>{
    "email": "john@abc.com"
}
</code></pre>
<h3 id="response_163">Response</h3>
<pre><code>{
    "id": "68b329da-9893-e340-99c7-d8ad5cb9c940",
    "email": "john@abc.com"
}
</code></pre>
<h2 id="get-synthetic-testing-status">Get Synthetic Testing Status</h2>
<pre><code>GET /api/v1/sites/:site_id/synthetic_test
</code></pre>
<h3 id="response_164">Response</h3>
<pre><code>{
    "id": "68b329da-9893-e340-99c7-d8ad5cb9c940",

    // TBD extra information populated
    "start_time": 1675718807,
    "end_time": 1675718873,
    "status": "ready"
    "report_url": TBD 
}
</code></pre>
<h2 id="get-synthetic-testing-result">Get Synthetic Testing Result</h2>
<pre><code>GET /api/v1/sites/:site_id/synthetic_test/search
</code></pre>
<h3 id="request_122">Request</h3>
<p>The following fields are available for searching.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>device identifier</td>
</tr>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>port_id used to run the test (for SSR only)</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>synthetic test type</td>
</tr>
<tr>
<td><code>vlan_id</code></td>
<td><code>int</code></td>
<td>Vlan ID</td>
</tr>
<tr>
<td><code>by</code></td>
<td><code>string</code></td>
<td>entity who triggers the test</td>
</tr>
<tr>
<td><code>reason</code></td>
<td><code>string</code></td>
<td>(optional) test failure reason</td>
</tr>
<tr>
<td><code>tenant</code></td>
<td><code>string</code></td>
<td>(optional) tenant network in which lan_connectivity test was run</td>
</tr>
<tr>
<td><code>protocol</code></td>
<td><code>string</code></td>
<td>(optional) lan_connectivity protocol (ping / traceroute)</td>
</tr>
</tbody>
</table>
<h3 id="response_165">Response</h3>
<pre><code>{
    "results": [
        {
            "timestamp": 1706824045.059036,
            "type": "speedtest",
            "failed": false,
            "port_id": "ge-0/0/2",
            "vlan_id": 20,
            "latency": 40,
            "rx_mbps": 322,
            "tx_mbps": 199,
            "device_type": "gateway",
            "mac": "001122334455"
            "by": "user"
        },
        {
            "timestamp": 1706824045.059036,
            "type": "speedtest",
            "failed": true,
            "port_id": "ge-0/0/2",
            "vlan_id": 100,
            "latency": 0,
            "rx_mbps": 0,
            "tx_mbps": 0,
            "reason": "interface not ready to perform test",
            "device_type": "gateway",
            "mac": "001122334455",
            "by": "marvis"
        }
    ]
}
</code></pre>
<h2 id="get-current-rrm-considerations-for-an-ap-on-a-specific-band">Get Current RRM Considerations for an AP on a Specific Band</h2>
<pre><code>GET /api/v1/sites/:site_id/rrm/current/devices/:device_id/band/:band
</code></pre>
<h3 id="parameters_106">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>24 / 5 / 6</td>
</tr>
</tbody>
</table>
<h3 id="response_166">Response</h3>
<pre><code>{
    "results": [
        {
            "channel": 36,
            "noise": -78,
            "non_wifi": 0.08,
            "wifi": 0.13

            // omitted if there's no near-by APs in the same site
            "rssi": -48,

            // omitted if there's no near-by APs
            "other_rssi": -66,
            "other_ssid": "Rivendell5G",

            "util_score": 0.1,           // total utilization (in a score format that's currently relevant / comparable against other channels) 
            "util_score_other": 0.05,    // utilizatyion contributed by other SSIDs served
            "util_score_non_wifi": 0.01, // utilization contributed by non-wifi
        }
    ]
}
</code></pre>
<h3 id="definition_8">Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>channel</code></td>
<td><code>int</code></td>
<td>channel</td>
</tr>
<tr>
<td><code>noise</code></td>
<td><code>float</code></td>
<td>noise floor</td>
</tr>
<tr>
<td><code>non_wifi</code></td>
<td><code>float</code></td>
<td>non-wifi RF utilization</td>
</tr>
<tr>
<td><code>wifi</code></td>
<td><code>float</code></td>
<td>WIFI RF utilization</td>
</tr>
<tr>
<td><code>rssi</code></td>
<td><code>int</code></td>
<td>the avg RSSI heard from neighbor APs (that belongs to the same site)</td>
</tr>
<tr>
<td><code>other_rssi</code></td>
<td><code>int</code></td>
<td>the avg RSSI heard from other APs (that does NOT belongs to the same site)</td>
</tr>
<tr>
<td><code>max_other_ssid</code></td>
<td><code>string</code></td>
<td>SSID from other AP that we heard from with the max RSSI</td>
</tr>
<tr>
<td><code>util_score</code></td>
<td><code>float</code></td>
<td>utilization score, 0-1, lower means less utilization (cleaner RF)</td>
</tr>
<tr>
<td><code>insite_channel_weight</code></td>
<td><code>float</code></td>
<td>channel weight score, 0-1, lower means less utilization (cleaner RF)</td>
</tr>
</tbody>
</table>
<h2 id="get-current-neighbors-aps">Get current neighbors APs</h2>
<pre><code>GET /api/v1/sites/:site_id/rrm/neighbors/band/:band?limit=100&amp;page=1
</code></pre>
<h3 id="parameters_107">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>24 / 5 / 6</td>
</tr>
<tr>
<td><code>limit</code></td>
<td><code>int</code></td>
<td>page size, 1-100, default is 100</td>
</tr>
</tbody>
</table>
<h3 id="response_167">Response</h3>
<pre><code>{
    "band": 6,

    "limit": 100,
    "page": 1,
    "total": 360,

    "results": [
        {
            "mac": "5c5b35000001",
            "neighbors": [
                {
                    "mac": "5c5b35000311",
                    "rssi": -66,
                },
                ...                
            ]
        },
        ...
    ]
}
</code></pre>
<h2 id="optimize">Optimize</h2>
<pre><code>POST /api/v1/sites/:site_id/rrm/optimize
</code></pre>
<h3 id="parameters_108">Parameters</h3>
<pre><code>{
    "bands": [ "24", "5", "6" ],
    "macs": [ "5c5b35000001" ],  // targeting AP (neighbor APs may get changed, too), default is empty for ALL APs
    "txpower_only": true  // only changng TX Power (will not disconnect clients), default is false
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>bands</code></td>
<td><code>list</code></td>
<td>list of bands</td>
</tr>
</tbody>
</table>
<h2 id="reset-all-aps-in-the-site-to-use-rrm">Reset all APs in the Site to use RRM</h2>
<pre><code>POST /api/v1/sites/:site_id/devices/reset_radio_config
</code></pre>
<h3 id="request_123">Request</h3>
<pre><code>{
    "bands": [ "24", "5", "6" ],
    "force": false
}
</code></pre>
<h2 id="parameters_109">Parameters</h2>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>bands</code></td>
<td><code>list</code></td>
<td>list of bands</td>
</tr>
<tr>
<td><code>force</code></td>
<td><code>boolean</code></td>
<td>whether to reset those with radio <code>disabled</code>. default is false (i.e. if user intentionally disables a radio, honor it)</td>
</tr>
</tbody>
</table>
<h2 id="get-rrm-events">Get RRM Events</h2>
<pre><code>GET /api/v1/sites/:site_id/rrm/events?band=24&amp;limit=100&amp;duration=1d
</code></pre>
<h3 id="parameters_110">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>24 / 5 / 6, required</td>
</tr>
</tbody>
</table>
<h3 id="response_168">Response</h3>
<pre><code>{
    "start": 1428939600,
    "end":   1428954000,
    "limit": 100,
    "results": [
        {
            "timestamp": 1428939600,

            // for periodical
            "event": "scheduled-site-rrm",

            // for user-triggered
            "event": "triggered-site-rrm",

            // for interference-induced
            "event": "interference-ap-co-channel",

            // for non-wifi-interference-induced
            "event": "interference-ap-non-wifi",

            // for radar-triggered
            "event": "radar-detected",

            // for ap-outage
            "event": "neighbor-ap-down",
            "event": "neighbor-ap-recovered",

            "ap_id": 00000000-0000-0000-1000-5c5b359e4fe0",
            "band": "24",
            "usage": "24",
            "channel": 6,
            "bandwidth": 20,
            "power": 5,
            "pre_usage": "24",
            "pre_channel": 1,
            "pre_power": 11,
            "pre_bandwidth": 20
        }
    ]
    "next": "/api/v1/sites/dca0a44b-324c-11e6-a776-0243ad110007/events/rrm?start=1428939600&amp;end=1428949600&amp;limit=200&amp;token=001a0010000000120010000005005880ec18000004776c616e007fffffeb067ab8e29c1d659b6a7c8cf698bf81490003"
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>timestamp</code></td>
<td><code>string</code></td>
<td>timestamp of the event</td>
</tr>
<tr>
<td><code>event</code></td>
<td><code>string</code></td>
<td>schedule-site-rrm / triggered-site-rrm / interference-ap-co-channel / rrm-radar</td>
</tr>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>for 2.4G or 5G or 6G</td>
</tr>
<tr>
<td><code>ap_id</code></td>
<td><code>string</code></td>
<td>ap id</td>
</tr>
<tr>
<td><code>channel</code></td>
<td><code>string</code></td>
<td>channel for the band from rrm</td>
</tr>
<tr>
<td><code>bandwidth</code></td>
<td><code>string</code></td>
<td>channel width for the band 20/40/80/160. 160 is 6G only.</td>
</tr>
<tr>
<td><code>power</code></td>
<td><code>string</code></td>
<td>tx power of the radio</td>
</tr>
<tr>
<td><code>pre_channel</code></td>
<td><code>string</code></td>
<td>(previously) channel for the band, 0 means no previously available</td>
</tr>
<tr>
<td><code>pre_bandwidth</code></td>
<td><code>string</code></td>
<td>(previously) channel width for the band 20/40/80/160, 0 means no previously available</td>
</tr>
<tr>
<td><code>pre_power</code></td>
<td><code>string</code></td>
<td>(previously) tx power of the radio, 0 means no previously available</td>
</tr>
<tr>
<td><code>next</code></td>
<td><code>string</code></td>
<td>the link to query next set of results. value is <code>null</code> if no next page exists.</td>
</tr>
</tbody>
</table>
<h2 id="roaming-events-data">Roaming Events data</h2>
<pre><code>GET /api/v1/sites/:site_id/events/fast_roam?type=success&amp;start=1500940800&amp;end=1501023379&amp;limit=2
</code></pre>
<h3 id="parameters_111">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>success / fail / none</td>
</tr>
</tbody>
</table>
<p>Start and end will provide granular data within the given day, going back to a year. Note: Date passed will not be
honored.</p>
<h3 id="response_169">Response</h3>
<pre><code>{
    "start": 1500940800,
    "next": "/api/v1/sites/dca0a44b-324c-11e6-a776-0243ad110007/events/fast_roam?type=success&amp;start=1428939600&amp;end=1428949600&amp;limit=200&amp;token=AAAAEgAIAAVVJh4hF8AAAARzc2lkAH%2F%2F%2F%2F0%3D",
    "end": 1501023379,
    "limit": 2,
    "results": [
        {
            "latency": 0.1874195,
            "ssid": "marvis_test",
            "subtype": "CLIENT_AUTHENTICATED_11R",
            "timestamp": 1501000002283782,
            "ap_mac": "5c5b350e040b",
            "fromap": "5c5b350e0569",
            "client_mac": "dc2b2a3fb13d"
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>timestamp</code></td>
<td><code>string</code></td>
<td>timestamp of the event in nsec</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>success / fail / none / poor/ pingpong / slow</td>
</tr>
<tr>
<td><code>next</code></td>
<td><code>string</code></td>
<td>the link to query next set of results. value is <code>null</code> if no next page exists.</td>
</tr>
</tbody>
</table>
<p>Note:</p>
<ul>
<li><code>success</code>: List of successful 11R events.</li>
<li><code>fail</code>: List of failed 11R events.</li>
<li><code>none</code>: List of roams where Clients that are capable of doing fast roam did a slow roam on a SSID where fast roam is
  enabled.</li>
<li><code>slow</code>: List of roams on a SSID where there is no fast roaming enabled.</li>
</ul>
<h1 id="const">Const</h1>
<h2 id="get-languages">Get Languages</h2>
<pre><code>GET /api/v1/const/languages
</code></pre>
<h3 id="response_170">Response</h3>
<pre><code>[
    {
        "key": "en-US",
        "display": "English (US)",
        "display_native": "English (US)"
    },
    {
        "key": "zh-TW",
        "display": "Chinese Traditional (Taiwan)",
        "display_native": "中文（台灣）"
    }
]
</code></pre>
<h2 id="get-licence-types">Get Licence Types</h2>
<pre><code>GET /api/v1/const/license_types
</code></pre>
<h3 id="response_171">Response</h3>
<pre><code>[
    {
        "key": "sub_eng",
        "type": "SUB-ENG",
        "description": "vBLE Engagement"
    },
    {
        "key": "sub_ex12",
        "type": "SUB-EX12",
        "description": "Wired Assurance 12"
    },
    {
        "key": "sub_ex12a",
        "type": "SUB-EX12A",
        "description": "Wired Assurance 12 Advanced",
        "entitled_licenses": ["sub_ex12", "sub_sadv1"]
    },
    {
        "key": "sub_sadv1",
        "type": "SUB-SADV1",
        "description": "Advanced Add-on for Wired Assurance 12"
    },
    ...
]
</code></pre>
<h2 id="get-applications">Get Applications</h2>
<p>Get a list of applications that we recognize</p>
<pre><code>GET /api/v1/const/applications
</code></pre>
<h3 id="response_172">Response</h3>
<pre><code>[
    {
        "key": "dropbox",
        "name": "Dropbox",
        "group": "File Sharing",
        "app_probe": true,  // whether it can be used for app_probing for SRX
        "app_id": true  // whether it can be used as an app in Service for gateways
    },
    ...
]
</code></pre>
<h2 id="get-all-gateway-applications">Get All Gateway Applications</h2>
<p>Get the full list of applications that we recognize</p>
<pre><code>GET /api/v1/const/gateway_applications
</code></pre>
<h3 id="response_173">Response</h3>
<pre><code>[
    {
        "key": "4shared",
        "name": "4shared",
        "ssr_app_id": true,  // whether this can be identified by SSR
        "app_id": true  // whether this can be identified by SRX
    }
]
</code></pre>
<h2 id="get-device-event-definition">Get Device Event Definition</h2>
<pre><code>GET /api/v1/const/device_events
</code></pre>
<h3 id="response_174">Response</h3>
<pre><code>[
    {
        "key": "AP_ASSIGNED",
        "display": "AP Assigned",
        "description": "AP was assigned to a site",
        "example": {
            "type": "AP_ASSIGNED",
            "timestamp": 1552408871,
            "org_id": "2818e386-8dec-2562-9ede-5b8a0fbbdc71",
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "ap": "5c5b35000001",
            "audit_id": "e9a88814-fa81-5bdc-34b0-84e8735420e5"
        }
    },
    ...
]
</code></pre>
<h2 id="get-client-event-definition">Get Client Event Definition</h2>
<pre><code>GET /api/v1/const/client_events
</code></pre>
<h3 id="response_175">Response</h3>
<pre><code>[
    {
        "key": "CLIENT_IP_ASSIGNED",
        "display": "DHCP Success"
    },
    ...
]
</code></pre>
<h2 id="get-ap-led-status">Get AP Led Status</h2>
<pre><code>GET /api/v1/const/ap_led_status
</code></pre>
<h3 id="response_176">Response</h3>
<pre><code>[
    {
        "code": "02",
        "key": "NO_ETHERNET_LINK",
        "name": "No ethernet link",
        "description": "Has no link (Seen using power injectors, but not connected to a switch)"
    },
    ...
]
</code></pre>
<h2 id="get-marvisclient-versions">Get Marvisclient Versions</h2>
<pre><code>GET /api/v1/const/marvisclient_versions
</code></pre>
<h3 id="response_177">Response</h3>
<pre><code>[
    {
        "os": "android",
        "version": "1.1.9",
        "url": "https://mobile.mist.com/installers/marvisclient/android/1.1.9/marvisclient-installer.apk",
        "label": "latest",
        "notes": ""
    },
    {
        "os": "macos",
        "version": "0.100.29",
        "url": "https://mobile.mist.com/installers/marvisclient/macos/0.100.29/marvisclient-installer.dmg",
        "label": "rc1",
        "notes": ""
    },
    {
        "os": "windows",
        "version": "0.100.26",
        "url": "https://mobile.mist.com/installers/marvisclient/windows/0.100.26/marvisclient-installer.zip",
        "label": "default",
        "notes": ""
    }
]
</code></pre>
<h2 id="get-webhook-topic-definitions">Get Webhook Topic definitions</h2>
<pre><code>GET /api/v1/const/webhook_topics
</code></pre>
<h3 id="response_178">Response</h3>
<pre><code>[
    {
        "key": "alarms",
        "for_org": true,
        "has_delivery_results": true
    },
    {
        "key": "client-info",
        "for_org": true
    },
    {
        "key": "ping",
        "for_org": true,
        "internal": true,
        "has_delivery_results": true
    },
    {
        "key": 'device-events',
        "for_org": true,
        "allows_single_event_per_message": true
    },
    {
        "key": "sdkclient-scan-data"
    },
    ...
]

</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>key</code></td>
<td><code>string</code></td>
<td>webhook topic name</td>
</tr>
<tr>
<td><code>for_org</code></td>
<td><code>bool</code></td>
<td>can be used in org webhooks, optional, default false</td>
</tr>
<tr>
<td><code>internal</code></td>
<td><code>bool</code></td>
<td>internal topic (not selectable in site/org webhooks)</td>
</tr>
<tr>
<td><code>has_delivery_results</code></td>
<td><code>bool</code></td>
<td>supports webhook delivery results <code>/api/v1/:scope/:scope_id/webhooks/:webhook_id/events/search</code></td>
</tr>
<tr>
<td><code>allows_single_event_per_message</code></td>
<td><code>bool</code></td>
<td>supports single event per message results</td>
</tr>
</tbody>
</table>
<h1 id="site-mxedge">Site MxEdge</h1>
<h2 id="upload-mist-edge-support-files">Upload Mist Edge support files</h2>
<p>Support / Upload Mist Edge support files</p>
<pre><code>POST /api/v1/sites/:site_id/mxedges/:mxedge_id/support
</code></pre>
<h2 id="get-site-mxedges-stats">Get Site MxEdges Stats</h2>
<pre><code>Get /api/vi/sites/:site_id/stats/mxedges
</code></pre>
<h3 id="response_179">Response</h3>
<pre><code>[
    {
        "status": "disconnected",
        "magic": "S2ZD-srTcoOp9GGttZpq1ISQEq4iPY3EhWpAKB9pb9JdWjeP12bjIbFYsDy5jP3a",
        "name": "staging_edge",
        "tunterm_port_config": {
            "separate_upstream_downstream": false,
            "upstream_ports": [
                "0"
            ],
            "downstream_ports": [
                "0"
            ]
        },
        "org_id": "5a5ed2f4-632f-41f3-b8ed-d3afa4b27f96",
        "site_id": "c88aa7a2-ac27-7d87-b633-1ac3a7837928",
        "mxcluster_id": null,
        "modified_time": 1574117211,
        "tunterm_registered": false,
        "for_site": true,
        "services": [
            "tunterm"
        ],
        "created_time": 1574114372,
        "model": "ME-100",
        "tunterm_ip_config": {
            "ip": "",
            "netmask": "",
            "gateway": ""
        },
        "id": "b025de9b-7bb6-43bd-8a71-bf3cu840c9ad",
        "mxagent_registered": false,
        "fwupdate": {
            "timestamp": 1574117214,
            "status": "inprogress",
            "progress": 23
        }
    }
]
</code></pre>
<p>See <a href="https://api.mist.com/api/v1/docs/Org#get-mist-edge-stats">Org:Mxedge</a> for fields description</p>
<h2 id="get-one-site-mxedges-stats">Get One Site MxEdges Stats</h2>
<pre><code>Get /api/vi/sites/:site_id/stats/mxedges/:mxedge_id
</code></pre>
<h2 id="search-mist-edge-events">Search Mist Edge Events</h2>
<pre><code>GET /api/v1/sites/:site_id/mxedges/events/search
</code></pre>
<h3 id="supported-filters_1">Supported Filters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mxedge_id</code></td>
<td>string</td>
<td>mist edge id</td>
</tr>
<tr>
<td><code>mxcluster_id</code></td>
<td>string</td>
<td>mist edge cluster id</td>
</tr>
<tr>
<td><code>type</code></td>
<td>string</td>
<td>mist edge event type <a href="https://api.mist.com/api/v1/docs/Org#get-supported-mist-edge-events">Supported Events</a></td>
</tr>
<tr>
<td><code>service</code></td>
<td>string</td>
<td>service running on mist edge(mxagent, tunterm etc)</td>
</tr>
<tr>
<td><code>start</code></td>
<td><code>string</code></td>
<td>start datetime, can be epoch or relative time like -1d, -1w; -1d if not specified</td>
</tr>
<tr>
<td><code>end</code></td>
<td><code>string</code></td>
<td>end datetime, can be epoch or relative time like -1d, -2h; now if not specified</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>string</code></td>
<td>duration like 7d, 2w</td>
</tr>
<tr>
<td><code>component</code></td>
<td><code>string</code></td>
<td>component like PS1, PS2</td>
</tr>
</tbody>
</table>
<h3 id="response_180">Response</h3>
<pre><code>{
    "results": [
        {
            "mxcluster_id": "2815c917-58e7-472f-a190-bfd44fb58d05",
            "timestamp": 1694678225.927,
            "org_id": "f2695c32-0e83-4936-b1b2-96fc88051213",
            "mxedge_id": "00000000-0000-0000-1000-020000dc585c",
            "type": "ME_SERVICE_STOPPED",
            "service": "tunterm"
        },
        {
            "timestamp": 1694678004.821,
            "org_id": "f2695c32-0e83-4936-b1b2-96fc88051213",
            "mxedge_id": "00000000-0000-0000-1000-020000dc585c",
            "type": "ME_SERVICE_STARTED",
            "service": "tunterm"
        },
         {
            "package": "radsecproxy",
            "timestamp": 1694678010.108,
            "org_id": "f2695c32-0e83-4936-b1b2-96fc88051213",
            "mxedge_id": "00000000-0000-0000-1000-020000dc585c",
            "type": "ME_PACKAGE_INSTALLED",
            "to_version": "1.9.1-1.mist.16"
        },
        {
            "timestamp": 1694679111.253,
            "org_id": "f2695c32-0e83-4936-b1b2-96fc88051213",
            "mxedge_id": "00000000-0000-0000-1000-020000dc585c",
            "type": "ME_POWERINPUT_DISCONNECTED",
            "component": "PS1"
        }
    ],
    "start": 1694622179,
    "end": 1694708579,
    "limit": 10,
    "total": 4
}

</code></pre>
<h2 id="count-mist-edge-events">Count Mist Edge Events</h2>
<pre><code>GET /api/v1/sites/:site_id/mxedges/events/count?distinct=type
</code></pre>
<h3 id="request_124">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>mxedge_id(default) / type / mxcluster_id / package</td>
</tr>
<tr>
<td><code>start</code></td>
<td><code>string</code></td>
<td>start datetime, can be epoch or relative time like -1d, -1w; -1d if not specified</td>
</tr>
<tr>
<td><code>end</code></td>
<td><code>string</code></td>
<td>end datetime, can be epoch or relative time like -1d, -2h; now if not specified</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>string</code></td>
<td>duration like 7d, 2w</td>
</tr>
</tbody>
</table>
<h3 id="response_181">Response</h3>
<pre><code>{
    "results": [
        {
            "type": "ME_SERVICE_RESTARTED",
            "count": 5003
        },
        {
            "type": "ME_SERVICE_STARTED",
            "count": 124
        },
        {
            "type": "ME_SERVICE_FAILED",
            "count": 120
        }
    ],
    "start": 1694622935,
    "end": 1694709335,
    "limit": 10,
    "distinct": "type",
    "total": 3
}
</code></pre>
<h1 id="site-128t-ssr">Site 128T (SSR)</h1>
<h2 id="upgrade-128t-ssr-device">Upgrade 128T (SSR) device</h2>
<pre><code>POST /api/v1/sites/:site_id/ssr/:device_id/upgrade
</code></pre>
<h3 id="request_125">Request</h3>
<pre><code>{
    "channel": "stable",
    "version": "5.3.0-93",
    "start_time": 1624405840
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>channel</code></td>
<td><code>string</code></td>
<td>upgrade channel to follow, stable (default) / beta / alpha</td>
</tr>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>128T firmware version to upgrade (e.g. 5.3.0-93)</td>
</tr>
<tr>
<td><code>start_time</code></td>
<td><code>long</code></td>
<td>128T firmware download start time in epoch seconds, default is now, -1 disables download</td>
</tr>
<tr>
<td><code>reboot_at</code></td>
<td><code>long</code></td>
<td>reboot start time in epoch seconds, default is <code>start_time</code>, -1 disables reboot</td>
</tr>
</tbody>
</table>
<h2 id="get-a-specific-upgrade">Get a specific Upgrade</h2>
<pre><code>GET /api/v1/sites/:site_id/ssr/upgrade/:upgrade_id
</code></pre>
<h3 id="response_182">Response</h3>
<pre><code>{
    "status": "upgrading",
    "versions": {},
    "channel": "stable",
    "device_type": "gateway",
    "id": "5cbcee0a-c620-4bb4-a25e-15000934e9d8",
    "targets": {
        "queued": [],
        "upgrading": ["8e525f1d-4178-4ae1-a988-2b0176855e55"],
        "success": [],
        "failed": []
    }
}
</code></pre>
<h2 id="search-bgp-stats">Search BGP Stats</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/bgp_peers/search
</code></pre>
<h3 id="response_183">Response</h3>
<pre><code>{
    "results": [
        {
            "org_id": "0c160b7f-1027-4cd1-923b-744534c4b070",
            "site_id": "725a8d34-a126-4f2c-b990-d1219421cb75",
            "mac": "020001c04668",
            "timestamp": 1666251056.07,
            "local_as": 65000,
            "neighbor_as": 65000,
            "vrf_name": "default",  // default (default) / or VRF name
            "neighbor": "15.8.3.5",
            "neighbor_mac": "020001e53153",  // if it's another device in the same org
            "uptime": 31355,
            "up": true,
            "for_overlay": true, // if this is created for overlay
            "state": "established",  // idle, connect, active, open_sent, open_confirm and established
            "tx_pkts": 1735,
            "rx_pkts": 63366,
            "rx_routes": 60,
            "tx_routes": 60,
            "evpn_overlay": true // if this is created for evpn overlay
        },
    ],
    "start": 1619518689.4989705,
    "end": 1619518989.4989712,
    "limit": 10,
    "total": 1
}
</code></pre>
<h4 id="definitions_9">Definitions</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>router org ID</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>router site ID</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>router mac address</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>long</code></td>
<td>sampling time (in epoch)</td>
</tr>
<tr>
<td><code>local_as</code></td>
<td><code>string</code></td>
<td>local AS</td>
</tr>
<tr>
<td><code>neighbor_as</code></td>
<td><code>string</code></td>
<td>neighbor AS</td>
</tr>
<tr>
<td><code>vrf_name</code></td>
<td><code>string</code></td>
<td>VRF name</td>
</tr>
<tr>
<td><code>neighbor</code></td>
<td><code>string</code></td>
<td>IP of neighbor</td>
</tr>
<tr>
<td><code>neighbor_mac</code></td>
<td><code>string</code></td>
<td>Mac of neighbor</td>
</tr>
<tr>
<td><code>state</code></td>
<td><code>string</code></td>
<td>idle, connect, active, open_sent, open_confirm and established</td>
</tr>
<tr>
<td><code>up</code></td>
<td><code>boolean</code></td>
<td>true/false</td>
</tr>
<tr>
<td><code>tx_pkts</code></td>
<td><code>int</code></td>
<td>tx pkts</td>
</tr>
<tr>
<td><code>rx_pkts</code></td>
<td><code>int</code></td>
<td>rx pkts</td>
</tr>
<tr>
<td><code>rx_routes</code></td>
<td><code>int</code></td>
<td>number of received routes</td>
</tr>
<tr>
<td><code>tx_routes</code></td>
<td><code>int</code></td>
<td>number of sent routes</td>
</tr>
<tr>
<td><code>uptime</code></td>
<td><code>int</code></td>
<td>uptime</td>
</tr>
<tr>
<td><code>for_overlay</code></td>
<td><code>boolean</code></td>
<td>true/false, if this is created for overlay</td>
</tr>
<tr>
<td><code>evpn_overlay</code></td>
<td><code>boolean</code></td>
<td>true/false, if this is created for evpn overlay</td>
</tr>
</tbody>
</table>
<h2 id="count-bgp-stats">Count BGP Stats</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/bgp_peers/count?state=disconnected&amp;distinct=mac
</code></pre>
<h3 id="response_184">Response</h3>
<pre><code>{
    "results": [
        {
            "mac": "02000111d2dc",
            "count": 2
        }
    ],
    "start": 1619518707.800029,
    "end": 1619519007.8000295,
    "limit": 10,
    "distinct": "mac",
    "total": 1,
}
</code></pre>
<h1 id="virtual-chassis">Virtual Chassis</h1>
<h2 id="get-vc-status">Get VC Status</h2>
<p>The API below returns a combined view of the VC status which includes topology and stats.</p>
<pre><code>GET /api/v1/sites/:site_id/devices/:device_id/vc
</code></pre>
<h3 id="vc-status-response">VC Status Response</h3>
<pre><code>{
    "id": "00000000-0000-0000-1000-dc38e1dbf3cd",
    "site_id": "9bf047be-1911-225c-a541-d6637a373633",
    "org_id": "eb6a1083-1e3a-48cc-8888-78ff7772c588",
    "mac": "dc38e1dbf3cd",
    "vc_mac": "dc38e1dbf3cd",
    "model": "EX4600",
    "type": "switch",
    "serial": "TC3714190003",
    "status": "connected",
    "locating": true,
    "members": [
        {
            "_idx": 0,
            "vc_role": "master",
            "model": "EX4600",
            "serial": "TC3714190003",
            "vc_state": "present",
            "locating": true,
            "fans": [
                {
                    "name": "Fan 0"
                    "status": "absent",
                },
                {
                    "name": "Fan 1"
                    "airflow": "out",
                    "status": "ok"
                }
            ],
            "temperatures": [
                {
                    "name": "CPU",
                    "status": "ok",
                    "celsius": 45.0
                }
            ],
            "psus": [
                {
                    "name": "Power Supply 0",
                    "status": "ok"
                },
                {
                    "name": "Power Supply 1",
                    "status": "failed"
                }
            ],
            "poe": {
                "max_power": 250.0,
                "power_draw": 120.3
            },
            "vc_links": [
                {
                    "port_id": "vcp-255/1/0",
                    "neighbor_module_idx": 1,
                    "neighbor_port_id": "vcp-255/1/0"
                }
            ]
        }
    ]
}
</code></pre>
<h2 id="form-a-new-vc">Form a New VC</h2>
<p>For models (e.g. EX4300 and up) having dedicated VC ports, it is easier to form a VC by just connecting cables with the
dedicated VC ports. Cloud will detect the new VC and update the inventory.</p>
<p>In case that the user would like to choose the dedicated switch as a VC master. Or for EX2300-C-12P and EX2300-C-12T
which doesn’t have dedicated VC ports, below are procedures to automate the VC creation:</p>
<ol>
<li>Power on the switch that is choosen as the VC master first. And the powering on the other member switches.</li>
<li>Claim or adopt all these switches under the same organization’s Inventory</li>
<li>Assign these switches into the same Site</li>
<li>Invoke vc command on the switch choosen to be the VC master. For EX2300-C-12P, VC ports will be created
   automatically.</li>
<li>Connect the cables to the VC ports for these switches</li>
<li>Wait for the VC to be formed. The Org’s inventory will be updated for the new VC.</li>
</ol>
<h3 id="create-a-vc-with-two-members-inter-connected-by-vc-port-xe-010">Create a VC with two members inter-connected by VC port xe-0/1/0</h3>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/vc
{
    "members": [
        {
            "mac": "aff827549235",      // fpc0, same as the mac of device_id
            "vc_ports": ["xe-0/1/0"],
            "vc_role": "master",        // vc_role is enforced to be master when creating the VC
        },
        {
            "mac": "8396cd006c8c",
            "vc_ports": ["xe-0/1/0"]
            "vc_role": "backup",
        }
    ]
}
</code></pre>
<h3 id="create-a-vc-with-three-members">Create a VC with three members</h3>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/vc
{
    "members": [
        {
            "mac": "aff827549235", // fpc0, same as the mac of device_id
            "vc_ports": ["xe-0/1/0"],
            "vc_role": "master"
        },
        {
            "mac": "8396cd006c8c",
            "vc_ports": ["xe-0/1/0", "xe-0/1/1"],
            "vc_role": "backup"
        },
        {
            "mac": "8396cd00888c",
            "vc_ports": ["xe-0/1/0"],
            "vc_role": "linecard"
        }
    ]
}
</code></pre>
<h3 id="create-a-pre-provisioned-vc-with-three-members">Create a pre-provisioned VC with three members</h3>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/vc
{
    "preprovisioned": true,
    "members": [
        {
            "mac": "aff827549235",      // fpc0, same as the mac of device_id
            "vc_role": "master",
            "member_id": 0,
            "vc_ports": ["xe-0/1/0", "xe-0/1/1"]
        },
        {
            "mac": "8396cd006c8c",
            "vc_role": "linecard",
            "member_id": 1,
            "vc_ports": ["xe-0/1/0"],
        },
        {
            "mac": "8396cd00888c",
            "vc_role": "backup",
            "member_id": 2,
            "vc_ports": ["xe-0/1/0"]
        }
    ]
}
</code></pre>
<h2 id="add-new-members">Add new members</h2>
<p>For models (e.g. EX4300 and up) having dedicated VC ports, it is easier to add new member switches into a VC by just
connecting cables with the dedicated VC ports. Cloud will detect the new members and update the inventory.</p>
<p>For EX2300 VC, adding new members requires to follow the procedures below:</p>
<ol>
<li>Powering on the new member switches and ensuring cables are not connected to any VC ports.</li>
<li>Claim or adopt all new member switches under the VC’s organization Inventory</li>
<li>Assign all new member switches to the same Site as the VC</li>
<li>Invoke vc command to add switches to the VC.</li>
<li>Connect the cables to the VC ports for these switches</li>
<li>After a while, the Org’s Inventory shows this new switches has been added into the VC.</li>
</ol>
<h3 id="adding-one-new-switch-as-line-card-connected-to-from-vc-port-xe-011-of-fpc0-of-vc-to-xe-010-of-8396cd00777c">Adding one new switch as line-card, connected to from VC port xe-0/1/1 of fpc0 of VC to xe-0/1/0 of 8396cd00777c</h3>
<pre><code>PUT /api/v1/sites/:site_id/devices/:device_id/vc
{
    "op": "add",
    "members": [
        {
            "mac": "aff827549235",      // same as the mac of device_id
            "member": 0,                // enabling vc port xe-0/1/1 on member 0
            "vc_ports": ["xe-0/1/1"],
        },
        {
            "mac": "8396cd00777c",
            "vc_ports": ["xe-0/1/0"],
            "vc_role": "linecard"
        }
    ]
}
</code></pre>
<h3 id="adding-two-new-switches-as-line-cards-into-the-vc-mac-aff827549235">Adding two new switches as line cards into the VC (MAC aff827549235)</h3>
<pre><code>PUT /api/v1/sites/:site_id/devices/:device_id/vc
{
    "op": "add",
    "members": [
        {
            "mac": "aff827549235",      // same as the mac of device_id
            "member": 0,                // enabling vc port xe-0/1/1 on member 0
            "vc_ports": ["xe-0/1/1"],
        },
        {
            "mac": "aff827549235",      // same as the mac of device_id
            "member": 2,                // enabling vc port xe-0/1/1 on member 2
            "vc_ports": ["xe-0/1/1"],
        },
        {
            "mac": "8396cd00777c",
            "vc_ports": ["xe-0/1/0"],
            "vc_role": "linecard"
        },
        {
            "mac": "8396cd00888c",
            "vc_ports": ["xe-0/1/0"],
            "vc_role": "linecard"
        }
    ]
}
</code></pre>
<h2 id="removing-member-switch">Removing member switch</h2>
<p>To remove a member switch from the VC, following the procedures below:</p>
<ol>
<li>Ensuring the VC is connected to the cloud first</li>
<li>Unplug the cable from the VC port of the switch</li>
<li>Waiting for the VC state (vc_state) of this switch is changed to not-present</li>
<li>Invoke update_vc with remove to remove this switch from the VC</li>
<li>The Org’s Inventory shows the switch is removed.</li>
</ol>
<p>Please notice that member ID 0 (fpc0) cannot be removed. When a VC has two switches left, unpluging the cable may result
in the situation that fpc0 becomes a line card (LC). When this situation is happened, please re-plug in the cable, wait
for both switches becoming present (show virtual-chassis) and then removing the cable again.</p>
<h3 id="removing-two-new-switches-into-the-vc-mac-aff827549235">Removing two new switches into the VC (MAC aff827549235)</h3>
<pre><code>PUT /api/v1/sites/:site_id/devices/:device_id/vc
{
    "op": "remove",
    "members": [
        {
            "member": 2,
        },
        {
            "member": 3,
        },
    ]
}
</code></pre>
<h2 id="renumber-a-member-switch">Renumber a member switch</h2>
<p>When a member switch doesn’t work properly and needed to be replaced, the renumber API could be used.
The following two types of renumber are supported:</p>
<ol>
<li>Replace a non-fpc0 member switch</li>
<li>Replace fpc0. When fpc0 is relaced, PAPI device config and JUNOS config will be both updated. </li>
</ol>
<p>For renumber to work, the following procedures are needed:
1. Ensuring the VC is connected to the cloud and the state of the member switch to be replaced
   must be non present.
2. Adding the new member switch to the VC
3. Waiting for the VC state (vc_state) of this VC to be updated to API server
4. Invoke vc with renumber to replace the new member switch from fpc X to </p>
<h3 id="renumber-member-id-3-to-member-id-2">Renumber member ID 3 to member ID 2</h3>
<pre><code>PUT /api/v1/sites/:site_id/devices/:device_id/vc
{
    "op": "renumber",
    "member": 3,
    "new-member": 2
}
</code></pre>
<h3 id="renumber-member-id-3-to-member-id-0">Renumber member ID 3 to member ID 0</h3>
<pre><code>PUT /api/v1/sites/:site_id/devices/:device_id/vc
{
    "op": "renumber",
    "member": 3,
    "new-member": 0
}
</code></pre>
<h4 id="example-response-of-new-device-replacing-fpc0">Example response of new device replacing fpc0</h4>
<pre><code>{
    'adopted': true,
    'virtual_chassis': {
        ...
    },
    'managed': true,
    'id': '00000000-0000-0000-1000-a874b9710001',
    'site_id': '1916d52a-4a90-11e5-8b45-1258369c38a9',
    'org_id': '2818e386-8dec-2562-9ede-5b8a0fbbdc71',
    'mac': 'a874b9710001',
    'serial': 'SW-REG-01',
    'model': 'EX4300-48P',
    'type': 'switch',
    ...
}
</code></pre>
<h2 id="deleting-a-virtual-chassis-vc">Deleting a Virtual Chassis (VC)</h2>
<p>When all the member switches of VC are removed and only member ID 0 is left, the cloud would detect this situation and
automatically changes the single switch to non-VC role.</p>
<p>For some unexpected cases that the VC is gone and disconncted, the API below could be used to change the state of VC’s
switches to be standalone. After it is executed, all the switches will be shown as standalone switches under Inventory.</p>
<pre><code>DELETE /api/v1/sites/:site_id/devices/:device_id/vc
</code></pre>
<h2 id="update-devices-vc-config">Update Device’s VC config</h2>
<p>The VC creation and adding member switch API will update the device’s virtual chassis config which is applied after VC
is formed to create JUNOS pre-provisioned virtual chassis configuration. To modify the device’s VC config after
VC is created, the device config API is leveraged:</p>
<pre><code>PUT /api/v1/sites/:site_id/devices/:device_id
</code></pre>
<h3 id="change-8396cd006c8c-to-be-a-line-card-and-8396cd00888c-as-a-routing-engine">Change 8396cd006c8c to be a line-card and 8396cd00888c as a routing-engine</h3>
<pre><code>{
    "virtual_chassis": {
        "preprovisioned": false,       // to configure whether the VC is preprovisioned or nonprovisioned. default is false
        "members": [
            {
                "mac": "aff827549235", // fpc0, same as the mac of device_id
                "vc_role": "master"
            },
            {
                "mac": "8396cd006c8c",
                "vc_role": "linecard"
            },
            {
                "mac": "8396cd00888c",
                "vc_role": "backup"
            }
        ]
    }
}
</code></pre>
<h3 id="change-to-use-preprovisioned-vc">Change to use preprovisioned VC</h3>
<p>To switch the VC to use preprovisioned VC, enable preprovisioned in virtual_chassis config. Both vc_role master and backup
will be matched to routing-engine role in Junos preprovisioned VC config.</p>
<p>In this config, fpc0 has to be the same as the mac of device_id. Use <a href="https://api.mist.com/api/v1/docs/Site#renumber-a-member-switch">renumber</a> if you want to
replace fpc0 which involves device_id change.</p>
<p>Notice: to configure preprovisioned VC, every member of the VC must be in the inventory.</p>
<pre><code>{
    "virtual_chassis": {
        "preprovisioned": true,
        "members": [
            {
                "mac": "aff827549235", // fpc0, same as the mac of device_id
                "vc_role": "master",
                "member_id": 0
            },
            {
                "mac": "8396cd006c8c",
                "vc_role": "linecard",
                "member_id": 1
            },
            {
                "mac": "8396cd00888c",
                "vc_role": "backup",
                "member_id": 2
            }
        ]
    }
}
</code></pre>
<h2 id="perprovision-vc-members">Perprovision VC members</h2>
<p>By specifying “preprovision” op, you can convert the current VC to pre-provisioned mode, update VC members as well as specify vc_ports when adding new members for device models without dedicated vc ports. Use <a href="https://api.mist.com/api/v1/docs/Site#renumber-a-member-switch">renumber</a> for fpc0 replacement which involves device_id change.</p>
<p>Note: 
1. vc_ports is used for adding new members and not needed if
    * the device model has dedicated vc ports, or
    * no new member is added
2. New VC members to be added should exist in the same Site as the VC</p>
<p><a href="https://api.mist.com/api/v1/docs/Site##Update-Device&#39;s-VC-config">Update Device’s VC config</a> can achieve similar purpose by directly modifying current virtual_chassis config. However, it cannot fulfill requests to enabling vc_ports on new members that are yet to belong to current VC.</p>
<h3 id="convert-to-pre-provisioned-vc-add-8396cd00888c-as-member-2-and-enable-related-vc-ports">Convert to pre-provisioned VC, add 8396cd00888c as member 2 and enable related vc ports</h3>
<pre><code>    PUT /api/v1/sites/:site_id/devices/:device_id/vc
    {
        "op": "preprovision",
        "members": [
            {
                "mac": "aff827549235",      // fpc0, same as the mac of device_id of current VC
                "vc_role": "master",
                "member_id": 0,
                "vc_ports": ["xe-0/1/1"]    // enabling vc port xe-0/1/1 on member 0
            },
            {
                "mac": "8396cd006c8c",
                "vc_role": "linecard",
                "member_id": 1
            },
            {
                "mac": "8396cd00888c",
                "vc_role": "backup",
                "member_id": 2,
                "vc_ports": ["xe-0/1/0"]    // enabling vc port xe-0/1/1 on member 2
            }
        ]
    }
</code></pre>
<h2 id="vc-port-commands-for-switchvc">VC port commands for switch/VC</h2>
<p>To change ports to VC port or delete a VC port, below is the API for this purpose.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/vc/vc_port
</code></pre>
<h3 id="set-vc-port-of-xe-011-of-member-0-and-member-2">Set VC port of xe-0/1/1 of member 0 and member 2</h3>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/vc/vc_port
{
    "op": "set",
    "members": [
        {
            "member": 0,                // enabling vc port xe-0/1/1 on member 0
            "vc_ports": ["xe-0/1/1"],
        },
        {
            "member": 2,                // enabling vc port xe-0/1/1 on member 2
            "vc_ports": ["xe-0/1/1"],
        },
    ]
}
</code></pre>
<h3 id="delete-vc-port-of-xe-011-of-member-0-and-member-2">Delete VC port of xe-0/1/1 of member 0 and member 2</h3>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/vc/vc_port
{
    "op": "delete",
    "members": [
        {
            "member": 0,                // enabling vc port xe-0/1/1 on member 0
            "vc_ports": ["xe-0/1/1"],
        },
        {
            "member": 2,                // enabling vc port xe-0/1/1 on member 2
            "vc_ports": ["xe-0/1/1"],
        },
    ]
}
</code></pre>
<h3 id="change-vcp-port-mode">Change VCP port mode</h3>
<p>Some switch model allows changing VCP port behaviors, e.g.
- use them as regular network ports
- change vcp protocol 
Note, this command will reboot the switch</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/set_vc_port_mode
</code></pre>
<h3 id="request_126">Request</h3>
<pre><code>{
    "mode": "network",  // required. network / vcp-higig / vcp-hgoe (EX4400-24X only supports this)
}
</code></pre>
<h2 id="convert-to-virtualmac-vc">Convert to Virtualmac VC</h2>
<p>Converts an FPC0-based VC to a Virtualmac VC, removing the limitation where the device ID must change whenever FPC0 is renumbered or removed.</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/vc/convert_to_virtualmac
</code></pre>
<h3 id="response_185">Response</h3>
<pre><code>Status: 200 OK
Status: 400 Bad Request. Possible reasons:
     - The device is not an OC device
     - Virtualmac VC is disabled in the Org Knob settings
     - The VC is already a Virtualmac VC
     - The VC is currently disconnected
     - The device is standalone
     - A new FPC0 exists with its own device config, causing ambiguity.
</code></pre>
<h2 id="ha-cluster">HA Cluster</h2>
<h3 id="srx-cabling">SRX cabling</h3>
<p>see <a href="https://www.juniper.net/documentation/us/en/software/junos/chassis-cluster-security-devices/topics/concept/chassis-cluster-srx-series-node-interface-understanding.html">Chassis Cluster User Guide for SRX Series Devices</a>
Here’s the recommended cabling.</p>
<h4 id="srx300">SRX300</h4>
<p>From ZTP / default state, ge-0/0/0 and ge-0/0/7 (SFP) are default WAN ports and will get DHCP IP.
However, ge-0/0/0 becomes OOB/fxp0 after cluster is enabled (i.e. using it for reach Mist is not recommended)</p>
<ol>
<li>form cluster in UI</li>
<li>configure ge-0/0/7,ge-1/0/7 for WAN (reth0)</li>
<li>configure ge-0/0/2,ge-1/0/2 for ha_data</li>
<li>configure ge-0/0/3- for LAN or additional WAN
e.g. </li>
</ol>
<pre><code>{
    "port_config": {
        "ge-0/0/2,ge-1/0/2": {
            "usage": "ha_data"
        },
        "ge-0/0/7,ge-1/0/7": {
            "usage": "wan",
            "redundant": true,
            "reth_idx": 0,
            "ip_config": {"type": "dhcp"}
        },
    }
}
</code></pre>
<ol start="5">
<li>connect ge-0/0/1 back to back for ha_control</li>
<li>connect ge-0/0/2 back to back for ha_data</li>
<li>connect both ge-0/0/7 to uplink switch to WAN and to reach Mist</li>
<li>power up both devices</li>
<li>it takes about 30 minutes for the cluster to form</li>
</ol>
<h4 id="srx320">SRX320</h4>
<p>From ZTP / default state, ge-0/0/0, ge-0/0/7 (SFP) and cl-1/0/0 (LTE) are default WAN ports and will get DHCP IP.
However, ge-0/0/0 becomes OOB/fxp0 after cluster is enabled (i.e. using it for reach Mist is not recommended)</p>
<h5 id="ztp-via-ge-007">ZTP via ge-0/0/7</h5>
<p>Similar to SRX300</p>
<h5 id="ztp-via-cl-100-lte">ZTP via cl-1/0/0 (LTE)</h5>
<ol>
<li>form cluster in UI</li>
<li>configure cl-1/0/0, cl-3/0/0 as WAN (reth0)</li>
<li>configure ge-0/0/2,ge-3/0/2 for ha_data</li>
<li>same as above</li>
</ol>
<h4 id="srx340-srx345-srx380">SRX340 / SRX345 / SRX380</h4>
<p>SRX340/SRX345 has dedicated OOB/fxp0 ports</p>
<ol>
<li>form cluster in UI</li>
<li>configure ge-0/0/0,ge-5/0/0 for WAN (reth0)</li>
<li>configure ge-0/0/2,ge-5/0/2 for ha_data</li>
<li>configure ge-0/0/3- for LAN or additional WAN</li>
<li>connect ge-0/0/0 to uplink switch to WAN and to reach Mist</li>
<li>connect ge-0/0/1 back-to-back for ha_control</li>
<li>connect ge-0/0/2 back-to-back for ha_data (fabric); or for SRX380, xe-0/0/16 if 10G SFP+ is used </li>
<li>connect ge-0/0/3- to LAN or additional WANs</li>
</ol>
<h4 id="srx550">SRX550</h4>
<p>ge-0/0/0 becomes OOB/fxp0 after cluster is enabled, make suenable oob_ip_config as dhcp to maintain cloud connectivity</p>
<ol>
<li>connect ge-0/0/0 to reach Mist (after cluster is fully up, this port becomes OOB/fxp0)</li>
<li>connect ge-0/0/1 back-to-back for ha_control</li>
<li>connect ge-0/0/2 back-to-back for ha_data (fabric)</li>
<li>connect ge-0/0/3 to WAN (after cluster is up, intended to be used for reth0)</li>
<li>connect ge-0/0/4- to LAN or additional WANs</li>
</ol>
<h4 id="srx1500">SRX1500</h4>
<p>SRX1500 has, additionally, dedicated HA Control port</p>
<ol>
<li>form cluster in UI</li>
<li>configure ge-0/0/0,ge-7/0/0 for WAN (reth0)</li>
<li>configure ge-0/0/1,ge-7/0/1 for ha_data</li>
<li>configure ge-0/0/2- for LAN or additional WAN</li>
<li>connect dedicated ha_control back-to-back</li>
<li>connect ge-0/0/0 to uplink switch to WAN and to reach Mist</li>
<li>connect ge-0/0/1 back-to-back for ha_data </li>
<li>connect ge-0/0/2- to LAN or additional WANs</li>
</ol>
<h4 id="srx1600">SRX1600</h4>
<p>SRX1600 has, additionally, two dedicated HA Control port</p>
<ol>
<li>form cluster in UI</li>
<li>configure ge-0/0/0,ge-7/0/0 for WAN (reth0)</li>
<li>configure ge-0/0/1,ge-7/0/1 for ha_data</li>
<li>configure ge-0/0/2- for LAN or additional WAN</li>
<li>connect dedicated both ha_control back-to-back</li>
<li>connect ge-0/0/0 to uplink switch to WAN and to reach Mist</li>
<li>connect ge-0/0/1 back-to-back for ha_data </li>
<li>connect ge-0/0/2- to LAN or additional WANs</li>
</ol>
<h4 id="srx4100">SRX4100</h4>
<p>SRX4100 has dedicated ha_control and ha_data (fabric) ports</p>
<ol>
<li>connect dedicated ha_control back-to-back</li>
<li>connect dedicated ha_data back-to-back</li>
<li>connect xe-0/0/0 to WAN to reach Mist</li>
<li>connect xe-0/0/1- to LAN or additional WANs</li>
</ol>
<h4 id="vsrx">VSRX</h4>
<p>When standalone, VSRX has fxp0 as first Network Adapter, then ge-0/0/0-N
When clustered, VSRX has fxp0, em0, then ge-0/0/0-N</p>
<ol>
<li>connect net0 (fxp0) to WAN to reach Mist</li>
<li>connect net1 back-to-back for ha_control</li>
<li>connect net2 (ge-0/0/0) back-to-back for ha_data (fab0/fab1)</li>
<li>connect net3 (ge-0/0/1) to WAN, intended to be used for reth0</li>
<li>connect net4 (ge-0/0/2) to LAN</li>
</ol>
<h3 id="form-a-ha-cluster">Form a HA Cluster</h3>
<p>Both nodes has to be in the same site. We expect the user to configure ha / ha_data port in port_configs already</p>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/ha
{
    "nodes": [
        {
            "mac": "aff827549235"  // node0, same as the mac of device_id
        },
        {
            "mac": "8396cd006c8c"  // node1
        }
    ]
}
</code></pre>
<h3 id="delete-a-ha-cluster">Delete a HA Cluster</h3>
<p>After deleting the HA Cluster, both nodes will become a standalone device in the same site</p>
<pre><code>DELETE /api/v1/sites/:site_id/devices/:device_id/ha
</code></pre>
<h3 id="replace-a-node-in-a-ha-cluster">Replace a Node in a HA Cluster</h3>
<p>Usually Device Replacement is done by <a href="https://api.mist.com/api/v1/docs/Org#device-replacement">Device Replacement</a> API.
For a HA cluster, you can also replace a node by another device in the same site.</p>
<pre><code>PUT /api/v1/sites/:site_id/devices/:device_id/ha
{
    // either mac has to remain the same as existing cluster
    "nodes": [
        {
            "mac": "aff827549235"  // node0
        },
        {
            "mac": "8396cd006c8c"  // node1
        }
    ]
}
</code></pre>
<h2 id="preempt-site-mxtunnel-aps-to-preferred-peer">Preempt site mxtunnel ap’s to preferred peer</h2>
<p>To preempt AP’s which are not connected to preferred peer to the preferred peer</p>
<pre><code>POST /api/v1/sites/:site_id/mxtunnels/:mxtunnel_id/preempt_aps
</code></pre>
<h3 id="response_186">Response</h3>
<pre><code>{
   "preempted_aps": ["5c5b35000001", "5c5b35000002"]
}
</code></pre>
<h1 id="ha-cluster_1">HA Cluster</h1>
<h2 id="form-a-new-ha-cluster">Form a New HA Cluster</h2>
<h3 id="create-a-ha-cluster">Create a HA Cluster</h3>
<pre><code>POST /api/v1/sites/:site_id/devices/:device_id/ha
{
    "nodes": [
        {
            "mac": "aff827549235" // node0, same as the mac of device_id
        },
        {
            "mac": "8396cd006c8c" // node1
        }
    ]
}
</code></pre>
<h3 id="delete-ha-cluster">Delete HA Cluster</h3>
<pre><code>DELETE /api/v1/sites/:site_id/devices/:device_id/ha
</code></pre>
<h2 id="count-by-distinct-attributes-of-applications">Count by Distinct Attributes of Applications</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/apps/count?distinct=services&amp;device_mac=&amp;app=Facebook&amp;wired=True
</code></pre>
<h3 id="parameters_112">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>For wireless devices - ‘ap’, ‘wcid’, ‘ssid’, ‘wlan_id’ ‘app’, default is ‘ap’. <br><br> For wired devices - ‘device_mac’, ‘wcid’, ‘src_ip’, ‘port_id’, ‘app’, ‘category’, ‘service’ , default is device_mac</td>
</tr>
<tr>
<td><code>device_mac</code></td>
<td><code>string</code></td>
<td>MAC of the device</td>
</tr>
<tr>
<td><code>app</code></td>
<td><code>string</code></td>
<td>Application name</td>
</tr>
<tr>
<td><code>wired</code></td>
<td><code>string</code></td>
<td>If a device is wired or wireless. Default is False.</td>
</tr>
</tbody>
</table>
<h3 id="response_187">Response</h3>
<pre><code>{
  "results": [
    {
      "service": "internet",
      "count": 4
    },
    {
      "service": "Corp.internet",
      "count": 4
    }
  ],
  "start": 1633046421.0,
  "end": 1636636504.0,
  "limit": 10,
  "distinct": "service",
  "total": 2
}
</code></pre>
<h2 id="search-calls">Search Calls</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/calls/search
</code></pre>
<h3 id="request_127">Request</h3>
<p>The following fields are available for searching.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>device identifier</td>
</tr>
<tr>
<td><code>app</code></td>
<td><code>string</code></td>
<td>Third party app name</td>
</tr>
</tbody>
</table>
<p>E.g. /api/v1/sites/:site_id/stats/calls/search?mac=001122334455&amp;app=zoom&amp;start=1511967600&amp;end=1513177200</p>
<h3 id="response_188">Response</h3>
<pre><code>{
    "start": 1511967600,
    "end": 1513177200,
    "limit": 10,
    "total": 100,
    "results": [
         {
          "app": "zoom",
          "end_time": 1665465341,
          "org_id": "85e1d87d-6541-4ebd-941a-272cac140948",
          "site_id": "a16fdfc0-8540-47ab-be59-9dd2d00e7c84",
          "meeting_id": 82126359919,
          "rating": 5,
          "start_time": 1665460836,
          "mac": "adf1c481b989",
          "audio_quality": 1,
          "video_quality": 2,
          "screen_share_quality": 3
        },
        {
          "app": "zoom",
          "end_time": 1665465339,
          "org_id": "0c160b7f-1027-4cd1-923b-744534c4b070",
          "site_id": "a16fdfc0-8540-47ab-be59-9dd2d00e7c84",
          "meeting_id": 87578079426,
          "rating": 4,
          "start_time": 1665460914,
          "mac": "983a78ea4a44",
          "audio_quality": 3,
          "video_quality": 1,
          "screen_share_quality": 4
        },
        {
          "app": "zoom",
          "end_time": 1665465339,
          "org_id": "0c160b7f-1027-4cd1-923b-744534c4b070",
          "site_id": "a16fdfc0-8540-47ab-be59-9dd2d00e7c84",
          "meeting_id": 97588079429,
          "rating": 3,
          "start_time": 1665460850,
          "mac": "25e9ddf8b1b9",
          "audio_quality": 4,
          "video_quality": 2,
          "screen_share_quality": 1
        },
        ...
    ]
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-calls">Count by Distinct Attributes of Calls</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/calls/count
</code></pre>
<h3 id="request_128">Request</h3>
<p>In addition to the filters that you can have in the search</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>mac</td>
</tr>
<tr>
<td><code>rating</code></td>
<td><code>list</code></td>
<td>feedback rating between 1-5</td>
</tr>
</tbody>
</table>
<p>NOTE: the filters from /stats/calls/search can also be used. (E.g. <code>/stats/calls/count?distinct=mac&amp;app=zoom&amp;mac=112233445566&amp;start=1511967600&amp;end=1513177200&amp;rating=1,2</code>)</p>
<h3 id="response_189">Response</h3>
<pre><code>{
    "start": 1511967600,
    "end": 1513177200,
    "limit": 100,
    "distinct": "mac",
    "total": 20,
    "results": [
        {
            "count": 217,
            "mac": "112233445566"
        }
        ...
    ]
}
</code></pre>
<h2 id="troubleshoot-a-call">Troubleshoot a call</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/calls/client/:mac/troubleshoot?meeting_id=87578079426
</code></pre>
<h3 id="request_129">Request</h3>
<p>In addition to the filters that you can have in the search</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>meeting_id</code></td>
<td><code>string</code></td>
<td>meeting_id, required</td>
</tr>
</tbody>
</table>
<h3 id="response_190">Response</h3>
<pre><code>{
    "mac": "983a78ea4a44",
    "meeting_id": 87578079426,

    "results": [
        {
            "timestamp": 1695425115,

            // latencies contributors
            "audio_in": {
                "expected": 30.941595,
                "client_tx_bytes": 0.15803306,
                "client_n_streams": 0.15803306,
                "client_wifi_version": 0.18267937,
                "client_rssi": -1.0839354,
                "client_radio_band": 0.5576923,
                "client_tx_rates": 0.62357205,
                "client_rx_bytes": 2.2622051,
                "client_tx_retries": 0.77553505,
                "client_rx_rates": 0.26726437,
                "client_tx_bytes": 6.6164713,
                "client_tx_retries": 1.702031,
                "client_vpn_distaince": 1.6474955,  // when client is connected to an AP in a site but connected to VPN server far away
                "client_cpu": 3.7028809,
                "ap_rtt": 0.16559607,
                "ap_num_clients": -0.6565111,
                "radio_bandwidth": -0.06538621,
                "radio_channel": -0.73391086,
                "radio_util": 12.770318,
                "radio_util_interference": -3.079999,
                "radio_tx_power": 0.10027129,
                "site_num_clients": 0.017364305,
                "wan_rtt": 46.77899,
                "wan_jitter": 5.9680853,
                "wan_avg_download_mbps": 1.4803165,
                "wan_avg_upload_mbps": -0.038184267,
                "wan_max_download_mbps": 1.4803165,
                "wan_max_upload_mbps": -0.038184267,
            },
            "audio_out": { ... },
            "video_in": { ... },
            "video_out": { ... }            
        }
    ]
}
</code></pre>
<h2 id="summary-of-calls-troubleshooting">Summary of calls troubleshooting</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/calls/troubleshoot?start=1531776183&amp;end=1531862583&amp;ap=:mac
</code></pre>
<h3 id="request_130">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>start</code></td>
<td><code>int</code></td>
<td>Start time</td>
</tr>
<tr>
<td><code>end</code></td>
<td><code>int</code></td>
<td>End time</td>
</tr>
<tr>
<td><code>ap</code></td>
<td><code>string</code></td>
<td>AP MAC, optional</td>
</tr>
</tbody>
</table>
<h3 id="response_191">Response</h3>
<pre><code>{
    "start" : 1531776183,
    "end" : 1531862583,
    "count": 245,

    // average latencies contributor
    "audio_out": {
            "client_tx_rates": 10.668423069847954,
            "client_tx_bytes": 1.8379177401463191,
            "client_tx_retries": 43.323209603627525,
            "site_wan_upload_mpbs": -0.8131117953194512,
            "site_wan_avg_upload_mpbs": -0.988989942603641,
            "ap_num_clients": 45.48306793636746,
            "client_rssi": 17.251008563571506,
            "ap_rtt": 6.352042701509264,
            "radio_bandwidth": -0.1533682727151447,
            "radio_channel": 0.662909648484654,
            "radio_util": 27.891777674357098,
            "client_radio_band": 1.5325644097982958e-06,
            "radio_util_interference": 4.38913492154744,
            "site_wan_rtt": 15.094849904378256,
            "site_wan_jitter": 0.7875519659784105,
            "client_cpu": 9.323452578650581,
            "site_num_clients": -0.2855822932389047,
            "client_vpn_distance": 112.4420166015625,
            "expected": 29.74261474609375,
        },
    "audio_in": { ... },
    "video_out": { ... },
    "video_in": { ... },
}
</code></pre>
<h2 id="calls-aggregation-stats">Calls aggregation stats</h2>
<pre><code>GET /api/v1/sites/:site_id/stats/calls/summary?start=1531776183&amp;end=1531862583&amp;ap_mac=:mac
</code></pre>
<h3 id="request_131">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>start</code></td>
<td><code>int</code></td>
<td>Start time</td>
</tr>
<tr>
<td><code>end</code></td>
<td><code>int</code></td>
<td>End time</td>
</tr>
<tr>
<td><code>ap_mac</code></td>
<td><code>string</code></td>
<td>AP MAC, optional</td>
</tr>
<tr>
<td><code>app</code></td>
<td><code>string</code></td>
<td>app name (zoom or teams). default is both. Optional</td>
</tr>
</tbody>
</table>
<h3 id="response_192">Response</h3>
<pre><code>{
    "num_users": 3,
    "num_aps": 1,
    "total_minutes": 575217.0,
    "bad_minutes": 5566.0,
    "bad_minutes_site_wan": 3612.0,
    "bad_minutes_wireless": 1428.0,
    "bad_minutes_client": 526.0
}
</code></pre>
<h1 id="auto-ap-placement-and-orientation">Auto AP Placement and orientation</h1>
<h2 id="post-run-auto-placement-for-map">POST Run Auto placement for Map</h2>
<pre><code>POST /api/v1/sites/:site_id/maps/:map_id/auto_placement
</code></pre>
<h3 id="request-payload_1">Request Payload</h3>
<pre><code>{
    "macs": [&lt;list of device macs&gt;, ...],
    "force_collection": true,
    "override": false,
    "dryrun": false, 
}
</code></pre>
<h3 id="parameters_113">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>macs</code></td>
<td><code>list</code></td>
<td>Optional list of MAC addresses to filter map devices by.</td>
</tr>
<tr>
<td><code>force_collection</code></td>
<td><code>boolean</code></td>
<td>Set to <code>true</code> to recollect auto placement data; set to <code>false</code> to rerun the localizer on existing FTM data.</td>
</tr>
<tr>
<td><code>override</code></td>
<td><code>boolean</code></td>
<td>Set to <code>true</code> to run auto placement even if there are invalid APs in the selected APs.</td>
</tr>
<tr>
<td><code>dryrun</code></td>
<td><code>boolean</code></td>
<td>Set to <code>true</code> to perform an invalid AP check and provide an estimated run time without enqueuing the run into the auto placement service.</td>
</tr>
</tbody>
</table>
<h3 id="usage_1">Usage</h3>
<p>This API is called to trigger auto placement for a map. For the auto placement feature to work, RTT-FTM data needs to be collected from the APs on the map. This scan is disruptive, and users must be notified of service disruption during the auto placement process. Repeated POST requests to this endpoint while a map is still running will be rejected.</p>
<p><code>force_collection</code> is set to <code>false</code> by default. If <code>force_collection</code> is set to <code>false</code>, the API attempts to start localization with existing data. If no data exists, the API attempts to start orchestration. If <code>force_collection</code> is set to <code>true</code>, the API attempts to start orchestration.</p>
<p>Providing a list of devices is optional. If provided, autoplacement suggestions will be made only for the specified devices. If no list is provided, all APs associated with the map are considered by default.</p>
<h3 id="responses">Responses</h3>
<h4 id="http-status-200-dryrun-for-map-completed">HTTP Status 200 - Dryrun for map completed</h4>
<pre><code>{
    "valid": true,
    "reason": "Map has met the minimum requirements for auto placement",
    "devices": {
        "00000000001": {
            "valid": true
        },
        "00000000002": {
            "valid": true
        },
        "00000000003": {
            "valid": true
        }
    },
    "estimated_runtime" : 30,
    "wifi_interrupting": false
}
</code></pre>
<h4 id="http-status-200-service-started-successfully-for-localization-orchestration">HTTP Status 200 - Service started successfully for localization / orchestration</h4>
<pre><code>{
    "started": true,
    "valid": true,
    "reason": "Started localization for auto placement",
    "devices": {
        "00000000001": {
            "valid": true
        },
        "00000000002": {
            "valid": true
        },
        "00000000003": {
            "valid": true
        }
    }
}
</code></pre>
<pre><code>{
    "started": true,
    "valid": true,
    "reason": "Started collection for auto placement",
    "devices": {
        "00000000001": {
            "valid": true
        },
        "00000000002": {
            "valid": true
        },
        "00000000003": {
            "valid": true
        }
    },
    "estimated_runtime": 30,
    "wifi_interrupting": true
}
</code></pre>
<h4 id="http-status-200-service-started-after-override-for-localization-orchestration">HTTP Status 200 - Service started after override for localization / orchestration</h4>
<pre><code>{
    "started": true,
    "valid": false,
    "reason": "Started localization for auto placement",
    "devices": {
        "00000000001": {
            "valid": true
        },
        "00000000002": {
            "valid": true
        },
        "00000000003": {
            "valid": true
        },
        "00000000004": {
            "valid": false,
            "reason": "Device model AP41 is not supported for auto placement"
        },
        "00000000005": {
            "valid": false,
            "reason": "Device firmware 0.14.28300 does not meet the minimum requirement 0.14.28310"
        }
    }
}
</code></pre>
<pre><code>{
    "started": true,
    "valid": false,
    "reason": "Started collection for auto placement",
    "devices": {
        "00000000001": {
            "valid": true
        },
        "00000000002": {
            "valid": true
        },
        "00000000003": {
            "valid": true
        },
        "00000000004": {
            "valid": false,
            "reason": "Device model AP41 is not supported for auto placement"
        },
        "00000000005": {
            "valid": false,
            "reason": "Device firmware 0.14.28300 does not meet the minimum requirement 0.14.28310"
        }
    },
    "estimated_runtime": 30,
    "wifi_interrupting": false
}
</code></pre>
<h4 id="http-status-200-service-failed-to-start-due-containing-invalid-aps">HTTP Status 200 - Service failed to start due containing invalid APs</h4>
<pre><code>{
    "started": false,
    "valid": false,
    "reason": "Map has APs that do not meet the minimum requirements for auto placement",
    "devices": {
        "00000000001": {
            "valid": true
        },
        "00000000002": {
            "valid": true
        },
        "00000000003": {
            "valid": true
        },
        "00000000004": {
            "valid": false,
            "reason": "Device model AP41 is not supported for auto placement"
        },
        "00000000005": {
            "valid": false,
            "reason": "Device firmware 0.14.28300 does not meet the minimum requirement 0.14.28310"
        }
    }
}
</code></pre>
<h4 id="http-status-200-map-failed-to-start-as-it-had-less-than-3-aps-associated-with-it">HTTP Status 200 - Map failed to start as it had less than 3 APs associated with it</h4>
<pre><code>{
    "started": false,
    "valid": false,
    "reason": "Map has less than 3 APs associated with it to perform auto placement",
    "devices": {}
}
</code></pre>
<h4 id="http-status-200-auto-placement-is-already-in-progress-for-this-map">HTTP Status 200 - Auto placement is already in progress for this map</h4>
<pre><code>{
    "started": false,
    "valid": true,
    "reason": "Map Already Enqueued",
    "devices": {
        "00000000001": {
            "valid": true
        },
        "00000000002": {
            "valid": true
        },
        "00000000003": {
            "valid": true
        }
    },
    "estimated_runtime" : 30
}
</code></pre>
<h4 id="http-status-200-unable-to-reach-the-autoplacement-service">HTTP Status 200 - Unable to reach the autoplacement service</h4>
<pre><code>{
    "started": false,
    "valid": true,
    "reason": "Unable to reach auto placement service",
    "devices": {
        "00000000001": {
            "valid": true
        },
        "00000000002": {
            "valid": true
        },
        "00000000003": {
            "valid": true
        }
    },
    "estimated_runtime" : 30
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>started</code></td>
<td><code>boolean</code></td>
<td>Indicates whether the autoplacement process has started.</td>
</tr>
<tr>
<td><code>valid</code></td>
<td><code>boolean</code></td>
<td>Indicates whether the autoplacement request is valid.</td>
</tr>
<tr>
<td><code>reason</code></td>
<td><code>string</code></td>
<td>Provides the reason for the status.</td>
</tr>
<tr>
<td><code>devices</code></td>
<td><code>object</code></td>
<td>Contains the validation status of each device.</td>
</tr>
<tr>
<td><code>estimated_runtime</code></td>
<td><code>int</code></td>
<td>Estimated runtime for the process in seconds.</td>
</tr>
<tr>
<td><code>wifi_interrupting</code></td>
<td><code>boolean</code></td>
<td>Indicates whether running collection disrupt WIFI service for map.</td>
</tr>
</tbody>
</table>
<p>NOTE: If all APs are both FTM and UWB capable, FTM valid is disabled to prevent interruption of WIFI service.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>valid</code></td>
<td><code>boolean</code></td>
<td>Indicates whether the ap is valid.</td>
</tr>
<tr>
<td><code>reason</code></td>
<td><code>string</code></td>
<td>Provides the reason for the status if the AP is invalid.</td>
</tr>
</tbody>
</table>
<h2 id="get-auto-placement-status-details-for-map">GET Auto placement status details for Map</h2>
<pre><code>GET /api/v1/sites/:site_id/maps/:map_id/auto_placement
</code></pre>
<h3 id="usage_2">Usage</h3>
<p>This API is called to view the current status of auto placement for a given map.</p>
<h3 id="response_193">Response</h3>
<pre><code>{
    "status": "done",
    "start_time": 1678900062,
    "stop_time": 1678900362,
}
</code></pre>
<pre><code>    "status": "inprogress",
    "start_time": 1678900062,
    "est_time_left": 0.0,
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>status</code></td>
<td><code>String</code></td>
<td>the status of autoplacement for a given map</td>
</tr>
<tr>
<td><code>start_time</code></td>
<td><code>float</code></td>
<td>time when autoplacement process was last queued for this map</td>
</tr>
<tr>
<td><code>est_time_left</code></td>
<td><code>float</code></td>
<td>(Only when inprogress) estimate of the time to completion</td>
</tr>
<tr>
<td><code>stop_time</code></td>
<td><code>float</code></td>
<td>time when autoplacement completed or was manually stopped</td>
</tr>
</tbody>
</table>
<h4 id="status-descriptions">Status Descriptions</h4>
<table>
<thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pending</code></td>
<td>Autoplacement has not been requested for this map</td>
</tr>
<tr>
<td><code>inprogress</code></td>
<td>Autoplacement is currently processing</td>
</tr>
<tr>
<td><code>done</code></td>
<td>The autoplacement process has completed</td>
</tr>
<tr>
<td><code>data_needed</code></td>
<td>Additional position data is required for autoplacement. Users should verify the requested anchor APs have a position on the map</td>
</tr>
<tr>
<td><code>invalid_model</code></td>
<td>Autoplacement is not supported on the model of the APs on the map</td>
</tr>
<tr>
<td><code>invalid_version</code></td>
<td>Autoplacement is not supported with the APs current firmware version</td>
</tr>
<tr>
<td><code>error</code></td>
<td>There was an error in the autoplacement process</td>
</tr>
</tbody>
</table>
<h2 id="delete-auto-placement-for-map">DELETE Auto placement for Map</h2>
<pre><code>DELETE /api/v1/sites/:site_id/maps/:map_id/auto_placement
</code></pre>
<h3 id="usage_3">Usage</h3>
<p>This API is called to force stop auto placement for a given map</p>
<h3 id="responses_1">Responses</h3>
<ul>
<li><code>400 Bad Request</code> - Autoplacement was not triggered</li>
<li><code>200, Success</code> - Autoplacement Process has stopped for this map</li>
</ul>
<h2 id="post-a-map_id-for-auto-orientation">POST a map_id for auto orientation</h2>
<pre><code>POST /api/v1/sites/:site_id/maps/:map_id/auto_orient
</code></pre>
<h3 id="request-payload_2">Request Payload</h3>
<pre><code>{
    "macs": [&lt;list of device macs&gt;, ...],
    "force_collection": true,
    "override": false,
    "dryrun": false
}
</code></pre>
<h3 id="parameters_114">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>macs</code></td>
<td><code>list</code></td>
<td>Optional list of MAC addresses to filter map devices by.</td>
</tr>
<tr>
<td><code>force_collection</code></td>
<td><code>boolean</code></td>
<td>Set to <code>true</code> to recollect auto orient data; set to <code>false</code> to rerun auto orient on existing run results.</td>
</tr>
<tr>
<td><code>override</code></td>
<td><code>boolean</code></td>
<td>Set to <code>true</code> to run auto orient even if there are invalid APs in the selected APs.</td>
</tr>
<tr>
<td><code>dryrun</code></td>
<td><code>boolean</code></td>
<td>Set to <code>true</code> to perform an invalid AP check and provide an estimated run time without enqueuing the run into the auto orient service.</td>
</tr>
</tbody>
</table>
<h3 id="usage_4">Usage</h3>
<p>This API is called to trigger a map for auto orient. For auto orient feature to work, BLE data needs to be collected from the APs on the map. This precess is not disruptive unlike FTM collection.
Repeated POST requests to this endpoint while a map is still running will be rejected.</p>
<p><code>force_collection</code> is set to <code>false</code> by default. If <code>force_collection</code> is set to <code>false</code>, the API attempts to start orientation with existing data. If no data exists, the API attempts to start collecting orientation data. If <code>force_collection</code> is set to <code>true</code>, the API attempts to start collecting orientation data.</p>
<p>Providing a list of device macs is optional. If provided, auto orientation suggestions will be made only for the specified devices. If no list is provided, all APs associated with the map are considered by default.</p>
<h3 id="responses_2">Responses</h3>
<h4 id="http-status-200-dryrun-for-map-completed_1">HTTP Status 200 - Dryrun for map completed</h4>
<pre><code>{
    "valid": true,
    "reason": "Map has met the minimum requirements for auto orient",
    "devices": {
        "00000000001": {
            "valid": true
            "reason": "Device meets the minimum requirements for auto orient"
        },
        "00000000002": {
            "valid": true
            "reason": "Device meets the minimum requirements for auto orient"
        },
        "00000000003": {
            "valid": true
            "reason": "Device meets the minimum requirements for auto orient"
        }
    },
    "estimated_runtime" : 300
}
</code></pre>
<h4 id="http-status-200-service-started-successfully-for-localization-orient-collection">HTTP Status 200 - Service started successfully for localization / orient collection</h4>
<pre><code>{
    "started": true,
    "valid": true,
    "reason": "Started localization for auto orient",
    "devices": {
        "00000000001": {
            "valid": true
        },
        "00000000002": {
            "valid": true
        },
        "00000000003": {
            "valid": true
        }
    },
}
</code></pre>
<pre><code>{
    "started": true,
    "valid": true,
    "reason": "Started collection for auto orient",
    "devices": {
        "00000000001": {
            "valid": true
        },
        "00000000002": {
            "valid": true
        },
        "00000000003": {
            "valid": true
        }
    },
    "estimated_runtime" : 300
}
</code></pre>
<h4 id="http-status-200-service-started-after-override-for-localization-orient-collection">HTTP Status 200 - Service started after override for localization / orient collection</h4>
<pre><code>{
    "started": true,
    "valid": false,
    "reason": "Started localization for auto orient",
    "devices": {
        "00000000001": {
            "valid": true
        },
        "00000000002": {
            "valid": true
        },
        "00000000003": {
            "valid": true
        },
        "00000000004": {
            "valid": false,
            "reason": "Device model AP32 is not supported for auto orient"
        },
        "00000000005": {
            "valid": false,
            "reason": "Device firmware 0.14.28300 does not meet the minimum requirement 0.14.28310"
        }
    }
}
</code></pre>
<pre><code>{
    "started": true,
    "valid": false,
    "reason": "Started collection for auto orient",
    "devices": {
        "00000000001": {
            "valid": true
        },
        "00000000002": {
            "valid": true
        },
        "00000000003": {
            "valid": true
        },
        "00000000004": {
            "valid": false,
            "reason": "Device model AP32 is not supported for auto orient"
        },
        "00000000005": {
            "valid": false,
            "reason": "Device firmware 0.14.28300 does not meet the minimum requirement 0.14.28310"
        }
    },
    "estimated_runtime" : 300
}
</code></pre>
<h4 id="http-status-200-service-failed-to-start-due-containing-invalid-aps_1">HTTP Status 200 - Service failed to start due containing invalid APs</h4>
<pre><code>{
    "started": false,
    "valid": false,
    "reason": "Map has APs that do not meet the minimum requirements for auto orient",
    "devices": {
        "00000000001": {
            "valid": true
        },
        "00000000002": {
            "valid": true
        },
        "00000000003": {
            "valid": true
        },
        "00000000004": {
            "valid": false,
            "reason": "Device model AP41 is not supported for auto orient"
        },
        "00000000005": {
            "valid": false,
            "reason": "Device firmware 0.14.28300 does not meet the minimum requirement 0.14.28310"
        }
    }
}
</code></pre>
<h4 id="http-status-200-map-failed-to-start-as-it-had-less-than-3-aps-associated-with-it_1">HTTP Status 200 - Map failed to start as it had less than 3 APs associated with it</h4>
<pre><code>{
    "started": false,
    "valid": false,
    "reason": "Map has less than 3 APs associated with it to perform auto orient",
    "devices": {}
}
</code></pre>
<h4 id="http-status-200-auto-orient-is-already-in-progress-for-this-map">HTTP Status 200 - Auto orient is already in progress for this map</h4>
<pre><code>{
    "started": false,
    "valid": true,
    "reason": "Map Already Enqueued",
    "devices": {
        "00000000001": {
            "valid": true
        },
        "00000000002": {
            "valid": true
        },
        "00000000003": {
            "valid": true
        }
    },
    "estimated_runtime" : 300
}
</code></pre>
<h4 id="http-status-200-unable-to-reach-the-orient-service">HTTP Status 200 - Unable to reach the orient service</h4>
<pre><code>{
    "started": false,
    "valid": true,
    "reason": "Unable to reach auto orient service",
    "devices": {
        "00000000001": {
            "valid": true
        },
        "00000000002": {
            "valid": true
        },
        "00000000003": {
            "valid": true
        }
    },
    "estimated_runtime" : 300
}
</code></pre>
<h3 id="response-definitions_4">Response Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>started</code></td>
<td><code>boolean</code></td>
<td>Indicates whether the auto orient process has started.</td>
</tr>
<tr>
<td><code>valid</code></td>
<td><code>boolean</code></td>
<td>Indicates whether the auto orient request is valid.</td>
</tr>
<tr>
<td><code>reason</code></td>
<td><code>string</code></td>
<td>Provides the reason for the status.</td>
</tr>
<tr>
<td><code>devices</code></td>
<td><code>object</code></td>
<td>Contains the validation status of each device.</td>
</tr>
<tr>
<td><code>estimated_runtime</code></td>
<td><code>int</code></td>
<td>Estimated runtime for the process in seconds.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>valid</code></td>
<td><code>boolean</code></td>
<td>Indicates whether the ap is valid.</td>
</tr>
<tr>
<td><code>reason</code></td>
<td><code>string</code></td>
<td>Provides the reason for the status if the AP is invalid.</td>
</tr>
</tbody>
</table>
<h2 id="get-get-status-for-auto-orientation">GET Get status for Auto Orientation</h2>
<pre><code>GET /internal/sites/:site_id/maps/:map_id/auto_orient
</code></pre>
<h3 id="usage_5">Usage</h3>
<p>This API is called to view the current status of auto orient for a given map.</p>
<h3 id="response_194">Response</h3>
<pre><code>{
    "status": "done",
    "start_time": 1678900062,
    "stop_time": 1678900362,
}
</code></pre>
<pre><code>    "status": "inprogress",
    "start_time": 1678900062,
    "est_time_left": 300.0,
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>status</code></td>
<td><code>String</code></td>
<td>the status of auto orient for a given map</td>
</tr>
<tr>
<td><code>start_time</code></td>
<td><code>float</code></td>
<td>time when auto orient process was last queued for this map</td>
</tr>
<tr>
<td><code>est_time_left</code></td>
<td><code>float</code></td>
<td>(Only when inprogress) estimate of the time to completion</td>
</tr>
<tr>
<td><code>stop_time</code></td>
<td><code>float</code></td>
<td>time when auto orient completed or was manually stopped</td>
</tr>
</tbody>
</table>
<h4 id="status-descriptions_1">Status Descriptions</h4>
<table>
<thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pending</code></td>
<td>Auto orient has not been requested for this map</td>
</tr>
<tr>
<td><code>inprogress</code></td>
<td>Auto orient is currently processing</td>
</tr>
<tr>
<td><code>done</code></td>
<td>The auto orient process has completed</td>
</tr>
<tr>
<td><code>error</code></td>
<td>There was an error in the auto orient process</td>
</tr>
</tbody>
</table>
<h2 id="delete-a-map_id-for-auto-orientation">DELETE a map_id for auto orientation</h2>
<pre><code>DELETE /api/v1/sites/:site_id/maps/:map_id/auto_orient
</code></pre>
<h3 id="usage_6">Usage</h3>
<p>This API is used to cancel Auto Orientation for a map</p>
<h3 id="responses_3">Responses</h3>
<ul>
<li><code>400 Bad Request</code> - Auto orient was not triggered</li>
<li><code>200, Success</code> - Auto orient process has stopped for this map</li>
</ul>
<h2 id="post-a-list-of-mac-addresses-to-accept-or-reject-localization-data">POST a list of mac addresses to accept or reject localization data</h2>
<pre><code>POST /api/v1/sites/:site_id/maps/:map_id/use_auto_ap_values
</code></pre>
<h3 id="request-payload_3">Request Payload</h3>
<pre><code>{
    "for": "placement",
    "accept": true,
    "macs": [&lt;list of device macs&gt;],
}
</code></pre>
<pre><code>    "for": "orientation",
    "accept": false,
    "macs": [&lt;list of device macs&gt;],
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>for</code></td>
<td><code>String</code></td>
<td>The selector to choose auto placement or auto orientation. default: placement</td>
</tr>
<tr>
<td><code>accept</code></td>
<td><code>bool</code></td>
<td>If accept is true, accepts placement for devices in list otherwise. If false, reject for devices in list. default: false</td>
</tr>
<tr>
<td><code>device_macs</code></td>
<td><code>list</code></td>
<td>A list of macs to accept/reject. If a list is not provided the API will accept/reject for the full map.</td>
</tr>
</tbody>
</table>
<h3 id="usage_7">Usage</h3>
<p>This API is used to accept or reject the cached autoplacement and auto-orientation values of a map or subset of APs on a map. Any APs that have autoplacement values are stored in cache for up to 7 days while awaiting acceptance or rejection.</p>
<pre><code>Accepting the autoplacement values overwrites the existing X, Y, and orientation of the accepted APs with their cached autoplacement values.
Rejecting the autoplacement values causes the APs to retain their current X, Y, and orientation.
</code></pre>
<p>Once a decision (accept or reject) is made, or the 7-day time-to-live (TTL) expires, the cached values are deleted.</p>
<h3 id="responses_4">Responses</h3>
<ul>
<li><code>400 Bad Request</code> - Map does not exist or belong to specified site</li>
<li><code>400 Bad Request</code> - Invalid localization service. Expected [placement, orientation]</li>
<li><code>200, Success</code></li>
</ul>
<h2 id="post-a-list-of-mac-addresses-to-clear-auto-placement-data">POST a list of mac addresses to clear auto placement data</h2>
<pre><code>POST /api/v1/sites/:site_id/maps/:map_id/clear_autoplacement
</code></pre>
<h3 id="request-payload_4">Request Payload</h3>
<pre><code>{
    "macs": [&lt;list of device macs&gt;, ...]
}
</code></pre>
<h3 id="usage_8">Usage</h3>
<p>This API is used to destroy the cached autoplacement locations of a map or subset of APs on a map.</p>
<h3 id="responses_5">Responses</h3>
<ol>
<li>200 Success</li>
</ol>
<h2 id="post-a-list-of-mac-addresses-to-clear-auto-orientation-data">POST a list of mac addresses to clear auto orientation data</h2>
<pre><code>POST /api/v1/sites/:site_id/maps/:map_id/clear_auto_orient
</code></pre>
<h3 id="request-payload_5">Request Payload</h3>
<pre><code>{
    "macs": [&lt;list of device macs&gt;, ...]
}
</code></pre>
<h3 id="usage_9">Usage</h3>
<p>This API is used to destroy the autoorientations of a map or subset of APs on a map.</p>
<h3 id="responses_6">Responses</h3>
<ol>
<li>200 Success</li>
</ol>
<h2 id="search-otherdevices-events">Search OtherDevices Events</h2>
<pre><code>GET /api/v1/sites/:site_id/otherdevices/events/search?mac=4c9614a78e00
</code></pre>
<h3 id="supported-filters_2">Supported Filters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>mac</td>
</tr>
<tr>
<td><code>device_mac</code></td>
<td><code>string</code></td>
<td>mac of attached device</td>
</tr>
<tr>
<td><code>vendor</code></td>
<td><code>string</code></td>
<td>vendor name</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>event type</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>device model</td>
</tr>
</tbody>
</table>
<h3 id="response_195">Response</h3>
<pre><code>{
    "results": [
        {
            "org_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862a",
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "vendor": "cradlepoint",
            "mac": "5c5b351e13b5",
            "device_mac": "5c5b351e13b5",
            "text": "Plugged: The Internal 5GB (SIM1) has been inserted into Internal 1.",
            "timestamp": 1547235620.89,
            "type": "CELLULAR_EDGE_MODEM_WAN_PLUGGED",
            "model": "W1850"
        },
        ...
    ]
}

</code></pre>
<h2 id="count-otherdevices-events">Count OtherDevices Events</h2>
<pre><code>GET /api/v1/sites/:site_id/otherdevices/events/count?distinct=mac
</code></pre>
<h3 id="response_196">Response</h3>
<pre><code>{
    "end": 1545874660.211871,
    "distinct": "mac",
    "results": [
        {
            "count": 22,
            "mac": "0030448c6e40"
        }
    ],
    "start": 1545788260.21184,
    "limit": 10,
    "total": 1
}
</code></pre>
<h2 id="search-wan-usages">Search WAN Usages</h2>
<pre><code>GET /api/v1/sites/:site_id/wan_usages/search
</code></pre>
<h3 id="request_132">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>MAC address</td>
</tr>
<tr>
<td><code>peer_mac</code></td>
<td><code>string</code></td>
<td>Peer MAC address</td>
</tr>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>Port ID for the device</td>
</tr>
<tr>
<td><code>peer_port_id</code></td>
<td><code>string</code></td>
<td>Peer Port ID for the device</td>
</tr>
<tr>
<td><code>policy</code></td>
<td><code>string</code></td>
<td>policy for the wan path</td>
</tr>
<tr>
<td><code>tenant</code></td>
<td><code>string</code></td>
<td>tenant network in which the packet is sent</td>
</tr>
<tr>
<td><code>path_type</code></td>
<td><code>string</code></td>
<td>path_type of the port</td>
</tr>
<tr>
<td>### Response</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<pre><code>{
  "results": [
    {
        "mac": "5c5b35000001",
        "port_id": "ge-0/0/0.0",
        "path_weight" : 10,
        "policy": "policy1",
        "tenant": "tenant1",
        "path_type": "vpn",
        "peer_mac": "0200018c95e1",
        "peer_port_id": "ge-0/0/3",
    }
  ]
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-wan-port">Count by Distinct Attributes of wan port</h2>
<pre><code>GET /api/v1/sites/:site_id/wan_usages/count
</code></pre>
<h3 id="request_133">Request</h3>
<p>In addition to the filters that you can have in the search</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>MAC address</td>
</tr>
<tr>
<td><code>peer_mac</code></td>
<td><code>string</code></td>
<td>Peer MAC address</td>
</tr>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>Port ID for the device</td>
</tr>
<tr>
<td><code>peer_port_id</code></td>
<td><code>string</code></td>
<td>Peer Port ID for the device</td>
</tr>
<tr>
<td><code>policy</code></td>
<td><code>string</code></td>
<td>policy for the wan path</td>
</tr>
<tr>
<td><code>tenant</code></td>
<td><code>string</code></td>
<td>tenant network in which the packet is sent</td>
</tr>
<tr>
<td><code>path_type</code></td>
<td><code>string</code></td>
<td>path_type of the port</td>
</tr>
</tbody>
</table>
<h3 id="response_197">Response</h3>
<pre><code>{
    "start": 1511967600,
    "end": 1513177200,
    "limit": 100,
    "distinct": "mac",
    "total": 20,
    "results": [
        {
            "count": 217,
            "Policy": "P1"
        }
    ]
}
</code></pre>
<h2 id="search-wan-clients">Search WAN Clients</h2>
<pre><code>GET /api/v1/sites/:site_id/wan_clients/search
</code></pre>
<h3 id="request_134">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>partial / full MAC address</td>
</tr>
<tr>
<td><code>hostname</code></td>
<td><code>string</code></td>
<td>partial / full hostname</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>client IP</td>
</tr>
<tr>
<td><code>mfg</code></td>
<td><code>string</code></td>
<td>Manufacture</td>
</tr>
<tr>
<td><code>network</code></td>
<td><code>string</code></td>
<td>network</td>
</tr>
<tr>
<td><code>ip_src</code></td>
<td><code>string</code></td>
<td>IP source</td>
</tr>
</tbody>
</table>
<h3 id="response_198">Response</h3>
<pre><code>{
  "results": [
    {
      "wcid": "8bbe7389-212b-c65d-2208-00fab2017936",
      "hostname": [
        "sonoszp"
      ],
      "ip": [
        "192.168.1.139",
        "192.168.1.122"
      ],
      "mfg": "Sonos",
      "last_hostname": "sonoszp",
      "timestamp": 1718791390,
      "org_id": "b4e16c72-d50e-4c03-a952-a3217e231e2c",
      "site_id": "f688779c-e335-4f88-8d7c-9c5e9964528b",
      "last_ip": "192.168.1.139",
      "network": "lan",
      "ip_src": "dhcp",
      "dhcp_expire_time": 1718798190,
      "dhcp_start_time": 1718788190
    },
    {
      "hostname": [
        "inband-management",
      ],
      "ip": [
        "169.254.127.127"
      ],
      "last_hostname": "inband-management",
      "When": "2022-12-31T23:59:43.497+0000",
      "org_id": "b4e16c72-d50e-4c03-a952-a3217e231e2c",
      "site_id": "f688779c-e335-4f88-8d7c-9c5e9964528b",
      "last_ip": "169.254.127.127"
    }
  ]
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-wan-clients">Count by Distinct Attributes of WAN Clients</h2>
<pre><code>GET /api/v1/sites/:site_id/wan_clients/count?distinct=mfg
</code></pre>
<h3 id="request_135">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>hostname, ip, mfg, network, default is mac</td>
</tr>
</tbody>
</table>
<h3 id="response_199">Response</h3>
<pre><code>{
    "start": 1511967600,
    "end": 1513177200,
    "limit": 10,
    "distinct": "device",

    "total": 2,
    "results": [
        {
            "mfg": "Apple",
            "count": 61
        },
        {
            "mfg": "Sonos",
            "count": 44
        }
    ]
}
</code></pre>
<h2 id="search-wan-client-events">Search WAN Client Events</h2>
<pre><code>GET /api/v1/sites/:site_id/wan_clients/events/search
</code></pre>
<h3 id="request_136">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>Event type, e.g. CLIENT_IP_ASSIGNED, CLIENT_IP_RENEWED, CLIENT_IP_EXPIRED</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>partial / full MAC address</td>
</tr>
<tr>
<td><code>hostname</code></td>
<td><code>string</code></td>
<td>partial / full hostname</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>client IP</td>
</tr>
<tr>
<td><code>mfg</code></td>
<td><code>string</code></td>
<td>Manufacture</td>
</tr>
</tbody>
</table>
<h3 id="response_200">Response</h3>
<pre><code>{
  "start": 1512572151,
  "end": 1513176951,
  "limit": 10,
  "total": 1,
  'results': [
    {
      "When": "2022-12-31T23:59:59.293Z",
      "org_id": "b0b9f142-aaba-11e6-aafc-0242ac110002",
      "site_id": "fc656275-b157-43fd-b922-5f4f341c19bf",
      "wcid": "62bbfb75-10d8-49d1-dec7-d2df91624287",
      "random_mac": False,
      "ev_type": "CLIENT_IP_ASSIGNED",
      "text": "DHCP Ack IP 192.168.88.216",
      "metadata": {
        "client_ip": "192.168.88.216",
        "expiration": 1672823632.127
      }
    }
  ]
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-wan-client-events">Count by Distinct Attributes of WAN Client-Events</h2>
<pre><code>GET /api/v1/sites/:site_id/wan_client/events/count?distinct=type
</code></pre>
<h3 id="request_137">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>type, hostname, ip, mfg, mac</td>
</tr>
</tbody>
</table>
<h3 id="response_201">Response</h3>
<pre><code>{
  "start": 1513276353,
  "end": 1513362753,
  "limit": 3,
  "total": 3,
  "results": [
    {
      "type": "CLIENT_IP_ASSIGNED",
      "count": 4
    },
    {
      "type": "CLIENT_IP_RENEWED",
      "count": 2
    },
    {
      "type": "CLIENT_IP_EXPIRED",
      "count": 2
    }
  ]
}
</code></pre>
<h3 id="example-delivery-of-nac-accounting">Example Delivery of nac-accounting</h3>
<pre><code>POST /uri/... HTTP/1.1

Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 596
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e

{
  "topic": "nac-accounting",
  "events": [
    {
      "timestamp": 1547235620.89,
      "ap": "5c5b355005be",
      "type": "NAC_ACCOUNTING_STOP",
      "mac": "6e795836d5f9",
      "auth_type": "eap-tls",
      "bssid": "5c5b35546bb4",
      "client_type": "wireless",
      "client_ip": "172.16.87.4",
      "nas_vendor": "juniper-mist",
      "rx_pkts": 9523,
      "tx_pkts": 5233,
      "ssid": "Test-CMR SSID",
      "username": "hi"
      "org_id": "625aba64-fe72-4b14-8985-cbf31ec3d78a",
      "site_id": "ec9d1e85-af24-43f9-8d65-d620580e8631"
    }
  ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>timestamp</code></td>
<td><code>long</code></td>
<td>sampling time (in epoch)</td>
</tr>
<tr>
<td><code>ap</code></td>
<td><code>string</code></td>
<td>mac address of the AP the client roamed or disconnected from</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>type of event. E.g. “ACCOUNTING_START”, “ACCOUNTING_UPDATE”, “ACCOUNTING_STOP”</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>the client’s mac</td>
</tr>
<tr>
<td><code>auth_type</code></td>
<td><code>string</code></td>
<td>radius authentication type</td>
</tr>
<tr>
<td><code>bssid</code></td>
<td><code>string</code></td>
<td>it’s the MAC physical address of the access point</td>
</tr>
<tr>
<td><code>client_type</code></td>
<td><code>string</code></td>
<td>client type E.g. “wired”, “wireless”, “vty”</td>
</tr>
<tr>
<td><code>client_ip</code></td>
<td><code>string</code></td>
<td>IP Address of client</td>
</tr>
<tr>
<td><code>nas_vendor</code></td>
<td><code>string</code></td>
<td>NAS Device vendor name E.g. “Juniper”, “Cisco”</td>
</tr>
<tr>
<td><code>rx_pkts</code></td>
<td><code>int</code></td>
<td>number of packets received</td>
</tr>
<tr>
<td><code>tx_pkts</code></td>
<td><code>int</code></td>
<td>number of packets sent</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>ESSID</td>
</tr>
<tr>
<td><code>username</code></td>
<td><code>string</code></td>
<td>username authenticated with</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>Org ID</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>Site ID</td>
</tr>
</tbody>
</table>
<pre><code>
### Example Delivery of nac-events

</code></pre>
<p>POST /uri/… HTTP/1.1</p>
<p>Host: hooks.abc.com:443
User-Agent: Mist-webhook
Content-Type: application/json
Content-Length: 596
X-Mist-Signature: ce3af7760f1289d02bf6a7ad19f3214c4e5c7c2e</p>
<p>{
  “topic”: “nac-events”,
  “events”: [
    {
      “type”: “NAC_CLIENT_PERMIT”,
      “nacrule_id”: “32f27e7d-ff26-4a9b-b3d1-ff9bcb264c62”,
      “nacrule_matched”: true,
      “dryrun_nacrule_id”: “32f27e7d-ff26-4a9b-b3d1-ff9bcb264012”,
      “dryrun_nacrule_matched”: true,
      “auth_type”: “eap-ttls”,
      “vlan”: “750”,
      “nas_vendor”: “juniper-mist”,
      “bssid”: “5c5b355fafcc”,
      “idp_id”: “912ef72e-2239-4996-b81e-469e87a27cd6”,
      “idp_role”: [
          “itsuperusers”,
          “vip”
      ],
      “resp_attrs”: [
          “Tunnel-Type=VLAN”,
          “Tunnel-Medium-Type=IEEE-802”,
          “Tunnel-Private-Group-Id=750”,
          “User-Name=anonymous”
      ],
      “ssid”: “##mist_nac”,
      “username”: “user@deaflyz.net”,
      “timestamp”: 1691512031.358188,
      “org_id”: “27547ac2-d114-4e04-beb1-f3f1e6e81ec6”,
      “site_id”: “441a1214-6928-442a-8e92-e1d34b8ec6a6”,
      “random_mac”: False,
      “ap”: “5c5b35513227”,
      “mac”: “ac3eb179e535”
    }
  ]
}</p>
<pre><code>
Name|Type| Description
----|----|------------
`type`|`string`| event type, e.g. NAC_CLIENT_PERMIT
`nacrule_id` | `string` | NAC Policy Rule ID, if matched
`nacrule_matched` | `bool` | NAC Policy Rule Matched
`dryrun_nacrule_id` | `string` | NAC Policy Dry Run Rule ID, if present and matched
`dryrun_nacrule_matched` | `bool` | True - if dryrun rule present and matched with priority, False - if not matched or not present
`auth_type`|`string`| authentication type, e.g. "eap-tls", "eap-peap", "eap-ttls", "eap-teap", "mab", "device-auth"
`vlan`|`string`| Vlan ID
`nas_vendor`|`string`| vendor of NAS device
`bssid`|`string`| SSID
`idp_id` | `string` | SSO ID, if present and used
`idp_role` | `string` | IDP returned roles/groups for the user
`resp_attrs` | `list` | Radius attributes returned by NAC to NAS Devive
`ssid`|`string`| SSID
`username`|`string`| Username presented by the client
`timestamp`|`long`| start time, in epoch
`org_id`| `string`  | org id
`site_id`| `string`  | site id if assigned, null if not assigned
`ap`|`string`| AP MAC
`random_mac`|`boolean`| random mac
`mac`| `string`  | MAC address


</code></pre>
<h2 id="search-nac-client-events">Search NAC Client Events</h2>
<pre><code>GET /api/v1/sites/:site_id/nac_clients/events/search
</code></pre>
<h3 id="request_138">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>event type, e.g. NAC_CLIENT_PERMIT</td>
</tr>
<tr>
<td><code>nacrule_id</code></td>
<td><code>string</code></td>
<td>NAC Policy Rule ID, if matched</td>
</tr>
<tr>
<td><code>dryrun_nacrule_id</code></td>
<td><code>string</code></td>
<td>NAC Policy Dry Run Rule ID, if present and matched</td>
</tr>
<tr>
<td><code>auth_type</code></td>
<td><code>string</code></td>
<td>authentication type, e.g. “eap-tls”, “peap-tls”, “eap-ttls”, “eap-teap”, “mab”, “psk”, “device-auth”</td>
</tr>
<tr>
<td><code>vlan</code></td>
<td><code>string</code></td>
<td>Vlan ID</td>
</tr>
<tr>
<td><code>nas_vendor</code></td>
<td><code>string</code></td>
<td>vendor of NAS device</td>
</tr>
<tr>
<td><code>bssid</code></td>
<td><code>string</code></td>
<td>SSID</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>SSID</td>
</tr>
<tr>
<td><code>idp_username</code></td>
<td><code>string</code></td>
<td>Username presented to the Identity Provider</td>
</tr>
<tr>
<td><code>username</code></td>
<td><code>string</code></td>
<td>Username presented by the client</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id if assigned, null if not assigned</td>
</tr>
<tr>
<td><code>ap</code></td>
<td><code>string</code></td>
<td>AP MAC</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>MAC address</td>
</tr>
<tr>
<td><code>mxedge_id</code></td>
<td><code>string</code></td>
<td>Mist Edge ID used to connect to cloud</td>
</tr>
<tr>
<td><code>port_type</code></td>
<td><code>string</code></td>
<td>Type of client i.e wired, wireless</td>
</tr>
<tr>
<td><code>device_mac</code></td>
<td><code>string</code></td>
<td>Switch MAC Address</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>IP addressed assigned to client</td>
</tr>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>Port ID for the device</td>
</tr>
<tr>
<td><code>usermac_label</code></td>
<td><code>list</code></td>
<td>labels derived from usermac entry</td>
</tr>
<tr>
<td><code>text</code></td>
<td><code>string</code></td>
<td>partial / full MAC address, username, device_mac or ap</td>
</tr>
<tr>
<td><code>nas_ip</code></td>
<td><code>string</code></td>
<td>IP address of NAS device</td>
</tr>
<tr>
<td><code>sort</code></td>
<td><code>string</code></td>
<td>sort options, ‘-‘ prefix represents DESC order, default is wcid in ASC order</td>
</tr>
<tr>
<td><code>ingress_vlan</code></td>
<td><code>string</code></td>
<td>vendor specific Vlan ID in radius requests</td>
</tr>
</tbody>
</table>
<h3 id="response_202">Response</h3>
<pre><code>{
    "start": 1512572151,
    "end": 1513176951,
    "limit": 10,

    "total": 1,
    "results": [
        {
            "type": "NAC_CLIENT_PERMIT",
            "nacrule_id": "32f27e7d-ff26-4a9b-b3d1-ff9bcb264c62",
            "nacrule_matched": true,
            "auth_type": "eap-ttls",
            "vlan": "750",
            "nas_vendor": "juniper-mist",
            "bssid": "5c5b355fafcc",
            "idp_id": "912ef72e-2239-4996-b81e-469e87a27cd6",
            "idp_role": [
                "itsuperusers",
                "vip"
            ],
            "resp_attrs": [
                "Tunnel-Type=VLAN",
                "Tunnel-Medium-Type=IEEE-802",
                "Tunnel-Private-Group-Id=750",
                "User-Name=anonymous"
            ],
            "ssid": "##mist_nac",
            "username": "user@deaflyz.net",
            "timestamp": 1691512031.358188,
            "org_id": "27547ac2-d114-4e04-beb1-f3f1e6e81ec6",
            "site_id": "441a1214-6928-442a-8e92-e1d34b8ec6a6",
            "random_mac": false,
            "ap": "5c5b35513227",
            "mac": "ac3eb179e535"
        }
    ]
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-nac-client-events">Count by Distinct Attributes of NAC Client-Events</h2>
<pre><code>GET /api/v1/sites/:site_id/nac_clients/events/count?distinct=type
</code></pre>
<h3 id="request_139">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>type / nacrule_id / dryrun_nacrule_id / auth_type / vlan / nas_vendor / username / ap / mac / ssid</td>
</tr>
</tbody>
</table>
<h3 id="response_203">Response</h3>
<pre><code>{
    "start": 1513276353,
    "end": 1513362753,
    "limit": 3,

    "total": 3,
    "results": [
        {
            "count": 80,
            "type": "NAC_CLIENT_PERMIT"
        },
        {
            "count": 36,
            "type": "NAC_CLIENT_CERT_CHECK_SUCCESS"
        },
        {
            "count": 19,
            "type": "NAC_CLIENT_DENY"
        }
    ]
}
</code></pre>
<h2 id="search-nac-clients">Search NAC Clients</h2>
<pre><code>GET /api/v1/sites/:site_id/nac_clients/search
</code></pre>
<h3 id="request_140">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>nacrule_id</code></td>
<td><code>string</code></td>
<td>NAC Policy Rule ID, if matched</td>
</tr>
<tr>
<td><code>nacrule_matched</code></td>
<td><code>bool</code></td>
<td>If NAC Policy Rule Matched</td>
</tr>
<tr>
<td><code>auth_type</code></td>
<td><code>string</code></td>
<td>authentication type, e.g. “eap-tls”, “peap-tls”, “eap-ttls”, “eap-teap”, “mab”, “device-auth”</td>
</tr>
<tr>
<td><code>vlan</code></td>
<td><code>string</code></td>
<td>Vlan name or ID assigned to the client</td>
</tr>
<tr>
<td><code>nas_vendor</code></td>
<td><code>string</code></td>
<td>vendor of NAS device</td>
</tr>
<tr>
<td><code>idp_id</code></td>
<td><code>string</code></td>
<td>SSO ID, if present and used</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>SSID</td>
</tr>
<tr>
<td><code>username</code></td>
<td><code>string</code></td>
<td>Username presented by the client</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>long</code></td>
<td>start time, in epoch</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id if assigned, null if not assigned</td>
</tr>
<tr>
<td><code>ap</code></td>
<td><code>string</code></td>
<td>AP MAC connected to by client</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>MAC address</td>
</tr>
<tr>
<td><code>device_mac</code></td>
<td><code>string</code></td>
<td>Switch MAC Address</td>
</tr>
<tr>
<td><code>status</code></td>
<td><code>string</code></td>
<td>Connection status of client i.e “permitted”, “denied, “session_started”, “session_ended”</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>Client type i.e. “wireless”, “wired” etc.</td>
</tr>
<tr>
<td><code>mdm_compliance</code></td>
<td><code>string</code></td>
<td>MDM compliancy of client i.e “compliant”, “not compliant”</td>
</tr>
<tr>
<td><code>mdm_managed</code></td>
<td><code>bool</code></td>
<td>Filters NAC clients that are managed by MDM providers</td>
</tr>
<tr>
<td><code>mdm_provider</code></td>
<td><code>string</code></td>
<td>MDM provider of client’s organisation eg “intune”, “jamf”</td>
</tr>
<tr>
<td><code>mxedge_id</code></td>
<td><code>string</code></td>
<td>ID of Mist Edge that the client is connected through</td>
</tr>
<tr>
<td><code>nacrule_name</code></td>
<td><code>string</code></td>
<td>NAC Policy Rule Name matched</td>
</tr>
<tr>
<td><code>text</code></td>
<td><code>string</code></td>
<td>partial / full MAC address, last_username, device_mac or last_ap</td>
</tr>
<tr>
<td><code>sort</code></td>
<td><code>string</code></td>
<td>sort options, ‘-‘ prefix represents DESC order, default is wcid in ASC order</td>
</tr>
<tr>
<td><code>usermac_label</code></td>
<td><code>string</code></td>
<td>Labels derived from usermac entry</td>
</tr>
<tr>
<td><code>mfg</code></td>
<td><code>string</code></td>
<td>Manufacturer of the client’s device</td>
</tr>
<tr>
<td><code>family</code></td>
<td><code>string</code></td>
<td>Family of the client’s device</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>Model of the client’s device</td>
</tr>
<tr>
<td><code>os</code></td>
<td><code>string</code></td>
<td>Operating system of the client’s device</td>
</tr>
<tr>
<td><code>hostname</code></td>
<td><code>string</code></td>
<td>Hostname of the client’s device</td>
</tr>
</tbody>
</table>
<h3 id="response_204">Response</h3>
<pre><code>{
    "start": 1512572151,
    "end": 1513176951,
    "limit": 10,

    "total": 2,
    "results": [
        {
            "ap": ["5c5b35bf16bb", "d4dc090041b4"],
            "auth_type": "eap-tls",
            "cert_cn": ["werqwerty"],
            "cert_issuer": ["/DC=com/DC=onmicrosoft/DC=Juniper461/CN=Juniper461-CA"],
            "idp_id": "a13df686-dc39-4bdd-920f-89a412444c06",
            "idp_role": ["Employee"],
            "ip": ["10.7.51.74"],
            "last_ap": "d4dc090041b4",
            "last_cert_cn": "werqwerty",
            "last_cert_expiry": 1725373986,
            "last_cert_issuer": "/DC=com/DC=onmicrosoft/DC=Juniper461/CN=Juniper461-CA",
            "last_ip": "10.7.51.74",
            "last_nacrule_id": "558d6c97-d3c2-43e7-941d-244603ef5ce6",
            "last_nacrule_name": "mdm_complaince",
            "last_nas_vendor": "juniper-mist",
            "last_ssid": "mdm_test",
            "last_status": "permitted",
            "nacrule_id": ["558d6c97-d3c2-43e7-941d-244603ef5ce6"],
            "nacrule_matched": true,
            "nacrule_name": ["mdm_complaince"],
            "nas_vendor": ["juniper-mist"],
            "mac": "ac3eb179e535",
            "org_id": "9301bff6-8992-49d6-b1ea-907ee81bb5fb",
            "random_mac": true,
            "site_id": "13d69fb2-5456-43a1-90c4-89513487dde2",
            "ssid": ["mdm_test"],
            "timestamp": 1694689718.612,
            "type": "wireless",
            "usermac_label": [
                "non-compliant",
                "building26",
                "floor52"
            ],
            "last_mfg": "Apple, Inc.",
            "last_family": "Phone/Tablet/Wearable",
            "last_model": "iPhone 16 Pro",
            "last_os": "iOS 18.1",
            "last_hostname": "Apple iPhone Work",
        },
        {
            "auth_type": "mab",
            "group": "employee",
            "type": "wired",
            "last_status": "session_started",
            "device_mac": "0c599c646778",
            "gbp_tag": "3005",
            "last_nacrule_id": "85abd6a3-c4a4-497d-a568-2765046e0dba",
            "last_nacrule_name": "Allowed Printers",
            "last_nas_vendor": "juniper-mist",
            "last_port_id": "ge-0/0/1.0",
            "last_username": "CanonPrinter1",
            "last_vlan": "750",
            "nacrule_id": [
                "85abd6a3-c4a4-497d-a568-2765046e0dba"
            ],
            "nacrule_matched": true,
            "nacrule_name": [
                "Allowed Printers"
            ],
            "nas_vendor": [
                "juniper-mist"
            ],
            "org_id": "9301bff6-8992-49d6-b1ea-907ee81bb5fb",
            "port_id": [
                "ge-0/0/1.0"
            ],
            "random_mac": false,
            "site_id": "441a1214-6928-442a-8e92-e1d34b8ec6a6",
            "site_ids": [
                "441a1214-6928-442a-8e92-e1d34b8ec6a6"
            ],
            "username": [
                "CanonPrinter1",
                "6c3c7c7573e7"
            ],
            "vlan": [
                "750",
                "751"
            ],
            "vlan_source": "usermac",
            "timestamp": 1721641794.344
        }
    ]
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-nac-clients">Count by Distinct Attributes of NAC Clients</h2>
<pre><code>GET /api/v1/sites/:site_id/nac_clients/count?distinct=type
</code></pre>
<h3 id="request_141">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>type / last_nacrule_id / auth_type / last_vlan / last_nas_vendor / last_username / last_ap / mac / last_ssid / last_status / mdm_compliance / mdm_provider</td>
</tr>
</tbody>
</table>
<h3 id="response_205">Response</h3>
<pre><code>{
    "start": 1513276353,
    "end": 1513362753,
    "limit": 3,
    "total": 2,
    "results": [
        {
            "count": 10,
            "type": "wired"
        },
        {
            "count": 15,
            "type": "wireless"
        }
    ]
}
</code></pre>
<h2 id="search-service-path-events">Search Service Path Events</h2>
<pre><code>GET /api/v1/sites/:site_id/services/events/search
</code></pre>
<h3 id="request_142">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>Event type, e.g. GW_SERVICE_PATH_DOWN</td>
</tr>
<tr>
<td><code>text</code></td>
<td><code>string</code></td>
<td>Description of the event including the reason it is triggered</td>
</tr>
<tr>
<td><code>vpn_name</code></td>
<td><code>string</code></td>
<td>Peer name</td>
</tr>
<tr>
<td><code>vpn_path</code></td>
<td><code>string</code></td>
<td>Peer path name</td>
</tr>
<tr>
<td><code>policy</code></td>
<td><code>string</code></td>
<td>Service policy associated with that specific path</td>
</tr>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>Network interface</td>
</tr>
<tr>
<td><code>peer_port_id</code></td>
<td><code>string</code></td>
<td>Port ID of the peer gateway</td>
</tr>
<tr>
<td><code>peer_mac</code></td>
<td><code>string</code></td>
<td>MAC address of the peer gateway</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>Device model</td>
</tr>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>Device firmware version</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>long</code></td>
<td>Start time, in epoch</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>Org id</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>Site id</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>MAC address</td>
</tr>
<tr>
<td><code>path_weight</code></td>
<td><code>int</code></td>
<td>Path weight</td>
</tr>
</tbody>
</table>
<h3 id="response_206">Response</h3>
<pre><code>{
  "results": [
    {
      "timestamp": 1697037334.204,
      "org_id": "a3c6718f-2823-4e48-bf5e-b841768a4c9b",
      "site_id": "4279edbd-1d24-41ea-9505-2eb26c8590fa",
      "port_id": "ge-0/0/0",
      "model": "SSR120",
      "type": "GW_SERVICE_PATH_DOWN",
      "text": "Probe Down",
      "version": "6.1.5-14.lts",
      "mac": "90ec7734b374",
      "policy": "management",
      "path_weight": 10
    },
    {
      "vpn_name": "Syracuse_HUB",
      "timestamp": 1697037328.651775,
      "org_id": "a3c6718f-2823-4e48-bf5e-b841768a4c9b",
      "site_id": "4279edbd-1d24-41ea-9505-2eb26c8590fa",
      "vpn_path": "Syracuse_HUB-Wan0",
      "text": "Peer Path Down",
      "port_id": "ge-1/0/6",
      "model": "SSR120",
      "type": "GW_SERVICE_PATH_REMOVE",
      "version": "6.1.5-14.lts",
      "mac": "90ec7734b374",
      "policy": "INTERNET",
      "path_weight": 20
    },
    {
      "timestamp": 1697037325.37843,
      "org_id": "a3c6718f-2823-4e48-bf5e-b841768a4c9b",
      "site_id": "4279edbd-1d24-41ea-9505-2eb26c8590fa",
      "port_id": "ge-1/0/6",
      "model": "SSR120",
      "type": "GW_SERVICE_PATH_ADD",
      "version": "6.1.5-14.lts",
      "mac": "90ec7734b374",
      "policy": "policy1",
      "path_weight": 30
    }
  ],
  "start": 1697009979,
  "end": 1697096379,
  "limit": 10,
  "total": 3
}
</code></pre>
<h2 id="count-service-path-events">Count Service Path Events</h2>
<pre><code>GET /api/v1/sites/:site_id/services/events/count?distinct=type
</code></pre>
<h3 id="request_143">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>type / mac / vpn_name / vpn_path / policy / port_id / model / site_id</td>
</tr>
</tbody>
</table>
<h3 id="response_207">Response</h3>
<pre><code>{
  "results": [
    {
      "type": "GW_SERVICE_PATH_ADD",
      "count": 14
    },
    {
      "type": "GW_SERVICE_PATH_REMOVE",
      "count": 1
    }
  ],
  "start": 1697010188,
  "end": 1697096588,
  "limit": 10,
  "distinct": "type",
  "total": 2
}
</code></pre>
<h1 id="auto-zones">Auto Zones</h1>
<h2 id="description">Description</h2>
<p>The auto zones service is a map parsing service that uses map image data to suggest spaces to designate as location zones.</p>
<h2 id="post-run-auto-zone-service-for-map">POST Run Auto Zone service for map</h2>
<pre><code>POST /api/v1/sites/:site_id/maps/:map_id/auto_zones
</code></pre>
<h3 id="usage_10">Usage</h3>
<p>This API starts the auto zones service for a specified map. This map must have an image to parse for the auto zones service.
Repeated POST requests to this endpoint while the auto zones service is proccessing the map or awaiting review will be rejected.</p>
<h3 id="responses_7">Responses</h3>
<ul>
<li><code>400 Bad Request</code> - Map does not contain image data</li>
<li><code>400 Bad Request</code> - Auto zones is already in progress for this map</li>
<li><code>400 Bad Request</code> - Unable to reach auto zones service</li>
<li><code>200 Success</code></li>
</ul>
<h2 id="get-auto-zone-service-status-for-map">GET Auto Zone service status for map</h2>
<pre><code>GET /api/v1/sites/:site_id/maps/:map_id/auto_zones
</code></pre>
<h3 id="usage_11">Usage</h3>
<p>This API provides the current status of the auto zones service for a given map</p>
<h3 id="responses_8">Responses</h3>
<pre><code>{
    "status":"in_progress"
}
</code></pre>
<pre><code>{
    "status": "awaiting_review",
    "zones": [
        {
            "name": "zone1",
            "vertices": [
                {
                    "x": 0,
                    "y": 0
                },
                {
                    "x": 0,
                    "y": 10
                },
                {
                    "x": 10,
                    "y": 10
                },
                {
                    "x": 10,
                    "y": 0
                }
            ]
        },
        {
            "name": "zone2",
            "vertices": [
                {
                    "x": 0,
                    "y": 0
                },
                {
                    "x": 0,
                    "y": 20
                },
                {
                    "x": 20,
                    "y": 20
                },
                {
                    "x": 20,
                    "y": 0
                }
            ]
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>status</code></td>
<td><code>String</code></td>
<td>The status for the auto zones service for a given map</td>
</tr>
<tr>
<td><code>zones</code></td>
<td><code>list</code></td>
<td>A list of suggested zones to review and accept for a given map</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>String</code></td>
<td>The name of the suggested zone</td>
</tr>
<tr>
<td><code>vertices</code></td>
<td><code>list</code></td>
<td>A list of of points comprising the zones map location in pixels</td>
</tr>
</tbody>
</table>
<h4 id="status-descriptions_2">Status Descriptions</h4>
<table>
<thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>not_started</code></td>
<td>The auto zones service has not been run on this map or the results were cleared by the user</td>
</tr>
<tr>
<td><code>in_progress</code></td>
<td>The auto zones service is currently in progress</td>
</tr>
<tr>
<td><code>awaiting_review</code></td>
<td>The auto zones service has completed and suggested location zones to be added to the map</td>
</tr>
<tr>
<td><code>error</code></td>
<td>There was an error with the auto zones service</td>
</tr>
</tbody>
</table>
<h2 id="delete-auto-zones-service-for-map">DELETE Auto zones service for Map</h2>
<pre><code>DELETE /api/v1/sites/:site_id/maps/:map_id/auto_zones
</code></pre>
<h3 id="usage_12">Usage</h3>
<p>This API is called to cancel auto zones for a given map and to delete the suggested zones returned by the service.
If the service was not it will still delete any suggested zones and clear the auto zones service status.</p>
<h3 id="responses_9">Responses</h3>
<ul>
<li><code>200, Success</code></li>
</ul>



</body></html>