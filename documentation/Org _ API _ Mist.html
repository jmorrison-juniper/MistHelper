
<!-- saved from url=(0042)https://api.mist.com/api/v1/docs/Org#sites -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Org | API | Mist</title>
<style>
/* modified from https://gist.github.com/andyferra/2554919 */
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url("../../images/modules/styleguide/para.png") no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 0; }

hr {
  background: transparent url("../../images/modules/pulls/dirty-shade.png") repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0; }

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }

ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

ul :last-child, ol :last-child {
  margin-bottom: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
    border-collapse: collapse;
  padding: 0; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      text-align: left;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      text-align: left;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }
</style>
</head>
<body>

<h2 id="organization">Organization</h2>
<p>An organization usually represents a customer - which has inventories, licenses. An Organization can contain multiple
sites. A site usually represents a deployment at the same location (a campus, an office).</p>
<h1 id="sites">Sites</h1>
<h2 id="create-a-site-under-the-org">Create a Site under the Org</h2>
<pre><code>POST /api/v1/orgs/:org_id/sites
</code></pre>
<h3 id="example">Example</h3>
<pre><code>{
    "name": "Mist Office",
    "timezone": "America/Los_Angeles",
    "country_code": "US",
    "rftemplate_id": "bb8a9017-1e36-5d6c-6f2b-551abe8a76a2",
    "secpolicy_id": "3bcd0beb-5d0a-4cbd-92c1-14aea91e98ef",
    "alarmtemplate_id": "684dfc5c-fe77-2290-eb1d-ef3d677fe168",
    "networktemplate_id": "12ae9bd2-e0ab-107b-72e8-a7a005565ec2",
    "gatewaytemplate_id": "6f9b2e75-9b2f-b5ae-81e3-e14c76f1a90f",
    "aptemplate_id": "16bdf952-ade2-4491-80b0-85ce506c760b",
    "sitetemplate_id": "155fb365-05c6-4d54-925f-1ac14244a95e",

    "latlng": { "lat": 37.295833, "lng": -122.032946 },
    "sitegroup_ids": [ "581328b6-e382-f54e-c9dc-999983183a34", "f57096b9-0c2f-4df6-c77b-ae6ae87a3d43" ],
    "address": "1601 S. Deanza Blvd., Cupertino, CA, 95014"
}
</code></pre>
<h3 id="parameters">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>. The name of the site</td>
</tr>
<tr>
<td><code>notes</code></td>
<td><code>string</code></td>
<td>optional, any notes about the site</td>
</tr>
<tr>
<td><code>timezone</code></td>
<td><code>string</code></td>
<td>Timezone the site is at</td>
</tr>
<tr>
<td><code>country_code</code></td>
<td><code>string</code></td>
<td>country code for the site (for AP config generation), in <a href="http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">two-character</a></td>
</tr>
<tr>
<td><code>latlng</code></td>
<td><code>latlng</code></td>
<td>site location</td>
</tr>
<tr>
<td><code>address</code></td>
<td><code>string</code></td>
<td>full address of the site</td>
</tr>
<tr>
<td><code>lat</code></td>
<td><code>float</code></td>
<td>latitude</td>
</tr>
<tr>
<td><code>lng</code></td>
<td><code>float</code></td>
<td>longitude</td>
</tr>
<tr>
<td><code>sitegroup_ids</code></td>
<td><code>list</code></td>
<td>sitegroups this site belongs to</td>
</tr>
<tr>
<td><code>rftemplate_id</code></td>
<td><code>string</code></td>
<td>RF Template ID, this takes precedence over Site Settings</td>
</tr>
<tr>
<td><code>apporttemplate_id</code></td>
<td><code>string</code></td>
<td>APPort Template ID</td>
</tr>
<tr>
<td><code>secpolicy_id</code></td>
<td><code>string</code></td>
<td>SecPolicy ID</td>
</tr>
<tr>
<td><code>alarmtemplate_id</code></td>
<td><code>string</code></td>
<td>Alarm Template ID, this takes precedence over the Org-level <code>alarmtemplate_id</code></td>
</tr>
<tr>
<td><code>networktemplate_id</code></td>
<td><code>string</code></td>
<td>Network Template ID where site can use as its base Site Setting</td>
</tr>
<tr>
<td><code>gatewaytemplate_id</code></td>
<td><code>string</code></td>
<td>Gateway Template ID, used by gateways</td>
</tr>
<tr>
<td><code>aptemplate_id</code></td>
<td><code>string</code></td>
<td>AP Template ID, used by APs</td>
</tr>
<tr>
<td><code>sitetemplate_id</code></td>
<td><code>string</code></td>
<td>Site Template ID</td>
</tr>
</tbody>
</table>
<h3 id="response">Response</h3>
<pre><code>{
    "id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
    "name": "Mist Office",
    "timezone": "America/Los_Angeles",
    "country_code": "US",
    "latlng": { "lat": 37.295833, "lng": -122.032946 },
    "sitegroup_ids": [ "581328b6-e382-f54e-c9dc-999983183a34", "f57096b9-0c2f-4df6-c77b-ae6ae87a3d43" ],
    "address": "1601 S. Deanza Blvd., Cupertino, CA, 95014"
}
</code></pre>
<h2 id="country-codes">Country Codes</h2>
<p>Get a list of country codes that we support</p>
<pre><code>GET /api/v1/const/countries
</code></pre>
<h3 id="parameters_1">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>extend</code></td>
<td><code>boolean</code></td>
<td>default is false, will include more country codes if true</td>
</tr>
</tbody>
</table>
<h3 id="response_1">Response</h3>
<pre><code>[
    {
        "alpha2": "US",
        "numeric": 840,
        "name": "United States",
        "certified": true
    },
    {
        "alpha2": "JP",
        "name": "Japan",
        "numeric": 392,
        "certified": true
    },
    {
        "alpha2": "BY",
        "name": "Belarus",
        "numeric": 112,
        "certified": true,
        "disabled": true
    },
    ...
]
</code></pre>
<h2 id="state-codes">State Codes</h2>
<p>Get ISO states based on country code</p>
<pre><code>GET /api/v1/const/states?country_code=US
</code></pre>
<h3 id="parameters_2">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>country_code</code></td>
<td><code>string</code></td>
<td>country code, in <a href="http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">two-character</a></td>
</tr>
</tbody>
</table>
<h3 id="response_2">Response</h3>
<pre><code>[
    {
        "iso_code": "AK", 
        "name": Alaska"
    },
    {
       "iso_code": "AL",
       "name": "Alabama"
    },
       "iso_code": "AS",
       "name": "American Samoa"
    },
    {
        "iso_code": "AZ",
        "name": "Arizona"
    },
    {
        "iso_code": "CA",
        "name": "California"
    },
     ...
]
</code></pre>
<h2 id="ap-channels">AP Channels</h2>
<p>Get a list of country codes that we support</p>
<pre><code>GET /api/v1/const/ap_channels?country_code=US
</code></pre>
<h3 id="parameters_3">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>country_code</code></td>
<td><code>string</code></td>
<td>country code, in <a href="http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">two-character</a></td>
</tr>
</tbody>
</table>
<h3 id="response_3">Response</h3>
<pre><code>{
    "key": "US",
    "name": "United States"
    "code": 840,
    "band24_enabled": true,
    "band24_channels": {
        "20": [
            1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11
        ],
        "40": [
            1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11
        ]
    },
    "band5_enabled": true,
    "dfs_ok": true,
    "band5_channels": {
        "20": [
            36, 40, 44, 48, 52, 56, 60, 64, 100, 104, 108, 112, 116, 132, 136, 140, 149, 153, 157, 161, 165
        ],
        "40": [
            36, 40, 44, 48, 52, 56, 60, 64, 100, 104, 108, 112, 132, 136, 149, 153, 157, 161
        ],
        "80": [
            36, 40, 44, 48, 52, 56, 60, 64, 100, 104, 108, 112, 132, 136, 149, 153, 157, 161
        ],
        "dfs": [
            52, 56, 60, 64, 100, 104, 108, 112, 116, 132, 136, 140
        ]
    }
}
</code></pre>
<h2 id="get-the-sites-that-belongs-to-an-org">Get the sites that belongs to an Org</h2>
<pre><code>GET /api/v1/orgs/:org_id/sites
</code></pre>
<h2 id="get-site">Get site</h2>
<pre><code>GET /api/v1/sites/:site_id
</code></pre>
<h2 id="get-stat-along-with-site">Get stat along with site</h2>
<pre><code>GET /api/v1/sites/:site_id/stats
</code></pre>
<h3 id="response_4">Response</h3>
<pre><code>{
    ...
    "msp_id": "9520c63a-f7b3-670c-0944-727774d5a722",

    "num_clients": 50,
    "num_devices": 8,
}
</code></pre>
<h3 id="definition">Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>msp_id</code></td>
<td><code>string</code></td>
<td>msp id</td>
</tr>
<tr>
<td><code>num_clients</code></td>
<td><code>int</code></td>
<td>Number of clients associated currently</td>
</tr>
<tr>
<td><code>num_devices</code></td>
<td><code>int</code></td>
<td>Number of devices in connected and managed state</td>
</tr>
</tbody>
</table>
<h2 id="update-a-site">Update a Site</h2>
<pre><code>PUT /api/v1/sites/:site_id
</code></pre>
<h2 id="delete-a-site">Delete a Site</h2>
<pre><code>DELETE /api/v1/sites/:site_id
</code></pre>
<h1 id="site-groups">Site Groups</h1>
<p>Site groups are a group of sites under the same Org. It’s many-to-many mapping to sites</p>
<pre><code>/api/v1/orgs/:org_id/sitegroups
</code></pre>
<h2 id="site-group-schema">Site Group Schema</h2>
<pre><code>{
    "name": "Group1"
}
</code></pre>
<h1 id="inventory">Inventory</h1>
<h3 id="pagination-notice">Pagination Notice</h3>
<p>To improve performance and reduce response size, please use paginated requests. We strongly recommend specifying pagination parameters when calling these endpoints. Even though a call without pagination parameters will return the full list of device stats, this behavior is temporary. In the future, paginated responses (with default values of <code>limit=100</code> and <code>page=1</code>) will be enforced.</p>
<p><strong>Query Parameters for Pagination:</strong></p>
<ul>
<li><strong><code>limit</code></strong>: The maximum number of items to return per page (default is 100).</li>
<li><strong><code>page</code></strong>: The page number to return (default is 1).</li>
</ul>
<p>When you include these parameters in your request, the response will also contain the following HTTP headers:
- <code>X-Page-Page</code>: The current page number.
- <code>X-Page-Limit</code>: The limit per page.
- <code>X-Page-Total</code>: The total number of items in the result set.</p>
<h2 id="get-inventory-of-an-org">Get inventory of an org</h2>
<pre><code>GET /api/v1/orgs/:org_id/inventory?&amp;modified_after=1733522845&amp;limit=100&amp;page=1
</code></pre>
<h3 id="response_5">Response</h3>
<h4 id="response-for-device-type-ap">Response for device type AP</h4>
<pre><code>[
    {
        "mac": "d420b080516d",
        "serial": "A0052190206A2",
        "model": "AP41",
        "sku": "AP41-US",
        "hw_rev": "F11",
        "type": "ap",
        "magic": "XXXXXXXXXXXXXXX",
        "name": "SaltLakeHQ-AP6d",
        "jsi": false,
        "org_id": "9777c1a0-6ef6-11e6-8bbf-02e208b2d34f",
        "site_id": "1505f5d6-5366-4ca2-a9e2-2c6b805e5a47",
        "created_time": 1585754725,
        "modified_time": 1649358858,
        "id": "00000000-0000-0000-1000-d420b080516d",
        "deviceprofile_id": null,
        "connected": true
    }
]
</code></pre>
<h4 id="response-for-device-type-switch">Response for device type Switch</h4>
<pre><code>[
    {
        "mac": "8403280bc0a0",
        "serial": "HV3620270051",
        "model": "EX2300-C-12P",
        "sku": "EX2300-C-12P",
        "hw_rev": "C",
        "type": "switch",
        "magic": "XXXXXXXXXXXXXXX",
        "name": "SaltLake-EX2300-C",     // configured
        "hostname": "SaltLake-EX2300-C", // reported
        "jsi": false,
        "org_id": "9777c1a0-6ef6-11e6-8bbf-02e208b2d34f",
        "site_id": "1505f5d6-5366-4ca2-a9e2-2c6b805e5a47",
        "created_time": 1623086870,
        "modified_time": 1656353525,
        "id": "00000000-0000-0000-1000-8403280bc0a0",
        "deviceprofile_id": null,
        "connected": true
    }
]
</code></pre>
<h4 id="response-for-device-type-gateway">Response for device type Gateway</h4>
<pre><code>[
    {
        "mac": "fc334262af00",
        "serial": "CW1419AN0651",
        "model": "SRX320",
        "sku": "SRX320-SYS-JB",
        "hw_rev": "C",
        "type": "gateway",
        "magic": "XXXXXXXXXXXXXXX",
        "name": "LD_SRX",      // configured
        "hostname": "LD_SRX",  // reported
        "jsi": false,
        "org_id": "9777c1a0-6ef6-11e6-8bbf-02e208b2d34f",
        "site_id": "978c48e6-6ef6-11e6-8bbf-02e208b2d34f",
        "created_time": 1616108044,
        "modified_time": 1616108293,
        "id": "00000000-0000-0000-1000-fc334262af00",
        "adopted": true,
        "deviceprofile_id": null,
        "connected": true
    }
]
</code></pre>
<h3 id="response-definitions">Response Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>serial</code></td>
<td><code>string</code></td>
<td>device serial</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>device model</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>device type, ap / switch / gateway</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>MAC address</td>
</tr>
<tr>
<td><code>sku</code></td>
<td><code>string</code></td>
<td>device stock keeping unit</td>
</tr>
<tr>
<td><code>hw_rev</code></td>
<td><code>string</code></td>
<td>device hardware revision number</td>
</tr>
<tr>
<td><code>magic</code></td>
<td><code>string</code></td>
<td>device claim code</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>device name if configured</td>
</tr>
<tr>
<td><code>hostname</code></td>
<td><code>string</code></td>
<td>hostname reported by the device</td>
</tr>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>device id</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id if assigned, null if not assigned</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id</td>
</tr>
<tr>
<td><code>deviceprofile_id</code></td>
<td><code>string</code></td>
<td>deviceprofile id if assigned, null if not assigned</td>
</tr>
<tr>
<td><code>connected</code></td>
<td><code>boolean</code></td>
<td>whether the device is connected</td>
</tr>
<tr>
<td><code>adopted</code></td>
<td><code>boolean</code></td>
<td>whether the switch/gateway is adopted</td>
</tr>
<tr>
<td><code>created_time</code></td>
<td><code>long</code></td>
<td>inventory created time, in epoch</td>
</tr>
<tr>
<td><code>modified_time</code></td>
<td><code>long</code></td>
<td>inventory last modified time, in epoch</td>
</tr>
</tbody>
</table>
<h2 id="get-filtered-inventory-of-an-org">Get filtered inventory of an org</h2>
<pre><code>GET /api/v1/orgs/:org_id/inventory?model=AP41
</code></pre>
<p>Supported filters: model, serial, magic, site_id, type, mac, vc_mac, vc, unassigned</p>
<h2 id="org-inventory-search">Org Inventory Search</h2>
<pre><code>GET /api/v1/orgs/:org_id/inventory/search?mac=f01c2df166e0
</code></pre>
<h3 id="request">Request</h3>
<p>The following fields are available for searching.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>device type, ap/switch/gateway</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>device mac</td>
</tr>
<tr>
<td><code>vc_mac</code></td>
<td><code>string</code></td>
<td>vc_mac</td>
</tr>
<tr>
<td><code>master_mac</code></td>
<td><code>string</code></td>
<td>master device mac for virtual mac cluster</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>device model</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>serial</code></td>
<td><code>string</code></td>
<td>device serial number</td>
</tr>
<tr>
<td><code>master</code></td>
<td><code>boolean</code></td>
<td>true/false</td>
</tr>
<tr>
<td><code>sku</code></td>
<td><code>string</code></td>
<td>device sku</td>
</tr>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>device version</td>
</tr>
<tr>
<td><code>status</code></td>
<td><code>string</code></td>
<td>device status</td>
</tr>
<tr>
<td><code>text</code></td>
<td><code>string</code></td>
<td>wildcards for name, mac, serial</td>
</tr>
</tbody>
</table>
<h3 id="response_6">Response</h3>
<pre><code>{
    "results": [
        {
            "type": "switch",
            "name": "mist-wa-ex4300-VC",
            "mac": "f01c2df166e0",
            "vc_mac": "f01c2df166e0",
            "model": "EX4300-48P",
            "master": true
            "site_id": "01dc141d-b6af-4baa-b00f-0e31ef954c4f",
            "org_id": "9b853544-51e4-45fb-81ac-a442e4a111d0",
            "serial": "PD3714460200",
            "members": [
                {
                    "mac": "f01c2df166e0",
                    "model": "EX4300-48P",
                    "serial": "PD3714460200"
                }
            ],
            "sku": "EX4300-48P",
            "version": "21.4R3.5",
            "status": "disconnected"
        }
    ]
    "limit": 1000,
    "total": 1
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-inventory">Count by Distinct Attributes of Inventory</h2>
<pre><code>GET /api/v1/orgs/:org_id/inventory/count?type=switch&amp;distinct=model
</code></pre>
<h3 id="request_1">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>device type, ap/switch/gateway</td>
</tr>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>model / status / site_id / sku / version, default is model</td>
</tr>
</tbody>
</table>
<h3 id="response_7">Response</h3>
<pre><code>{
    "limit": 10,
    "distinct": "model",

    "total": 2,
    "results": [
        {
            "model": "EX4300-48P",
            "count": 12
        },
        {
            "model": "EX4400-24P",
            "count": 4
        }
    ]
}
</code></pre>
<h3 id="vc-virtual-chassis-management">VC (Virtual-Chassis) Management</h3>
<p>Ideally VC should be managed as a single device - where</p>
<ul>
<li>one managed entity where config / monitoring is anchored against (with a stable identify MAC)</li>
<li>all members appears in the inventory</li>
</ul>
<p>In our implementation, we strive to achieve that without manual user configurations by</p>
<ol>
<li>during claim or adoption a VC, we require FPC0 to exist and will use its MAC as identify for the entire chassis</li>
<li>other VC members will be automatically populated when they’re all present</li>
</ol>
<p>The perceivable result is</p>
<ol>
<li>from /sites/:site_id/stats/devices/:fpc0_mac API, you’d see the VC where <code>module_stat</code> contains the VC members</li>
<li>from /orgs/:org_id/inventory?vc=true API, you’d see all VC members with <code>vc_mac</code> pointing to the FPC0</li>
</ol>
<h2 id="add-inventory-to-an-org">Add inventory to an org</h2>
<pre><code>POST /api/v1/orgs/:org_id/inventory
</code></pre>
<h3 id="request_2">Request</h3>
<pre><code>[
    "6JG8E-PTFV2-A9Z2N",
    "DVH4V-SNMSZ-PDXBR"
]
</code></pre>
<h3 id="parameters_4">Parameters</h3>
<p>a list of claim codes</p>
<h3 id="response-if-any-of-entries-are-valid-or-theres-no-errors">Response if any of entries are valid or there’s no errors</h3>
<pre><code>Status: 200 OK

{
    "added": [ "6JG8E-PTFV2-A9Z2N" ],
    "duplicated": [ "DVH4V-SNMSZ-PDXBR" ],
    "error": [ "PO1025335ohoh" ],
    "inventory_added": [
        {
            "serial": "FXLH2015150025",
            "model": "AP41",
            "type": "ap",
            "magic": "6JG8EPTFV2A9Z2N",
            "mac": "5c5b35000018"
        }
    ],
    "inventory_duplicated": [
        {
            "serial": "FXLH2015150027",
            "model": "AP41",
            "type": "ap",
            "magic": "DVH4VSNMSZPDXBR",
            "mac": "5c5b35000012"
        }
    ]
}
</code></pre>
<h3 id="response-if-none-of-the-entries-are-valid">Response if none of the entries are valid</h3>
<pre><code>Status: 400 Bad Request
</code></pre>
<h2 id="add-inventory-to-an-org-while-limiting-device-type">Add inventory to an org while limiting device type</h2>
<pre><code>POST /api/v1/orgs/:org_id/inventory/switch
</code></pre>
<h3 id="request_3">Request</h3>
<pre><code>[
    "6JG8E-PTFV2-A9Z2N",
    "DVH4V-SNMSZ-PDXBR"
]
</code></pre>
<h2 id="delete-multiple-inventory-from-org">Delete multiple inventory from org</h2>
<p>This removes the inventory from the org. If the inventory is already assigned to a site, it will be unassigned.</p>
<pre><code>PUT /api/v1/orgs/:org_id/inventory
</code></pre>
<h3 id="request_4">Request</h3>
<pre><code>{
    "op": "delete",
    "serials": [
        "FXLH2015150025",
        "FXLH2015150026"
    ],
    "macs": [
        "5c5b350e0001"
    ]
}
</code></pre>
<h3 id="parameters_5">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>op</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>. delete</td>
</tr>
<tr>
<td><code>serials</code></td>
<td><code>list</code></td>
<td>list of serial numbers, e.g. FXLH2015150025</td>
</tr>
<tr>
<td><code>macs</code></td>
<td><code>list</code></td>
<td>list of MAC, e.g. 5c5b350e0001</td>
</tr>
</tbody>
</table>
<h3 id="response_8">Response</h3>
<pre><code>{
    "op": "delete",
    "success": [ "FXLH2015150025", "5c5b350e0001" ],
    "error": [ "FXLH2015150026" ]
}
</code></pre>
<h2 id="assign-inventory-to-a-site">Assign inventory to a site</h2>
<pre><code>PUT /api/v1/orgs/:org_id/inventory
</code></pre>
<h3 id="request_5">Request</h3>
<pre><code>{
    "op": "assign",
    "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
    "macs": [
        "5c5b350e0001"
    ],
    "no_reassign": false,

    // for cloud-ready switches/gateways
    "disable_auto_config": false

    // for adopted switches
    "managed": false
}
</code></pre>
<h3 id="parameters_6">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>op</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>. assign</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>. target site id</td>
</tr>
<tr>
<td><code>macs</code></td>
<td><code>list</code></td>
<td>list of MAC, e.g. 5c5b350e0001</td>
</tr>
<tr>
<td><code>no_reassign</code></td>
<td><code>boolean</code></td>
<td>if true, treat site assignment against an already assigned AP as error</td>
</tr>
<tr>
<td><code>disable_auto_config</code></td>
<td><code>boolean</code></td>
<td>a cloud-ready switch/gateway will be managed/configured by Mist by default, this disabled the behavior</td>
</tr>
<tr>
<td><code>managed</code></td>
<td><code>boolean</code></td>
<td>an adopted switch/gateway will <code>_not_</code> be managed/configured by Mist by default, this enables the behavior</td>
</tr>
</tbody>
</table>
<h3 id="response_9">Response</h3>
<pre><code>{
    "op": "assign",
    "success": [ "5c5b350e0001" ]
    "error": [ ]
}
</code></pre>
<h2 id="unassign-inventory-from-any-site">Unassign inventory from any site</h2>
<pre><code>PUT /api/v1/orgs/:org_id/inventory
</code></pre>
<h3 id="request_6">Request</h3>
<pre><code>{
    "op": "unassign",
    "macs": [
        "5c5b350e0001"
    ]
}
</code></pre>
<h3 id="parameters_7">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>op</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>. unassign</td>
</tr>
<tr>
<td><code>macs</code></td>
<td><code>list</code></td>
<td>list of MAC, e.g. 5c5b350e0001</td>
</tr>
</tbody>
</table>
<h3 id="response_10">Response</h3>
<pre><code>{
    "op": "unassign",
    "success": [ "5c5b350e0001" ]
    "error": [ ]
}
</code></pre>
<h2 id="create-ha-cluster-from-unassigned-gateways">Create HA Cluster from unassigned Gateways</h2>
<pre><code>POST /api/v1/orgs/:org_id/inventory/create_ha_cluster
</code></pre>
<pre><code>{
    "nodes": [
        {
            "mac": "aff827549235"  // node0 mac, should be unassigned
        },
        {
            "mac": "8396cd006c8c"  // node1 mac, should be unassigned
        }
    ],

    // optional
    "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
    "managed": false,            // if the device is adopted
    "disable_auto_config": true  // if the device is manufed
}
</code></pre>
<h2 id="delete-ha-cluster">Delete HA Cluster</h2>
<pre><code>POST /api/v1/orgs/:org_id/inventory/delete_ha_cluster
</code></pre>
<pre><code>{
    "mac": "aff827549235"  // node0 mac
}
</code></pre>
<p>After HA cluster deleted, both of the nodes will be unassigned.</p>
<h2 id="get-org-devices-summary">Get Org Devices Summary</h2>
<pre><code>GET /api/v1/orgs/:org_id/devices/summary
</code></pre>
<h3 id="response_11">Response</h3>
<pre><code>{
    "num_aps": 630,
    "num_switches": 30,
    "num_gateways": 6,
    "num_unassigned_aps": 5,
    "num_unassigned_switches": 0,
    "num_unassigned_gateways": 0,
    "num_mxedges": 1
}
</code></pre>
<h2 id="get-org-devices-stats">Get Org Devices Stats</h2>
<p>This API renders some high-level device stats, pagination is assumed and returned in response header (as the response is
an array)</p>
<pre><code>GET /api/v1/orgs/:org_id/stats/devices?limit=100
</code></pre>
<h3 id="request-filters">Request Filters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site_id</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>device tyoe: ap / switch / gateway / all</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>5c5b350e0001</td>
</tr>
<tr>
<td><code>evpntopo_id</code></td>
<td><code>string</code></td>
<td>EVPN Topology ID</td>
</tr>
<tr>
<td><code>evpn_unused</code></td>
<td><code>bool</code></td>
<td>if evpn_unused=true, find EVPN eligible switches which don’t belong to any EVPN Topology yet</td>
</tr>
</tbody>
</table>
<h3 id="response_12">Response</h3>
<pre><code>X-Page-Limit: 100
X-Page-Page: 1
X-Page-Total: 31

[
    {
        "mac": "5c5b35000010",
        "model": "AP200",
        "type": "ap",
        "serial": "FXLH2015170017",
        "last_seen": 1470417522,
        "name": "conference room",
        "status": "connected",
        "version": "1.0.0",
        "ip": "10.2.9.159", // first IP
        "uptime": 13500
    },
    ...
]
</code></pre>
<h1 id="custom-roles">Custom Roles</h1>
<p>Custom roles restrict Org users to specific UI views. This is useful for limiting UI access of Org users.</p>
<p>You can invite a new user or update existing users in your Org to this custom role. For this, specify <code>view</code> along
with <code>role</code> when assigning privileges.</p>
<p>Below are the list of supported UI views. Note that this is UI only feature</p>
<table>
<thead>
<tr>
<th>UI View</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>reporting</code></td>
<td>full access to all analytics tools</td>
</tr>
<tr>
<td><code>marketing</code></td>
<td>can view analytics and location maps</td>
</tr>
<tr>
<td><code>location</code></td>
<td>can view and manage location maps</td>
</tr>
<tr>
<td><code>security</code></td>
<td>can view and manage WLAN, rogues and authentication</td>
</tr>
<tr>
<td><code>switch_admin</code></td>
<td>can view and manage Switch ports</td>
</tr>
<tr>
<td><code>mxedge_admin</code></td>
<td>can view and manage Mist edges and Mist tunnels</td>
</tr>
<tr>
<td><code>lobby_admin</code></td>
<td>full access to Org and Site Pre-shared keys</td>
</tr>
</tbody>
</table>
<h1 id="admins">Admins</h1>
<h2 id="get-admins">Get Admins</h2>
<p>Get a list of people who can manage the Site/Org under the Org</p>
<pre><code>GET /api/v1/orgs/:org_id/admins
</code></pre>
<h3 id="response_13">Response</h3>
<pre><code>[
    {
        "admin_id": "456b7016-a916-a4b1-78dd-72b947c152b7",
        "first_name": "Joe",
        "last_name": "Smith",
        "two_factor_verified": false,
        "privileges": [
            { "scope":"org", "role": "admin" },
            { "scope":"site", "site_id": "d96e3952-53e8-4266-959a-45acd55f5114", "role": "admin" },
            { "scope":"sitegroup", "sitegroup_id": "581328b6-e382-f54e-c9dc-999983183a34", "role": "admin" }
        ]
    },
    {
      "admin_id": "72bfa2bd-e58a-4670-9d20-a1468f7a6f58",
      "first_name": "John",
      "last_name": "Doe",
      "two_factor_verified": true,
      "privileges": [
         { "scope":"site", "site_id": "d96e3952-53e8-4266-959a-45acd55f5114", "role": "write", "view": "location" },
         { "scope":"site", "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b", "role": "write", "view": "location" }
      ]
    },
    {
        "invite_id": "456b7016-a916-a4b1-78dd-72b947c152b7",
        "email": "joe@abc.com",
        "first_name": "Joe",
        "last_name": "Smith",
        "privileges": [
            { "scope":"org", "role": "admin" },
            { "scope":"site", "site_id": "d96e3952-53e8-4266-959a-45acd55f5114", "role": "admin" }
        ],
        "expire_time": 1445966955
    },
    {
        "invite_id": "15899c53-92da-4119-bdcf-65203bc84663",
        "email": "jsnow@abc.com",
        "first_name": "John",
        "last_name": "Snow",
        "privileges": [
            { "scope":"org", "role": "read", "view": "reporting" }
        ],
        "expire_time": 1445966955
    }
]
</code></pre>
<h3 id="response-definition">Response Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>admin_id</code></td>
<td><code>string</code></td>
<td>admin id</td>
</tr>
<tr>
<td><code>first_name</code></td>
<td><code>string</code></td>
<td>first name</td>
</tr>
<tr>
<td><code>last_name</code></td>
<td><code>string</code></td>
<td>last name</td>
</tr>
<tr>
<td><code>two_factor_verified</code></td>
<td><code>boolean</code></td>
<td>two factor status</td>
</tr>
<tr>
<td><code>privileges</code></td>
<td><code>list</code></td>
<td>list of privileges the admin has on the orgs/sites</td>
</tr>
<tr>
<td><code>scope</code></td>
<td><code>string</code></td>
<td>site / org / sitegroup</td>
</tr>
<tr>
<td><code>role</code></td>
<td><code>string</code></td>
<td>admin / write / read / helpdesk / installer</td>
</tr>
<tr>
<td><code>view</code></td>
<td><code>string</code></td>
<td>see <a href="https://api.mist.com/api/v1/docs/Org#Custom-Roles">supported UI views</a></td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>first_name</code></td>
<td><code>string</code></td>
<td>for an invite, this is the original first name used</td>
</tr>
<tr>
<td><code>last_name</code></td>
<td><code>string</code></td>
<td>for an invite, this is the original last name used</td>
</tr>
</tbody>
</table>
<h2 id="update-admins">Update Admins</h2>
<p>Update admin privileges under the Org</p>
<pre><code>PUT /api/v1/orgs/:org_id/admins/:admin_id
</code></pre>
<h3 id="request_7">Request</h3>
<pre><code>{
    "privileges": [
        { "scope":"org", "role": "write", "view": "reporting" },
        { "scope":"site", "site_id": "d96e3952-53e8-4266-959a-45acd55f5114", "role": "write", "view": "reporting" },
        { "scope":"sitegroup", "sitegroup_id": "581328b6-e382-f54e-c9dc-999983183a34", "role": "write", "view": "reporting" }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>admin_id</code></td>
<td><code>string</code></td>
<td>admin id</td>
</tr>
<tr>
<td><code>privileges</code></td>
<td><code>list</code></td>
<td>list of privileges the admin has on the orgs/sites</td>
</tr>
<tr>
<td><code>scope</code></td>
<td><code>string</code></td>
<td>site / org / sitegroup</td>
</tr>
<tr>
<td><code>role</code></td>
<td><code>string</code></td>
<td>admin / write / read / helpdesk / installer / none</td>
</tr>
<tr>
<td><code>view</code></td>
<td><code>string</code></td>
<td>optional, see <a href="https://api.mist.com/api/v1/docs/Org#Custom-Roles">supported UI views</a></td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
</tbody>
</table>
<h3 id="response_14">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h2 id="revoke-admin">Revoke Admin</h2>
<p>This removes all privileges this admin has against the org</p>
<pre><code>DELETE /api/v1/orgs/:org_id/admins/:admin_id
</code></pre>
<h3 id="response_15">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h2 id="invite-admin">Invite Admin</h2>
<p>An Org admin can invite other admin to manage (admin or read) the Org and/or Site(s) under the Org.</p>
<pre><code>POST /api/v1/orgs/:org_id/invites
</code></pre>
<h3 id="request_8">Request</h3>
<pre><code>{
    "email": "joe@abc.com",
    "first_name": "Joe",
    "last_name": "Smith",
    "hours": 24,
    "privileges": [
        { "scope":"org", "role": "admin", "view": "location" },
        { "scope":"site", "site_id": "d96e3952-53e8-4266-959a-45acd55f5114", "role": "admin", "view": "location" }
    ]
}
</code></pre>
<h3 id="parameters_8">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>email</code></td>
<td><code>string</code></td>
<td>email (admin_id is not exposed)</td>
</tr>
<tr>
<td><code>first_name</code></td>
<td><code>string</code></td>
<td>first name, used in the invitation text</td>
</tr>
<tr>
<td><code>last_name</code></td>
<td><code>string</code></td>
<td>last name</td>
</tr>
<tr>
<td><code>privileges</code></td>
<td><code>list</code></td>
<td>list of privileges the admin has on the orgs/sites</td>
</tr>
<tr>
<td><code>scope</code></td>
<td><code>string</code></td>
<td>site / org / sitegroup</td>
</tr>
<tr>
<td><code>role</code></td>
<td><code>string</code></td>
<td>admin / write / read / helpdesk / installer</td>
</tr>
<tr>
<td><code>view</code></td>
<td><code>string</code></td>
<td>optional, see <a href="https://api.mist.com/api/v1/docs/Org#Custom-Roles">supported UI views</a></td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>hours</code></td>
<td><code>int</code></td>
<td>optional, how long the invite should be valid, default is 1 day, maximum is 1 week.</td>
</tr>
</tbody>
</table>
<h3 id="response_16">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<p>An email will also be sent to the user with a link
to https://manage.mist.com/verify/invite?token=:token&amp;expire=1459632743&amp;org=OrgName</p>
<h2 id="verify-invitation">Verify Invitation</h2>
<pre><code>POST /api/v1/invite/verify/:token
</code></pre>
<h3 id="response-if-successful">Response if successful</h3>
<pre><code>Status: 200 OK
</code></pre>
<p>NOTE: another call to <code>GET /api/v1/self</code> is required to see the new set of privileges</p>
<h3 id="response-if-secret-is-invalid-or-verification-expired">Response if secret is invalid or verification expired</h3>
<pre><code>Status: 404 Not Found

{
    "detail": "invalid secret"
}
</code></pre>
<h3 id="response-if-the-invitation-is-claimed-by-the-same-one-requesting-it">Response if the invitation is claimed by the same one requesting it</h3>
<pre><code>Status: 404 Not Found

{
    "detail": "invite created by self"
}
</code></pre>
<h2 id="un-invite-admin">Un-invite Admin</h2>
<pre><code>DELETE /api/v1/orgs/:org_id/invites/:invite_id
</code></pre>
<h2 id="update-the-invite">Update the Invite</h2>
<pre><code>PUT /api/v1/orgs/:org_id/invites/:invite_id
</code></pre>
<h3 id="request_9">Request</h3>
<pre><code>{
    "hours": 24,
    "privileges": {
        { "scope":"site", "site_id": "d96e3952-53e8-4266-959a-45acd55f5114", "role": "write", "view": "reporting" },
        { "scope":"sitegroup", "sitegroup_id": "581328b6-e382-f54e-c9dc-999983183a34", "role": "write", "view": "reporting" }
    }
}
</code></pre>
<h1 id="api-token">API Token</h1>
<p>API tokens can be generated for a specific Org/Site with the required privileges</p>
<h2 id="create-api-token">Create API Token</h2>
<p>Note that the token key is only available during creation time.</p>
<pre><code>POST /api/v1/orgs/:org_id/apitokens
</code></pre>
<h3 id="request_10">Request</h3>
<pre><code>{
    "name": "org_token_xyz",
    "privileges": [
        { "scope":"org", "role": "read" },
        { "scope":"site", "site_id": "d96e3952-53e8-4266-959a-45acd55f5114", "role": "admin" },
        { "scope":"sitegroup", "sitegroup_id": "581328b6-e382-f54e-c9dc-999983183a34", "role": "write" }
    ],
    "src_ips": ["63.3.56.0/24", "63.3.55.4"]
}
</code></pre>
<h3 id="parameters_9">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name of the token</td>
</tr>
<tr>
<td><code>privileges</code></td>
<td><code>list</code></td>
<td>list of privileges the token has on the orgs/sites</td>
</tr>
<tr>
<td><code>scope</code></td>
<td><code>string</code></td>
<td>site / org / sitegroup</td>
</tr>
<tr>
<td><code>role</code></td>
<td><code>string</code></td>
<td>admin / write / read</td>
</tr>
<tr>
<td><code>src_ips</code></td>
<td><code>list</code></td>
<td>optional, list of allowed IP addresses from where the token can be used from. At most 10 IP addresses can be specified</td>
</tr>
</tbody>
</table>
<h3 id="response_17">Response</h3>
<pre><code>{
    "name": "org_token_xyz",
    "id": "7cc917df-630a-1508-1889-e18028052dde",
    "key": "MEaTAllON7hM0GUquvka2czM0xE9RIh2bpkZK2UqefoHoT1bDzET7FcXB9POI8o9zkkMy52doYpz3gG4aiDpStZOv4zQ3quf",
    "org_id": "bc411cd9-0d1b-4713-94df-eee8617758ed",
    "src_ips": ["63.3.56.0/24", "63.3.55.4"]
}
</code></pre>
<h2 id="use-api-token">Use API Token</h2>
<p>To use API token, add a Authorization header when making an API request like the following:</p>
<pre><code>Authorization: Token &lt;key&gt;

GET /api/v1/self
</code></pre>
<h2 id="list-current-api-tokens">List Current API Tokens</h2>
<pre><code>GET /api/v1/orgs/:org_id/apitokens
</code></pre>
<h3 id="response_18">Response</h3>
<pre><code>[
    {
        "name": "org_token_xyz",
        "id": "7cc917df-630a-1508-1889-e18028052dde",
        "key": "MEaT...3quf",
        "org_id": "bc411cd9-0d1b-4713-94df-eee8617758ed",
        "created_by": "joe@abc.com",
        "privileges": [
            {
                "scope": "org",
                "org_id": "bc411cd9-0d1b-4713-94df-eee8617758ed",
                "role": "write"
            }
        ],
        "src_ips": ["63.3.56.0/24", "63.3.55.4"]
    },
    {
        "name": "?",
        "id": "864f351a-1377-4ad9-83f8-72f3fe6199ba",
        "key": "1qkb...QQCL",
        "org_id": "bc411cd9-0d1b-4713-94df-eee8617758ed",
        "created_by": null,
        "privileges": [
            {
                "scope": "site",
                "site_id": "d96e3952-53e8-4266-959a-45acd55f5114",
                "role": "admin"
            }
        ]
    }
]
</code></pre>
<h3 id="response-definition_1">Response Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name of the token</td>
</tr>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>token id</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id</td>
</tr>
<tr>
<td><code>created_by</code></td>
<td><code>string</code></td>
<td>email of the token creator / null if creator is deleted</td>
</tr>
<tr>
<td><code>privileges</code></td>
<td><code>list</code></td>
<td>list of privileges the token has on the orgs/sites</td>
</tr>
</tbody>
</table>
<h2 id="update-api-token">Update API Token</h2>
<pre><code>PUT /api/v1/orgs/:org_id/apitokens/:apitoken_id
</code></pre>
<h3 id="request_11">Request</h3>
<pre><code>{
    "name": "org_token_pqr",
    "privileges": [
        { "scope":"org", "role": "write" },
        { "scope":"site", "site_id": "d96e3952-53e8-4266-959a-45acd55f5114", "role": "admin" }
    ],
    "src_ips": ["63.3.56.0/24", "63.3.55.6"]
}
</code></pre>
<h3 id="parameters_10">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name of the token</td>
</tr>
<tr>
<td><code>privileges</code></td>
<td><code>list</code></td>
<td>list of privileges the token has on the orgs/sites</td>
</tr>
<tr>
<td><code>scope</code></td>
<td><code>string</code></td>
<td>site / org / sitegroup</td>
</tr>
<tr>
<td><code>role</code></td>
<td><code>string</code></td>
<td>admin / write / read</td>
</tr>
<tr>
<td><code>src_ips</code></td>
<td><code>list</code></td>
<td>list of allowed IP addresses from where the token can be used from. At most 10 IP addresses can be specified</td>
</tr>
</tbody>
</table>
<h3 id="response_19">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h2 id="get-api-token">Get API Token</h2>
<pre><code>GET /api/v1/orgs/:org_id/apitokens/:apitoken_id
</code></pre>
<h3 id="response_20">Response</h3>
<pre><code>[
    {
        "name": "org_token_pqr",
        "id": "7cc917df-630a-1508-1889-e18028052dde",
        "key": "MEaT...3quf",
        "org_id": "bc411cd9-0d1b-4713-94df-eee8617758ed",
        "created_by": "joe@abc.com"
        "privileges": [
            {
                "scope": "org",
                "org_id": "bc411cd9-0d1b-4713-94df-eee8617758ed",
                "role": "write"
            },
            {
                "scope": "site",
                "site_id": "d96e3952-53e8-4266-959a-45acd55f5114",
                "role": "admin"
            }
        ],
        "src_ips": ["63.3.56.0/24", "63.3.55.6"]
    }
]
</code></pre>
<h2 id="delete-an-api-token">Delete an API Token</h2>
<pre><code>DELETE /api/v1/orgs/:org_id/apitokens/:apitoken_id
</code></pre>
<h3 id="response_21">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h1 id="sdk-invite">SDK Invite</h1>
<p>SDK Invites can be generated for (and belongs to) an Org. They can be generated by an Admin of an Org and can be revoked
at anytime.</p>
<h2 id="create-a-new-sdk-invite">Create a New SDK Invite</h2>
<pre><code>POST /api/v1/orgs/:org_id/sdkinvites
</code></pre>
<h3 id="request_12">Request</h3>
<pre><code>{
    "name": "Macy's"
}
</code></pre>
<h3 id="parameters_11">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name, will show up in mobile</td>
</tr>
<tr>
<td><code>quota_limited</code></td>
<td><code>boolean</code></td>
<td>whether quota limiting is enabled , default is False</td>
</tr>
<tr>
<td><code>quota</code></td>
<td><code>int</code></td>
<td>number of time this invite can be used</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>default is true</td>
</tr>
</tbody>
</table>
<h3 id="response_22">Response</h3>
<pre><code>{
    "id": "5034b980-b49e-501c-66e0-9de4c38f18a2",
    "name": "Macy's",
    "enabled": true,
    "quota": -1,
    "created_time": 1428954000
    "expire_time": 1428954000
}
</code></pre>
<h2 id="deleterevoke-a-sdk-invite">Delete/Revoke a SDK Invite</h2>
<pre><code>DELETE /api/v1/orgs/:org_id/sdkinvites/:sdkinvite_id
</code></pre>
<h2 id="get-qrcode-for-a-sdk-invite">Get QRCode for a SDK Invite</h2>
<pre><code>GET /api/v1/orgs/:org_id/sdkinvites/:sdkinvite_id/qrcode
</code></pre>
<h2 id="send-sdk-invite-as-email-sms">Send SDK Invite as Email / SMS</h2>
<pre><code>POST /api/v1/orgs/:org_id/sdkinvites/:sdkinvite_id/email
POST /api/v1/orgs/:org_id/sdkinvites/:sdkinvite_id/sms
</code></pre>
<h3 id="request_13">Request</h3>
<pre><code>// when sending email
{
    "email": "test@abc.com"
}

// when sending sms
{
    "number": "14081234567"
}
</code></pre>
<h2 id="sdk-client-activation">SDK Client Activation</h2>
<pre><code>POST /api/v1/mobile/verify/:secret
</code></pre>
<h3 id="request_14">Request</h3>
<pre><code>{
    "device_id": "b069b358-4c97-5319-1f8c-7c5ca64d6ab1"
}
</code></pre>
<h3 id="response_23">Response</h3>
<pre><code>{
    "name": "Macy's",
    "org_id": "2818e386-8dec-2562-9ede-5b8a0fbbdc71",
    "secret": "device-specific-secret"
}
</code></pre>
<h1 id="sdk-client">SDK Client</h1>
<h2 id="update-sdkclient-information">Update SdkClient information</h2>
<pre><code>PUT /api/v1/orgs/:org_id/sdkclients/:sdkclient_id
</code></pre>
<h3 id="request_15">Request</h3>
<pre><code>{
    "name": "John Smith"
}
</code></pre>
<h1 id="sdk-template">SDK Template</h1>
<p>SDK Template stores the customization (e.g. background image, text…)</p>
<h2 id="create-a-new-sdk-template">Create a New SDK Template</h2>
<pre><code>POST /api/v1/orgs/:org_id/sdktemplates
</code></pre>
<h3 id="request_16">Request</h3>
<pre><code>{
    "name": "default"
    "welcome_msg": "Welcome to Mist",
    "bg_image"   :"http://p.imgci.com/db/PICTURES/CMS/227700/227791.4.jpg",
    "btn_flr_bgcolor" : "#282828",
    "search_txtcolor" : "#282828",
    "header_txt":"Mist",
    "default": true
}
</code></pre>
<h3 id="parameters_12">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name for identification purpose</td>
</tr>
<tr>
<td><code>default</code></td>
<td><code>boolean</code></td>
<td>whether this is the default template when there are multiple templates</td>
</tr>
</tbody>
</table>
<h2 id="update-sdk-template">Update Sdk Template</h2>
<pre><code>PUT /api/v1/orgs/:org_id/sdktemplates/:sdktemplate_id
</code></pre>
<h2 id="deleterevoke-a-sdk-template">Delete/Revoke a SDK Template</h2>
<pre><code>DELETE /api/v1/orgs/:org_id/sdktemplates/:sdktemplate_id
</code></pre>
<h1 id="license">License</h1>
<h2 id="get-license-summary">Get License Summary</h2>
<pre><code>GET /api/v1/orgs/:org_id/licenses
</code></pre>
<h3 id="response_24">Response</h3>
<pre><code>{
    "licenses": [
        {
            "order_id": "00000464",
            "subscription_id": "SUB-0000144",
            "type": "SUB-MAN",
            "start_time": 1504828800,
            "end_time": 1520380800,
            "quantity": 180
        },
        {
            "order_id": "00000464",
            "subscription_id": "SUB-0000145",
            "type": "SUB-MAN",
            "start_time": 1504828800,
            "end_time": 1520380800,
            "quantity": 30
        }
        {
            "order_id": "00000464",
            "subscription_id": "SUB-0000146",
            "type": "SUB-LOC",
            "start_time": 1504828800,
            "end_time": 1520380800,
            "quantity": 120
        }
    ],
    "amendments": [
        {
            "id": "2b9116ab-cd1e-e897-6e08-31fccd88e792",
            "subscription_id": "SUB-0000144",
            "type": "SUB-MAN",
            "start_time": 1504828800,
            "end_time": 1520380800,
            "quantity": -30
        },
        {
            "id": "4e974f27-fcbc-03cb-caa4-688e20aa539f",
            "subscription_id": "SUB-0000146",
            "type": "SUB-LOC",
            "start_time": 1504828800,
            "end_time": 1520380800,
            "quantity": 75
        },
    ],
    // current usage summary (across sites)
    "summary": {
        "SUB-MAN": 150,
        "SUB-LOC": 120
    },
    "entitled": {
        "SUB-MAN": 180,
        "SUB-LOC": 195
    }
}
</code></pre>
<h3 id="definitions">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>licenses</code></td>
<td><code>list</code></td>
<td>list of licenses</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>subscription type, SUB-MAN / SUB-LOC / SUB-AST / SUB-VNA / SUB-DATA</td>
</tr>
<tr>
<td><code>start</code></td>
<td><code>long</code></td>
<td>start date of the license term</td>
</tr>
<tr>
<td><code>end</code></td>
<td><code>long</code></td>
<td>end date of the license term</td>
</tr>
<tr>
<td><code>quantity</code></td>
<td><code>int</code></td>
<td>number of devices entitled for this license</td>
</tr>
<tr>
<td><code>usage</code></td>
<td><code>object</code></td>
<td>usages of each license type</td>
</tr>
<tr>
<td><code>entitled</code></td>
<td><code>object</code></td>
<td>currently entitled for each license type</td>
</tr>
</tbody>
</table>
<h2 id="get-license-usage-by-sites">Get License Usage By Sites</h2>
<p>This shows license usage (i.e. needed) based on the features enabled for the site.</p>
<pre><code>GET /api/v1/orgs/:org_id/licenses/usages
</code></pre>
<h3 id="response_25">Response</h3>
<pre><code>[
    {
        "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
        "num_devices": 80,
        "usages": {
            "SUB-MAN": 60
            "SUB-LOC": 30
        },
        "fully_loaded": {
            "SUB-MAN": 80
            "SUB-LOC": 30
        }
    }
]
</code></pre>
<h3 id="definitions_1">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>usages</code></td>
<td><code>object</code></td>
<td>subscriptions and their quantities</td>
</tr>
</tbody>
</table>
<h2 id="claim-an-order-by-activation-code">Claim an Order by Activation Code</h2>
<pre><code>POST /api/v1/orgs/:org_id/claim
</code></pre>
<h3 id="example_1">Example</h3>
<pre><code>{
    "code": "ZHT3K-H36DT-MG85D-M61AC",
    "type": "all"
}
</code></pre>
<h3 id="parameters_13">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>code</code></td>
<td><code>string</code></td>
<td>activation code</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>what to claim, all (default) / license / inventory</td>
</tr>
<tr>
<td><code>device_type</code></td>
<td><code>string</code></td>
<td>if only intended to claim certain device type</td>
</tr>
<tr>
<td><code>async</code></td>
<td><code>bool</code></td>
<td>whether to do a async claim process</td>
</tr>
</tbody>
</table>
<h3 id="response-of-the-licenses-that-are-successfully-claimed-and-applied">Response of the license(s) that are successfully claimed and applied</h3>
<pre><code>{
    "license_added": [
        {
            "type": "SUB-MAN",
            "start": 1504828800,
            "end": 1520380800,
            "quantity": 180
        },
        {
            "type": "SUB-LOC",
            "start": 1504828800,
            "end": 1520380800,
            "quantity": 120
        }
    ],
    "license_duplicated": [
        {
            "type": "SUB-MAN",
            "start": 1504828800,
            "end": 1520380800,
            "quantity": 180
        }
    ],
    "license_error": [
        {
            "order": "00000464",
            "reason": ""
        }
    ],
    "inventory_added": [
        {
            "serial": "FXLH2015150025",
            "model": "AP41",
            "type": "ap",
            "magic": "6JG8EPTFV2A9Z2N",
            "mac": "5c5b35000018"
        }
    ],
    "inventory_duplicated": [
        {
            "serial": "FXLH2015150027",
            "model": "AP41",
            "type": "ap",
            "magic": "DVH4VSNMSZPDXBR",
            "mac": "5c5b35000012"
        }
    ],
    "inventory_pending": [ 
        {
            "mac": "5c5b35000012" // for async claim
        }
    ]
}
</code></pre>
<h3 id="response-when-the-key-is-invalid-or-already-used">Response when the key is invalid (or already used)</h3>
<pre><code>Status: 400 Bad Request
</code></pre>
<h2 id="get-processing-status-for-async-claim">Get Processing Status for Async Claim</h2>
<pre><code>GET /api/v1/orgs/:org_id/claim/status?detail=False
</code></pre>
<h3 id="response_26">Response</h3>
<pre><code>{
    'status': 'done', //prepared, ongoing, done
    'total': 2, 
    'scheduled_at': 1709598052, 
    'processed': 2, 
    'failed': 0, 
    'succeed': 2, 
    'timestamp': 1709598053, 
    'incompleted': [], 
    'completed': ['000000000022', '000000000011'], 
    'details': [{
        'mac': '000000000022', 
        'status': 'added', 
        'timestamp': 1709598053, 
        }
    ]
}
</code></pre>
<h3 id="response-definition_2">Response Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>status</code></td>
<td><code>string</code></td>
<td>processing status of async; prepared/ongoing/done</td>
</tr>
<tr>
<td><code>total</code></td>
<td><code>int</code></td>
<td>total number of device included in claim</td>
</tr>
<tr>
<td><code>failed</code></td>
<td><code>int</code></td>
<td>current failed number of device</td>
</tr>
<tr>
<td><code>succeed</code></td>
<td><code>int</code></td>
<td>current succeed number of device</td>
</tr>
<tr>
<td><code>scheduled_at</code></td>
<td><code>int</code></td>
<td>epoch time of aysnc claim scheduled</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>int</code></td>
<td>epoch time of last reporting time</td>
</tr>
<tr>
<td><code>processed</code></td>
<td><code>int</code></td>
<td>current proceseed number of device</td>
</tr>
<tr>
<td><code>incompleted</code></td>
<td><code>list</code></td>
<td>current incompleted lists (macs)</td>
</tr>
<tr>
<td><code>completed</code></td>
<td><code>list</code></td>
<td>current completed lists (macs)</td>
</tr>
<tr>
<td><code>detail</code></td>
<td><code>list</code></td>
<td>detail claim status per device</td>
</tr>
</tbody>
</table>
<h2 id="move-license-to-another-org">Move License To Another Org</h2>
<p>If the admin has admin privilege against the <code>org_id</code> and <code>dst_org_id</code>, he can move some of the licenses to another Org.
Given that:</p>
<ol>
<li>the specified license is currently active</li>
<li>there’s enough licenses left in the specified license (by <code>subscription_id</code>)</li>
<li>
<p>there will still be enough entitled licenses for the <code>type</code> of license after the amendment</p>
<p>PUT /api/v1/orgs/:org_id/licenses</p>
</li>
</ol>
<h3 id="request_17">Request</h3>
<pre><code>{
    "op": "amend",
    "subscription_id": "SUB-0000144",
    "dst_org_id": "3eff35f7-c218-894e-bca2-24e5325601cc",
    "quantity": 10
}
</code></pre>
<h3 id="parameters_14">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>op</code></td>
<td><code>string</code></td>
<td>operation (amend/unamend/delete/annotate)</td>
</tr>
<tr>
<td><code>subscription_id</code></td>
<td><code>string</code></td>
<td>license id</td>
</tr>
<tr>
<td><code>dst_org_id</code></td>
<td><code>string</code></td>
<td>destination org id</td>
</tr>
<tr>
<td><code>quantity</code></td>
<td><code>int</code></td>
<td>quantity</td>
</tr>
</tbody>
</table>
<h2 id="undo-the-license-move">Undo the License Move</h2>
<pre><code>PUT /api/v1/orgs/:org_id/licenses
</code></pre>
<h3 id="request_18">Request</h3>
<pre><code>{
    "op": "unamend",
    "amendment_id": "2b9116ab-cd1e-e897-6e08-31fccd88e792",
}
</code></pre>
<h2 id="delete-license">Delete License</h2>
<pre><code>PUT /api/v1/orgs/:org_id/licenses
</code></pre>
<h3 id="request_19">Request</h3>
<pre><code>{
    "op": "delete",
    "subscription_id": "SUB-0000144"
}
</code></pre>
<h2 id="annotate-a-license">Annotate a License</h2>
<pre><code>PUT /api/v1/orgs/:org_id/licenses
</code></pre>
<h3 id="request_20">Request</h3>
<pre><code>{
    "op": "annotate",
    "subscription_id": "SUB-000144",
    "notes": "customer notes"
}
</code></pre>
<h1 id="audit-logs">Audit Logs</h1>
<p>Audit logs records all administrative activities in an Org</p>
<h2 id="get-a-list-of-change-logs-for-the-current-org">Get a list of change logs for the current Org</h2>
<pre><code>GET /api/v1/orgs/:org_id/logs?start=1431384000&amp;end=1431298000&amp;limit=100
</code></pre>
<h3 id="supported-filters">Supported Filters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>admin_name</code></td>
<td><code>string</code></td>
<td>admin name or email</td>
</tr>
<tr>
<td><code>message</code></td>
<td><code>string</code></td>
<td>message</td>
</tr>
</tbody>
</table>
<h3 id="response_27">Response</h3>
<p>The logs are always sorted by time in descending order</p>
<pre><code>{
    "start": 1428939600,
    "end":   1428954000,
    "limit": 100,

    "total": 135,
    "results": [
        {
            "timestamp": 1431382121,
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "org_id": "2818e386-8dec-2562-9ede-5b8a0fbbdc71",
            "admin_id": "72bfa2bd-e58a-4670-9d20-a1468f7a6f58",
            "admin_name": "test@mistsys.com",
            "message": "TEST AUDIT",
            "id": "c6f9347b-b0a4-4a23-b927-fa9249f2ffb2"
        }
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>timestamp</code></td>
<td><code>long</code></td>
<td>start time, in epoch</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id</td>
</tr>
<tr>
<td><code>admin_id</code></td>
<td><code>string</code></td>
<td>admin id</td>
</tr>
<tr>
<td><code>admin_name</code></td>
<td><code>string</code></td>
<td>name of the admin that performs the action</td>
</tr>
<tr>
<td><code>message</code></td>
<td><code>string</code></td>
<td>log message</td>
</tr>
<tr>
<td><code>before</code></td>
<td><code>object</code></td>
<td>field values prior to the change</td>
</tr>
<tr>
<td><code>after</code></td>
<td><code>object</code></td>
<td>field values after the change</td>
</tr>
</tbody>
</table>
<h2 id="count-by-distinct-attributes-of-audit-logs">Count by Distinct Attributes of Audit Logs</h2>
<pre><code>GET /api/v1/orgs/:org_id/logs/count?distinct=admin_name
</code></pre>
<h3 id="request_21">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>admin_id / admin_name / message / site_id, default is admin_name</td>
</tr>
</tbody>
</table>
<h3 id="response_28">Response</h3>
<pre><code>{
    "start": 1511967600,
    "end": 1513177200,
    "limit": 10,
    "distinct": "admin_name",

    "total": 2,
    "results": [
        {
            "admin_name": "John Smith john.smith@corp.com",
            "count": 61
        },
        {
            "admin_name": "Eric Sky eric@corp.com",
            "count": 44
        }
    ]
}
</code></pre>
<h1 id="org">Org</h1>
<p>Org admin can invite people to manage the org. Furthermore, he can dictate the level of security those accounts are. The
check is enforced when the invited admin tries to “accept” the invitation and every time the admin tries to login</p>
<h2 id="create-org">Create Org</h2>
<pre><code>POST /api/v1/orgs
</code></pre>
<h3 id="scheme">Scheme</h3>
<pre><code>{
    "name": "ABC Company",
    "session_expiry": 1440,

    "alarmtemplate_id": "684dfc5c-fe77-2290-eb1d-ef3d677fe168",
    "orggroup_ids": [ "507f1bab-13ba-73e2-f291-2bcb8d1362b0" ]
    "allow_mist": true
}
</code></pre>
<h3 id="parameters_15">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>org name</td>
</tr>
<tr>
<td><code>session_expiry</code></td>
<td><code>int</code></td>
<td>how long the login session should last, in minutes, default is 1440 (24 hours), between 10 (min) and 20160 (2 weeks)</td>
</tr>
<tr>
<td><code>alarmtemplate_id</code></td>
<td><code>string</code></td>
<td>Alarm Template ID, the default Alarm Template to use for the Org, can be override by Site</td>
</tr>
<tr>
<td><code>orggroup_ids</code></td>
<td><code>list</code></td>
<td>list of OrgGroup ids</td>
</tr>
<tr>
<td><code>allow_mist</code></td>
<td><code>boolean</code></td>
<td>whether to allow Mist to look at this org, default is True</td>
</tr>
</tbody>
</table>
<h2 id="get-org">Get Org</h2>
<pre><code>GET /api/v1/orgs/:org_id
</code></pre>
<h3 id="response_29">Response</h3>
<pre><code>{
    'name': 'Org',
    'id': '2818e386-8dec-2562-9ede-5b8a0fbbdc71',
    'msp_id': 'b9d42c2e-88ee-41f8-b798-f009ce7fe909',
    'created_time': 1652905706,
    'modified_time': 1652905706,
    'allow_mist': True,
    'session_expiry': 1440,
    'alarmtemplate_id': None,
    'msp_name': 'MSP',
    'msp_logo_url': 'https://.../logo/b9d42c2e-88ee-41f8-b798-f009ce7fe909.jpeg'
}
</code></pre>
<h3 id="definitions_2">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>msp_name</code></td>
<td><code>string</code></td>
<td>name of the msp the org belongs to</td>
</tr>
<tr>
<td><code>msp_logo_url</code></td>
<td><code>string</code></td>
<td>logo uploaded by the MSP with advanced tier, only present if provided</td>
</tr>
</tbody>
</table>
<h2 id="update-org">Update Org</h2>
<pre><code>PUT /api/v1/orgs/:org_id
</code></pre>
<h2 id="delete-org">Delete Org</h2>
<pre><code>DELETE /api/v1/orgs/:org_id
</code></pre>
<h2 id="clone-org">Clone Org</h2>
<p>Create an Org by cloning from another one. Org Settings, Templates, Device Profiles, Alarm Templates, RFTemplates,
Security Policies, Wxlan Tags, Wxlan Tunnels, Wxlan Rules, Org Wlans will be copied. Sites and Site Groups will not be
copied, and therefore, the copied template will not be applied to any site/sitegroups.</p>
<pre><code>POST /api/v1/orgs/:org_id/clone
</code></pre>
<h3 id="request_22">Request</h3>
<pre><code>{
    "name": "New Org"
}
</code></pre>
<h1 id="org-stats">Org Stats</h1>
<pre><code>GET /api/v1/orgs/:org_id/stats
</code></pre>
<h3 id="response_30">Response</h3>
<pre><code>{
    "num_inventory": 12,
    "num_devices": 10,
    "name": "Sam MSP Customer 5",
    "orggroup_ids": [],
    "allow_mist": false,
    "num_devices_connected": 8,
    "num_devices_disconnected": 2,
    "num_sites": 1,
    "id": "448a3934-df89-11e5-8898-1258369c38a9"
}
</code></pre>
<h3 id="definitions_3">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>num_inventory</code></td>
<td><code>int</code></td>
<td>number of devices claimed</td>
</tr>
<tr>
<td><code>num_devices</code></td>
<td><code>int</code></td>
<td>number of devices in use</td>
</tr>
<tr>
<td><code>num_devices_connected</code></td>
<td><code>int</code></td>
<td>number of devices in use that are connected</td>
</tr>
<tr>
<td><code>num_devices_disconnected</code></td>
<td><code>int</code></td>
<td>number of devices in use that are not connected</td>
</tr>
</tbody>
</table>
<h1 id="org-setting">Org Setting</h1>
<h2 id="get-org-setting">Get Org Setting</h2>
<pre><code>GET /api/v1/orgs/:org_id/setting
</code></pre>
<h3 id="request_23">Request</h3>
<pre><code>{
    "password_policy": {
        "enabled": true
        "expiry_in_days": 60,
        "min_length": 8,
        "requires_special_char": false,
        "requires_two_factor_auth": true
    },
    "ui_idle_timeout": 10,

    "switch_mgmt": {
         "ap_affinity_threshold": 10
    },

    "mgmt": {
        "use_wxtunnel": false,
        "use_mxtunnel": true,
        "mxtunnel_ids": ["08cd7499-5841-51c8-e663-fb16b6f3b45e"]
    },

    "disable_remote_shell": false,
    "disable_pcap": false,
    "pcap": {
        "bucket": "myorg-pcap"
        "max_pkt_len": 128
    },
    "pcap_bucket_verified": true,

    "security": {
        "disable_local_ssh": false,
        "limit_ssh_access": false,
        "fips_zeroize_password": "NUKETHESITE"
    },

    // controls api behavior
    "api_policy": {
        // by default, API hides password/secrets when the user doesn't have write access
        "no_reveal": true,  // false (default, may change) / true (API will not return any secrets)
    },

    "installer": {
        "grace_period": 14,
        "extra_site_ids": [
            "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "52f4347e-3e4b-186c-21ca-ad5b70eb23d6"
        ],
        "allow_all_sites": false,
        "allow_all_devices": false
    },

    "wan_pma": {
        "enabled": false  // default is false
    },
    "wired_pma": {
        "enabled": false  // default is false
    },
    "wireless_pma": {
        "enabled": true  // default is true 
    },

    "auto_site_assignment": {
        "enable": true,

        "rules": [
            // use device name (via Installer APIs)
            {
                "src": "name",
                "expression": "[0:3]",           // "abcdef" -&gt; "abc"
                              "split(.)[1]",     // "a.b.c" -&gt; "b"
                              "split(-)[1][0:3], // "a1234-b5678-c90" -&gt; "b56"
                "prefix": "XX-",
                "suffix": "-YY"
            },
            // use ext_ip
            {
                "src": "ext_ip",
                "subnet": "34.82.100.0/24",
                "value": "site1"
            },
            // use subnet
            {
                "src": "subnet",
                "subnet": "10.1.2.0/18",
                "value": "s1351"
            },
            // use LLDP System Name
            {
                "src": "lldp_system_name",
                "expression": "..." // same as above
            },
            // use DNS Suffix
            {
                "src": "dns_suffix",
                "expression": "..." // same as above
            },
            {
                "src": "model",
                "model": "AP41",
                "value": "s1351"
            },
            {
                // optional filters
                "match_device_type": "ap",  // ap / switch / gateway / other, default is `ap`
                "match_model": "AP41",

                ...
            },
            {
                // DRAFT
                "match_device_type": "gateway",
                "src": "geoip",
                "match_country": ...

                // site name for the device to be assigned to
                "value": "city",  // "city" / "city+country" / ...

                // by default, a claimed device only gets assigned if the site exists
                // to auto-create the site, enable this
                "create_new_site_if_needed": true,
                // and if a gateway template is desired for this newly created site
                "gatewaytemplate_id": "6f9b2e75-9b2f-b5ae-81e3-e14c76f1a90f"                
            },            
        ]
    },

    "auto_device_naming": {
        "enable": true,

        "rules": [
            {
                // use LLDP Port Description
                "src": "lldp_port_desc",
                "prefix": "MIST-",
                "suffix": ""
                "expression": "..." // same as above
            },
            {
                // use mac directly
                "src": "mac",
                "prefix": "MIST-",
                "suffix": "",
                "match_device_type": "ap",  // ap / switch / gateway, default is `ap`
            }
        ]
    },

    "cloudshark": {
        "apitoken": "accbd6f10c6d05c3"

        // if using CS Enteprise
        "url": "https://cloudshark.hosted.domain"
    }

    "cradlepoint": {
        "ecm_api_id": "73446d61-2206-4ea5-855a-0043f980be62",
        "ecm_api_key": "68b329da9893e34099c7d8ad5cb9c9405",
        "cp_api_id": "84446d61-2206-4ea5-855a-0043f980be54",
        "cp_api_key": "79c329da9893e34099c7d8ad5cb9c941",
    },

    "celona": {
        "api_prefix": "cc3273fcb016470e",
        "api_key": "$2a$04$OkaLCoJn6rDjR8ha.oduQVDST3.kJNIrte"
    },

    "auto_deviceprofile_assignment": {
        "enable": true,

        "rules": [
            // same rules definition that can be used for auto_site_assignment
        ]
    },


    // RADSec certs for AP
    "cacerts": [
        "-----BEGIN CERTIFICATE-----\nMIIFZjCCA06gAwIBAgIIP61/1qm/uDowDQYJKoZIhvcNAQELBQE\n-----END CERTIFICATE-----",
        "-----BEGIN CERTIFICATE-----\nBhMCRVMxFDASBgNVBAoMC1N0YXJ0Q29tIENBMSwwKgYDVn-----END CERTIFICATE-----"
    ],
    "device_cert": {
        "cert": "-----BEGIN CERTIFICATE-----\nMIIFZjCCA06gAwIBAgIIP61/1qm/uDowDQYJKoZIhvcNAQELBQE\n-----END CERTIFICATE-----",
        "key": "-----BEGIN PRI..."
    },

    "tags": [ "beta" ],
    "device_updown_threshold": 0,
    // by default, device_updown_thresold, if set, will apply to all devices types
    // if different values for specific device type is desired, use the following
    "ap_updown_threshold": null,
    "gateway_updown_threshold": 10,
    "switch_updown_threshold": 0,

    "mxedge_mgmt": {
        "mist_password": "MIST_PASSWORD",
        "root_password": "ROOT_PASSWORD",
        "fips_enabled": true, // default is false
        "oob_ip_type": "disabled",  // dhcp (default) / disabled
        "oob_ip_type6": "disabled", // autoconf (default) / dhcp / disabled
        "config_auto_revert": true, // default is false
    },

    "blacklist_url": "https://papi.s3.amazonaws.com/blacklist/xxx...",

    "mist_nac": {
        // default is false. By default NAC POD failover considers all NAC pods available around the globe,
        // i.e. EU, US, or APAC based, failover happens based on geo IP of the originating site.
        // For strict GDPR compliancy NAC POD failover would only happen between the PODs located within the EU environment,
        // and no authentication would take place outside of EU. This is an org setting that is applicable
        // to WLANs, switch templates, mxedge clusters that have mist_nac enabled
        "eu_only": false,

        // by default NAS devices(switches/aps) and proxies(mxedge) are configured to use port 2083(radsec) to reach mist-nac
        // to override that port with 443(ssl), use the following knob
        // this is a org level setting that is applicable to wlans, switch-templates, and mxedge-clusters that have
        // mist-nac enabled
        "use_ssl_port": true,

        // by default NAS devices(switches/aps) and proxies(mxedge) are configured to reach mist-nac via IPv4
        "use_ip_version": "v4",  // v4 (default) / v6 / v4+v6

        // use this IDP when no explicit realm present in the incoming
        // username/CN OR when no IDP is explicitly mapped to the incoming realm.
        "default_idp_id": "4c441a74-d0de-32c4-78a7-a05e00d080ae",

        "idps": [
            {
                "id": "4c441a74-d0de-32c4-78a7-a05e00d080ae",

                // which realm should trigger this IDP
                "user_realms": [ "abc" ],

                // we extract user realm from
                // 1. Username-AVP (`mist.com` from john@mist.com)
                // 2. Cert CN
            }.
            {
                // mxedge-proxy (eduroam) type IDP
                "id": "5c441a74-d0de-32c4-78a7-a05e00d080af",

                // which realm should trigger this IDP
                "user_realms": [ "*.edu" ],

                // we extract user realm from
                // 1. Username-AVP (`stanford.com` from anonymous@stanford.edu)

                // when the IDP of mxedge-proxy type, exclude the following realms from proxying
                // in addition to other valid home realms in this org
                "exclude_realms": [
                  "stanford.edu"
                ],
            }.
            ...
        ],
        // the CA certs we use to verify client certs
        "cacerts": [
            ""-----BEGIN CERTIFICATE-----\nMIIFZjCCA06gAwIBAgIIP61/1qm/uDowDQYJKoZIhvcNAQELBQE\n-----END CERTIFICATE-----",
            ...
        ],
        // radius server cert to be presented in EAP TLS
        "server_cert": {
            "cert": "-----BEGIN CERTIFICATE-----\nMIIFZjCCA06gAwIBAgIIP61/1qm/uDowDQYJKoZIhvcNAQELBQE\n-----END CERTIFICATE-----",
            "key": "-----BEGIN PRI...",
            // private key password (optional)
            "password": "****"
        },

        // eap ssl security level
        // see https://www.openssl.org/docs/man1.1.1/man3/SSL_CTX_set_security_level.html#DEFAULT-CALLBACK-BEHAVIOUR
        "eap_ssl_security_level": 2,  // 2 (default), 1 - 4

        // disable RSAE encryption algorithms forcefully
        // see https://www.openssl.org/docs/man3.0/man1/openssl-ciphers.html
        "disable_rsae_algorithms": false, // true - to disable RSAE_PSS_SHA256, RSAE_PSS_SHA384, RSAE_PSS_SHA512 from server side

        // allow customer to choose the EAP-TLS client certificate's field to use for IDP User Groups lookup
        “idp_user_cert_lookup_field”: automatic (default) // email, upn, cn

        // allow customer to choose the EAP-TLS client certificate's field to use for IDP Machine Groups lookup
        “idp_machine_cert_lookup_field”: automatic (default) // cn, dns
    },

    "gateway_mgmt": {
        "app_usage": true,
        "app_probing": {
            "apps": [
                "facebook" // app-keys from /const/applications
            ]
        },

        "overlay_ip": {
            // when it's going overlay, a routable IP to overlay will be required
            "ip": "172.16.10.5",
            // for SSR HA cluster, another IP for node1 will be required, too 
            "node1_ip": "172.16.10.6"
        },
        // optional, for some of the host-out traffic, the path preference can be specified
        // by default, ECMP will be used from all available route/path
        // available services: dns/mist/ntp
        "host_out_policies": {
            "dns": {
                "path_preference": "dc_only"
            },
            "ntp":
                "path_preference": "broadband_wans"
            },
            "syslog":
                "path_preference": "broadband_wans",
                // if different path_preference is desired for each syslog server
                // see `remote_syslog`
                "servers": [
                    {
                        "host": "103.35.3.5",
                        "name": "server1",
                        "path_preference": "dc_only"
                    }
                ]
            }
        },
        "host_in_policies": {
            "icmp": {
                "name": "policy1",
                "tenants": [
                    "datacenter",
                    "wan-net-1"
                ]
            },
            "snmp": {
                "name": "policy2",
                "tenants": [
                    "wan-net-2"
                ]
            }
        }
        "fips_enabled": true // default is false
    },

    // by default, webshell access is only enabled for Admin user
    "junos_shell_access": {
        "admin": "admin",  // admin (default) / viewer / none
        "write": "admin",  // admin (default) / viewer / none
        "read": "none"  // viewer / none (default)
        "helpdesk": "none" // viewer / none (default)
    },

    "synthetic_test": {
        "disabled": true, // default is false (i.e. enabled)

        "aggressiveness": "auto",  // auto (default) / high / low



        // allow user to test custom
        "custom_probes": {
            "connectivity-to-dc2": {
                "type" : "icmp”; // icmp / curl / tcp
                // if type = icmp / tcp
                "host": "internal.host",
                // if type = tcp
                "port": 443,

                // if type=curl 
                "url": "https://10.3.5.1:8080/about”, // can be url or IP

                "aggressiveness": "auto", // auto (default) / high / low / med
                "threshold": 100  // milliseconds
            }        
        },

        "vlans": [
            {
                "vlan_ids": [10, 20],

                // app name comes from `customer_probes` above or /const/synthetic_test_probes
                "probes": ["telnet-to-dc", "team-reachability"],
            },
            {
                "vlan_ids": [30, 40],
                // for some vlans where we don't want this to run 
                "disabled": true
            },
            {
                "vlan_ids": [18],

                // deprecated
                "custom_test_urls": [ "http://www.abc.com/", "https://10.3.5.1:8080/about" ]
            }
        ],

        // configure minis probes to be tested on lan networks of gateways
        "lan_networks": [
            {
                // networks to run the test
                "networks": ["pos-stations", "pos-machines"],
                // app name comes from `customer_probes` above or /const/synthetic_test_probes
                "probes": ["telnet-to-dc", "team-reachability"],
            }
        ],

        "wan_speedtest": {
            "enabled": false,  // default is false (i.e. disabled)

            // optional
            // by default, we'll look at the tarffic pattern and determine when to run automatically 
            "time_of_day": "02:00"
        }
    },

    // marvis
    "marvis": {
        "auto_operations": {
            // default are all false
            "bounce_port_for_abnormal_poe_client": false,
            "disable_port_when_rogue_dhcp_server_detected": false,
            "disable_port_when_ddos_protocol_violation": false
        }
    },

    "vpn_options": {
        "as_base": 65000,  // 1-4294967295, default is 65000,
        "st_subnet": "10.224.0.0/12"  // default is 10.224.0.0/12, requiring /12 or bigger to support 16 private IPs for 65535 gateways
    },

    "juniper": {
        "linked": true,
        "customer_name": "Corp NMO"
    },

    // t128 ssr
    "ssr": {
        "conductor_hosts": [ "1.1.1.1", 2.2.2.2" ],
        "conductor_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwc2siOiIxMj",
        "disable_stats": false,
    },

    "jcloud": {
        "org_id": "&lt;jcloud_org_id&gt;",
        "org_apitoken", "&lt;jcloud_token&gt;",
        "org_apitoken_name", "&lt;jcloud_token_name&gt;"
    },

    "jcloud_ra": {
        "org_id": "&lt;jcloud_org_id&gt;",
        "org_apitoken", "&lt;jcloud_token&gt;",
        "org_apitoken_name", "&lt;jcloud_token_name&gt;"
    },

    "switch": {
        // auto_upgrade device first time it is onboarded
        "auto_upgrade": {
            "enabled": true,
            "snapshot": true, // default is false
            "custom_versions": {
                "QFX5130-32CD": "23.4R2-S2.3",
                "QFX5120-32C": "23.4R2-S2.1",
            }
        }
    }
}
</code></pre>
<h3 id="parameters_16">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>org name</td>
</tr>
<tr>
<td><code>password_policy</code></td>
<td><code>object</code></td>
<td>password policy</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether the policy is enabled, default is false</td>
</tr>
<tr>
<td><code>expiry_in_days</code></td>
<td><code>int</code></td>
<td>password expiry in days, optional</td>
</tr>
<tr>
<td><code>min_length</code></td>
<td><code>int</code></td>
<td>required password length, default is 8</td>
</tr>
<tr>
<td><code>requires_special_char</code></td>
<td><code>boolean</code></td>
<td>whether to require special character, default is false</td>
</tr>
<tr>
<td><code>requires_two_factor_auth</code></td>
<td><code>boolean</code></td>
<td>whether to require two-factor auth, default is false</td>
</tr>
<tr>
<td><code>ui_idle_timeout</code></td>
<td><code>int</code></td>
<td>automatically logout the user when UI session is inactive, 0-480 in minutes, default is 0 (disabled)</td>
</tr>
<tr>
<td><code>mgmt</code></td>
<td><code>object</code></td>
<td>management-related properties</td>
</tr>
<tr>
<td><code>use_wxtunnel</code></td>
<td><code>boolean</code></td>
<td>whether to use wxtunnel for mgmt connectivity, default is false</td>
</tr>
<tr>
<td><code>use_mxtunnel</code></td>
<td><code>boolean</code></td>
<td>whether to use Mist Tunnel for mgmt connectivity, default is false, this takes precedence over <code>use_wxtunnel</code></td>
</tr>
<tr>
<td><code>mxtunnel_ids</code></td>
<td><code>list</code></td>
<td>list of Mist Tunnels</td>
</tr>
<tr>
<td><code>disable_pcap</code></td>
<td><code>boolean</code></td>
<td>whether to disallow Mist to analyze pcap files (this is required for marvis pcap), default is false</td>
</tr>
<tr>
<td><code>max_pkt_len</code></td>
<td><code>int</code></td>
<td>max_len of non-management packets to capture, default is 128, maximum is 128</td>
</tr>
<tr>
<td><code>disable_local_ssh</code></td>
<td><code>boolean</code></td>
<td>whether to disable local SSH (by default, local SSH is enabled with <code>allow_mist</code> in Org is enabled</td>
</tr>
<tr>
<td><code>limit_ssh_access</code></td>
<td><code>boolean</code></td>
<td>whether to allow certain SSH keys to SSH into the AP (see <a href="https://api.mist.com/api/v1/docs/Site#site-setting">Site:Setting</a>), default is false</td>
</tr>
<tr>
<td><code>fips_zeroize_password</code></td>
<td><code>string</code></td>
<td>password required to zeroize devices (FIPS) on site level</td>
</tr>
<tr>
<td><code>cacerts</code></td>
<td><code>list</code></td>
<td>list of PEM-encoded ca certs</td>
</tr>
<tr>
<td><code>device_cert</code></td>
<td><code>object</code></td>
<td>common device cert, optional</td>
</tr>
<tr>
<td><code>tags</code></td>
<td><code>list</code></td>
<td>list of tags</td>
</tr>
<tr>
<td><code>remote_syslog</code></td>
<td><code>object</code></td>
<td>syslog parameters</td>
</tr>
<tr>
<td><code>device_updown_threshold</code></td>
<td><code>int</code></td>
<td>enable threshold-based device down delivery via 1) <code>device-updowns</code> webhooks topic, 2) Mist Alert Framework; e.g. send AP/SW/GW down event only if AP/SW/GW Up is not seen within the threshold in minutes; 0 - 240, default is 0 (trigger immediate)</td>
</tr>
<tr>
<td><code>ap_updown_threshold</code></td>
<td><code>int</code></td>
<td>enable threshold-based device down delivery for AP devices only. When configured it takes effect for AP devices and device_updown_threshold is ignored.</td>
</tr>
<tr>
<td><code>gateway_updown_threshold</code></td>
<td><code>int</code></td>
<td>enable threshold-based device down delivery for Gateway devices only. When configured it takes effect for GW devices and device_updown_threshold is ignored.</td>
</tr>
<tr>
<td><code>switch_updown_threshold</code></td>
<td><code>int</code></td>
<td>enable threshold-based device down delivery for Switch devices only. When configured it takes effect for SW devices and device_updown_threshold is ignored.</td>
</tr>
<tr>
<td><code>simple_alert</code></td>
<td><code>object</code></td>
<td>threshold setting for dhcp, dns, arp failure alerts. Alert generates if there are <code>x (int)</code> failures or <code>y (int)</code> clients failing within <code>z (int)</code> minutes per server, where 5&lt;=z&lt;=60. Defaults: <code>dhcp_failure</code>: {<code>client_count</code>: 10, <code>incident_count</code>: 20, <code>duration</code>: 10}, <code>dns_failure</code>: {<code>client_count</code>: 20 , <code>incident_count</code>: 30 , <code>duration</code>: 10}, <code>arp_failure</code>: {<code>client_count</code>: 10 , <code>incident_count</code>: 10 , <code>duration</code>: 20}</td>
</tr>
<tr>
<td><code>ap_affinity_threshold</code></td>
<td><code>int</code></td>
<td>ap_affinity_threshold can be added as a field under org/setting. By default this value is set to 12. If the field is set in both site/setting and org/setting, the value from site/setting will be used.</td>
</tr>
<tr>
<td><code>host</code></td>
<td><code>string</code></td>
<td>ip / hostname of TACACS server</td>
</tr>
<tr>
<td><code>port</code></td>
<td><code>int</code></td>
<td>port of TACACS server, default is 49</td>
</tr>
<tr>
<td><code>secret</code></td>
<td><code>string</code></td>
<td>secret of TACACS server</td>
</tr>
<tr>
<td><code>timeout</code></td>
<td><code>int</code></td>
<td>TACACS timeout, default is 10, from 1 to 90</td>
</tr>
<tr>
<td><code>disable_remote_shell</code></td>
<td><code>boolean</code></td>
<td>whether to disable remote shell access for an entire org</td>
</tr>
<tr>
<td>### Automatic Site Assignment</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Auto Site Assignment can be enabled to automatically assign APs to sites. Once enabled, when an AP in the Org inventory
is seen online (e.g. freshly installed), we will try to use the criteria defined to <em>identify</em> the Site Name. Only when
a non-empty Site Name is identified and the Site exists, the AP will be assigned to the site.</p>
<h3 id="automatic-device-naming">Automatic Device Naming</h3>
<p>Automatic Device Naming works along with Automatic Site Assignment. When an AP that’s already assigned to a site that
has no name, we will try to use the criteria defined to name the device. Only when a non-empty Name is identified and no
AP with the same name exists in the same Site, the AP will be assigned the name.</p>
<h2 id="update-org-setting">Update Org Setting</h2>
<pre><code>PUT /api/v1/orgs/:org_id/setting
</code></pre>
<h2 id="reevaluate-auto-assignment">Reevaluate Auto Assignment</h2>
<pre><code>POST /api/v1/orgs/:org_id/inventory/reevaluate_auto_assignment
</code></pre>
<h3 id="response-if-successful_1">Response if successful</h3>
<pre><code>Status: 200 OK
</code></pre>
<h2 id="set-up-custom-pcap-bucket">Set up Custom PCAP Bucket</h2>
<p>Setting up Custom PCAP Bucket Involves the following:</p>
<ol>
<li>provide the bucket name</li>
<li>we’ll attempt to write a file <code>MIST_TOKEN</code></li>
<li>you have to verify the ownership of the bucket by providing the content of the MIST_TOKEN</li>
</ol>
<h2 id="provide-customer-bucket-name">Provide Customer Bucket Name</h2>
<pre><code>POST /api/v1/orgs/:org_id/setting/pcap_bucket/setup
</code></pre>
<h3 id="request_24">Request</h3>
<pre><code>{
    "bucket": "company-private-pcap"
}
</code></pre>
<h3 id="response-if-failed">Response if failed</h3>
<pre><code>{
    "bucket": "company-private-pcap",
    "detail": "failed to write bucket - 403 AccessDenied"
}
</code></pre>
<h2 id="verify-customer-pcap-bucket">Verify Customer PCAP Bucket</h2>
<pre><code>POST /api/v1/orgs/:org_id/setting/pcap_bucket/verify
</code></pre>
<h3 id="request_25">Request</h3>
<pre><code>{
    "bucket": "company-private-pcap",
    "verify_token": "eyJhbGciOiJIUzI1J9.eyJzdWIiOiIxMjM0joiMjgxOG5MDIyfQ.2rzcRvMA3Eg09NnjCAC-1EWMRtxAnFDM"
}
</code></pre>
<h3 id="response-if-successful_2">Response if successful</h3>
<pre><code>Status: 200 OK
</code></pre>
<p>NOTE: a “VERIFIED” file will be created in the bucket</p>
<h2 id="get-org-certificates">Get Org Certificates</h2>
<pre><code>GET /api/v1/orgs/:org_id/cert
</code></pre>
<h3 id="response_31">Response</h3>
<pre><code>{
    "cert": "-----BEGIN CERTIFICATE-----\nMIIowDQYJKoZIhvcNAQELBQE\n-----END CERTIFICATE-----"
    // If the current Org CA certificate is set to expire within 30 days, \
    // a pending certificate will be returned along with the expected auto-renewal timestamp.
    "pending_cert": "-----BEGIN CERTIFICATE-----\nMIIowDQYJKoZIhvcNAQELBQE\n-----END CERTIFICATE-----",
    "pending_cert_expiry": 2044471109,
}
</code></pre>
<h2 id="clear-org-certificates">Clear Org Certificates</h2>
<pre><code>POST /api/v1/orgs/:org_id/cert/regenerate
</code></pre>
<h2 id="rotate-org-certificates">Rotate Org Certificates</h2>
<p>Replace the current org cert with the pending cert generated previously</p>
<pre><code>POST /api/v1/orgs/:org_id/cert/apply_pending
</code></pre>
<h2 id="get-org-crl-file">Get Org CRL file</h2>
<pre><code>GET /api/v1/orgs/:org_id/crl
</code></pre>
<h2 id="truncate-org-crl-file">Truncate Org CRL file</h2>
<p>By default, all certs used by recently unclaimed devices within 9 month will be included in CRL.
If the list grows too big, you can truncate it</p>
<pre><code>POST /api/v1/orgs/:org_id/crl/truncate
</code></pre>
<h3 id="request_26">Request</h3>
<pre><code>{
    "days": 30  // default is 30
}
</code></pre>
<h2 id="get-org-ssl-proxy-certificates">Get Org SSL proxy Certificates</h2>
<pre><code>GET /api/v1/orgs/:org_id/ssl_proxy_cert
</code></pre>
<h3 id="response_32">Response</h3>
<pre><code>{
    "cert": "-----BEGIN CERTIFICATE-----\nMIIowDQYJKoZIhvcNAQELBQE\n-----END CERTIFICATE-----"
}
</code></pre>
<h2 id="get-org-level-oauth-application-authorization-url">Get Org Level OAuth Application Authorization Url</h2>
<p>GET /api/v1/orgs/:org_id/setting/:app_name/link?forward=:forward_url // This is kept for backward compatibility</p>
<p>GET /api/v1/orgs/:org_id/setting/:app_name/link_accounts?forward=:forward_url</p>
<h3 id="parameters_17">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, org id</td>
</tr>
<tr>
<td><code>app_name</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, OAuth application name (Example : zoom, teams, intune)</td>
</tr>
<tr>
<td><code>forward_url</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Mist portal url to which backend needs to redirect after successful OAuth authorization</td>
</tr>
</tbody>
</table>
<h3 id="response_33">Response</h3>
<pre><code>{
    "linked": true,
    "accounts": [
      {
        "account_id": "KkEM7orQSIWHZNFzwMLuRA",
        "last_sync": 1665465339000,
        "last_status": "success",
        "linked_by": "Testname1",
        "company": "Test Compay1 Ltd",
        "max_daily_api_requests": 1500 // This field is specific to Zoom app
      },
      {
        "account_id": "kojzWgIJQ0ujR73VvydOdg",
        "last_sync": 1665465346000,
        "last_status": "failed",
        "linked_by": "Testname2",
        "company": "Test Compay2 Ltd",
        "error": "OAuth token refresh failed, please re-link your account",
        "errors": ["OAuth token refresh failed, please re-link your account", "API daily rate limit reached for your account"],
        "max_daily_api_requests": null, // This field is specific to Zoom app
      },
      {
        "account_id": "iojzXIJWEuiD73ZvydOfg",
        "last_sync": "failed",
        "last_status": 1665465538000,
        "linked_by": "Testname3",
        "company": "Test Compay3 Ltd",
        "max_daily_api_requests": 3500 // This field is specific to Zoom app
      }
    ],
    "authorization_url": "https://zoom.us/oauth/authorize?response_type=code&amp;client_id=YDyajBmJREjwkyb3TPAbA&amp;redirect_uri=https%3A%2F%2Fapi.local%2Fapi%2Fv1%2Forg%2Fb4e16c72-d50e-4c03-a952-a3217e231e2c%2Foauth2%2Fapp%2Fzoom%2Fcallback&amp;state=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE2NDk3NjE0MDQsImZvcndhcmQiOiJodHRwczovL2NsaWVudGZvcndhcmR1cmwuY29tIn0.RIE4XTU5kpF4nKIy7_enJ0PpOCyTTp6DLm9PZsdncpI"
}
</code></pre>
<h3 id="definitions_4">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>linked</code></td>
<td><code>boolean</code></td>
<td>OAuth application linked status, is mist portal authorized with the OAuth appliation</td>
</tr>
<tr>
<td><code>authorization_url</code></td>
<td><code>string</code></td>
<td>OAuth application authorization url</td>
</tr>
<tr>
<td><code>accounts</code></td>
<td><code>list</code></td>
<td>List of linked apps(zoom/teams/intune) account details</td>
</tr>
</tbody>
</table>
<h2 id="delete-org-level-oauth-application-authorization-with-mist-portal">Delete Org Level OAuth Application Authorization With Mist Portal</h2>
<p>DELETE /api/v1/orgs/:org_id/setting/:app_name/link // This is kept for backward compatibility</p>
<h3 id="parameters_18">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, org id</td>
</tr>
<tr>
<td><code>app_name</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, OAuth application name (Example : zoom, teams)</td>
</tr>
</tbody>
</table>
<h3 id="response_34">Response</h3>
<pre><code>Status: 200 Successful
Status: &gt; 400 Unsuccessful
</code></pre>
<p>DELETE /api/v1/orgs/:org_id/setting/:app_name/link_accounts // kept for backward compatibility</p>
<h3 id="request-payload">Request Payload</h3>
<pre><code>{
    "account_id": "iojzXIJWEuiD73ZvydOfg"
}
</code></pre>
<h3 id="parameters_19">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, org id</td>
</tr>
<tr>
<td><code>app_name</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, OAuth application name (Example : zoom, teams, intune)</td>
</tr>
<tr>
<td><code>account_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Linked app(zoom/teams/intune) account id</td>
</tr>
</tbody>
</table>
<h3 id="response_35">Response</h3>
<pre><code>Status: 200 Successful
Status: &gt; 400 Unsuccessful
</code></pre>
<p>DELETE /api/v1/orgs/:org_id/setting/:app_name/link_accounts/:account_id</p>
<h3 id="parameters_20">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, org id</td>
</tr>
<tr>
<td><code>app_name</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, OAuth application name (Example : zoom, teams, intune)</td>
</tr>
<tr>
<td><code>account_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Linked app(zoom/teams/intune) account id</td>
</tr>
</tbody>
</table>
<h3 id="response_36">Response</h3>
<pre><code>Status: 200 Successful
Status: &gt; 400 Unsuccessful
</code></pre>
<h2 id="update-the-third-party-apps-accounts-org-settings">Update The Third Party Apps Accounts Org Settings</h2>
<p>PUT /api/v1/orgs/:org_id/setting/:app_name/link_accounts</p>
<h3 id="request-payload-these-field-and-values-will-be-specific-to-each-of-the-third-party-apps-accounts">Request Payload, These Field And Values Will Be Specific To Each Of The Third Party Apps Accounts.</h3>
<h2 id="request-payload-for-zoom-app">Request Payload For Zoom App</h2>
<pre><code>{
    "account_id": "iojzXIJWEuiD73ZvydOfg",
    "max_daily_api_requests": 5000
}
</code></pre>
<h3 id="parameters_21">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, org id</td>
</tr>
<tr>
<td><code>app_name</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, OAuth application name (Example : zoom, teams, intune)</td>
</tr>
<tr>
<td><code>account_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Linked app(zoom/teams/intune) account id</td>
</tr>
<tr>
<td><code>max_daily_api_requests</code></td>
<td><code>integer</code></td>
<td><strong>Optional</strong>, Zoom daily api request quota, https://developers.zoom.us/docs/api/rest/rate-limits/</td>
</tr>
</tbody>
</table>
<h3 id="response_37">Response</h3>
<pre><code>Status: 200 Successful
Status: &gt; 400 Unsuccessful
</code></pre>
<h2 id="get-juniper-linked-accounts">Get Juniper Linked Accounts</h2>
<pre><code>GET /api/v1/orgs/:org_id/setting
</code></pre>
<h3 id="response_38">Response</h3>
<pre><code>{
    ...
    "juniper": {
        "accounts": [
            {
                "name": "ABC Corp",
                "linked_by": "John Smith (john@abccorp.com)"
            }
        ]
    }
}
</code></pre>
<h2 id="link-juniper-accounts">Link Juniper Accounts</h2>
<pre><code>POST /api/v1/orgs/:org_id/setting/juniper/link_accounts
</code></pre>
<h3 id="request-payload_1">Request Payload</h3>
<pre><code>{
    "username": "john@nmo.com",
    "password": "password"
}
</code></pre>
<h3 id="response-if-account-linked">Response if Account linked</h3>
<pre><code>Status 200 OK

{
    "account": {
        "name": "ABC Corp",
        "linked_by": "John Smith (john@abccorp.com)"
    }
}
</code></pre>
<h3 id="response-if-account-already-linked">Response if account already linked</h3>
<pre><code>Status 400 BadRequest

{
    "detail": "Account[ABC Corp] already linked",
}
</code></pre>
<h2 id="unlink-juniper-customer-id">Unlink Juniper Customer ID</h2>
<pre><code>DELETE /api/v1/orgs/:org_id/setting/juniper/linked_account
</code></pre>
<h3 id="request_27">Request</h3>
<pre><code>{
    "account_name": "ABC Corp"

    // required only if there are duplicate account_names
    "linked_by": "John Smith (john@abccorp.com)"
}
</code></pre>
<h2 id="setup-cradlepoint-connection-to-mist">Setup CradlePoint Connection to Mist</h2>
<p>This sets up Cradlepoint webhooks to send events to Mist</p>
<pre><code>POST /api/v1/orgs/:org_id/setting/cradlepoint/setup
</code></pre>
<h3 id="payload">Payload</h3>
<pre><code>{
    "ecm_api_id": "73446d61-2206-4ea5-855a-0043f980be62",
    "ecm_api_key": "68b329da9893e34099c7d8ad5cb9c9405",
    "cp_api_id": "84446d61-2206-4ea5-855a-0043f980be54",
    "cp_api_key": "79c329da9893e34099c7d8ad5cb9c941",
}
</code></pre>
<h2 id="update-cradlepoint-connection-to-mist">Update CradlePoint Connection to Mist</h2>
<p>This updates the Cradlepoint integration settings in Mist</p>
<pre><code>PUT /api/v1/orgs/:org_id/setting/cradlepoint/setup
</code></pre>
<h3 id="payload_1">Payload</h3>
<pre><code>{
    "ecm_api_id": "73446d61-2206-4ea5-855a-0043f980be62",
    "ecm_api_key": "68b329da9893e34099c7d8ad5cb9c9405",
    "cp_api_id": "84446d61-2206-4ea5-855a-0043f980be54",
    "cp_api_key": "79c329da9893e34099c7d8ad5cb9c941",
}
</code></pre>
<h2 id="delete-cradlepoint-connection-to-mist">Delete CradlePoint Connection to Mist</h2>
<p>This deletes the Cradlepoint integration in Mist</p>
<pre><code>DELETE /api/v1/orgs/:org_id/setting/cradlepoint/setup
</code></pre>
<h2 id="test-cradlepoint-connection-to-mist">Test CradlePoint Connection to Mist</h2>
<p>This tests the Cradlepoint integration in Mist</p>
<pre><code>GET /api/v1/orgs/:org_id/setting/cradlepoint/setup
</code></pre>
<h3 id="response_39">Response</h3>
<pre><code>{
    "last_status": "inactive",
    "error": "Cradlepoint API keys are no longer valid, please verify and update the keys under organization settings."
}
</code></pre>
<h3 id="definitions_5">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>last_status</code></td>
<td><code>string</code></td>
<td>status of integration <code>active</code>/<code>inactive</code> detected during last sync.</td>
</tr>
<tr>
<td><code>error</code></td>
<td><code>string</code></td>
<td>if status is <code>inactive</code> this field returns the reason for it being <code>inactive</code>.</td>
</tr>
</tbody>
</table>
<h2 id="sync-cradlepoint-routers">Sync CradlePoint Routers</h2>
<p>This syncs cradlepoint devices with Mist. We’ll also attempt to use the LLDP data from cradlepoint to identify the linkage against
Mist Site / Device</p>
<pre><code>POST /api/v1/orgs/:org_id/setting/cradlepoint/sync
</code></pre>
<h2 id="update-otherdevice">Update OtherDevice</h2>
<p>If the Site / Device cannot be identified, a manual association can be made</p>
<pre><code>PUT /api/v1/orgs/:org_id/otherdevices/:mac
</code></pre>
<h3 id="request_28">Request</h3>
<pre><code>{
    "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
    "device_mac": "0adfea67e65b"
}
</code></pre>
<h2 id="update-otherdevices">Update OtherDevices</h2>
<p>Assign or unassign OtherDevices to and from a site.</p>
<pre><code>PUT /api/v1/orgs/:org_id/otherdevices
</code></pre>
<h2 id="parameters_22">Parameters</h2>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>op</code></td>
<td><code>string</code></td>
<td>The operation being performed. Either ‘assign’ or ‘unassign’.</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>The site identifier.</td>
</tr>
<tr>
<td><code>macs</code></td>
<td><code>list</code></td>
<td>List of otherdevice mac addresses.</td>
</tr>
</tbody>
</table>
<h3 id="request_29">Request</h3>
<pre><code>{
    "op": "assign",
    "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
    "macs": [
        "5c5b350e0001",
        "5c5b350e0003"
    ]
}
</code></pre>
<h2 id="get-otherdevices">Get OtherDevices</h2>
<pre><code>GET /api/v1/orgs/:org_id/otherdevices?vendor=:vendor
</code></pre>
<h3 id="response_40">Response</h3>
<pre><code>[
    {
        "id": "ae9dee49-69e7-4710-a114-5b827a777738",
        "org_id": "2818e386-8dec-2562-9ede-5b8a0fbbdc71",
        "created_time": 1676983730,
        "modified_time": 1676983730,
        "vendor": "cradlepoint",
        "mac": "5c5b35000018",
        "serial": "FXLH2015150025",
        "model": "AP41",
        "name": "hallway",
        "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
        "device_mac": "001122334455"
    }
]
</code></pre>
<h2 id="get-otherdevice">Get OtherDevice</h2>
<pre><code>GET /api/v1/orgs/:org_id/otherdevice/:mac
</code></pre>
<h3 id="response_41">Response</h3>
<pre><code>{
    "id": "ae9dee49-69e7-4710-a114-5b827a777738",
    "org_id": "2818e386-8dec-2562-9ede-5b8a0fbbdc71",
    "vendor": "cradlepoint",
    "mac": "5c5b35000018",
    "serial": "WB23015E025468",
    "model": "W2005",
    "name": "W2005-268",
    "vendor_api_id": "4658714",
    "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
    "device_mac": "001122334455",
    "state": "online"
}
</code></pre>
<h2 id="delete-otherdevice">Delete OtherDevice</h2>
<pre><code>DELETE /api/v1/orgs/:org_id/otherdevices/:mac
</code></pre>
<h2 id="get-otherdevice-stats">Get Otherdevice Stats</h2>
<pre><code>GET /api/v1/orgs/:org_id/stats/otherdevices/:mac
</code></pre>
<h3 id="response_42">Response</h3>
<pre><code>{
    "vendor": "cradlepoint",
    "mac": "0030448f1f44",
    "uptime": 25065,
    "last_seen": 1736499062,
    "version": "7.24.50",
    "vendor_specific": {
        "interfaces": {
            "ethernet-lan": {
                "ip": "192.168.0.1",
                "mode": "lan",
                "link": false,
                "service_mode": "Ethernet",
                "type": "ethernet",
                "uptime": 0,
                "bytes_in": 331068567,
                "bytes_out": 6763536255,
                "display_name": "Primary LAN",
                "port_parent": "Primary LAN"
            },
            "mdm-81ade837": {
                "ip": "12.68.86.17",
                "mode": "wan",
                "link": true,
                "carrier": "AT&amp;T",
                "state": "READY",
                "service_mode": "5G NSA",
                "type": "mdm",
                "uptime": 2464657,
                "bytes_in": 287174553,
                "bytes_out": 306774804,
                "rssi": -79,
                "rsrp": -109.0,
                "rsrq": -15.0,
                "sinr": 3.4,
                "imei": "650994581483248",
                "imsi": "410410436288436",
                "mtu": 1400,
                "display_name": "Internal 5GB (SIM1)"
            },..
        }
    },
    "cached_stats": true,
    "lldp_enabled": true,
    "connected_devices": {}
}
</code></pre>
<h2 id="reboot-otherdevice">Reboot OtherDevice</h2>
<pre><code>POST /api/v1/orgs/:org_id/otherdevices/:mac/reboot
</code></pre>
<h3 id="payload_2">Payload</h3>
<pre><code>{}
</code></pre>
<h2 id="subscribe-to-otherdevice-sync-events">Subscribe to OtherDevice sync events</h2>
<pre><code>WS /api-ws/v1/stream
</code></pre>
<h3 id="request_30">Request</h3>
<pre><code>{
    "subscribe": "/orgs/:org_id/otherdevices/sync"
}
</code></pre>
<h3 id="response_43">Response</h3>
<pre><code>{
    "event": "data"
    "channel": "/orgs/67970e46-4e12-11e6-9188-0242ac110007/otherdevices/sync"
    "data": {
        "vendor": "cradlepoint"
        "status": "failed",
        "text": "Cannot sync devices, please verify API keys under organization setting."
    }
}
</code></pre>
<h3 id="definitions_6">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>event</code></td>
<td><code>string</code></td>
<td>what type of event is received.</td>
</tr>
<tr>
<td><code>channel</code></td>
<td><code>string</code></td>
<td>from which channel the data is received.</td>
</tr>
<tr>
<td><code>vendor</code></td>
<td><code>string</code></td>
<td>vendor of otherdevices sync event.</td>
</tr>
<tr>
<td><code>status</code></td>
<td><code>string</code></td>
<td>status of event e.g done or failed.</td>
</tr>
<tr>
<td><code>text</code></td>
<td><code>string</code></td>
<td>provides more information on the event.</td>
</tr>
</tbody>
</table>
<h2 id="get-jamf-application-linked-status">Get Jamf Application Linked Status</h2>
<p>GET /api/v1/orgs/:org_id/setting/jamf/link_accounts</p>
<h3 id="parameters_23">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, org id</td>
</tr>
</tbody>
</table>
<h3 id="response_44">Response</h3>
<pre><code>{
    "linked": true,
    "accounts": [
     {
        "account_id": "ae9dee49-69e7-4710-a114-5b827a777738",
        "instance_url": "junipertest.jamfcloud.com",
        "smartgroup_name": "CompliantGroup1",
        "last_sync": 1665465339000,
        "last_status": "success",
        "linked_by": "Testname1",
        "name": "Test Compay1 Ltd"
      },
      {
        "account_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
        "instance_url": "junipernfr.jamfcloud.com", // Linked Jamf Instance URL
        "smartgroup_name": "CompliantGroup", // smartgroup name to determine compliance status
        "last_sync": 1234567890123, // Last data pull timestamp, background jobs that pull Jamf account data
        "last_status": "failed", // Is the last data pull for Jamf account is successful or not
        "linked_by": "Testname2", // First name of the user who linked the Jamf account
        "name": "Test Compay2 Ltd", // Name of the company whose Jamf account mist has subscribed to
        "error": "Get token failed, please re-link jamf" // This error is provided when the Jamf account fails to fetch token/data
      }
    ]
}
</code></pre>
<h3 id="definitions_7">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>linked</code></td>
<td><code>boolean</code></td>
<td>OAuth application linked status, is mist portal enabled for Jamf</td>
</tr>
<tr>
<td><code>accounts</code></td>
<td><code>list</code></td>
<td>List of linked Jamf account details</td>
</tr>
</tbody>
</table>
<h2 id="add-jamf-authorization-with-mist-portal">Add Jamf Authorization With Mist Portal</h2>
<p>POST /api/v1/orgs/:org_id/setting/jamf/link_accounts</p>
<h3 id="request-payload_2">Request Payload</h3>
<pre><code>{
    "instance_url": "customer account Jamf instance URL"
    "client_id": "customer account api client id",
    "client_secret": "customer account api client secret",
    "smartgroup_name": "smart group membership for determining compliance status"
}
</code></pre>
<h3 id="parameters_24">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, org id</td>
</tr>
<tr>
<td><code>instance_url</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, customer account Jamf instance URL</td>
</tr>
<tr>
<td><code>client_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, customer account api client ID</td>
</tr>
<tr>
<td><code>client_secret</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, customer account api client Secret</td>
</tr>
<tr>
<td><code>smartgroup_name</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, smart group membership for determining compliance status</td>
</tr>
</tbody>
</table>
<h3 id="response_45">Response</h3>
<pre><code>{
    "linked": true,
    "accounts": [
     {
        "account_id": "ae9dee49-69e7-4710-a114-5b827a777738",
        "instance_url": "junipertest.jamfcloud.com",
        "smartgroup_name": "CompliantGroup1",
        "last_sync": 1665465339000,
        "last_status": "success",
        "linked_by": "Testname1",
        "name": "Test Compay1 Ltd"
      },
      {
        "account_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",     // generated account id (uuid)
        "instance_url": "junipernfr.jamfcloud.com", // Linked Jamf Instance URL
        "smartgroup_name": "CompliantGroup", // smartgroup name to determine compliance status
        "last_sync": 1234567890123, // Last data pull timestamp, background jobs that pull Jamf account data
        "last_status": "failed", // Is the last data pull for Jamf account is successful or not
        "linked_by": "Testname2", // First name of the user who linked the Jamf account
        "name": "Test Compay2 Ltd", // Name of the company whose Jamf account mist has subscribed to
        "error": "Get token failed, please re-link jamf" // This error is provided when the Jamf account fails to fetch token/data
      }
    ]
}
</code></pre>
<h3 id="definitions_8">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>linked</code></td>
<td><code>boolean</code></td>
<td>application linked status, is mist portal enabled for Jamf</td>
</tr>
<tr>
<td><code>accounts</code></td>
<td><code>list</code></td>
<td>List of linked Jamf account details</td>
</tr>
</tbody>
</table>
<pre><code>Status: 200 Successful
Status: &gt; 400 Unsuccessful
</code></pre>
<h2 id="delete-jamf-authorization-with-mist-portal">Delete Jamf Authorization With Mist Portal</h2>
<p>DELETE /api/v1/orgs/:org_id/setting/jamf/link_accounts  // kept for backward compatibility</p>
<h3 id="request-payload_3">Request Payload</h3>
<pre><code>{
    "account_id": "ae9dee49-69e7-4710-a114-5b827a777738"
}
</code></pre>
<h3 id="parameters_25">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, org id</td>
</tr>
<tr>
<td><code>account_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Linked Jamf account ID</td>
</tr>
</tbody>
</table>
<h3 id="response_46">Response</h3>
<pre><code>Status: 200 Successful
Status: &gt; 400 Unsuccessful
</code></pre>
<p>DELETE /api/v1/orgs/:org_id/setting/jamf/link_accounts/:account_id</p>
<h3 id="parameters_26">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, org id</td>
</tr>
<tr>
<td><code>account_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Linked Jamf account ID (UUID)</td>
</tr>
</tbody>
</table>
<h3 id="response_47">Response</h3>
<pre><code>Status: 200 Successful
Status: &gt; 400 Unsuccessful
</code></pre>
<h2 id="get-vmware-application-linked-status">Get VMware Application Linked Status</h2>
<p>GET /api/v1/orgs/:org_id/setting/vmware/link_accounts</p>
<h3 id="parameters_27">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, org id</td>
</tr>
</tbody>
</table>
<h3 id="response_48">Response</h3>
<pre><code>{
    "linked": true,
    "accounts": [
     {
        "account_id": "f43ea4c4-8a97-4159-9214-112a8c7b8f22",
        "instance_url": "as800.airwatchportals.com",
        "last_sync": 1665465339000,
        "last_status": "success",
        "linked_by": "Testname1",
        "name": "Test Compay1 Ltd",
        "linked_timestamp": 1702284364
      },
      {
        "account_id": "m56ea4c4-8a10-4189-9214-113a8c7b8m82",
        "instance_url": "as561.airwatchportals.com", // Linked VMware Instance URL
        "last_sync": 1234567890123, // Last data pull timestamp, background jobs that pull VMware account data
        "last_status": "failed", // Is the last data pull for VMware account is successful or not
        "linked_by": "Testname2", // First name of the user who linked the VMware account
        "name": "Test Compay2 Ltd", // Name of the company whose VMware account mist has subscribed to
        "linked_timestamp": 1702284364
        "error": "Get token failed, please re-link VMware" // This error is provided when the VMware account fails to fetch token/data
      }
    ]
}
</code></pre>
<h3 id="definitions_9">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>linked</code></td>
<td><code>boolean</code></td>
<td>Basic Auth application linked status in mist portal enabled for VMware</td>
</tr>
<tr>
<td><code>accounts</code></td>
<td><code>list</code></td>
<td>List of linked VMware account details</td>
</tr>
</tbody>
</table>
<h2 id="add-vmware-authorization-with-mist-portal">Add VMware Authorization With Mist Portal</h2>
<p>POST /api/v1/orgs/:org_id/setting/vmware/link_accounts</p>
<h3 id="request-payload_4">Request Payload</h3>
<pre><code>{
    "instance_url": "customer account VMware instance URL"
    "client_id": "customer account api client id",
    "client_secret": "customer account api client secret"
}
</code></pre>
<h3 id="parameters_28">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, org id</td>
</tr>
<tr>
<td><code>instance_url</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, customer account VMware instance URL</td>
</tr>
<tr>
<td><code>client_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, customer account Client ID</td>
</tr>
<tr>
<td><code>client_secret</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, customer account Client Secret</td>
</tr>
</tbody>
</table>
<h3 id="response_49">Response</h3>
<pre><code>{
    "linked": true,
    "accounts": [
     {
        "account_id": "f43ea4c4-8a97-4159-9214-112a8c7b8f22",
        "instance_url": "as800.airwatchportals.com",
        "last_sync": 1665465339000,
        "last_status": "success",
        "linked_by": "Testname1",
        "name": "Test Compay1 Ltd",
        "linked_timestamp": 1702284364
      },
      {
        "account_id": "m56ea4c4-8a10-4189-9214-113a8c7b8m82",
        "instance_url": "as561.airwatchportals.com", // Linked VMware Instance URL
        "last_sync": 1234567890123, // Last data pull timestamp, background jobs that pull VMware account data
        "last_status": "failed", // Is the last data pull for VMware account is successful or not
        "linked_by": "Testname2", // First name of the user who linked the VMware account
        "name": "Test Compay2 Ltd", // Name of the company whose VMware account mist has subscribed to
        "linked_timestamp": 1702284364
        "error": "Get token failed, please re-link VMware" // This error is provided when the VMware account fails to fetch token/data
      }
    ]
}
</code></pre>
<h3 id="definitions_10">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>linked</code></td>
<td><code>boolean</code></td>
<td>application linked status, is mist portal enabled for VMware</td>
</tr>
<tr>
<td><code>accounts</code></td>
<td><code>list</code></td>
<td>List of linked VMware account details</td>
</tr>
</tbody>
</table>
<pre><code>Status: 200 Successful
Status: &gt; 400 Unsuccessful
</code></pre>
<h2 id="delete-vmware-authorization-with-mist-portal">Delete VMware Authorization With Mist Portal</h2>
<p>DELETE /api/v1/orgs/:org_id/setting/vmware/link_accounts    // kept for backward compatibility</p>
<h3 id="request-payload_5">Request Payload</h3>
<pre><code>{
    "account_id": "f43ea4c4-8a97-4159-9214-112a8c7b8f22"
}
</code></pre>
<h3 id="parameters_29">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, org id</td>
</tr>
<tr>
<td><code>account_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Linked VMware account ID</td>
</tr>
</tbody>
</table>
<h3 id="response_50">Response</h3>
<pre><code>Status: 200 Successful
Status: &gt; 400 Unsuccessful
</code></pre>
<p>DELETE /api/v1/orgs/:org_id/setting/vmware/link_accounts/:account_id</p>
<h3 id="parameters_30">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, org id</td>
</tr>
<tr>
<td><code>account_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Linked VMware account ID (UUID)</td>
</tr>
</tbody>
</table>
<h3 id="response_51">Response</h3>
<pre><code>Status: 200 Successful
Status: &gt; 400 Unsuccessful
</code></pre>
<h2 id="get-mobicontrol-application-linked-status">Get MobiControl Application Linked Status</h2>
<pre><code>GET /api/v1/orgs/:org_id/setting/mobicontrol/link_accounts
</code></pre>
<h3 id="parameters_31">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Organization id</td>
</tr>
</tbody>
</table>
<h3 id="response_52">Response</h3>
<pre><code>{
    "linked": True, 
    "accounts": [
            {
                "account_id": "7f80cd00-40b1-49e5-b2cb-9386d89af0d6", 
                "instance_url": "https://a0020372.mobicontrol.cloud", 
                "client_id": "3e408b13255844149f2830e8609fe8f3"
                "last_sync": 1665465339000, 
                "last_status": "success", 
                "linked_by": "User1", 
                "linked_timestamp": 1702284364, 
                "name": "Company1 Ltd.", 
            }, 

            {
                "account_id": "80364a28-7ccc-4746-b110-ecf3dfd3a359", 
                "instance_url": "https://a0032314.mobicontrol.cloud", // Linked MobiControl Instance URL
                "client_id": "e81cfb1980454b4bb6109c74136ca528" //Linked MobiControl Client Id
                "last_sync": 1234567890123, // Last data pull timestamp, background jobs that pull MobiControl account data
                "last_status": "failed", // Is the last data pull for MobiControl account is successful or not
                "linked_by": "User2", // First name of the user who linked the MobiControl account
                "linked_timestamp": 1702284364, 
                "name": "Company2 Ltd.", // Name of the company whose MobiControl account mist has subscribed to
                "error" : "Get token failed, please re-link MobiControl account" // This error is provided when the MobiControl account fails to fetch token/data
            }
        ]
}
</code></pre>
<h3 id="definitions_11">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>linked</code></td>
<td><code>boolean</code></td>
<td>Application linked status, is mist portal enabled for MobiControl</td>
</tr>
<tr>
<td><code>accounts</code></td>
<td><code>list</code></td>
<td>List of linked MobiControl account details</td>
</tr>
</tbody>
</table>
<h2 id="add-mobicontrol-authorization-with-mist-portal">Add MobiControl Authorization With Mist Portal</h2>
<p>POST /api/v1/orgs/:org_id/setting/mobicontrol/link_accounts</p>
<h3 id="request-payload_6">Request Payload</h3>
<pre><code>{
    "instance_url" : "Customer account MobiControl instance URL",
    "client_id" : "Customer account API client ID",
    "client_secret" : "Customer account API client Secret",
    "username" : "Customer account username",
    "password" : "Customer account password"
}
</code></pre>
<h3 id="parameters_32">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Organization ID</td>
</tr>
<tr>
<td><code>instance_url</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Customer account MobiControl instance URL</td>
</tr>
<tr>
<td><code>client_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Customer account API client ID</td>
</tr>
<tr>
<td><code>client_secret</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Customer account API client Secret</td>
</tr>
<tr>
<td><code>username</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Customer account username</td>
</tr>
<tr>
<td><code>password</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Customer account password</td>
</tr>
</tbody>
</table>
<h3 id="response_53">Response</h3>
<pre><code>{
    "linked": True, 
    "accounts": [
            {
                "account_id": "7f80cd00-40b1-49e5-b2cb-9386d89af0d6", 
                "instance_url": "https://a0020372.mobicontrol.cloud", 
                "client_id": "3e408b13255844149f2830e8609fe8f3"
                "last_sync": 1665465339000, 
                "last_status": "success", 
                "linked_by": "User1", 
                "linked_timestamp": 1702284364, 
                "name": "Company1 Ltd.", 
            }, 

            {
                "account_id": "80364a28-7ccc-4746-b110-ecf3dfd3a359", // Generated account id (uuid)
                "instance_url": "https://a0032314.mobicontrol.cloud", // Linked MobiControl Instance URL
                "client_id': 'e81cfb1980454b4bb6109c74136ca528' //Linked MobiControl Client Id
                'last_sync': 1234567890123, // Last data pull timestamp, background jobs that pull MobiControl account data
                'last_status': 'failed', // Is the last data pull for MobiControl account is successful or not
                'linked_by': 'User2', // First name of the user who linked the MobiControl account
                'linked_timestamp': 1702284364, 
                'name': 'Company2 Ltd.', // Name of the company whose MobiControl account mist has subscribed to
                'error' : 'Get token failed, please re-link MobiControl account' // This error is provided when the MobiControl account fails to fetch token/data
            }
        ]
}
</code></pre>
<h3 id="definitions_12">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>linked</code></td>
<td><code>boolean</code></td>
<td>application linked status, is mist portal enabled for MobiControl</td>
</tr>
<tr>
<td><code>accounts</code></td>
<td><code>list</code></td>
<td>List of linked MobiControl account details</td>
</tr>
</tbody>
</table>
<pre><code>Status: 200 Successful
Status: &gt; 400 Unsuccessful
</code></pre>
<h2 id="delete-mobicontrol-authorization-with-mist-portal">Delete MobiControl Authorization With Mist Portal</h2>
<p>DELETE /api/v1/orgs/:org_id/setting/mobicontrol/link_accounts/:account_id</p>
<h3 id="parameters_33">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Organization ID</td>
</tr>
<tr>
<td><code>account_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Linked MobiControl account ID(UUID)</td>
</tr>
</tbody>
</table>
<h3 id="response_54">Response</h3>
<pre><code>Status: 200 Successful
Status: &gt; 400 Unsuccessful
</code></pre>
<h2 id="get-linked-zdx-accounts">Get Linked ZDX Accounts</h2>
<pre><code>GET /api/v1/orgs/:org_id/setting/zdx/link_accounts
</code></pre>
<h3 id="parameters_34">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Organization id</td>
</tr>
</tbody>
</table>
<h3 id="response_55">Response</h3>
<pre><code>{
    "linked": true,
    "accounts": [
        {
            "account_id": "80364a28-7ccc-4746-b110-ecf3dfd3a359", // Generated account id (uuid)
            "key_id": "L72frZcK3JvrZc",
            "webhook_url": "https://webhook.url/xxx",    // Webhook url to notify Mist about a ZDX alert
            "zdx_org_id": "123456",
            "cloud_name": "zdxcloud.net"
        },
        {
            "account_id": "80364a28-7ccc-4746-b110-ecf3dfd3a359",
            "key_id": "K35vrZcK3JvrZc",
            "webhook_url": "https://webhook.url/yyy",
            "zdx_org_id": "4601412",
            "cloud_name": "zdxcloud.net"
        }
    ]
}
</code></pre>
<h3 id="add-zdx-authorization-with-mist-portal">Add ZDX Authorization With Mist Portal</h3>
<pre><code>POST /api/v1/orgs/:org_id/setting/zdx/link_accounts
</code></pre>
<h3 id="parameters_35">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Organization ID</td>
</tr>
<tr>
<td><code>key_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Customer account API key ID</td>
</tr>
<tr>
<td><code>key_secret</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Customer account API key Secret</td>
</tr>
<tr>
<td><code>zdx_org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, ZDX organization id</td>
</tr>
<tr>
<td><code>cloud_name</code></td>
<td><code>string</code></td>
<td>ZDX cloud name <br><strong>default:</strong> zdxcloud.net<br> Refer https://help.zscaler.com/zdx/getting-started-zdx-api for ZDX cloud name</td>
</tr>
</tbody>
</table>
<h3 id="delete-zdx-authorization-with-mist-portal">Delete ZDX Authorization With Mist Portal</h3>
<pre><code>DELETE /api/v1/orgs/:org_id/setting/zdx/link_accounts/:account_id
</code></pre>
<h3 id="parameters_36">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Organization ID</td>
</tr>
<tr>
<td><code>account_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Linked ZDX account ID</td>
</tr>
</tbody>
</table>
<h3 id="response_56">Response</h3>
<pre><code>Status: 200 Successful
Status: &gt; 400 Unsuccessful
</code></pre>
<h3 id="link-prisma-account">Link Prisma Account</h3>
<pre><code>POST /api/v1/orgs/:org_id/setting/prisma/link_accounts
</code></pre>
<h3 id="request_31">Request</h3>
<pre><code>{
  "client_id": "mist-integration@18995xxxx.iam.panserviceaccount.com",
  "client_secret": "07519xxx-fb64-xxxx-xxxx-xxxx4af3384",
  "tsg_id": "189953456",
  "enable_probe": true,
  "auto_probe_subnet": "11.0.0.0/8"
}
</code></pre>
<h3 id="parameters_37">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Organization ID</td>
</tr>
<tr>
<td><code>client_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Customer account API Client ID</td>
</tr>
<tr>
<td><code>client_secret</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Customer account API Client Secret</td>
</tr>
<tr>
<td><code>tsg_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Prisma Tenant Service Group id</td>
</tr>
<tr>
<td><code>enable_probe</code></td>
<td><code>boolean</code></td>
<td>To enable/disable tunnel probe, default is false (disabled)</td>
</tr>
<tr>
<td><code>auto_probe_subnet</code></td>
<td><code>string</code></td>
<td><strong>Required</strong> if enable_probe=true, This field will accept an IPv4 cidr and an IP address will be picked from this range to be used as tunnel probe source ip address and as well as BGP neighbour IP address. The subnet should be big enough for num_devices * num_tunnel * 2</td>
</tr>
</tbody>
</table>
<h3 id="response_57">Response</h3>
<pre><code>{
    "linked": true,
    "accounts": [
        {
            "account_id": "80364a28-7ccc-4746-b110-ecf3dfd3a359",   // Generated account id (uuid)
            "tsg_id": "189953456",
            "service_account_name": "Corp SA",
            "cloud_name": "api.sase.paloaltonetworks.com",
            "region": "americas",
            "enable_probe": true,
            "auto_probe_subnet": "11.0.0.0/8",
            "service_connections": []
        }
    ]
}
</code></pre>
<h3 id="update-prisma-account">Update Prisma Account</h3>
<pre><code>PUT /api/v1/orgs/:org_id/setting/prisma/link_accounts/:account_id
</code></pre>
<h3 id="request_32">Request</h3>
<pre><code>{
  "enable_probe": true,
  "auto_probe_subnet": "11.0.0.0/8"
}
</code></pre>
<h3 id="parameters_38">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>enable_probe</code></td>
<td><code>boolean</code></td>
<td>To enable/disable tunnel probe, default is false (disabled)</td>
</tr>
<tr>
<td><code>auto_probe_subnet</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, if enable_probe=true, This field will accept an IPv4 cidr and an IP address will be picked from this range to be used as tunnel probe source ip address and as well as BGP neighbour IP address. The subnet should be big enough for num_devices * num_tunnel * 2<br></td>
</tr>
</tbody>
</table>
<h3 id="response_58">Response</h3>
<pre><code>{
    "linked": true,
    "accounts": [
        {
            "account_id": "80364a28-7ccc-4746-b110-ecf3dfd3a359",
            "tsg_id": "189953456",
            "service_account_name": "Corp SA",
            "cloud_name": "api.sase.paloaltonetworks.com",
            "region": "americas",
            "enable_probe": true,
            "auto_probe_subnet": "11.0.0.0/8"
        }
    ]
}
</code></pre>
<h2 id="get-linked-prisma-accounts">Get Linked Prisma Accounts</h2>
<pre><code>GET /api/v1/orgs/:org_id/setting/prisma/link_accounts
</code></pre>
<h3 id="parameters_39">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Organization id</td>
</tr>
</tbody>
</table>
<h3 id="response_59">Response</h3>
<pre><code>{
    "linked": true,
    "accounts": [
        {
            "account_id": "80364a28-7ccc-4746-b110-ecf3dfd3a359",   // Generated account id (uuid)
            "tsg_id": "189953456",
            "service_account_name": "Demo SA",
            "cloud_name": "api.sase.paloaltonetworks.com",
            "region": "americas",
            "enable_probe": true,
            "auto_probe_subnet": "11.0.0.0/8",
            "service_connections": ['sc1', 'sc2']
        },
        {
            "account_id": "80364a28-7ccc-4746-b110-5678aafd65cc",
            "tsg_id": "189954023",
            "service_account_name": "Corp SA",
            "cloud_name": "api.sase.paloaltonetworks.com",
            "enable_probe": false,
            "auto_probe_subnet": null,
            "service_connections": ['sc3', 'sc4']
        }
    ]
}
</code></pre>
<h3 id="unlink-prisma-account">Unlink Prisma Account</h3>
<pre><code>DELETE /api/v1/orgs/:org_id/setting/prisma/link_accounts/:account_id
</code></pre>
<h3 id="parameters_40">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Organization ID</td>
</tr>
<tr>
<td><code>account_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Linked Prisma account ID</td>
</tr>
</tbody>
</table>
<h3 id="response_60">Response</h3>
<pre><code>Status: 200 Successful
Status: &gt; 400 Unsuccessful
</code></pre>
<h2 id="get-crowdstrike-application-linked-status">Get CrowdStrike Application Linked Status</h2>
<p>GET /api/v1/orgs/:org_id/setting/crowdstrike/link_accounts</p>
<h3 id="parameters_41">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, org id</td>
</tr>
</tbody>
</table>
<h3 id="response_61">Response</h3>
<pre><code>{
    "linked": true,
    "accounts": [
     {
        "last_status": "success",
        "last_sync": 1665465339000,
        "account_id": "ae9dee49-69e7-4710-a114-5b827a777738",
        "linked_by": "Testname1",
        "name": "Test Company1 Ltd"
        "linked_timestamp":1728275689.284758,
      },
      {
        "last_status": "failed", // Is the last data pull for crowdstrike account is successful or not
        "last_sync": 1234567890123, // Last data pull timestamp, background jobs that that pull CrowdStrike account data
        "account_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5", //uuid generated
        "linked_by": "Testname2", // First name of the user who linked the crowdstrike account
        "name": "Test Company2 Ltd", // Name of the company whose crowdstrike account mist has subscribed to
        "linked_timestamp":1728275689.284758, // Timestamp when the account is linked
        "error": "Get token failed, please re-link crowdstrike" // This error is provided when the crowdstrike account fails to fetch token/data
      }
}
</code></pre>
<h3 id="definitions_13">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>linked</code></td>
<td><code>boolean</code></td>
<td>OAuth application linked status, is mist portal enabled for CrowdStrike</td>
</tr>
<tr>
<td><code>accounts</code></td>
<td><code>list</code></td>
<td>List of linked CrowdStrike account details</td>
</tr>
</tbody>
</table>
<h2 id="add-crowdstrike-authorization-with-mist-portal">Add CrowdStrike Authorization With Mist Portal</h2>
<p>POST /api/v1/orgs/:org_id/setting/crowdstrike/link_accounts</p>
<h3 id="request-payload_7">Request Payload</h3>
<pre><code>{
    "customer_id": "customer id of an admin"
    "client_id": "customer account api client id",
    "client_secret": "customer account api client secret",
}
</code></pre>
<h3 id="parameters_42">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, org id</td>
</tr>
<tr>
<td><code>customer_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, customer id of an admin</td>
</tr>
<tr>
<td><code>client_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, customer account api client ID</td>
</tr>
<tr>
<td><code>client_secret</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, customer account api client Secret</td>
</tr>
</tbody>
</table>
<h3 id="response_62">Response</h3>
<pre><code>{
    "linked": true,
    "accounts": [
     {
        "last_status": "success",
        "last_sync": 1665465339000,
        "account_id": "ae9dee49-69e7-4710-a114-5b827a777738",
        "linked_by": "Testname1",
        "name": "Test Company1 Ltd"
        "linked_timestamp":1728275689.284758,
      },
      {
        "last_status": "failed", // Is the last data pull for crowdstrike account is successful or not
        "last_sync": 1234567890123, // Last data pull timestamp, background jobs that that that pull CrowdStrike account data
        "account_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5", //uuid generated
        "linked_by": "Testname2", // First name of the user who linked the crowdstrike account
        "name": "Test Company2 Ltd", // Name of the company whose crowdstrike account mist has subscribed to
        "linked_timestamp":1728275689.284758, // Timestamp when the account is linked
        "error": "Get token failed, please re-link crowdstrike" // This error is provided when the crowdstrike account fails to fetch token/data
      }
    ]
}
</code></pre>
<h3 id="definitions_14">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>linked</code></td>
<td><code>boolean</code></td>
<td>application linked status, is mist portal enabled for CrowdStrike</td>
</tr>
<tr>
<td><code>accounts</code></td>
<td><code>list</code></td>
<td>List of linked CrowdStrike account details</td>
</tr>
</tbody>
</table>
<p>DELETE /api/v1/orgs/:org_id/setting/crowdstrike/link_accounts/:account_id</p>
<h3 id="parameters_43">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, org id</td>
</tr>
<tr>
<td><code>account_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Linked CrowdStrike account ID (UUID)</td>
</tr>
</tbody>
</table>
<h3 id="response_63">Response</h3>
<pre><code>{Status: 200 Successful}
Status: &gt; 400 Unsuccessful
</code></pre>
<h2 id="add-sentinelone-authorization-with-mist-portal">Add SentinelOne Authorization With Mist Portal</h2>
<p>POST /api/v1/orgs/:org_id/setting/sentinelone/link_accounts</p>
<h3 id="request-payload_8">Request Payload</h3>
<pre><code>{
    "instance_url": "customer account SentinelOne instance URL"
    "api_token": "customer account api token",
}
</code></pre>
<h3 id="parameters_44">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, org id</td>
</tr>
<tr>
<td><code>instance_url</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, customer account SentinelOne instance URL</td>
</tr>
<tr>
<td><code>api_token</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, customer account api_token</td>
</tr>
</tbody>
</table>
<h3 id="response_64">Response</h3>
<pre><code>{
    "linked": True,
     "accounts": [
        {
            "account_id": "00fd8b39-cf92-4b43-a2ff-a461b48e7059",
            "instance_url": "usea1-015.sentinelone.net"
            "linked_by": "user1@test.com",
            "last_status": "success",
            "last_sync": 1234567891,
            "name": "company1",
            "linked_timestamp": 1234567891,
        },
        {
            "account_id": "00fd8b39-cf92-4b43-a2ff-a461b48e7060",
            "instance_url": "usea1-017.sentinelone.net"//Linked SentinelOne instance URL
            "linked_by": "user2@test.com",//user who linked the SentinelOne account
            "last_status": "failed", //Is the last data bull for SentinelOne account is successful or not
            "last_sync": 1234567800, //Lastpull timestamp , background jobs that pull SentinelOne account data
            "name": "company2", //Name of the company whose SentinelOne account mist has subscribed to
            "linked_timestamp": 1234567891,
            "error" : "Get token failed, please re-link SentinelOne account" // This error is provided when the SentinelOne account fails to fetch token/data
        }
    ]
}
</code></pre>
<h3 id="definitions_15">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>linked</code></td>
<td><code>boolean</code></td>
<td>Application linked status, is mist portal enabled for SentinelOne</td>
</tr>
<tr>
<td><code>accounts</code></td>
<td><code>list</code></td>
<td>List of linked SentinelOne account details</td>
</tr>
</tbody>
</table>
<pre><code>Status: 200 Successful
Status: &gt; 400 Unsuccessful
</code></pre>
<h2 id="delete-sentinelone-authorization-with-mist-portal">Delete SentinelOne Authorization With Mist Portal</h2>
<p>DELETE /api/v1/orgs/:org_id/setting/sentinelone/link_accounts/:account_id</p>
<h3 id="parameters_45">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, org id</td>
</tr>
<tr>
<td><code>account_id</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>, Linked SentinelOne account ID (UUID)</td>
</tr>
</tbody>
</table>
<h3 id="response_65">Response</h3>
<pre><code>Status: 200 Successful
Status: &gt; 400 Unsuccessful
</code></pre>
<h2 id="setup-zscaler-integration">Setup Zscaler Integration</h2>
<p>in Zscaler UI
1. add Partner Integration at https://admin.zscalerbeta.net/#administration/partner-integration
2. Add Partner Administrator Role at https://admin.zscalerbeta.net/#administration/role-management
   - Name: Mist
   - Access: Full
3. add Partner Admin at https://admin.zscalerbeta.net/#administration/admin-management with
   - Login ID: john
   - email: john@abc.com
4. Find the cloud name for ZIA https://help.zscaler.com/zia/what-my-cloud-name-zia</p>
<h3 id="to-setup-zscaler-credential">To setup Zscaler credential</h3>
<pre><code>POST /api/v1/orgs/:org_id/setting/zscaler/setup
</code></pre>
<pre><code>{
    "partner_key": "K35vrZcK3JvrZc",
    "username": "john@abc.com",
    "password": "foryoureyesonly",
    "cloud_name": "zscalerbeta.net"
}
</code></pre>
<h3 id="to-get-zscaler-credential">To get Zscaler credential</h3>
<pre><code>GET /api/v1/orgs/:org_id/setting/zscaler/setup
</code></pre>
<h3 id="response_66">Response</h3>
<pre><code>{
    "partner_key": "abcd12cK3JvrZc",
    "username": "john@abc.com",
    "cloud_name": "zscalerbeta.net"
}
</code></pre>
<h3 id="to-delete-zscaler">To delete Zscaler</h3>
<pre><code>DELETE /api/v1/orgs/:org_id/setting/zscaler/setup
</code></pre>
<h2 id="setup-jse-integration">Setup JSE Integration</h2>
<p>in JSE UI
1. Create custom role with Read access to service-location and RW access to site and IPSec profile APIs.
2. Create a user with the above custom role.
   - email: john@abc.com
3. Activate the user in the JSE account.
4. Create the service locations on the JSE account.</p>
<h3 id="to-setup-jse">To setup JSE</h3>
<pre><code>POST /api/v1/orgs/:org_id/setting/jse/setup
</code></pre>
<pre><code>{
    "username": "john@abc.com",
    "password": "foryoureyesonly",
    "cloud_name": "devcentral.juniperclouds.net"
}
</code></pre>
<h3 id="to-get-jse-information">To get JSE information</h3>
<pre><code>GET /api/v1/orgs/:org_id/setting/jse/setup
</code></pre>
<h3 id="response_67">Response</h3>
<pre><code>{
    "username": "john@abc.com",
    "cloud_name": "devcentral.juniperclouds.net"
}
</code></pre>
<h3 id="to-delete-jse-credential">To delete JSE credential</h3>
<pre><code>DELETE /api/v1/orgs/:org_id/setting/jse/setup
</code></pre>
<h3 id="to-get-jse-info">To get JSE info</h3>
<p>Retrieves the list of JSE orgs associated with the account.</p>
<pre><code>GET /api/v1/orgs/:org_id/setting/jse/info
</code></pre>
<h3 id="response_68">Response</h3>
<pre><code>{
    "cloud_name": "devcentral.juniperclouds.net"
    "org_names": ["Mist-Sys", "Mist-Eng"]
}
</code></pre>
<h2 id="setup-sky-atp-integration">Setup Sky ATP Integration</h2>
<ol>
<li>Login to the Sky ATP realm through the Mist UI by providing the realm, username and password.</li>
<li>Sky ATP API is invoked which creates the realm using above details.</li>
<li>Sky ATP by default will provide functionality for Security-Intelligence and Advanced Anti Malware.</li>
<li>Security Intelligence will provide configuration for CC, DNS Feeds, Infected Host, Blocklists and Allowlists.</li>
</ol>
<h3 id="to-create-sky-atp-realm">To create Sky ATP realm</h3>
<pre><code>POST /api/v1/orgs/:org_id/setting/skyatp/setup
</code></pre>
<pre><code>{
     "realm": "mist-team",
     "username": "john@abc.com",
     "password": "skyatp"
}
</code></pre>
<h3 id="to-delete-sky-atp">To delete Sky ATP</h3>
<pre><code>DELETE /api/v1/orgs/:org_id/setting/skyatp/setup
</code></pre>
<h3 id="to-get-sky-atp">To get Sky ATP</h3>
<pre><code>GET /api/v1/orgs/:org_id/setting/skyatp/setup
</code></pre>
<h3 id="response_69">Response</h3>
<pre><code>{
    "realm": "mist-team",
    "username": "john@abc.com",
    // optional -  third party threat feeds/allowlist/blocklist
    "secintel": {
        // juniper secintel_feeds are enabled depending on your license tier: infected_host, geo_ip, attacker_ip, command_and_control

        // third party:
        //   - ip-based: block_list, threatfox_ip, feodo_tracker, dshield, tor
        //   - url-based: threatfox_url, urlhaus, open_phish
        //   - domain-based: threatfox_domains
        "third_party_threat_feeds": [ "block_list" ]
    },
    "secintel_allowlist_url": "https://papi.s3.amazonaws.com/secintel_allowlist/xxx...",
    "secintel_blocklist_url": "https://papi.s3.amazonaws.com/secintel_blocklist/xxx..."
}
</code></pre>
<h3 id="update-sky-atp-third-party-threat-feeds">Update Sky ATP Third Party Threat Feeds</h3>
<pre><code>PUT /api/v1/orgs/:org_id/setting/skyatp/setup
</code></pre>
<pre><code>{
    "secintel": {
        // juniper secintel_feeds are enabled depending on your license tier: infected_host, geo_ip, attacker_ip, command_and_control

        // third party:
        //   - ip-based: block_list, threatfox_ip, feodo_tracker, dshield, tor
        //   - url-based: threatfox_url, urlhaus, open_phish
        //   - domain-based: threatfox_domains
        "third_party_threat_feeds": [ "block_list" ]
    }
} 
</code></pre>
<h3 id="update-sky-atp-allowedblocked-list">Update Sky ATP Allowed/Blocked List</h3>
<pre><code>PUT /api/v1/orgs/:org_id/setting/skyatp/secintel_allowlist
PUT /api/v1/orgs/:org_id/setting/skyatp/secintel_blocklist
</code></pre>
<pre><code>{
    "ip": [
        {
            "value": "10.1.3.5",
            // optional
            "comment": "nas"
        }
    ],
    "domain": [
        {
            "value": "unsafe.xxx",
            // optional
            "comment": "restricted"
        }
    ]
}
</code></pre>
<h1 id="org-webhooks">Org Webhooks</h1>
<h3 id="base-uri">Base URI</h3>
<pre><code>/api/v1/orgs/:org_id/webhooks
/api/v1/orgs/:org_id/webhooks/:webhook_id/ping
/api/v1/orgs/:org_id/webhooks/:webhook_id/events/search
/api/v1/orgs/:org_id/webhooks/:webhook_id/events/count
</code></pre>
<h3 id="example_2">Example</h3>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#webhooks">Site:Webhooks</a> for schema</p>
<p><strong>N.B.</strong> For org webhooks, only <em>alarms/audits/client-info/client-join/client-sessions/device-events/device-updowns/mxedge-events</em>
Infrastructure topics are supported.</p>
<h1 id="installer-apis">Installer APIs</h1>
<p>In a typical enterprise, a separate group of people, Installers, are responsible for install new devices. May it be a
new installation (e.g. new stores), a replacement installation (e.g. replacing Cisco APs with Mist APs), or addition (
e.g. adding new APs for better coverage). Instead of granting them Admin/Write privilege, it’s more desirable to grant
them minimum privileges to do the initial provisioning so they cannot read sensible information (e.g. PSK of a WLAN), or
change configs of running APs.</p>
<p>At a high level, Installer APs try to achieve the following:</p>
<ol>
<li>identifying a device by MAC (that’s what they see)</li>
<li>they can only touch configurations of the devices they’re installing</li>
<li>allow the following configurations:<ul>
<li>name</li>
<li>site assignment</li>
<li>device profile assignment</li>
<li>map and location (x/y) assignment</li>
<li>claim (if not already in the inventory)</li>
<li>replace existing device with the device being installed</li>
</ul>
</li>
</ol>
<h4 id="grace-period">Grace Period</h4>
<p>Grace period provides a dynamic way to limit what devices / sites installer can work on. Generally installers work on
recent deployments - bringing up new sites, add newly claimed devices to new / existing sites. They make mistakes, too,
and may need to further tweak some of the parameters. Default grace period is 7 days and can be set from 1 day to 365
days.</p>
<h2 id="get-list-of-devices-recently-claimed">Get List of Devices Recently Claimed</h2>
<pre><code>GET /api/v1/installer/orgs/:org_id/devices?limit=100
</code></pre>
<h3 id="supported-filters_1">Supported Filters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>device model</td>
</tr>
<tr>
<td><code>site_name</code></td>
<td><code>string</code></td>
<td>site name</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site_id</td>
</tr>
</tbody>
</table>
<h3 id="response_70">Response</h3>
<pre><code>X-Page-Limit: 100
X-Page-Page: 1
X-Page-Total: 31
[
    {
        //
        "mac": "5c5b35000018",
        "model": "AP41",
        "serial": "FXLH2015150025",
        "vc_mac": null,

        // from site / profile assignment
        "name": "hallway",
        "site_name": "SJ1",
        "deviceprofile_name": "SJ1",

        // if assigned to a site
        "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
        "x": 150,
        "y": 300,
        "height": 2.7,
        "orientation": 90,

        // from stats
        "connected": true,
        "last_seen": 1687887907.5919843,
        "uptime": 12345,
        "version": "0.10.24362",
        "ip": "192.168.1.111",
        "ext_ip": "12.34.56.78"
    },
    ...
]
</code></pre>
<h2 id="provision">Provision</h2>
<pre><code>PUT /api/v1/installer/orgs/:org_id/devices/:mac
</code></pre>
<h3 id="request_33">Request</h3>
<pre><code>{
    "name": "SJ1-AP1",

    // optional
    "deviceprofile_name": "SJ1",

    // optional
    "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
    "site_name": "SJ1",

    // optional
    "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",  // has to be in the same site
    "x": 150,
    "y": 300,
    "height": 2.7,
    "orientation": 90,

    // optional role for switch / gateway
    "role": "switch_role",

    // if this is to replace an existing device
    "replacing_mac": "5c5b3500003"
}
</code></pre>
<p>If <code>replacing_mac</code> is in the request payload, other attributes are ignored, we attempt to replace existing device (with mac <code>replacing_mac</code>) with the inventory device being configured.
The replacement device must be in the inventory but not assigned, and the <code>replacing_mac</code> device must be assigned to a site, and satisfy grace period requirements.
The Device replaced will become unassigned.</p>
<h3 id="response-if-it-was-last-modified-outside-of-grace-period">Response if it was last modified outside of grace period</h3>
<pre><code>Status: 400 Bad Request

{
    "detail": "outside of grace period"
}
</code></pre>
<h3 id="failures-with-replacing-device">Failures with replacing device</h3>
<p>invalid mac given for <code>replacing_mac</code>:</p>
<pre><code>Status: 400 Bad Request

{
    "detail": "invalid replacing_mac"
}
</code></pre>
<p><code>replacing_mac</code> device is not in org inventory:</p>
<pre><code>Status: 404 Not Found

{
    "detail": "replacing_mac inventory not found"
}
</code></pre>
<p><code>replacing_mac</code> device not found:</p>
<pre><code>Status: 404 Not Found

{
    "detail": "replacing_mac device not found"
}
</code></pre>
<p><code>replacing_mac</code> device last modified outside of grace period:</p>
<pre><code>Status: 400 Bad Request

{
    "detail": "replacing_mac device outside of grace period"
}
</code></pre>
<p><code>replacing_mac</code> device is not assigned to a site:</p>
<pre><code>Status: 400 Bad Request

{
    "detail": "replacing_mac device is unassigned"
}
</code></pre>
<p>inventory device is already assigned:</p>
<pre><code>Status: 400 Bad Request

{
    "detail": "device already assigned"
}
</code></pre>
<h2 id="unassign-a-device-recently-claimed">Unassign a Device Recently Claimed</h2>
<pre><code>DELETE /api/v1/installer/orgs/:org_id/devices/:mac
</code></pre>
<h2 id="claim-devices">Claim Devices</h2>
<p>This mirrors<code>POST /api/v1/orgs/:org_id/inventory</code> (see <a href="https://api.mist.com/api/v1/docs/Org#add-inventory-to-an-org">Inventory API</a>)</p>
<pre><code>POST /api/v1/installer/orgs/:org_id/devices
</code></pre>
<h3 id="request_34">Request</h3>
<pre><code>[
    "6JG8E-PTFV2-A9Z2N",
    "DVH4V-SNMSZ-PDXBR"
]
</code></pre>
<h2 id="get-sites">Get Sites</h2>
<p>Get the sites Installer can see / modify. This includes all sites (last modified within the grace period) and the
<code>extra_site_ids</code> defined in Org Setting</p>
<pre><code>GET /api/v1/installer/orgs/:org_id/sites
</code></pre>
<h3 id="response_71">Response</h3>
<pre><code>[
    {
        "id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
        "name": "Mist Office",
        "timezone": "America/Los_Angeles",
        "country_code": "US",
        "latlng": { "lat": 37.295833, "lng": -122.032946 },
        "address": "1601 S. Deanza Blvd., Cupertino, CA, 95014"
    }
]
</code></pre>
<h2 id="create-or-update-a-site">Create or Update a Site</h2>
<p>Often the Installers are asked to assign Devices to Sites. The Sites can either be pre-created or created/modified by
the Installer. If this is an update, the same grace period also applies.</p>
<pre><code>PUT /api/v1/installer/orgs/:org_id/sites/:site_name
</code></pre>
<h3 id="request_35">Request</h3>
<pre><code>{
    "timezone": "America/Los_Angeles",
    "country_code": "US",
    "latlng": { "lat": 37.295833, "lng": -122.032946 },
    "address": "1601 S. Deanza Blvd., Cupertino, CA, 95014"

    "rftemplate_name": "rftemplate1",
    "sitegroup_names": ["sg1", "sg2"]
}
</code></pre>
<h2 id="get-update-create-maps">Get / Update / Create Maps</h2>
<p>CRUD APIs for Maps works exactly the same way as those in Sites</p>
<pre><code>GET /api/v1/installer/orgs/:org_id/sites/:site_name/maps
POST /api/v1/installer/orgs/:org_id/sites/:site_name/maps/:id
PUT /api/v1/installer/orgs/:org_id/sites/:site_name/maps/:id
DELETE /api/v1/installer/orgs/:org_id/sites/:site_name/maps/:id
</code></pre>
<h2 id="map-import">Map Import</h2>
<p>Import data from files is a multipart POST which has an file, an optional json, and an optional csv, to create
floorplan, assign &amp; place ap if name or mac matches</p>
<pre><code>POST /api/v1/installer/orgs/:org_id/sites/:site_name/maps/import
</code></pre>
<h3 id="request_36">Request</h3>
<p>A multi-part POST</p>
<pre><code>"json": a JSON string, vendor option: ekahau, ibwave, import_all_floorplans: optional, false by default,
import_height: optional, default: true, import_orientation: optional, default: true
"file": a binary file, option: .esx
"csv": a csv file for ap name mapping, optional
// for the JSON payload
{
    "vendor_name": "ekahau",
    "import_all_floorplans": true  // optional
    "import_height": true, // optional
    "import_orientation": false // optional
}
</code></pre>
<h3 id="device-import-csv-file-format">Device Import CSV File Format</h3>
<pre><code>Vendor AP name,Mist AP Mac
US Office AP-2 - 5c:5b:35:00:00:02,5c5b35000002
</code></pre>
<h3 id="response_72">Response</h3>
<pre><code>{
    "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
    "aps": [
        {
            "mac": "5c5b35000001",
            // placed
            "action": "placed"
            "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5"
            // assigned to a site and placed
            "action": "assigned-placed",
            // named and placed
            "action": "named-placed"
            // assigned, named and placed
            "action": "assigned-named-placed"
            // if we ignore it (did nothing with it)
            "action": "ignored",
            // floorplan id, height, orientation for ignored ap
            "floorplan_id": "cbdb7f0b-3be0-4872-88f9-58790b509c23-j68kows8"
            "orientation": 45,
            "height": 3
            "reason": "not found on site" // "not found in inventory"
        }
    ],
    "floorplans": [
        {
            // whatever ID vendor has
            "id": "cbdb7f0b-3be0-4872-88f9-58790b509c23-j68kows8",
            "name": "map1",
            // we only import the floorplan if at least one of the AP is being placed by default
            "action": "imported",
            "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
            "action": "ignored",
            "reason": "no aps placed"
        }
    ],
    "summary": {
        "num_ap_assigned": 1,
        "num_map_assigned": 1,
        "num_inv_assigned": 1
    }
}
</code></pre>
<h2 id="locate-a-device">Locate a Device</h2>
<p>Locate a Device by blinking it’s LED, it’s a persisted state that has to be stopped by calling Stop Locating API</p>
<pre><code>POST /api/v1/installer/orgs/:org_id/devices/:mac/locate
</code></pre>
<h2 id="stop-locating-a-device">Stop Locating a Device</h2>
<pre><code>POST /api/v1/installer/orgs/:org_id/devices/:mac/unlocate
</code></pre>
<h2 id="optimize">Optimize</h2>
<p>After installation is considered complete (APs are placed on maps, all powered up), you can trigger an optimize
operation where RRM will kick in (and maybe other things in the future) before it’s automatically scheduled.</p>
<pre><code>GET /api/v1/installer/sites/:site_name/optimize
</code></pre>
<h2 id="get-vc-status">Get VC Status</h2>
<p>This mirrors <code>GET /api/v1/sites/:site_id/devices/:device_id/vc</code> (see <a href="https://api.mist.com/api/v1/docs/Site.md#Get-VC-Status">Virtual Chassis API</a>)
where site_id and device_id are replaced with fpc0_mac</p>
<pre><code>GET /api/v1/installer/orgs/:org_id/devices/:fpc0_mac/vc
</code></pre>
<h2 id="form-a-new-preprovisioned-vc">Form a New Preprovisioned VC</h2>
<p>This mirrors <code>POST /api/v1/sites/:site_id/devices/:device_id/vc</code> (see <a href="https://api.mist.com/api/v1/docs/Site.md#Create-a-pre-provisioned-VC-with-three-members">Virtual Chassis API</a>) where site_id and device_id are replaced with fpc0_mac</p>
<pre><code>    POST /api/v1/installer/orgs/:org_id/devices/:fpc0_mac/vc
    {
        "preprovisioned": true,
        "members": [
            {
                "mac": "aff827549235",      // fpc0, same as fpc0_mac
                "vc_role": "master",
                "member_id": 0,
                "vc_ports": ["xe-0/1/0", "xe-0/1/1"]
            },
            {
                "mac": "8396cd006c8c",
                "vc_role": "linecard",
                "member_id": 1,
                "vc_ports": ["xe-0/1/0"],
            },
            {
                "mac": "8396cd00888c",
                "vc_role": "backup",
                "member_id": 2,
                "vc_ports": ["xe-0/1/0"]
            }
        ]
    }
</code></pre>
<h2 id="perprovision-vc-members">Perprovision VC members</h2>
<p>This mirrors <code>PUT /api/v1/sites/:site_id/devices/:device_id/vc</code> (see <a href="https://api.mist.com/api/v1/docs/Site.md#Perprovision-VC-members">Virtual Chassis API</a>)
where site_id and device_id are replaced with fpc0_mac</p>
<h3 id="add-8396cd00888c-as-member-2-and-enable-related-vc-ports">add 8396cd00888c as member 2 and enable related vc ports</h3>
<pre><code>    PUT /api/v1/installer/orgs/:org_id/devices/:fpc0_mac/vc
    {
        "op": "preprovision",
        "members": [
            {
                "mac": "aff827549235",      // fpc0, same as fpc0_mac of current VC
                "vc_role": "master",
                "member_id": 0,
                "vc_ports": ["xe-0/1/1"]    // enabling vc port xe-0/1/1 on member 0
            },
            {
                "mac": "8396cd006c8c",
                "vc_role": "linecard",
                "member_id": 1
            },
            {
                "mac": "8396cd00888c",
                "vc_role": "backup",
                "member_id": 2,
                "vc_ports": ["xe-0/1/0"]    // enabling vc port xe-0/1/1 on member 2
            }
        ]
    }
</code></pre>
<h2 id="get-list-of-deviceprofile-names-wip">Get List of DeviceProfile Names (WIP)</h2>
<pre><code>GET /api/v1/installer/orgs/:org_id/deviceprofiles?type=ap
</code></pre>
<h3 id="parameters_46">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>device type, ap (default) / switch / gateway</td>
</tr>
</tbody>
</table>
<h3 id="response_73">Response</h3>
<pre><code>[
    {
        "id": "6f4bf402-45f9-2a56-6c8b-7f83d3bc98e9",
        "name: "DeviceProfile 1",
        "type": "ap"  // device type, ap (default) / switch / gateway
    }
]
</code></pre>
<h2 id="attach-device-image-wip">Attach Device Image (WIP)</h2>
<p>Attach up to 3 images to a device</p>
<pre><code>POST /api/v1/installer/orgs/:org_id/devices/:mac/image1
POST /api/v1/installer/orgs/:org_id/devices/:mac/image2
POST /api/v1/installer/orgs/:org_id/devices/:mac/image3
</code></pre>
<h3 id="request_37">Request</h3>
<p>A multi-part POST</p>
<pre><code>"file": a binary file
</code></pre>
<h2 id="remove-device-image-wip">Remove Device Image (WIP)</h2>
<p>Delete background image for Portal</p>
<pre><code>DELETE /api/v1/installer/orgs/:org_id/devices/:mac/image1
DELETE /api/v1/installer/orgs/:org_id/devices/:mac/image2
DELETE /api/v1/installer/orgs/:org_id/devices/:mac/image3
</code></pre>
<h2 id="get-list-of-rftemplate-names-wip">Get List of RFTemplate Names (WIP)</h2>
<pre><code>GET /api/v1/installer/orgs/:org_id/rftemplates
</code></pre>
<h3 id="response_74">Response</h3>
<pre><code>[
    {
        "id": "bb8a9017-1e36-5d6c-6f2b-551abe8a76a2",
        "name: "RFTemplate 1"
    }
]
</code></pre>
<h2 id="get-list-of-sitegroup-names-wip">Get List of SiteGroup Names (WIP)</h2>
<pre><code>GET /api/v1/installer/orgs/:org_id/sitegroups
</code></pre>
<h3 id="response_75">Response</h3>
<pre><code>[
    {
        "id": "581328b6-e382-f54e-c9dc-999983183a34",
        "name: "SiteGroup 1"
    }
]
</code></pre>
<h2 id="get-list-of-alarm-templates">Get List of Alarm Templates</h2>
<pre><code>GET /api/v1/installer/orgs/:org_id/alarmtemplates
</code></pre>
<h3 id="response_76">Response</h3>
<pre><code>[
    {
        "id": "684dfc5c-fe77-2290-eb1d-ef3d677fe168",
        "name: "AlarmTemplate 1"
    }
]
</code></pre>
<h1 id="rf-template">RF Template</h1>
<p>RF Templates are designed to make Radio Configs more consistent across Sites - by creating a RF Templates with desired
settings and apply it to <a href="https://api.mist.com/api/v1/docs/Org#sites">Sites</a>. AP/Device-level overwrite can still be done.</p>
<p>NOTE: country_code, if specified, will take precedence over one defined in the Site</p>
<h2 id="get-all-create-rf-templates">Get All Create RF Templates</h2>
<pre><code>GET /api/v1/orgs/:org_id/rftemplates
POST /api/v1/orgs/:org_id/rftemplates
</code></pre>
<h2 id="get-update-delete-rf-templates">Get / Update / Delete RF Templates</h2>
<pre><code>GET /api/v1/orgs/:org_id/rftemplates/:rftemplate_id
PUT /api/v1/orgs/:org_id/rftemplates/:rftemplate_id
DELETE /api/v1/orgs/:org_id/rftemplates/:rftemplate_id
</code></pre>
<h3 id="example_3">Example</h3>
<pre><code>{
    "name": "5G-Restricted",
    "country_code": "US",
    "band_24": {
        "disabled": false,
        "channels": [ 1, 6, 11 ],
        "bandwidth": 20,
        "power": 16
    },
    "band_5": {
        "disabled": false,
        "channels": null,
        "bandwidth": 40,
        "power": 0,
        "preamble": "short",
        "power_min": 10,
        "power_max": 18
    },
    "band_6": {
        "disabled": false,
        "channels": null,
        "bandwidth": 40,
        "power": 0,
        "preamble": "short",
        "power_min": 10,
        "power_max": 18
    },
    "model_specific": {
        "AP61": {
            "band_5": {
                "disabled": false,
                "channels": [ 100, 104 ],
                "bandwidth": 40,
                "power": 0
            }
        }
    }
}
</code></pre>
<h3 id="response-definitions_1">Response Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>The name of the RF template</td>
</tr>
<tr>
<td><code>country_code</code></td>
<td><code>string</code></td>
<td>optional, country code to use. If specified, this gets applied to all sites using the RF Template</td>
</tr>
<tr>
<td><code>model_specific</code></td>
<td><code>object</code></td>
<td>overwrites for a specific model. If a band is specified, it will shadow the default.</td>
</tr>
<tr>
<td><code>channels</code></td>
<td><code>list</code></td>
<td>list of channels, null or empty array means auto</td>
</tr>
<tr>
<td><code>bandwidth</code></td>
<td><code>int</code></td>
<td>channel width for the band, 20 / 40 / 80 / 160, 80 is only applicable for band_5 and 160 is only for band_6</td>
</tr>
<tr>
<td><code>power</code></td>
<td><code>int</code></td>
<td>tx power of the radio, 0 mean auto</td>
</tr>
<tr>
<td><code>power_min</code></td>
<td><code>int</code></td>
<td>when power=0, min tx power to use, HW-specific values will be used if not set</td>
</tr>
<tr>
<td><code>power_max</code></td>
<td><code>int</code></td>
<td>when power=0, max tx power to use, HW-specific values will be used if not set</td>
</tr>
<tr>
<td><code>preamble</code></td>
<td><code>string</code></td>
<td>short / long / auto, default is short</td>
</tr>
</tbody>
</table>
<h1 id="network-template">Network Template</h1>
<p>Network template is intended to be applied to a Site. It works like a blueprint of the network of the site.</p>
<p>All Site Settings can go into Network Templates. See <a href="https://api.mist.com/api/v1/docs/Site#site-setting">Site:Site Setting</a> for schema</p>
<p>Moreover, this can further be overwritten by individual Site Setting</p>
<h2 id="create-network-template">Create Network Template</h2>
<pre><code>POST /api/v1/orgs/:org_id/networktemplates
</code></pre>
<h2 id="get-update-delete-network-templates">Get / Update / Delete Network Templates</h2>
<pre><code>GET /api/v1/orgs/:org_id/networktemplates/:networktemplate_id
PUT /api/v1/orgs/:org_id/networktemplates/:networktemplate_id
DELETE /api/v1/orgs/:org_id/networktemplates/:networktemplate_id
</code></pre>
<h3 id="payload_3">Payload</h3>
<pre><code>{
    "name": "xxx",

    "networks": {
        // default is assumed, cannot be changed
        "default": {
            "vlan_id": 1
        },

        // create more
        "corp": {
            "vlan_id": 600
        },
        "guest": {
            "vlan_id": 700
        },
        "mgmt": {
            "vlan_id": 500
        }
    },


    // optional, the Org Networks that we'd like to import
    "import_org_networks": ["ap", "iot"],

    // mist_nac: enable mist_nac to use racsec
    "mist_nac": {
        "enabled": true,
        "network": "default"
    }

    "radius_config": {
        "auth_servers_timeout": 5,
        "auth_servers_retries": 3,
        "auth_servers": [
            {
                "host": "1.2.3.4",
                "port": 1812,
                "secret": "testing123"
            },
            {
                "host": "radius.internal",
                "port": 1812,
                "secret": "testing123"
            }
        ],
        "acct_servers": [
            {
                "host": "1.2.3.4",
                "port": 1812,
                "secret": "testing123"
            }
        ],
        "acct_interim_interval": 0,

        // Enable COA. Default is false. When coa_port is not specified, 3799 is the default value.
        “coa_enabled”: true,
        “coa_port”: 3799,

        // which network the RADIUS server resides, if there's static IP for this network,
        // we'd use it as source-ip
        "network": "default"

        // or specifiy "source_ip" directly
        "source_ip": "192.168.3.5"
    },

    "dns_servers": [ "8.8.8.8", "4.4.4.4" ],
    "dns_suffix": [ ".mist.local", ".mist.com" ],

    "port_usages": {
        "ap": {
            // the following parameter is assumed by default
            "mode": "trunk",
            "all_networks": true,
            "stp_edge": true,
            "port_network": "default",
            "mtu": 9192,

            // to limit networks it trunks
            "all_networks": false,
            "networks": [ "guest", "corp" ],

            // to change the native network
            "port_network": "mgmt"

            // to make the port disabled
            "disabled": true,

            // if alternative name is desired
            "description": "WAP"
        },
        "uplink": {
            // the following parameter is assumed by default
            "mode": "trunk",
            "all_networks": true,
            "stp_edge": false,
            "port_network": null,
            "enable_qos": false,
        },
        "iot": {
            // the following parameter is assumed by default
            "mode": "access",
            "stp_edge": true,
            "port_network": "default",

            // if DHCP snooping is enabled, DHCP server is allowed
            "allow_dhcpd": true,
        },
        "default": {
            // the following parameter is assumed by default and cannot be changed
            "mode": "access",
            "stp_edge": false,  // we don't know how it will be connected at default state, not doing anything
            "port_network": "default"
        },
        "disabled": {
            // mode to disable port
            // the following parameter is assumed by default
            "disabled": true,
        }
        "dynamic": {
            // this is a special mode where the actually usage is determined
            // by a set of rules
            // the port will start with `access` mode and isolated
            // depending on the rules, if resolved, the port will have
            // the resolved usage applied.
            //
            // if the port/link goes down, it goes back to the initial state
            "mode": "dynamic",

            // Control when the DPC port should be changed to the default port usage
            // Configuring to none will let the DPC port keep at the current port usage.
            // The default value is link_down
            "reset_default_when": "none",   // none or link_down.

            "rules": [
                // use LLDP attributes
                {
                    "src": "lldp_system_name",  // or lldp_chassis_id
                    "expression": "[0:3]",           // "abcdef" -&gt; "abc"
                                  "split(.)[1]",     // "a.b.c" -&gt; "b"
                                  "split(-)[1][0:3], // "a1234-b5678-c90" -&gt; "b56"
                    "equals": "SENSOR",
                    "usage": "iot"
                },
                // use equals_any to match any item in a list
                {
                    "src": "lldp_chassis_id",
                    "expression": "[0:17]",
                    “equals_any”: [“00:11:22:33:44:55", “00:11:22:33:44:66”, “00:11:22:33:44:77"],
                    "usage": "iot"
                },
                // use RADIUS (WIP)
                {
                    "src": "radius_username",  // or radius_group
                    "expression": "[0:3]",           // "abcdef" -&gt; "abc"
                                  "split(.)[1]",     // "a.b.c" -&gt; "b"
                                  "split(-)[1][0:3], // "a1234-b5678-c90" -&gt; "b56"
                    "equals": "SENSOR"
                    "usage": "iot"
                },
            ]
        },

        // additional usages can be defined
        "user": {
            "mode": "access",
            "stp_edge": true,

            // 802.1x
            "port_auth": "dot1x",
            "enable_mac_auth": false,
            "mac_auth_protocol": "eap-md5", // eap-md5 (default) / pap / eap-peap. This type is ignored if mist_nac is enabled.  
            "guest_network": null,
            "bypass_auth_when_server_down": false,
        },
    },

    "group_tags": {

    },

    "switch_matching": {
        "enable": true,

        "rules": [
            {
                "name": "match by name",
                "match_name[0:3]": "abc",
                "match_model": "EX4300",

                "port_config": {
                    "ge-0/0/0": {
                        "usage": "uplink"
                    },
                    "ge-0/0/8-16,ge-1/0/0-47": {
                        "usage": "ap"
                    },

                    // this is assumed
                    "*": {
                        "usage": "default"
                    }
                },

                // additional CLI commands to append if this rule matches
                // NOTE: no check is done
                "additional_config_cmds": [
                    "set snmp community public"
                ],
                "port_mirroring": {
                    "port_mirror": {
                        "input_port_ids_ingress": ["ge-0/0/4"],
                        "input_networks_ingress": ["test"],
                        "input_port_ids_egress": ["ge-0/0/5", "ge-0/0/6"],
                        "output_port_id": "ge-0/0/3",
                    },
                    "port_mirror_test": {
                        "input_port_ids_ingress": ["ge-0/0/3"],
                        "input_networks_ingress": ["iot"],
                        "input_port_ids_egress": ["ge-0/0/22", "ge-0/0/21"],
                        "output_port_id": "ge-0/0/4",
                    }
                },

                "switch_mgmt": {
                    "config_revert_timer": 5,
                    // Enable to provide the FQDN with DHCP option 81. Default is false
                    "dhcp_option_fqdn": false

                    // use mxedge as proxy
                    "use_mxedge_proxy": true,
                    "mxedge_proxy_host": "1.1.1.1",
                    "mxedge_proxy_port": 2222,  // optional, default is 2222
                    "ap_affinity_threshold": 10,
                    "cli_idle_timeout": 20,
                    "cli_banner": "\t\tW A R N I N G !!!!!!!",
                    "local_accounts": {
                        "user1": {
                            "role": "admin", // none (default) / admin / read / helpdesk
                            "password": "Juniper123" // optional
                        },
                    },
                    "fips_enabled": true // default is false
                }
            },
            {
                "name": "match by role",
                "match_role": "access",

                "port_config": {
                    "ge-0/0/0": {
                        "usage": "uplink"
                    }
                },

                // additional CLI commands to append if this rule matches
                // NOTE: no check is done
                "additional_config_cmds": [
                    "set snmp community public2"
                ]
            },
            {
                "name": "access-no-out-of-band",
                "match_role": "access",
                "match_model[0:6]": "EX2300"
                "switch_mgmt": {
                    "disable_oob_down_alarm": true
                }
            }
        ]
    },

    "optic_port_config": {
        "et-0/0/0": {
            "speed": "25g",
            "channelized": True // enable channelization 
        }
        "et-0/0/1": {
            "speed": "25g" // do chassis speed by default
        }
    }

    "snmp_config":{
        "enabled": true, // enable or disable
        "name": "TGH-1K-QFX10K",
        "location": "Las Vegas, NV",
        "description": "Juniper QFX Series Switch - 1K_5LA",
        "contact": "cns@juniper.net",
        "network": "default",
        "client_list": [
            {
                "client_list_name": "clist-1",
                "clients": [
                    "151.140.101.218/32",
                    "151.140.2.179/32"
                ]
            }
        ],
        "views":[
            {
                 "view_name":"all",
                 "oid": "1.3.6.1",
                 "include": true  //oid 1.3.6.1 include"
            }
        ],
        "engine_id_type": "local", // local (default) / use_mac_address
        "engine_id": "engine-id-suffix", // if engine_id_type is local, this is the suffix to use
        "trap_groups": [
            {
                "group_name": "profiler",
                // Categories list can refer to https://www.juniper.net/documentation/software/topics/task/configuration/snmp-trap-groups-configuring-junos-nm.html
                "categories": [
                    "link", "authentication"
                ],
                "targets": [
                    "172.29.158.19",
                    "172.29.146.73"
                ],
                //version can be v1, v2 and all
                "version": "v2"
            }
        ],
        "v2c_config": [
            {
                "community_name": "abc123",
                "authorization": "read-only",
                "view": "all" //view name here should be defined in views above
            },
            {
                "community_name": "abc1233",
                //client_list_name here should refer to client_list above
                "client_list_name": "clist-1"
            }
        ],
        "v3_config": {
            "usm": [
                {
                    "engine_type": "remote_engine | local_engine",
                    "remote_engine_id": "00:00:00:0b:00:00:70:10:6f:08:b6:3f &lt;remote engine required only&gt;",
                    "users": [
                        {
                            "name": "m01620",
                            "authentication_type": "authentication-md5 | authentication-sha | authentication-sha224 | authentication-sha256 | authentication-sha384 | authentication-sha512 | authentication-none", //sha224, sha256, sha384, sha512 are supported in 21.1 and newer release
                            "authentication_password": "at least eight characters long, include alphabetic, numeric, and special characters, but it cannot include control characters. &lt;Don't require if type is none&gt;",
                            "encryption_type": "privacy-aes128 | privacy-des | privacy-3des | privacy-none",
                            "encryption_password": "at least eight characters long, include alphabetic, numeric, and special characters, but it cannot include control characters. &lt;Don't require if type is none&gt;",
                        }
                    ]
                }
            ],
            "vacm": {
                "access": [
                    {
                        "group_name": "group_name",
                        "prefix_list": [
                            {
                                "type": "default_context_prefix | context_prefix",
                                "context_prefix": "iil &lt;needed only type is context_prefix&gt;",
                                "security_model": "any | usm | v1 | v2c",
                                "security_level": "privacy | authentication | none",
                                "notify_view": "all &lt;refer to above view name&gt;",
                                "read_view": "all &lt;refer to above view name&gt;",
                                "write_view": "all &lt;refer to above view name&gt;"
                            }
                        ]
                    }
                ],
                "security_to_group": {
                    "security_model": "usm | v1 | v2c",
                    "content":[
                        {
                            "security_name": "security_name",
                            "group": "group_name, &lt;refer to above group_name under access&gt;"
                        }
                    ]
                }
            },
            "notify": [
                {
                    "name": "notify_name",
                    "tag": "tag_name",
                    "type": "trap | inform"
                }
            ],
            "notify_filter": [
                {
                    "profile_name": "notify_name",
                    "contents": [
                        {
                            "oid": "1.3.6.1.4.1",
                            "include": true  //oid object-identifier (include | exclude)
                        }
                    ]
                }
            ],
            "target_parameters": [
                {
                    "name": "target_parameters_name",
                    "notify_filter": "profile_name &lt;refer to profile-name in notify-filter above&gt;",
                    "message_processing_model": "v1 | v2c | v3",
                    "security_level": "authentication | none | privacy",
                    "security_model": "usm | v1 | v2c",
                    "security_name": "m01620 &lt;refer to security_name in usm&gt;"
                }
            ],
            "target_address": [
                {
                    "target_address_name": "target_address_name",
                    "address": "address",
                    "address_mask": "address_mask",
                    "port": 161,
                    "tag_list": "tag name &lt;refer to notify tag above, can be multiple with blank&gt;",
                    "target_parameters": "target_parameters &lt;refer to notify target parameters name above&gt;"
                }
            ]
        }
    }
}
</code></pre>
<h1 id="ap-template">AP Template</h1>
<h2 id="get-update-delete-ap-port-templates">Get / Update / Delete AP-Port Templates</h2>
<pre><code>GET /api/v1/orgs/:org_id/aptemplates/:aptemplate_id
PUT /api/v1/orgs/:org_id/aptemplates/:aptemplate_id
DELETE /api/v1/orgs/:org_id/aptemplates/:aptemplate_id
</code></pre>
<h3 id="example_4">Example</h3>
<pre><code>{
    "ap_matching": {
        "enabled": true,

        "rules": [
            {
                "name": "AP12",
                "match_model": "AP12",

                "port_config": {
                    "eth1,eth2": {
                        // see Device Config's port_config
                    }
                }
            },
        }
    },
    "wifi": {
        "enabled": true,
        "mesh_enabled": true,
        "mesh_allow_dfs": false,
        "mesh_enable_crm": false
        "cisco_enabled": true,
        "proxy_arp": "default",
        "enable_arp_spoof_check": false,
        "locate_connected": false,
        "locate_unconnected": false,
        "enable_shared_radio_scanning": false,
        "disable_11k": false,
        "disable_radios_when_power_constrained": false,
    },
}
</code></pre>
<h1 id="site-template">Site Template</h1>
<p>Site template is intended to be applied to a Site. The items in site setting which should be shared for all device types.</p>
<h2 id="create-network-template_1">Create Network Template</h2>
<pre><code>POST /api/v1/orgs/:org_id/sitetemplates
</code></pre>
<h2 id="get-update-delete-site-templates">Get / Update / Delete Site Templates</h2>
<pre><code>GET /api/v1/orgs/:org_id/sitetemplates/:sitetemplate_id
PUT /api/v1/orgs/:org_id/sitetemplates/:sitetemplate_id
DELETE /api/v1/orgs/:org_id/sitetemplates/:sitetemplate_id
</code></pre>
<h3 id="example_5">Example</h3>
<pre><code>{
    "name": "template_000",
    "vars": {
        "VLAN_ID': "2345",
        "SSID_STR': "mist"
    },
    "auto_upgrade": {
        "enabled": true,
        "version": "stable",
        "time_of_day": "01:00",
        "day_of_week": "mon"
    }
}
</code></pre>
<h1 id="device-config-generation">Device Config Generation</h1>
<p>Mist provides many ways (device-type specific template, site template, device profile, per-device)
to configure devices for different kind of scenarios.</p>
<p>The precedence goes from most specific to least specific</p>
<p>Device &gt; Device Profile &gt; RFTemplate (for AP only) &gt; DeviceType-specific Template &gt; Site Template &gt; Site Setting</p>
<h1 id="evpn">EVPN</h1>
<p>In some scenarios, you may want to have EVPN topologies across sites. For usage, seesee <a href="https://api.mist.com/api/v1/docs/Site#evpn">Site:EVPN</a></p>
<pre><code>GET /api/v1/orgs/:org_id/evpn_topologies
POST /api/v1/orgs/:org_id/evpn_topologies

GET /api/v1/orgs/:org_id/evpn_topologies/:evpn_topology_id
PUT /api/v1/orgs/:org_id/evpn_topologies/:evpn_topology_id
DELETE /api/v1/orgs/:org_id/evpn_topologies/:evpn_topology_id
</code></pre>
<h1 id="networks">Networks</h1>
<p>Networks are usually subnets that have cross-site significance. They will got merged into <code>networks</code> in and Site Setting
For gateways, they can be used to define Service Routes.</p>
<h2 id="create-network">Create Network</h2>
<pre><code>POST /api/v1/orgs/:org_id/networks
</code></pre>
<h2 id="get-update-delete-network">Get / Update / Delete Network</h2>
<pre><code>GET /api/v1/orgs/:org_id/networks/:network_id
PUT /api/v1/orgs/:org_id/networks/:network_id
DELETE /api/v1/orgs/:org_id/networks/:network_id
</code></pre>
<pre><code>{
    "name": "store",
    "vlan_id": 70,
    "subnet": "192.168.70.0/24",
    "gateway": "192.168.70.1",
    "subnet6": "fdad:b0bc:f29e::/32",
    "gateway6": "fdad:b0bc:f29e::1",


    // whether to allow clients in the network to talk to each other
    "isolation": false,

    // whether to disallow Mist Devices in the network
    "disallow_mist_services": false,  // default is false

    // for a Network (usually LAN), it can be routable to other networks (e.g. OSPF)
    "routed_for_networks": ["pos"], 

    // whether this network has direct internet access
    "internet_access": {
        "static_nat": {
            "63.16.0.1": {"internal_ip": "192.168.70.3", "name": "printer-1"},
            "63.16.0.32/30": {"internal_ip": "192.168.70.16/30", "name": "pos-stations"},
        },
        "destination_nat": {
            ":2222": {"internal_ip": "192.168.70.30", "name": "ssh", "port": 22},
            "63.16.0.3:443": {"internal_ip": "192.168.70.5", "name": "web server", "port": 443}
        },

        // a quick way to enable this network to access Internet
        "create_simple_service_policy": false   // default is false
    },

    // whether this network can be accessed from vpn
    "vpn_access": {
        "data-center": {
            "routed": true,  // whether this network is routable
            "allow_ping": false,  // whether to allow ping from vpn into this routed network

            // if routable = false (usually at Spoke), but some hosts needs to be reachable from Hub
            "nat_pool": "172.16.0.0/26",  // a subnet is required to create and advertise the route to Hub
            "source_nat": {
                "external_ip": "172.16.0.8/30"
            },
            "static_nat": {
                "172.16.0.1": {"internal_ip": 192.168.70.3", "name": "pos-station-1"},
                "172.16.0.2": {"internal_ip": 192.168.70.8", "name": "pos-station-2"}
                "172.16.0.12/30": {"internal_ip": 192.168.70.12/30", "name": "pos-stations"}
            },
            "destination_nat": {
                "172.16.0.5/30": {"internal_ip": "192.168.70.5/30", "name": "web server"}
                "172.16.0.3:8443": {"internal_ip": "192.168.70.5", "name": "web server", "port": 443}
            },

            // if routed=true, whether to advertise an aggregated subnet toward HUB
            // this is useful when there are multiple networks on SPOKE's side
            "advertised_subnet": "172.16.0.0/24",

            // optionally, how HUB should deal with routes it received from Spokes
            // 1. toward overlay            
            "no_readvertise_to_overlay": false,
            "summarized_subnet": "172.16.0.0/16",
            // by default, the routes are only readvertised toward the same vrf on spoke
            // to allow it to be leaked to other vrfs
            "other_vrfs": [ "iot" ],

            // 2. toward LAN-side BGP peers
            "no_readvertise_to_lan_bgp": false, 
            "summarized_subnet_to_lan_bgp": "172.16.0.0/16"

            // 2. toward LAN-side OSPF peers
            "no_readvertise_to_lan_ospf": false,
            "summarized_subnet_to_lan_ospf": "172.16.0.0/16"
        }
    },

    // whether to enable multicast support (only PIM-sparse mode is supported)
    "multicast": {
        "enabled": true,  // default is false

        // group address to RP (rendezvous point) mapping
        "groups": {
            "225.1.0.3/32": {
                "rp_ip": "10.10.0.5"
            }
        }

        // if the network will only be the soruce of the multicast traffic, IGMP can be disabled
        "disable_igmp": false  // default is false
    },

    "tenants": {
        "pos-stations": {
            "addresses": ["192.168.70.16/30"]
        },
        "printer-1": {
            "addresses": ["192.168.70.3"]
        },
    }
}
</code></pre>
<h1 id="services">Services</h1>
<h3 id="base-uri_1">Base URI</h3>
<pre><code>/api/v1/orgs/:org_id/services
</code></pre>
<h3 id="example_6">Example</h3>
<pre><code>{
    "name": "dc_service",
    "description": "optional",

    "type": "custom",  // custom (default) / apps / app_categories

    // when type = custom, ip subnet
    "addresses": ["10.0.0.0/8", "172.21.0.0/16"],  // the subnets where the service resides (if more specific is required)
    "specs": [
        {
            "protocol": "tcp",  // tcp / udp / icmp / gre / any / ":protocol_number", `protocol_number` is between 1-254, default is `any`
            "port_range": "80"  // or
        }
    ],

    // when type = custom, web filtering
    "hostnames": ["example.com", "*.google.com"],  // the hostnames
    // specs is optional, if it doesn't exist, http and https is assumed. If non-standard http/https ports are used
    "specs": [
        {
            "protocol": "tcp",
            "port_range": "8080,8443"
        }
    ],

    // when type = apps
    "name": "allowed_apps",
    "apps": [ "office365", "okta"],  // list of applications are available through
                                            /const/applications,
                                            /insight/top-app-by-bytes?wired=true or
                                            /const/gateway_applications

    // when type = app_categories
    "name": "allowed_app_categories",
    "app_categories": [ "Sports"],  // list of application categories are available through /const/app_categories
    "app_subcategories": [ "Shopping" ], // list of application sub-categories are available through /const/app_subcategories

    // when type = urls
    "type": "urls",
    "urls": ["http://example.com", "*.google.com"], // no need for spec as URL can encode the ports being used.

    // when type=apps, we'll choose traffic_type automatically
    // when type=addresses/hostnames, you can provide your own settings, also optionally,
    "traffic_type": "data_best_effort",  // data_best_effort (default) / ... (from /const/traffic_types) / custom

    // when traffic_type is `custom`
    "failover_policy": "revertable",  // revertable (default) / non_revertable / none
    "traffic_class": "best_effort",  // best_effort (default) / high  / medium / low
    "dscp": 46,
    "max_latency": 100,
    "max_jitter": 30,
    "max_loss": 1,
    "ssr_relaxed_tcp_state_enforcement": true,  // default is false

    // bandwidth limiting - SSR only
    "service_limit_up": 300000,  // 0-107374182, optional, default is unlimited, in kbps
    "service_limit_down": null,  // 0-107374182, optional, default is unlimited, in kbps
    "client_limit_up": 300000,  // 0-107374182, optional, default is unlimited, in kbps
    "client_limit_down": 100000,  // 0-107374182, optional, default is unlimited, in kbps
}
</code></pre>
<h1 id="vpn">VPN</h1>
<p>VPN object represents an overlay network where gateways can participate in and optionally expose routes to.</p>
<h3 id="base-uri_2">Base URI</h3>
<pre><code>/api/v1/orgs/:org_id/vpns
</code></pre>
<h3 id="payload_4">Payload</h3>
<pre><code>{
    // type = hub_spoke (default)
    "name": "data-center",
    "type": "hub_spoke",

    "paths": {
        "dc1-broadband": {
        },
        "dc1-mpls": {
        },
        "dc2-broadband": {
        },

        "dc2-pod2-broadband": {
            "pod": 2   // default is 1, 1-128
        }
    },    
    "path_selection": {
        "strategy": "disabled",  // disabled (default) / simple / manual
    },

    // type = mesh
    "name": "mesh-useast",
    "type": "mesh",
    "paths": {
        // the path offered
        “wan0": {
            “peer_paths”: {
                // preference indicates which outgoing wan should be preferred
                “wan0”: { “preference”: 2 }
                “wan1”: { “preference”: 1 }
            },

            // behavior of this mesh path
            "bfd_profile": "lte",  // broadband (default) / lte
            "bfd_use_tunnel_mode": true,  // false (default), whether to use tunnel mode. SSR only
            "traffic_shaping": {
                 "enabled": true,
                 "max_tx_kbps": 3000,  // 3Mbps
                 // percentages for differet class of traffic: high / medium / low / best-effort
                 // adding up to 100 
                 "class_percentages": [ 80, 10, 9, 1 ]  // default is [80, 10, 9, 1 ]
            }
        },
        “wan1”: {
            “peer_paths”: {
                 “wan1”: { “preference”: 2 }
            }
        },
        “mpls”: {
            “peer_paths”: {
                 “mpls”: { “preference”: 1 }
            }
        }
    }
    /*
        gateways participating will

        // 1. defines which WAN port will join a mesh and how (meshlink_name)
        "port_config": {
            "ge-0/0/0": {
                "usage": "wan",
                "name": "wan0",
                ...
                "vpn_paths": {
                    "wan0.mesh-useast": {
                        "role": "mesh"  // assumed
                    },
                    ...
                },
            }
        }

        // 2. path preference
        “path_preference”: {
            “to_mesh”: {
                “strategy”: “ordered”,  // ordered (default) / weighted / ecmp
                “paths”: [
                    {
                        “type”: “vpn”,
                        “name”: “wan0.mesh1”
                    },
                    // ... path by hub-spoke-vpn or wan ...
                ]
             }
        }            
    */
}
</code></pre>
<h1 id="service-policies">Service Policies</h1>
<h3 id="base-uri_3">Base URI</h3>
<pre><code>/api/v1/orgs/:org_id/servicepolicies
</code></pre>
<h3 id="payload_5">Payload</h3>
<pre><code>{
    "name": "DC-APPs",
    "tenants": ["pos.store", "camera.store"],
    "services": ["dc-apps"],
    "action": "allow", // allow (default) / deny
}
</code></pre>
<h1 id="idp-profiles">IDP Profiles</h1>
<h3 id="base-uri_4">Base URI</h3>
<pre><code>/api/v1/orgs/:org_id/idpprofiles
</code></pre>
<h3 id="payload_6">Payload</h3>
<pre><code>{
    "name": "relaxed",

    "base_profile": "strict",  // strict (default) / standard
    // overwrites takes precedence over the base_profile
    "overwrites": [
        {
            "matching": {
                "severity": [ "major" ],  // critical / major / minor / info
                "attack_name": [ "HTTP:INVALID:HDR-FIELD" ]
                "dst_subnet": [ "63.1.2.0/24" ],
            },
            "action": "alert",  // alert (default) / drop (siliently dropping packets) / close (notify client/server to close connection)
        }
    ]            
}
</code></pre>
<h1 id="antivirus-profile">Antivirus Profile</h1>
<h3 id="base-uri_5">Base URI</h3>
<pre><code>/api/v1/orgs/:org_id/avprofiles
</code></pre>
<h3 id="payload_7">Payload</h3>
<pre><code>{
    "name": "av-custom",
    "url_whitelist": [],
    "mime_whitelist": [],
    "fallback_action": "permit", // permit / block
    "max_filesize": 10000 // 20-40000 (KB)
    "protocols": [] // ftp / http / imap / pop3 / smtp
}
</code></pre>
<h1 id="advance-anti-malware-profile-skyatp">Advance Anti Malware Profile (SkyAtp)</h1>
<h3 id="base-uri_6">Base URI</h3>
<pre><code>/api/v1/orgs/:org_id/aamwprofiles
</code></pre>
<h3 id="payload_8">Payload</h3>
<pre><code>{
    "name": "aamw-custom",
    // sky atp file scanning parameters
    "categories": [{
        "category": "executable" // archive / document / pdf / executable / rich_application / library / os_package / mobile / java / configuration / script
        "hash_lookup_only": false, // default false, false / true
    }]
    "verdict_threshold": 8,  // default 8, minimum: 1, maximum: 10
    "file_action": "block", // default block, block / permit
    "fallback_action": "block", // default block/ permit / block 
}
</code></pre>
<h1 id="sky-atp-secintel-profile">Sky ATP Secintel Profile</h1>
<h3 id="base-uri_7">Base URI</h3>
<pre><code>/api/v1/orgs/:org_id/secintelprofiles
</code></pre>
<h3 id="payload_9">Payload</h3>
<pre><code>{
    "name": "secintel-custom",
    "profiles": [{"category": "CC", // CC / IH (Infected host) / DNS
                  "action": "default" // default / standard / strict
                }]
}
</code></pre>
<h1 id="gateway-template">Gateway Template</h1>
<p>Gateway Template is applied to a site for gateway(s) in a site.</p>
<h2 id="create-gateway-template">Create Gateway Template</h2>
<pre><code>POST /api/v1/orgs/:org_id/gatewaytemplates
</code></pre>
<h2 id="get-update-delete-gateway-templates">Get / Update / Delete Gateway Templates</h2>
<pre><code>GET /api/v1/orgs/:org_id/gatewaytemplates/:gatewaytemplate_id
PUT /api/v1/orgs/:org_id/gatewaytemplates/:gatewaytemplate_id
DELETE /api/v1/orgs/:org_id/gatewaytemplates/:gatewaytemplate_id
</code></pre>
<h3 id="payload_10">Payload</h3>
<pre><code>{
    "name": "xxx",

    "type": "standalone",  // standalone (default) / spoke / hub

    "networks": {
        // additional networks that are not already defined from Networks
    },

    "port_config": {
        // WAN
        "ge-0/0/0": {
            "usage": "wan",
            "name": "wan0",
            "critical": false, // default is false, if want to generate port up/down alarm, set it to true
            "wan_disable_speedtest": false, // default is false.  to disallow marvis/ scheduler to run speedtest on this port, set it to true
            "description": "towards ISP”,

            "wan_type": "broadband",  // broadband (default), dsl, lte
            "ip_config": {
                "type": "dhcp",  // dhcp (default) / static / pppoe

                // if type=pppoe
                "pppoe_auth": "none",  // none (default) / chap / pap
                "pppoe_username": "u13534",
                "pppoe_password": "foryoureyesonly"
            },
            // optional, if spoke should reach this port by a different IP
            "wan_ext_ip": "64.2.4.3",
            // optional, by default, source-NAT is performed on all WAN Ports using the interface-ip
            "wan_source_nat": {
                // if alternative nat_pool is desired (
                "nat_pool": "64.2.4.0/30",
                // or to disable the source-nat
                "disabled": false  // default is false
            },

            "vpn_paths": {
                "dc1-broadband.data-center": {
                    "role": "spoke",  // spoke (default) / hub
                    "bfd_profile": "lte",  // broadband (default) / lte
                    "bfd_use_tunnel_mode": true,  // false (default), whether to use tunnel mode. SSR only
                    "traffic_shaping": {
                         "enabled": true,
                         "max_tx_kbps": 3000,  // 3Mbps
                         // percentages for differet class of traffic: high / medium / low / best-effort
                         // adding up to 100 
                         "class_percentages": [ 80, 10, 9, 1 ]  // default is [80, 10, 9, 1 ]
                    },

                    // for a given VPN, when path_selection.strategy=simple, the preference for a path (lower is preferred) 
                    "preference": 1
                },

                "wan0.mesh-useast": {
                    "role": "mesh"  // assumed
                    // all other configs (bfd_profile, bfd_use_tunnel_mode, ...) is defined in the VPN object
                }
            },

            // optionally, for WAN port, traffic_shaping can be performed
            "traffic_shaping": {
                "enabled": true,
                // percentages for differet class of traffic: high / medium / low / best-effort
                // adding up to 100 
                "class_percentages": [ 80, 10, 9, 1 ]  // default is [80, 10, 9, 1 ]
            },

            // for 128T
            "svr_port_range": "60000-60005",  // none (default), 1025 - 65535
            "ssr_no_virtual_mac": false,  // default is false, when SSR is running as VM, this is required on certain hosting platforms


            // other port settings
            "speed": "1g",  // auto (default)
            "duplex": "full",  // auto (default), full, and half
            "disable_autoneg": false,  // default is false
            "poe_disabled": true,  // default is false
            "mtu": null,  // default is null, between 552-1500 if specified
            "disabled": false, // default is false, port admin up (false) / down (false)
            // when wan_type = broadband
            "wan_arp_policer": "recommended" // default (system default) / recommended / max
            "wan_extra_routes": {
                "100.100.100.0/24": {
                    "via": "64.2.4.1"
                }
            },
            "wan_probe_override": {
                // when usage = wan
                "ips": [ "10.173.5.3" ],
                "probe_profile": "broadband",  // broadband (default)/ lte
            },

            // if some networks are connected to this WAN port, it can be added here so policies can be defined
            "wan_networks": [ "ip-pool", "mpls-datacenter" ],
        },
        "cl-1/0/0": {
            "usage": "wan",
            "name": "lte",

            "wan_type": "lte",
            "lte_apn": "5ginternet",
            "lte_auth": "none",  // none (default) / chap / pap
            "lte_username": "user1",
            "lte_password": "pass",

            "ip_config": {
                "type": "dhcp"  // dhcp (default), static
            }
        },

        // DSL PPPoE (experimental)
        "at-1/0/0": {
            "usage": "wan",
            "name": "dsl",
            "wan_type": "dsl",
            "dsl_type": "adsl" // vdsl (default), adsl
            "dsl_vpi":  0 // 0 (default) 8 bit int
            "dsl_vci": 35 // 35 (default) 16 bit int
            "ip_config": {
                "type": "dhcp"  // dhcp (default), static
            }
        },

        // LAN
        "ge-0/0/1-5": {
            "usage": "lan",
            "networks": ["default", "guest", "pos"],

            // whether to preserve dscp when sending traffic over VPN (SSR-only)
            "preserve_dscp": true,

            "port_network": "default"
        },

        // if WAN interface is on a VLAN (e.g. an MPLS link through uplink switch/router)
        "ge-0/0/0.5": {  // name suffixed with ".&lt;vlan_id&gt;"
            "usage": "wan"
            "name": "mpls",
            "vlan_id": 5,
            "outer_vlan_id": null  // optional, for Q-in-Q

            "ip_config": {
                "type": "dhcp",  // dhcp (default), static
            }

            "vpn_paths": {
                "dc1-mpls.data-center": {
                    "role": "spoke"
                }
            },

            // "wan_type" will be ignored
            // "pci_address" will be ignored
        },
    },

    "oob_ip_config": {
        // out-of-band (vme/em0/fxp0) IP config
        // same payload as `ip_config` except dns / dns_suffix

        "vlan_id": xxx, // optional
        "use_mgmt_vrf": true, // true (default) / false

        // for host-out traffic (NTP/TACPLUS/RADIUS/SYSLOG/SNMP), if alternative source network/ip is desired, 
        "use_mgmt_vrf_for_host_out": false, // false (default), whether to use `mgmt_junos`

        // for HA Cluster, node1 can have different IP Config
        "node1": {
            // same payload as `ip_config` except dns / dns_suffix
            "vlan_id": xxx // optional, if different from parent
        }
    },

    // all the IP configs on the LAN side
    "ip_configs": {
        "guest": {
            "ip": "192.168.70.1",
            "netmask": "/24",
            // optional list of secondary IPs in CIDR format
            "secondary_ips": [ "192.168.50.1/24", "192.168.60.1/26"]
        },
    },

    "dhcpd_config": {
        "guest": {
            "type": "local",  // local (default) / relay / none
            "ip_start": "192.168.70.100",
            "ip_end": "192.168.70.200",
            "gateway": "192.168.70.1",

            // optional, system one will be used
            "dns_servers": [ "8.8.8.8", "4.4.4.4" ],
            "dns_suffix": [ ".mist.local", ".mist.com" ],

            // if using DHCP relay
            "type": "relay",
            "servers": ["11.2.3.4"]
        }
    },

    "router_id": "10.2.1.10",  // auto-assigned if unset

    "path_preferences": {
        "dc_path": {
            "strategy": "ordered",  // ordered (default) / weighted / ecmp
            "paths": [
                {
                    "type": "vpn",
                    "name": "dc1-broadband.data-center",

                    // optional, spoke's outgoing wan is desired
                    "wan_name": "wan0",
                    // optional params depending on strategy
                    "cost": 10,

                    // SSR only
                    "disabled": false  // true if this specific path is undesired 
                },
                {
                    "type": "vpn",
                    "name": "dc1-mpls.data-center",
                },
                {
                    "type": "vpn",
                    "name": "dc2-broadband.data-center",
                }
            }
        },

        "to_spoke": {
            "strategy": "ordered",  // ordered (default) / weighted / ecmp
            "paths": [
                {
                    "type": "vpn",
                    "name": "dc1-broadband.data-center",

                    // optional, spoke's outgoing wan is desired
                    "wan_name": "wan0",                    
                    // SSR only
                    "disabled": true  // true if this specific path is undesired 
                }
            }
        },

        "local_path": {
            "strategy": "ecmp",  // ordered (default) / weighted / ecmp
            "paths": [
                {
                    "type": "wan",
                    "name": "wan0"
                },
                {
                    "type": "wan"
                    "name": "lte"
                },
                {
                    // use mpls path to dc1 as backup
                    "type": "vpn"
                    "name": "dc1-mpls.data-center",
                    // additionally, if this vpn path can be used for internet
                    "internet_access": true  // default is false
                }
            }
        },
        "local_breakout": {
            "paths": [
                {
                    "type": "tunnel",
                    "name": "zscalar"
                },
                {
                    "type": "wan",
                    "name": "wan0"
                },
            ]
        },

        "customized": {
            "paths": [
                {
                    // it can also be local
                    "type": "local",
                    "networks": ["guest"],

                    // optional, if a different gateway is desired
                    "gateway_ip": "192.168.30.5",
                    // optional, if destination IP is to be replaced
                    "target_ips": ["30.1.2.5"]
                }
            ]
        }
    },

    "tunnel_provider_options": {
        "jse": {
            // for jse-ipsec
            // this allow provisioning of adequate resource on JSE. Make sure adequate licenses are added
            "num_users": 5
            "org_name": "JSE_ORG1",  // optional
            "region": "auto",  // auto (default) / africa / asia / europe / north_america / south_america / oceania
        },

        "prisma": {
            // for prisma-ipsec
            "service_account_name": "sa1@1823425211",  // service account name to used for tunnel auto provisioning
        },

        "zscalar": {
            // for zscaler-ipsec and zscaler-gre        
            // see https://help.zscaler.com/zia/configuring-locations
            "use_xff": false,  // location uses proxy chaining to forward traffic

            "enforce_authentication": false,  // default is false

            // when enforce_authentication=false
            "enable_caution": false,  // display caution notification for non-authenticated users, default is false

            "enable_aup": false,  // display Acceptable Use Policy (AUP), default is false, use_xff has to be true
            "aup_acceptance_required": true,  // default is true 
            "aup_ssl_proxy": false,  // proxy HTTPs traffic, requiring Zscaler cert to be installed in browser, default is false  
            "aup_expire": 2,  // days before AUP is requested again, default is 1 day

            // optional
            "download_mbps": 200,  // the download bandwidth cap of the link, in Mbps
            "upload_mbps": 200,   // the download bandwidth cap of the link, in Mbps            

            // if use_xff == true 
            "sub_locations": [
                {
                    "name": "guest-wifi",
                    "subnets": ["172.16.8.0/24", "172.16.32.0/23"],
                    "enforce_authentication": false,  // default is false

                    // when enforce_authentication=false
                    "enable_caution": false,  // display caution notification for non-authenticated users, default is false

                    "enable_aup": false,  // display Acceptable Use Policy (AUP), default is false, use_xff has to be true
                    "aup_acceptance_required": true,  // default is true 
                    "aup_ssl_proxy": false,  // proxy HTTPs traffic, requiring Zscaler cert to be installed in browser, default is false  
                    "aup_expire": 2,  // days before AUP is requested again, default is 1 day

                    // optional
                    "download_mbps": 200,  // the download bandwidth cap of the link, in Mbps
                    "upload_mbps": 200,   // the download bandwidth cap of the link, in Mbps
                }                    
            ]
        },
    },


    "tunnel_configs": {
        "zscalar": {
            "provider": "zscaler-ipsec",

            // if provider = zscaler-ipsec
            "local_id": "{{ SITE_LOCAL_ID }}",
            "psk": "{{ SITE_PRESHARED_KEY }}",
            "primary": {
                "hosts": [ "63.1.5.3" ],
                "probe_ips": [ "1.1.1.1" ],
                "wan_names": [ "wan0", "wan1" ]
            },
            "secondary": {
                "hosts": [ "63.1.5.4" ],
                "probe_ips": [ "2.2.2.2" ],
                "wan_names": [ "wan1", "wan0" ]
            },

            // auto-provision (takes precedence)
            "auto_provision": {
                "enabled": true,
                "latlng": { "lat": 37.295833, "lng": -122.032946 },  // overwrite can be given
                "primary": {
                    "num_hosts": 2,

                    // optional, only needed if `vars_only`=false
                    "wan_names": ["wan0", "wan1"],
                },
                "secondary": null
            },

            "mode": "active-standby" // options are active-standby (default), active-active
        },
        "zscalar-gre": {
            "provider": "zscaler-gre",

            // if provider = zscaler-gre
            "primary": {
                "hosts": [ "216.66.5.49" ],
                "internal_ips": [ "172.18.58.121" ],
                "probe_ips": [ "172.18.58.122" ],
                "wan_names": [
                    "wan0",
                    "wan1"
                ]
            },
            "secondary": {
                "hosts": [ "199.168.149.179" ],
                "internal_ips": [ "172.18.58.125" ],
                "probe_ips": [ "172.18.58.126" ],
                "wan_names": [
                    "wan0",
                    "wan1"
                ]
            },
            "mode": "active-standby" // options are active-standby (default), active-active
        },
        "jse-ipsec": {
            "provider": "jse-ipsec",

            // if provider = jse-ipsec
            "local_id": "{{ SITE_LOCAL_ID }}",
            "psk": "{{ SITE_PRESHARED_KEY }}",
            "primary": {
                "hosts": [ "63.1.5.3" ],
                "probe_ips": [ "1.1.1.1" ],
                "remote_ids": ["abcd@juniper.net"],
                "wan_names": [ "wan0", "wan1" ]
            },
            "secondary": {
                "hosts": [ "63.1.5.4" ],
                "probe_ips": [ "2.2.2.2" ],
                "remote_ids": ["edfg@juniper.net"],
                "wan_names": [ "wan1", "wan0" ]
            },
            "mode": "active-standby" // options are active-standby (default), active-active,
        },
        "custom-ipsec": {
            "provider": "custom-ipsec",
            "protocol": "ipsec",

            "local_id": "{{ SITE_LOCAL_ID }}",
            "psk": "{{ SITE_PRESHARED_KEY }}",
            "primary": {
                "hosts": [ "63.1.5.3" ],
                "probe_ips": [ "1.1.1.1" ],
                "wan_names": [ "wan0" ]
            },
            "secondary": {
                "hosts": [ "63.1.5.4" ],
                "probe_ips": [ "2.2.2.2" ],
                "wan_names": [ "wan0" ]
            },
            "mode": "active-standby" // options are active-standby (default), active-active

            // customized ipsec parameters
            "version": "2", // 2 (default) / 1
            "ike_mode": "main", // main (default) / aggressive
            "ike_proposals": [
                {
                    "auth_algo": "sha2", // sha1, sha2, md5,
                    "enc_algo": "aes256", // 3des, aes128, aes256, aes_gcm256, aes_gcm128, null
                    "dh_group": "2" // 14 (default, 2048-bit) / 1 / 2 (1024-bit) / 5 / 15 (3072-bit) / 16 (4096-bit)
                                    // 19 (256-bit ECP) / 20 (384-bit ECP) / 21 (521-bit ECP) / 24 (2048-bit ECP)
                }
            ],
            "ike_lifetime": 3600,
            "ipsec_proposals": [
                {
                    "auth_algo": "sha2", // sha1, sha2, md5,
                    "enc_algo": "aes256", // 3des, aes128, aes256, aes_gcm256, aes_gcm128, null
                    "dh_group": "2"
                }
            ],
            "ipsec_lifetime": 1800,

            // networks reachable via this tunnel
            "networks": [ 
                "ntwk",
                "protected-net"
            ],

            "probe": {
                 "type": "icmp", // icmp (default) / http
                 "interval": 120, // how often to trigger the probe
                 "threshold": 3, // number of consecutive misses before declaring the tunnel down
                 "timeout": 20 // time within which to complete the connectivity check
            }
        },
        "custom-gre": {
            "provider": "custom-gre",
            "protocol": "gre",

            "primary": {
                "hosts": [ "216.66.5.49" ],
                "internal_ips": [ "172.18.58.121" ],
                "probe_ips": [ "172.18.58.122" ],
                "wan_names": [
                    "wan0",
                    "wan1"
                ]
            },
            "secondary": {
                "hosts": [ "199.168.149.179" ],
                "internal_ips": [ "172.18.58.125" ],
                "probe_ips": [ "172.18.58.126" ],
                "wan_names": [
                    "wan0",
                    "wan1"
                ]
            },
            "mode": "active-standby" // options are active-standby (default), active-active
        },
        "prisma-ipsec": {
            "provider": "prisma-ipsec",
            // networks reachable via this tunnel
            "networks": [
                "corp-network",
                "protected-network"
            ],
            "auto_provision": {
                "enabled": true,
                // by default, we'll use the location of the site to determine the optimal Remote Network location.

                // optionally, service_connection can be considered, then we'll also consider this along with the site location
                "service_connection": "Juniper-Lab-SC-1",    // Define service_connection if the traffic is to be routed to a specific service connection.
                                                             // This field takes a service connection name that is configured in the Prisma cloud, Prisma Access Setup -&gt; Service Connections.

                // in the case user wants to override the auto discovery of remote network location and force the tunnel to use the specified peer location.
                "region": "us-west-1",  // auto(default) / us-west-1 / us-east-1 / eu-central-1 / ap-southeast-1 /..
                                        // https://docs.paloaltonetworks.com/prisma/prisma-access/3-0/prisma-access-panorama-admin/prepare-the-prisma-access-infrastructure/list-of-prisma-access-locations/list-of-locations-by-compute-location

                "primary": {
                    "probe_ips": [
                        "8.8.8.8"
                    ],
                    "wan_names": [
                        "wan0"
                     ]
                }
            }
        }
    },

    "idp_profiles": {
        "relaxed": {
            "base_profile": "strict",  // strict (default) / standard
            // overwrites takes precedence
            "overwrites": [
                {
                    "matching": {
                        "severity": [ "major" ],  // critical / major / minor / info
                        "attack_name": [ "HTTP:INVALID:HDR-FIELD" ]
                        "dst_subnet": [ "63.1.2.0/24" ],
                    },
                    "action": "alert",  // alert (default) / drop (siliently dropping packets) / close (notify client/server to close connection)
                }
            ]            
        }
    },

    "service_policies": [
        // policies for store
        {
            "name": "DC-APPs",
            "tenants": ["pos.store", "camera.store"],
            "services": ["dc-apps"],
            "action": "allow",
            "idp": {
                "enabled": true,  // default is false
                "idpprofile_id": "89b9d208-84a4-fa8f-af57-78f92c639cf2",  // org-level IDP Profile can be used, this takes precedence over `profile`
                "profile": "strict", // strict (default) / standard / or keys from from idp_profiles
                "alert_only": false                
            },
            // SRX-only
            "appqoe": {
                "enabled": true,  // default is false
            },
            // SRX-only
            "antivirus": {
                "enabled": true, // default is false
                "avprofile_id": "5cb2e071-cfc5-4231-b5f8-3543e04dfb55" // org-level AV Profile can be used, this takes precendence over 'profile'
                "profile": "default", // default / noftp / httponly / or keys from av_profiles
            },
            // SRX-only
            "secintel": {
                "enabled": True,
                "secintelprofile_id": "5cb2e071-cfc5-4231-b5f8-3543e04dfb55" // org-level secintel Profile can be used, this takes precendence over 'profile'
                "profile": "default", // default / standard / strict
            },
            // SRX-only
            "aamw": {
                "enabled": True,
                "aamwprofile_id": "5cb2e071-cfc5-4231-b5f8-3543e04dfb55" // org-level secintel Profile can be used, this takes precendence over 'profile'
                "profile": "standard", // standard / docsonly / executables
            },
            // by default, we derive all paths available and use them
            // optionally, you can customize by
            "path_preference": "dc_path",
            // SRX-only, optional
            "ssl_proxy": {
                "enabled": true,
                "ciphers_category": "strong" // strong(default), medium, weak
            }
        },
        {
            // we can use a policy defined at org level and overwrite some attributes
            "servicepolicy_id": "dbdf808a-5429-51b7-89ac-1b52d7a4b4b5",

            "name": "Cloud Apps",
            "tenants": ["pos.store", "camera.store"],
            "services": ["cloud-apps"],
            "path_preference": "local_path"
        },
        {
            "name": "Guest",
            "tenants": ["guest"],
            "service": ["internet"],
            "path_preference": "local_breakout"
        },
        {
            "name": "Mgmt from DC",
            "tenants": ["it.datacenter"],
            "services": ["store_servers"],
            "path_preference": "customized"
        },
        {
            "name": "local routing",
            "tenants": ["corp", "vendor"],
            "services": ["ping"],

            // access within the same VRF
            "local_routing": true
            // no path_preference
        }
    ],

    "bgp_config": {
        "local": {
            "type": "internal",
            "networks": [ "corp" ],  // networks where we expect BGP neighbor to connect to/from
            "local_as": 65000,
            "auth_key": "auth-key",
            "export_policy": "export_policy",
            "import_policy": "import_policy",
            "neighbors": {
                "10.1.10.5": {
                    "disabled": false // Default false. If true, the BGP session to this neighbor will be administratively disabled/shutdown
                }
            },
            // by default, either inet/net6 unicast depending on neighbor IP family (v4 or v6)
            // for v6 neighbors, to exchange v4 nexthop, which allows dual-stack support, enable this
            "extended_v4_nexthop": true,            
        },
        "attlink": {
            "type": "external",
            "via": "wan",  // lan (default) / wan / tunnel
            // if via = wan
            "wan_name": "wan0",
            // if via = lan
            "networks": [ "corp" ],  // networks where we expect BGP neighbor to connect to/from
            // if via = tunnel
            "tunnel_name": "custom-ipsec",

            "local_as": 3000,
            "neighbor_as": 3105,
            "no_private_as": false // false(default) / true
            "auth_key": "auth-key",
            "disable_bfd": false,  // BFD provides faster path failure detection and is enabled by default
            "bfd_minimum_interval": 1-255000, by default, 1000 is used when type=external, 350 when type=internal
            "bfd_multiplier": 1-255, default is 3
            "hold_time":120, // 0-65535, default is 90s
            "graceful_restart_time":240 // 1-4095, default is 0 (disabled)
            "neighbors": {
                "63.1.56.3": {
                    // if per-neighbor as is desired
                    "neighbor_as": 500
                    "multihop_ttl": 64,  // 0-255, default is 0, assuming BGP neighbor is directly connected
                    "export_policy": "neighbor_specific_export_policy",
                    "import_policy": "neighbor_specific_import_policy",
                    "hold_time":120, // 0-65535, default is 90s
                    "disabled": false // Default false. If true, the BGP session to this neighbor will be administratively disabled/shutdown
                }
            },

            // by default, we'll re-advertise all learned BGP routers toward overlay
            "no_readvertise_to_overlay": false,

            // default export/import policies if no per-neighbor policies defined
            "export_policy": "export_policy",
            "import_policy": "import_policy"
        },
        "vpn1": {
            "via": "vpn",  //
            "vpn_name": "data-center",

            "import_policy": "import_policy",            
            "export_policy": "export_policy"            
        }
    }

    // routing-policies
    "routing_policies": {
        "sample_import_policy": {
            "terms": [
                {
                    // zero or more criteria/filter can be specified
                    // to match the term, all criteria have to be met
                    "matching": {
                        "prefix": ["192.168.0.0/16-30"],

                        "as_path": ["65001,65353"],
                        "protocol": ["direct"],  // direct / bgp / ospf / ...
                        "community": ["65001:2"],

                        // overlay-facing criteria (used for bgp_config where via=vpn)
                        "vpn_path": ["dc1-broadband"], // ordered list
                        "vpn_path_sla": {
                            "max_latency": 1500,
                            "max_loss": 30,
                            "max_jitter": null,
                        },
                        "vpn_neighbor_mac": ["7d027e0ffcb9"]
                    },

                    "actions": {
                        "accept": true,
                        "local_preference": "50", // optional, for an import policy, local_preference can be changed

                        // for SSR, hub decides how VRF routes are leaked on spole   
                        "add_target_vrfs": ["guest"]
                    }
                }
            ],
        },
        "sample_export_policy": {
            "terms": [
                {
                    "name": "export",
                    "matching": {
                        // zero or more criteria/filter can be specified
                        // to match the term, all criteria have to be met
                        "prefix": ["192.168.0.0/16-30"],

                        "as_path": ["65001", "65353"],  // takes regular expression
                        "protocol": ["direct"],  // direct / bgp / ospf / static / aggregate ...
                        "community": ["65001:2"],  // community
                        "route_exists": [{
                            "route": "192.168.0.0/24",
                            "vrf_name": "guest"  // name of the vrf instance, default is `default`
                                                 // it can also be the name of the VPN or wan if they
                        }]
                    },
                    "actions": {
                        "accept": true,
                        // when used as export policy, all optional
                        "community": [ "65003:10" ], // takes precedence
                        "add_community": [ "65003:10" ],
                        "exclude_community": [ "65003:10" ],
                        // by default, the local AS will be prepended, to change it
                        "prepend_as_path": ["65003"],
                        // exclude some as_path
                        "exclude_as_path": ["65002"],
                        // local preference
                        "local_preference": "30"
                    }
                }
            ],
        }
    },

    // static routes
    "extra_routes": {
        "it_mgmt": {   // use names from `networks`
            "via": "10.2.1.1"
        },
        "172.16.3.0/24": {
            "via": "10.2.1.1"
        }
    },

    // experimental
    "gateway_matching": {
        "enable": true,
        // see network template
    },

    // additional CLI commands to append
    // NOTE: no check is done
    "additional_config_cmds": [
        "set snmp community public2"
    ]
}
</code></pre>
<h5 id="port-usage">Port Usage</h5>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>speed</code></td>
<td><code>string</code></td>
<td>speed, default is auto to automatically negotiate speed</td>
</tr>
<tr>
<td><code>duplex</code></td>
<td><code>string</code></td>
<td>link connection mode, choices are auto (default), full, and half</td>
</tr>
<tr>
<td><code>disable_autoneg</code></td>
<td><code>bool</code></td>
<td>if <code>speed</code> and <code>duplex</code> are specified, whether to disable autonegotiation, default is false</td>
</tr>
<tr>
<td><code>poe_disabled</code></td>
<td><code>bool</code></td>
<td>whether poe is disabled, default is false</td>
</tr>
<tr>
<td><code>mtu</code></td>
<td><code>int</code></td>
<td>media maximum transmission unit (MTU) is the largest data unit that can be forwarded without fragmentation. The default value is 1514.</td>
</tr>
</tbody>
</table>
<h3 id="configure-ha">Configure HA</h3>
<pre><code>{
    "port_config": {
        "ge-0/0/5,ge-1/0/5": {
            "usage": "ha_control"
        },
        "ge-0/0/6,ge-1/0/6": {
            // for HA Data
            "usage": "ha_data"
        },
        "ge-0/0/0,ge-1/0/0": {
            "usage": "wan",
            "redundant": true,
            "reth_idx": 0,
            "reth_node": "node0"
        },
        "ge-0/0/2,ge-1/0/2": {
            "usage": "lan",
            "redundant": true,
            "reth_idx": 1,
            "reth_node": "node1",

            "networks": ["corp", "guest"],

            // SRX Only - support redundancy-group
            "redundant_group": 3, // 1-128 for physical SRX, 1-64 for virtual SRX (optional)
            // SSR only - supporting vlan-based redundancy (matching the size of `networks`)
            "reth_nodes": ["node1", "node0"]
        },
    }
}
</code></pre>
<h2 id="generate-default-gateway-config">Generate Default Gateway Config</h2>
<p>GET /api/v1/const/default_gateway_config?model=SRX320&amp;ha=false</p>
<h3 id="parameters_47">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>model the default gateway config is intended (as the default LAN/WAN port can differ)</td>
</tr>
<tr>
<td><code>ha</code></td>
<td><code>boolean</code></td>
<td>whether the config is intended for HA</td>
</tr>
</tbody>
</table>
<h3 id="response_77">Response</h3>
<pre><code>{
    "port_config": {
        "ge-0/0/0,ge-0/0/7": {
            "usage": "wan",
            "name": "wan",
            "ip_config": {
                "type": "dhcp"
            }
        },
        "ge-0/0/1-6": {
            "usage": "lan",
            "port_network": "lan"
        },
        "cl-1/0/0": {
            "usage": "wan",
            "name": "lte",
            "wan_type": "lte",
            "ip_config": {
                "type": "dhcp"
            }
        }
    },
    "networks": {
        "lan": {
            "name": "lan",
            "vlan_id": 1,
            "subnet": "192.168.1.0/24"
        }
    },
    "ip_configs": {
        "lan": {
            "type": "static",
            "ip": "192.168.1.1"
        }
    },
    "dhcpd_config": {
        "lan": {
            "ip_start": "192.168.1.2",
            "ip_end": "192.168.1.254"
        }
    },
    "path_preferences": {
        "wan": {
            "paths": [
                {
                    "type": "wan",
                    "name": "wan"
                }
            ]
        }
    },
    "service_policies": [
        {
            "name": "Internet",
            "tenants": [
                "lan"
            ],
            "services": [
                "any"
            ],
            "action": "allow",
            "path_preference": "wan"
        }
    ]
}
</code></pre>
<h2 id="device-replacement">Device Replacement</h2>
<p>It’s a common request we get from the customers. When a AP HW has problem and need a replacement, they would want to
copy the existing attributes (<a href="https://api.mist.com/api/v1/docs/Site#device-config">Device Config</a>) of this old AP to the new one. It can be done by
providing the MAC of a device that’s currently in the inventory but not assigned. The Device replaced will become
unassigned.
This API also supports replacement of Mist Edges. This API copies device agnostic attributes from old Mist edge to new one.
Mist manufactured Mist Edges will be reset to factory settings but will still be in Inventory.Brownfield or VM’s will be 
deleted from Inventory.</p>
<pre><code>POST /api/v1/orgs/:org_id/inventory/replace
</code></pre>
<h3 id="request_38">Request</h3>
<pre><code>{
    "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
    "mac": "5c5b35000101",
    "inventory_mac": "5c5b35000301",
    "discard": []
    // tunterm_port_config is optional and applicable for mist-edge replacement only
    "tunterm_port_config": {"separate_upstream_downstream": true/false,
                            "upstream_ports": ["0", "1"],
                            "downstream_ports": ["2", "3"]
                            }
}
</code></pre>
<h3 id="parameters_48">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>the site_id of the device to be replaced</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>device mac</td>
</tr>
<tr>
<td><code>inventory_mac</code></td>
<td><code>string</code></td>
<td>mac of the inventory that will be replacing the old one. It has to be claimed and unassigned.</td>
</tr>
<tr>
<td><code>discard</code></td>
<td><code>list</code></td>
<td>attributes that you don’t want to copy</td>
</tr>
</tbody>
</table>
<p><strong>NOTE</strong></p>
<p>For Gateway devices only like-for-like replacements (can only replace a SRX320 with a SRX320 and not some otehr model)
are allowed.</p>
<h2 id="get-org-devices">Get Org Devices</h2>
<pre><code>GET /api/v1/orgs/:org_id/devices
</code></pre>
<h3 id="_1"></h3>
<pre><code>{
    "results": [
        {
            "mac": "5c5b350eb31b",
            "name": "Conference Room"
        }
    ]
}
</code></pre>
<h1 id="template">Template</h1>
<p>Templates are collection of configs that can be applied to orgs / sitegroups / sites</p>
<h3 id="why-templates">Why Templates?</h3>
<p>Conceptually, site is where configurations will be created (and eventually be derived). People with only a few
deployments (or when each deployment is different) will mostly define their WLAN/Tunnels/Policies under a site.</p>
<p>For big deployments (hundreds / thousands of sites), it’s unpractical to do so. Instead, they can define templates
(holding same set of stuff WLAN/Tunnels/Policies) and apply them to sites. Therefore,</p>
<ol>
<li>these WLANs/Tunnels/Policies are <em>contained</em> in the template. I.e. Objects like WLAN / WxlanTunnel / WxlanRule can
   only reference each other in the same template</li>
<li>At the site level, one site may be applied with multiple templates as well as holding its own.</li>
</ol>
<p>So how does derivation work?</p>
<p>For WLANs, it’s straightforward, a site will simply have multiple WLANs from multiple templates plus those defined in a
site itself For Wxlan, all template Wxlan Rules will be checked first. If there’s no match, it will continue checking
the Site Wxlan Rules. If there’s no match, the default action defined in the Site Wxlan Rule will be used.</p>
<p>However, a template Wxlan Rule differs from a Site Wxlan Rule in two ways.</p>
<ol>
<li>It has to come with a WLAN Label on the left. If not, it’s implicit that it matches with ANY of the WLANs defined in
   the template</li>
<li>AP Wxlan Tag (match=ap_id) cannot be created / used as there’s no AP concept at org level</li>
</ol>
<h2 id="get-all-create-templates">Get All Create Templates</h2>
<pre><code>GET /api/v1/orgs/:org_id/templates
POST /api/v1/orgs/:org_id/templates
</code></pre>
<h2 id="get-update-delete-templates">Get Update Delete Templates</h2>
<pre><code>GET /api/v1/orgs/:org_id/templates/:template_id
PUT /api/v1/orgs/:org_id/templates/:template_id
DELETE /api/v1/orgs/:org_id/templates/:template_id
</code></pre>
<h2 id="example_7">Example</h2>
<pre><code>{
    "name": "west",
    "applies": {
        "org_id": "2818e386-8dec-2562-9ede-5b8a0fbbdc71",
        "sitegroup_ids": [ "581328b6-e382-f54e-c9dc-999983183a34", "f57096b9-0c2f-4df6-c77b-ae6ae87a3d43" ],
        "site_ids": [ "4ac1dcf4-9d8b-7211-65c4-057819f0862b" ]
    },
    "exceptions": {
        "sitegroup_ids": [ "90badd2e-c028-5e8e-dd8f-b3c718882b9d" ],
        "site_ids": [ "52f4347e-3e4b-186c-21ca-ad5b70eb23d6" ]
    },
    "filter_by_deviceprofile": true,
    "deviceprofile_ids": [
        "6f4bf402-45f9-2a56-6c8b-7f83d3bc98e9",
    ]
}
</code></pre>
<h3 id="definition_1">Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name of the template</td>
</tr>
<tr>
<td><code>applies</code></td>
<td><code>object</code></td>
<td>where this template should be applied to, can be org_id, site_ids, sitegroup_ids</td>
</tr>
<tr>
<td><code>exceptions</code></td>
<td><code>object</code></td>
<td>where this template should <em>not</em> be applied to (takes precedence)</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id, should be the same as the org, this shadows sitegroup_ids and site_ids</td>
</tr>
<tr>
<td><code>sitegroup_ids</code></td>
<td><code>list</code></td>
<td>list of sitegroup ids</td>
</tr>
<tr>
<td><code>site_ids</code></td>
<td><code>list</code></td>
<td>list of site ids</td>
</tr>
<tr>
<td><code>filter_by_deviceprofile</code></td>
<td><code>boolean</code></td>
<td>whether to further filter by Device Profile</td>
</tr>
<tr>
<td><code>deviceprofile_ids</code></td>
<td><code>list</code></td>
<td>list of Device Profile ids</td>
</tr>
</tbody>
</table>
<h2 id="clone-template">Clone Template</h2>
<pre><code>POST /api/v1/orgs/:org_id/templates/:template_id/clone
</code></pre>
<h3 id="request_39">Request</h3>
<pre><code>{
    "name": "Cloned"
}
</code></pre>
<h1 id="org-wlan">Org Wlan</h1>
<h3 id="base-uri_8">Base URI</h3>
<pre><code>/api/v1/orgs/:org_id/wlans
</code></pre>
<h3 id="example_8">Example</h3>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#wlan">Site:Wlan</a> for schema</p>
<pre><code>{
    "name": "whatever",
    "template_id": "867860f2-dd82-3677-54a5-4d6b139c96ca"
    ...
}
</code></pre>
<h2 id="wlan-portal-image-upload">Wlan Portal Image Upload</h2>
<p>Upload background image for Portal</p>
<pre><code>POST /api/v1/orgs/:org_id/wlans/:wlan_id/portal_image
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#wlan-portal-image-upload">Site:Wlan Portal Image Upload</a> for schema</p>
<h2 id="wlan-portal-image-delete">Wlan Portal Image Delete</h2>
<p>Delete background image for Portal</p>
<pre><code>DELETE /api/v1/orgs/:org_id/wlans/:wlan_id/portal_image
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#wlan-portal-image-delete">Site:Wlan Portal Image Delete</a></p>
<h1 id="org-wxlan-tunnel">Org Wxlan Tunnel</h1>
<pre><code>/api/v1/orgs/:org_id/wxtunnels
</code></pre>
<p>There can be Management Tunnels (which can be applied to a sitegroup, see <a href="https://api.mist.com/api/v1/docs/Org#org-setting">Org:Setting</a>) as well as
Data Tunnels, which can only be applied to Org Wlans in a Template. Moreover, the WxlanTunnel inside a template can only
be used by Org Wlans in the same template</p>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#wxlan-tunnels">Site:Wlan Tunnels</a> for schema</p>
<h1 id="org-wxlan-tags">Org Wxlan Tags</h1>
<p>Wxlan Tags can be defined inside a template. When used, it can be deployed to</p>
<pre><code>/api/v1/orgs/:org_id/wxtags
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#wxlan-tags">Site:Wlan Tags</a> for schema</p>
<h1 id="org-wxlan-rules">Org Wxlan Rules</h1>
<p>Wxlan Rules can be applied to template. WxlanRule defined inside a template will operate with the scope of specified
template.</p>
<pre><code>/api/v1/orgs/:org_id/wxrules
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#wxlan-rules">Site:Wlan Rules</a> for schema</p>
<h1 id="org-asset-filters">Org Asset Filters</h1>
<pre><code>/api/v1/orgs/:org_id/assetfilters
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#asset-filters">Site:Asset Filters</a> for schema</p>
<h1 id="org-asset">Org Asset</h1>
<pre><code>/api/v1/orgs/:org_id/asset
/api/v1/orgs/:org_id/asset/:asset_id
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#assets">Site:Asset</a> for schema</p>
<h2 id="org-import-assets">Org Import Assets</h2>
<pre><code>POST /api/v1/orgs/:org_id/assets/import
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#assets">Site:Asset</a> for schema</p>
<h2 id="org-assets-status">Org Assets Status</h2>
<pre><code>GET /api/v1/orgs/:org_id/stats/assets
GET /api/vi/orgs/:org_id/stats/assets/:asset_id
</code></pre>
<h3 id="response_78">Response</h3>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#get-asset-stats">Site:Asset:Stats</a> for schema</p>
<h2 id="org-assets-search">Org Assets Search</h2>
<pre><code>GET /api/v1/orgs/:org_id/stats/assets/search
GET /api/v1/orgs/:org_id/stats/assets/search?mac='fbc721cc3022'
</code></pre>
<h3 id="parameters_49">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td>string</td>
<td>path</td>
</tr>
<tr>
<td><code>query</code></td>
<td><code>string</code></td>
<td><code>site_id</code>,<code>mac</code>,<code>map_id</code>,<code>ibeacon_uuid</code>,<code>ibeacon_major</code>,<code>ibeacon_minor</code></td>
</tr>
<tr>
<td><code>eddystone_uid_namespace</code>, <code>eddystone_uid_instance</code>, <code>eddystone_url</code>, <code>by</code>, <code>name</code>, <code>device_name</code></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="response_79">Response</h3>
<pre><code>{
    "results": [
        {
            "battery_voltage": "283",
            "eddystone_uid_namespace": "f7826da6bc5b71e0893e",
            "last_seen": 1633971808,
            "eddystone_uid_instance": "424c43527039",
            "eddystone_url": "eddystone_url",
            "mac": "fbc721cc3022",
            "manufacture": "Unknown",
            "timestamp": 1633971808667,
            "map_id": "map_id",
            "org_id": "org_id",
            "by": "assetfilter",
            "site_id": "site_id",
            "name": "name",
            "temperature": "0.0"
        },
    ],
    "start": 1633367108.3799882,
    "end": 1633971908.3799632,
    "limit": 100,
    "total": 1
}
</code></pre>
<h2 id="count-org-asset-by-distinct-field">Count Org Asset by distinct field</h2>
<pre><code>GET /api/v1/orgs/:org_id/stats/assets/count
GET /api/v1/orgs/:org_id/stats/assets/count?distinct=ibeacon_uuid
</code></pre>
<h3 id="parameters_50">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td>string</td>
<td>path</td>
</tr>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td><code>site_id</code>,<code>mac</code>,<code>map_id</code>,<code>ibeacon_uuid</code>,<code>ibeacon_major</code>,<code>ibeacon_minor</code></td>
</tr>
<tr>
<td><code>eddystone_uid_namespace</code>, <code>eddystone_uid_instance</code>, <code>eddystone_url</code>, <code>by</code>, <code>name</code>, <code>device_name</code>, default is <code>site_id</code></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="response_80">Response</h3>
<pre><code>{
    "results": [
        {
            "site_id": "site_id",
            "count": 19
        }
    ],
    "start": 1633368208.7445683,
    "end": 1633973008.7445416,
    "limit": 100,
    "distinct": "site_id",
    "total": 1,
}

</code></pre>
<h1 id="org-coa-change-of-authorization">Org CoA (Change of Authorization)</h1>
<h2 id="reauth-a-8021x-client">Reauth a 802.1x Client</h2>
<p>Trigger a CoA against a client</p>
<pre><code>POST /api/v1/orgs/:org_id/clients/:client_mac/coa
</code></pre>
<h1 id="device-profile">Device Profile</h1>
<p>While Templates / RF Templates / Network Templates / Gateway Templates provides powerful ways to control
how a Device’s configuration is derived for a Site.
There are cases where you’d like another level of control at the Org Level.</p>
<p>A Device Profile contains a subset of Device’s configurations you’d like a device to have. It will be <em>merged</em> at
runtime when we’re provisioning an AP.</p>
<h2 id="get-all-create-device-profiles">Get All Create Device Profiles</h2>
<pre><code>GET /api/v1/orgs/:org_id/deviceprofiles?type=ap
POST /api/v1/orgs/:org_id/deviceprofiles
</code></pre>
<h2 id="get-update-delete-device-profile">Get Update Delete Device Profile</h2>
<pre><code>GET /api/v1/orgs/:org_id/deviceprofiles/:deviceprofile_id
PUT /api/v1/orgs/:org_id/deviceprofiles/:deviceprofile_id
DELETE /api/v1/orgs/:org_id/deviceprofiles/:deviceprofile_id
</code></pre>
<h3 id="schema">Schema</h3>
<pre><code>{
    "id": "6f4bf402-45f9-2a56-6c8b-7f83d3bc98e9",
    "type": "ap",  // intended device type, default is AP
    "name": "LowPower",

    // anything provided here will be merged against the devices this profile applies to
    "radio_config": {
        "band_5": {
            "power": 8
        }
    }
}
</code></pre>
<p>NOTE: see <a href="https://api.mist.com/api/v1/docs/Site#device-config">Device Config</a></p>
<h2 id="assignunassign-device-profile-tofrom-devices">Assign/Unassign Device Profile to/from Devices</h2>
<pre><code>POST /api/v1/orgs/:org_id/deviceprofiles/:deviceprofile_id/assign
POST /api/v1/orgs/:org_id/deviceprofiles/:deviceprofile_id/unassign
</code></pre>
<h3 id="request_40">Request</h3>
<pre><code>{
    "macs": [
        "5c5b350e0001",
        "5c5b350e0003"
    ]
}
</code></pre>
<h3 id="response_81">Response</h3>
<pre><code>{
    // devices that has deviceprofile_id changed
    "success": [ "5c5b350e0001" ]
}
</code></pre>
<h1 id="org-psk">Org PSK</h1>
<h3 id="base-uri_9">Base URI</h3>
<pre><code>/api/v1/orgs/:org_id/psks
</code></pre>
<h2 id="add-psk">Add PSK</h2>
<p>Add psk on the org. Required: <code>ssid</code>, <code>passphrase</code>.</p>
<pre><code>POST /api/v1/orgs/:org_id/psks
</code></pre>
<h2 id="get-psk">Get PSK</h2>
<p>Get list of psks on the org. This API is always paginated, default limit is 100.</p>
<p>Use query param, to filter or sort by name/role/ssid</p>
<pre><code>GET /api/v1/orgs/:org_id/psks?name=Common&amp;role=student&amp;sort=ssid&amp;limit=200&amp;page=3
</code></pre>
<h2 id="delete-psk">Delete PSK</h2>
<p>Delete list of psks on the org. This API accepts single string or list of strings</p>
<pre><code>POST /api/v1/orgs/:org_id/psks/delete
</code></pre>
<h3 id="example_9">Example</h3>
<pre><code>{
    "psk_ids": ['0039c16c-ca87-4d3f-bb94-b97c58199f18', '6562cc8e-5893-418a-acaa-4d7c1af8084f']
}
</code></pre>
<h3 id="update-by-psk-name">Update by PSK name</h3>
<pre><code>/api/v1/orgs/:org_id/psks?upsert=true
</code></pre>
<h3 id="example_10">Example</h3>
<pre><code>{
    "name": "Common",
    "passphrase": "foryoureyesonly",
    "ssid": "warehouse",
    "usage": "single",
    "vlan_id": 417,            // optional
    "mac": "5684dae9ac8b",     // optional
    "role": "",                // optional
    "expire_time": 1614990263  // optional, epoch time in seconds, default is null, as no expiration
    "max_usage": 20            // optional, default is 0 (unlimited)
    "notes": "notes"           // optional
    "notify_expiry": true      // optional
    "expiry_notification_time": 2      // optional, unit days
    "notify_on_create_or_edit": true   // optional
    "email": "admin@test.com"  // optional, email to send psk expiring notifications to
    "admin_sso_id": "sso_id"  // optional, sso id for psk created from psk portal
}
</code></pre>
<h3 id="update-multi-psks">Update multi PSKs</h3>
<pre><code>PUT /api/v1/orgs/:org_id/psks
</code></pre>
<h3 id="example_11">Example</h3>
<pre><code>[
    {
         "id": "2f64a022-9422-4fa3-92aa-ff6559a9f7f9", //psk_id, required
         "name": "common123",
    },
    {
        "id": "110c59ae-d7b2-40f9-9bf2-82367370e55a", //psk_id, required
        "usage": "single",
        "name": "common12",
        "passphrase": "foryoureyesonly1",
        "role": "teacher",
    }
]
</code></pre>
<h3 id="definitions_16">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>a name for the PSK</td>
</tr>
<tr>
<td><code>passphrase</code></td>
<td><code>string</code></td>
<td>passphrase of the PSK (8-63 character or 64 in hex)</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>SSID this PSK should be applicable to</td>
</tr>
<tr>
<td><code>usage</code></td>
<td><code>string</code></td>
<td>multi (default) / single / macs</td>
</tr>
<tr>
<td><code>vlan_id</code></td>
<td><code>int</code></td>
<td>VLAN for this PSK key</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>if usage==single, the mac that this PSK ties to, empty if auto-binding</td>
</tr>
<tr>
<td><code>max_usage</code></td>
<td><code>int</code></td>
<td>max concurrent users for this PSK key. Default is 0 (unlimited)</td>
</tr>
<tr>
<td><code>role</code></td>
<td><code>string</code></td>
<td>Role for this PSK key (32 character maximum)</td>
</tr>
<tr>
<td><code>expire_time</code></td>
<td><code>int</code></td>
<td>Expire time for this PSK key. Default is half year, max is 5 year</td>
</tr>
<tr>
<td><code>notes</code></td>
<td><code>string</code></td>
<td>notes</td>
</tr>
<tr>
<td><code>notify_expiry</code></td>
<td><code>boolean</code></td>
<td>If set to true, reminder notification will be sent when psk is about to expire</td>
</tr>
<tr>
<td><code>expiry_notification_time</code></td>
<td><code>int</code></td>
<td>Number of days before psk is expired. Used as to when to start sending reminder notification when the psk is about to expire</td>
</tr>
<tr>
<td><code>notify_on_create_or_edit</code></td>
<td><code>boolean</code></td>
<td>If set to true, notification will be sent when psk is created or edited</td>
</tr>
<tr>
<td><code>email</code></td>
<td><code>string</code></td>
<td>Email to send psk expiring notifications to</td>
</tr>
<tr>
<td><code>admin_sso_id</code></td>
<td><code>string</code></td>
<td>sso id for psk created from psk portal</td>
</tr>
<tr>
<td><code>old_passphrase</code></td>
<td><code>string</code></td>
<td>previous passphrase of the PSK if it has been rotated</td>
</tr>
<tr>
<td><code>macs</code></td>
<td><code>list</code></td>
<td>if usage==macs, this list contains N number of client mac addresses or mac patterns(11:22:*) or both. This list is capped at 5000</td>
</tr>
</tbody>
</table>
<h3 id="add-a-psk-of-type-macs">Add a psk of type “macs”</h3>
<p>Adds a PSK with usage type set to “macs”. When usage==macs, corresponding “macs” field will hold a list consisting of client mac addresses ([“xx:xx:xx:xx:xx”,…]) or mac patterns([“xx:xx:<em>”,”xx</em>”,…]) or both ([“xx:xx:xx:xx:xx:xx”, “xx:*”, …]). This list is capped at 5000</p>
<pre><code>POST /api/v1/orgs/:org_id/psks
</code></pre>
<h3 id="example_12">Example</h3>
<pre><code>{
    "name": "Common",
    "passphrase": "foryoureyesonly",
    "ssid": "warehouse",
    "usage": "macs",
    "macs": ["11:22:33:44:55:66", "aa:bb:*", "53*"],
    "vlan_id": 417,            // optional
    "role": "",                // optional
    "expire_time": 1614990263  // optional, epoch time in seconds, default is null, as no expiration
    "notify_expiry": true      // optional
    "expiry_notification_time": 2      // optional, unit days
    "notify_on_create_or_edit": true   // optional
    "email": "admin@test.com"  // optional, email to send psk expiring notifications to
}
</code></pre>
<h3 id="delete-old_passphrase-from-psk">Delete <code>old_passphrase</code> from PSK</h3>
<pre><code>POST /api/v1/orgs/:org_id/psks/:psk_id/delete_old_passphrase
</code></pre>
<p>If successful, response is same as GET, returns the PSK with <code>old_passphrase</code> removed.</p>
<h2 id="import-psks">Import PSKs</h2>
<pre><code>POST /api/v1/orgs/:org_id/psks/import
</code></pre>
<h3 id="upload-via-csv-file">Upload via CSV file</h3>
<p>A multi-part POST</p>
<pre><code>"file": CSV File
</code></pre>
<h3 id="psk-import-csv-file-format">PSK Import CSV File Format</h3>
<pre><code>name,ssid,passphrase,usage,vlan_id,mac,max_usage,role,expire_time,notify_expiry,expiry_notification_time,notify_on_create_or_edit,email
Common,warehouse,foryoureyesonly,single,35,a31425f31278,0,student,1618594236
Justin,reception,visible,multi,1002,200,teacher,1618594236
Common2,ssid,1245678-xx,single,35,a31425f31278,0,student,1618594236,true,7,true,admin@test.com
</code></pre>
<h3 id="definitions_17">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>a name for the PSK</td>
</tr>
<tr>
<td><code>passphrase</code></td>
<td><code>string</code></td>
<td>passphrase of the PSK (8-63 character or 64 in hex)</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>SSID this PSK should be applicable to</td>
</tr>
<tr>
<td><code>usage</code></td>
<td><code>string</code></td>
<td>multi (default) / single / macs</td>
</tr>
<tr>
<td><code>vlan_id</code></td>
<td><code>int</code></td>
<td>VLAN for this PSK key</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>if usage==single, the mac that this PSK ties to, empty if auto-binding</td>
</tr>
<tr>
<td><code>max_usage</code></td>
<td><code>int</code></td>
<td>max concurrent users for this PSK key. Default is 0 (unlimited)</td>
</tr>
<tr>
<td><code>role</code></td>
<td><code>string</code></td>
<td>Role for this PSK key (32 character maximum)</td>
</tr>
<tr>
<td><code>expire_time</code></td>
<td><code>int</code></td>
<td>Expire time for this PSK key. Default is half year, max is 5 year</td>
</tr>
<tr>
<td><code>notify_expiry</code></td>
<td><code>boolean</code></td>
<td>If set to true, reminder notification will be sent when psk is about to expire</td>
</tr>
<tr>
<td><code>expiry_notification_time</code></td>
<td><code>int</code></td>
<td>Number of days before psk is expired. Used as to when to start sending reminder notification when the psk is about to expire</td>
</tr>
<tr>
<td><code>notify_on_create_or_edit</code></td>
<td><code>boolean</code></td>
<td>If set to true, notification will be sent when psk is created or edited</td>
</tr>
<tr>
<td><code>email</code></td>
<td><code>string</code></td>
<td>Email to send psk expiring notifications to</td>
</tr>
<tr>
<td><code>macs</code></td>
<td><code>list</code></td>
<td>if usage==macs, this list contains N number of client mac addresses or mac patterns(1122*) or both. This list is capped at 5000</td>
</tr>
</tbody>
</table>
<h3 id="request-if-upload-via-json">Request if Upload via JSON</h3>
<pre><code>[
    {
        "name": "Common",
        "ssid": "warehouse",
        "passphrase": "foryoureyesonly",
        "usage": "single",
        "vlan_id", 35,
        "mac": "a31425f31278",
        "max_usage": 300,
        "role": "teacher",
        "expire_time": "1618594236",
        "notify_expiry": true,
        "expiry_notification_time": 2,
        "notify_on_create_or_edit"; true,
        "email": "admin@test.com"
    },
    {
        "name": "Justin",
        "ssid": "reception",
        "passphrase": "visible",
        "usage": "multi",
        "vlan_id", 1002,
        "mac": null,
    },
    {
        "name": "Alice",
        "ssid": "guest",
        "passphrase": "visible",
        "usage": "macs",
        "vlan_id", 1002,
        "macs": ["112233445566", "aabbcc*"]
    }
]
</code></pre>
<h1 id="psk-portal">PSK Portal</h1>
<p>PSK Self-Service Portals are for</p>
<ol>
<li><strong>WIFI users</strong> who want to connect to a WLAN with personal PSK, they’re told to connect to a URL
   where they can login (likely through company’s SSO) and get the WIFI Name / Passphrase<ul>
<li>required input fields <code>name</code>, <code>email</code> so we can generate PSK</li>
</ul>
</li>
<li><strong>PSK Admins</strong> (they don’t have access to normal Network Admin Portal)</li>
</ol>
<h2 id="base-url">Base URL</h2>
<pre><code>/api/v1/orgs/:org_id/pskportals
</code></pre>
<pre><code>{
    "name": "get-wifi"

    "ssid": "Corp",             // intended SSID

    // for personal psk portal
    "type": "byod",         // byod / admin

    // how PSK should be generated
    "vlan_id": 417,             // optional
    "role": "",                 // optional
    "max_usage": 20,            // optional, default is 0 (unlimited)
    "cleanup_psk": true,        // optional, default is false, used to cleanup exited psk when portal delete or ssid changed

    // auth
    "auth": "sso",              // sso / sponsor(not yet)
    "notification_renew_url": "https://custom-sso/url",    // optional, will include the link in the notification email
    // the customer can either provide their own url or use the one generate from mist, or do a url shorterner against either

    "sso": {
        "issuer": "https://app.onelogin.com/saml/metadata/138130"
        "idp_cert": "-----BEGIN CERTIFICATE-----\nMIIFZjCCA06gAwIBAgIIP61/1qm/uDowDQYJKoZIhvcNAQELBQE\n-----END CERTIFICATE-----",
        "idp_sign_algo": "sha256",
        "idp_sso_url": "https://yourorg.onelogin.com/trust/saml2/http-post/sso/138130",
        "nameid_format": "email",
        // optional
        "allowed_roles": ["Student", "Teather"], // allowed roles for accessing psk portal, if none, any role is permitted.
        "use_sso_role_for_psk_role": true,  // if enabled, the `role` above will be ignored
        "role_mapping": {
            "Student": "user",
            "Teacher": "faculty"
        }
    },

    // rule for generating psk
    "passphrase_rules": {
        "length": 8,
        "max_length": int,              (optional)
        "min_length": int,              (optional)
        "alphabets_enabled": true,
        "numerics_enabled": true,
        "symbols_enabled": false,          // disabled by default
        "symbols": "()[]{}_%@#&amp;$"
        // for valid `max_length` and `min_length`, passphrase size is set randomly from that range.
        // if `max_length` and/or `min_length` are invalid, passphrase size is equal to `length` parameter
        // if `length` is not set or is invalid, default passphrase size is 8.
        // valid `max_length`, `min_length`, `length` should be an integer between 8 to 63. Also, `max_length` &gt; `min_length`
    },
    "expire_time": 1440, // unit min
    "notify_expiry": true,  // optional
    "expiry_notification_time": 2, // optional, unit days
    "notify_on_create_or_edit": true // optional
    "hide_psks_created_by_other_admins": false // optional, for admin psk portal only 

    // what information to ask for (email is required by default)
    "required_fields": ["name", "role"],  // name / notes

    // UI customization
    "bg_image_url": ...
    "thumbnail_url": ...
    "template_url": ...

    // for PSK admin portal
    "type": "admin",
    "auth": "sso",
}
</code></pre>
<h3 id="get-saml-metadata">Get SAML Metadata</h3>
<pre><code>GET /api/v1/orgs/:org_id/pskportals/:pskportal_id/saml_metadata
GET /api/v1/orgs/:org_id/pskportals/:pskportal_id/saml_metadata.xml
</code></pre>
<h3 id="get-latest-saml-failures">Get Latest SAML Failures</h3>
<pre><code>GET /api/v1/orgs/:org_id/pskportals/:pskportal_id/saml_failures
</code></pre>
<h3 id="response_82">Response</h3>
<pre><code>{
    "results": [
        {
            "timestamp": 1431382121,
            "detail": "Role attribute missing",
            "saml_assertion_xml": "&lt;samlp:Response xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:saml="urn:oasis:nam..."
        }
    ]
}
</code></pre>
<h2 id="pskportal-template">PskPortal Template</h2>
<pre><code>PUT /api/v1/orgs/:org_id/pskportals/:pskportal_id/portal_template
</code></pre>
<h3 id="request_41">Request</h3>
<pre><code>{
  "poweredBy": false,
  "color": "#1074bc",
  "logo": null,
  "alignment": "center",
  "tos": false,
  "tosText": "&lt;&lt; provide your Terms of Service here &gt;&gt;",
  "tosAcceptLabel": "I accept the Terms of Service ",
  "tosLink": "Terms of Service",
  "tosError": "Please review and accept the Terms of Service"
}
</code></pre>
<h3 id="parameters_51">Parameters</h3>
<p><code>poweredBy</code>|<code>boolean</code>| whether to hide “Powered by Juniper Mist” and email footers, default is false
<code>color</code>|<code>string</code>| “#1074bc”
<code>logo</code>|<code>string</code>| custom logo with “data:image/png;base64,” format, default null, uses Juniper Mist Logo.
<code>alignment</code>|<code>string</code>| defines alignment on portal. “center” is default.
<code>tos</code>|<code>boolean</code>| enable terms and service for portal. default is false.
<code>tosText</code>|<code>string</code>| terms and service text displayed in footer if tos is enabled.
<code>tosAcceptLabel</code>|<code>string</code>| label for accept tos
<code>tosLink</code>|<code>string</code>| link for tos
<code>tosError</code>|<code>string</code>| error message for not accepting tos</p>
<h2 id="pskportal-image-upload">PskPortal Image Upload</h2>
<p>Upload background image for PskPortal</p>
<pre><code>POST /api/v1/orgs/:org_id/pskportals/:pskportal_id/portal_image
</code></pre>
<h3 id="request_42">Request</h3>
<p>A multi-part POST</p>
<pre><code>"json": a JSON string describing the upload
"file": a binary file
</code></pre>
<h2 id="pskportal-image-delete">PskPortal Image Delete</h2>
<p>Delete background image for PskPortal</p>
<pre><code>DELETE /api/v1/orgs/:org_id/pskportals/:pskportal_id/portal_image
</code></pre>
<p>If image is not uploaded or is deleted, PskPortal will use default image.</p>
<h2 id="get-pskportal-logs">GET PskPortal LOGS</h2>
<pre><code>GET /api/v1/orgs/:org_id/pskportals/logs?start=1431384000&amp;end=1431298000&amp;limit=100
GET /api/v1/orgs/:org_id/pskportals/logs/search?start=1431384000&amp;end=1431298000&amp;limit=100
</code></pre>
<h3 id="supported-filters_2">Supported Filters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>psk_name</code></td>
<td><code>string</code></td>
<td>psk_name</td>
</tr>
<tr>
<td><code>psk_id</code></td>
<td><code>string</code></td>
<td>psk_id</td>
</tr>
<tr>
<td><code>pskportal_id</code></td>
<td><code>string</code></td>
<td>pskportal_id</td>
</tr>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>audit_id</td>
</tr>
<tr>
<td><code>admin_name</code></td>
<td><code>string</code></td>
<td>admin name or email</td>
</tr>
<tr>
<td><code>admin_id</code></td>
<td><code>string</code></td>
<td>admin id</td>
</tr>
<tr>
<td><code>name_id</code></td>
<td><code>string</code></td>
<td>name_id used in SSO</td>
</tr>
</tbody>
</table>
<h3 id="response_83">Response</h3>
<pre><code>Status: 200 OK
{
    "start": 1428939600,
    "end":   1428954000,
    "limit": 100,

    "total": 135,
    "results": [{
        'timestamp': 1686346104.096, 
        'org_id': '2818e386-8dec-2562-9ede-5b8a0fbbdc71', 
        'psk_name': 'test@mist.com', 
        'psk_id': '608fe603-f9f0-4ce9-9473-04ef6c6ea749', 
        'id': '8a3dcaa7-80e3-4bb0-a75b-7bc6322cfd09', 
        'message': 'Rotate PSK test@mist.com', 
        'pskportal_id': 'c1742c09-af35-4161-96ef-7dc65c6d5674', 
        'name_id': 'test@mist.com'
        }]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>timestamp</code></td>
<td><code>long</code></td>
<td>start time, in epoch</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id</td>
</tr>
<tr>
<td><code>admin_id</code></td>
<td><code>string</code></td>
<td>admin id</td>
</tr>
<tr>
<td><code>admin_name</code></td>
<td><code>string</code></td>
<td>name of the admin that performs the action</td>
</tr>
<tr>
<td><code>message</code></td>
<td><code>string</code></td>
<td>log message</td>
</tr>
<tr>
<td><code>psk_name</code></td>
<td><code>string</code></td>
<td>psk_name</td>
</tr>
<tr>
<td><code>psk_id</code></td>
<td><code>string</code></td>
<td>psk_id</td>
</tr>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>audit_id</td>
</tr>
<tr>
<td><code>name_id</code></td>
<td><code>string</code></td>
<td>user_id or user email</td>
</tr>
</tbody>
</table>
<h2 id="count-by-distinct-attributes-of-pskportal-logs">Count by Distinct Attributes of PskPortal Logs</h2>
<pre><code>GET /api/v1/orgs/:org_id/pskportals/logs/count?distinct=user_id
</code></pre>
<h3 id="request_43">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>admin_id / admin_name / psk_name / psk_id / pskportal_id / user_id, default is pskportal_id</td>
</tr>
</tbody>
</table>
<h3 id="response_84">Response</h3>
<pre><code>{
    "start": 1511967600,
    "end": 1513177200,
    "limit": 10,
    "distinct": "admin_name",

    "total": 2,
    "results": [
        {
            "admin_name": "John Smith john.smith@corp.com",
            "count": 61
        },
        {
            "admin_name": "Eric Sky eric@corp.com",
            "count": 44
        }
    ]
}
</code></pre>
<h1 id="map-import_1">Map Import</h1>
<p>Import data from files is a multipart POST which has an file, an optional json, and an optional csv, to create
floorplan, assign matching inventory to specific site, place ap if name or mac matches</p>
<pre><code>POST /api/v1/orgs/:org_id/maps/import
</code></pre>
<h3 id="request_44">Request</h3>
<p>A multi-part POST</p>
<pre><code>"json": a JSON string, site id required, vendor option: ekahau, ibwave, etc., import_all_floorplans: optional, default: false,
import_height: optional, default: true, import_orientation: optional, default: true
"file": a binary file, option: .esx
"auto_deviceprofile_assignment": boolean, default: false, whether to auto assign device to deviceprofile by name
"csv": a csv file for ap name mapping, optional
// for the JSON payload
{
    "vendor_name": "ekahau",
    "site_id": "bee1902c-84aa-a993-bee2-d774ed6aa4cf",
    "import_all_floorplans": true,  // optional
    "import_height": true, // optional
    "import_orientation": false // optional
}
</code></pre>
<h3 id="device-import-csv-file-format_1">Device Import CSV File Format</h3>
<pre><code>Vendor AP name,Mist AP Mac
US Office AP-2 - 5c:5b:35:00:00:02,5c5b35000002
</code></pre>
<h3 id="response_85">Response</h3>
<pre><code>{
    "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
    "aps": [
        {
            "mac": "5c5b35000001",
            // placed
            "action": "placed"
            "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5"
            // assigned to a site and placed
            "action": "assigned-placed",
            // named and placed
            "action": "named-placed"
            // assigned, named and placed
            "action": "assigned-named-placed"
            // if we ignore it (did nothing with it)
            "action": "ignored",
            "reason": "not found on site" // "not found in inventory",
            // floorplan id, height, orientation for ignored ap
            "floorplan_id": "cbdb7f0b-3be0-4872-88f9-58790b509c23-j68kows8"
            "orientation": 45,
            "height": 3
        }
    ],
    "floorplans": [
        {
            // whatever ID vendor has
            "id": "cbdb7f0b-3be0-4872-88f9-58790b509c23-j68kows8",
            "name": "map1",
            // we only import the floorplan if at least one of the AP is being placed by default
            "action": "imported",
            "map_id": "845a23bf-bed9-e43c-4c86-6fa474be7ae5",
            "action": "ignored",
            "reason": "no aps placed"
        }
    ],
    "summary": {
        "num_ap_assigned": 1,
        "num_map_assigned": 1,
        "num_inv_assigned": 1
    }
}
</code></pre>
<h2 id="org-wired-clients-search">Org Wired Clients Search</h2>
<pre><code>GET /api/v1/orgs/:org_id/wired_clients/search
GET /api/v1/orgs/:org_id/wired_clients/search?mac=112233445566
</code></pre>
<h3 id="request_45">Request</h3>
<p>The following fields are available for searching.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>device_mac</code></td>
<td><code>string</code></td>
<td>device mac</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>client mac</td>
</tr>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>port id</td>
</tr>
<tr>
<td><code>vlan</code></td>
<td><code>int</code></td>
<td>vlan</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>ip</td>
</tr>
<tr>
<td><code>manufacture</code></td>
<td><code>string</code></td>
<td>client manufacture</td>
</tr>
<tr>
<td><code>text</code></td>
<td><code>string</code></td>
<td>single entry of hostname/mac</td>
</tr>
<tr>
<td><code>nacrule_id</code></td>
<td><code>string</code></td>
<td>nacrule_id</td>
</tr>
<tr>
<td><code>dhcp_hostname</code></td>
<td><code>string</code></td>
<td>dhcp hostname</td>
</tr>
<tr>
<td><code>dhcp_fqdn</code></td>
<td><code>string</code></td>
<td>dhcp full qualified domain name</td>
</tr>
<tr>
<td><code>dhcp_client_identifier</code></td>
<td><code>string</code></td>
<td>dhcp client identifier</td>
</tr>
<tr>
<td><code>dhcp_vendor_class_identifier</code></td>
<td><code>string</code></td>
<td>dhcp vendor class identifier</td>
</tr>
<tr>
<td><code>dhcp_request_params</code></td>
<td><code>string</code></td>
<td>dhcp request parameters</td>
</tr>
<tr>
<td><code>auth_state</code></td>
<td><code>string</code></td>
<td>authentication state</td>
</tr>
<tr>
<td><code>auth_method</code></td>
<td><code>string</code></td>
<td>authentication method</td>
</tr>
<tr>
<td><code>source</code></td>
<td><code>string</code></td>
<td>source from where the client was learned (lldp, mac)</td>
</tr>
</tbody>
</table>
<h3 id="response_86">Response</h3>
<pre><code>{
    "results": [
        {
            "ip": [
                "11.216.202.61"
            ],
            "device_mac": [
                "001122334455"
            ],
            "org_id": "c168ddee-c14c-11e5-8e81-1258369c38a9",
            "vlan": [
                0,
                1001
            ],
            "site_id": "c168ddee-c14c-11e5-8e81-1258369c38a9",
            "device_mac_port": [
                {
                    "device_mac": "001122334455",
                    "vlan": 1,
                    "ip": "",
                    "start": "2020-12-10T00:07:36.262+0000",
                    "port_id": "et-0/0/1",
                    "port_parent": "",
                    "when": "2022-03-29T04:56:05.172+0000"
                },
            ],
            "mac": "112233445566",
            "timestamp": 1571174567.807,
            "port_id": [
                "et-0/0/1"
            ],
            "dhcp_hostname": "ITS-VMMT0-D1N02",
            "dhcp_fqdn": "ITS-VMMT0-D1N02.mgthub.local",
            "dhcp_client_identifier": "MAC address 00155df6d500",
            "dhcp_vendor_class_identifier": "MSFT 5.0",
            "dhcp_request_params": "1 3 6 15 31 33 43 44 46 47 119 121 249 252",
            "dhcp_client_options": [
                {
                    "code": "DHO_DHCP_MESSAGE_TYPE(53)", 
                    "data": "DHCPREQUEST"
                }, {
                    "code": "DHO_DHCP_CLIENT_IDENTIFIER(61)",
                    "data": "MAC address 00155df6d500",  
                }, {
                    "code": "DHO_DHCP_REQUESTED_ADDRESS(50)",
                    "data": "172.17.10.255",
                }, {
                    "code": "DHO_DHCP_SERVER_IDENTIFIER(54)",
                    "data": "172.17.8.1"
                }, {
                    "code": "DHO_DHCP_MAX_MESSAGE_SIZE(57)",
                    "data": "1280"
                }, {
                    "code": "DHO_DHCP_PARAMETER_REQUEST_LIST(55)",
                    "data": " 1 3 6 12 15 28 43 180"
                }, {
                    "code": "DHO_VENDOR_CLASS_IDENTIFIER(60)",
                    "data": "MSFT 5.0"
                }, {
                    "code": "DHO_HOST_NAME(12)",
                    "data": "ITS-VMMT0-D1N02"
                }
            ],
            "auth_method": "mac_auth",
            "auth_state": "authenticated"
        }
    ],
    "start": 1648443400.8221116,
    "end": 1648529800.8221116,
    "limit": 1000,
    "total": 1
}
</code></pre>
<h2 id="count-org-wired-clients-by-distinct-attributes">Count Org Wired Clients by Distinct Attributes</h2>
<pre><code>GET /api/v1/orgs/:org_id/wired_clients/count
</code></pre>
<h3 id="request_46">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>port_id, vlan, device_mac, site_id, ip, manufacture, default is device_mac</td>
</tr>
</tbody>
</table>
<h3 id="response_87">Response</h3>
<pre><code>{
    "start": 1648443400.8221116,
    "end": 1648529800.8221116,
    "limit": 1000,
    "distinct": "device_mac",
    "total": 20,
    "results": [
        {
            "device_mac": "112233445566",
            "count": 7
        },
        {
            "device_mac": "aabbccddeeff",
            "count": 2
        },
        ...
    ]
}
</code></pre>
<h2 id="org-wired-clients-events-search">Org Wired Clients Events Search</h2>
<pre><code>GET /api/v1/orgs/:org_id/wired_clients/events/search
GET /api/v1/orgs/:org_id/wired_clients/events/search?mac=112233445566
</code></pre>
<h3 id="request_47">Request</h3>
<p>The following fields are available for searching.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>device_mac</code></td>
<td><code>string</code></td>
<td>device mac</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>client mac</td>
</tr>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>port id</td>
</tr>
<tr>
<td><code>vlan</code></td>
<td><code>int</code></td>
<td>vlan</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>text</code></td>
<td><code>string</code></td>
<td>single entry of hostname/mac</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td><a href="https://api.mist.com/api/v1/docs/Org#Supported-Events-Type">See Supported Events Type</a> (E.g. CLIENT_DNS_OK)</td>
</tr>
</tbody>
</table>
<h3 id="response_88">Response</h3>
<pre><code>{
    "results": [
        {
            "device_mac": "device_mac",
            "timestamp": 1594708454.257958,
            "org_id": "1688605f-916a-47a1-8c68-f19618300a08",
            "site_id": "ec3b5624-73f1-4ed3-b3fd-5ba3ee40368a",
            "port_id": "ge-0/0/5",
            "type": "SW_DOT1XD_USR_AUTHENTICATED",
            "text": "text",
            "mac": "mac"
        }

    ],
    "start": 1663038067.062201,
    "end": 1663113667.0622225,
    "limit": 1000,
    "total": 1
}
</code></pre>
<h2 id="count-org-wired-clients-by-distinct-attributes_1">Count Org Wired Clients by Distinct Attributes</h2>
<pre><code>GET /api/v1/orgs/:org_id/wired_clients/events/count
</code></pre>
<h3 id="request_48">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>port_id, vlan, device_mac, site_id, mac, type</td>
</tr>
</tbody>
</table>
<h3 id="response_89">Response</h3>
<pre><code>{
    "results": [{
        "count": 1,
        "type": "SW_DOT1XD_USR_AUTHENTICATED"
    }],
    "start": 1663038067.062201,
    "end": 1663113667.0622225,
    "limit": 1000,
    "distinct": "type",
    "total": 1,
    "percentage": 100
}
</code></pre>
<h2 id="doing-coa-against-a-wired-client">Doing CoA against a wired client</h2>
<pre><code>POST /api/v1/orgs/:org_id/wired_clients/:mac/coa
</code></pre>
<h3 id="request_49">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>wired_client mac</td>
</tr>
</tbody>
</table>
<h3 id="response_90">Response</h3>
<pre><code>{
    "device_mac": "5c5b35000002",
    "port_id": "ge-0/0/0",
    "session": "0a2a11b8-4b30-40d8-a6d1-e91ea540d86f"
}
</code></pre>
<h1 id="tickets">Tickets</h1>
<h2 id="get-tickets-of-an-org">Get Tickets of an Org</h2>
<pre><code>GET /api/v1/orgs/:org_id/tickets?start=1546300800&amp;end=-1d
</code></pre>
<h3 id="parameters_52">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>start</code></td>
<td><code>string</code></td>
<td>start datetime, can be epoch or relative time like -1d, -1w; -1d if not specified</td>
</tr>
<tr>
<td><code>end</code></td>
<td><code>string</code></td>
<td>end datetime, can be epoch or relative time like -1d, -2h</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>string</code></td>
<td>duration like 7d, 2w</td>
</tr>
</tbody>
</table>
<p>NOTE: if both start &amp; duration are specified, duration will be ignored</p>
<h3 id="response_91">Response</h3>
<pre><code>[
    {
        "id": "00000000-0000-0000-0000-00000000000c",
        "case_number": "12",
        "created_at": 1453908369,
        "updated_at": 1453908369,
        "subject": "Please add me",
        "type": "question",
        "status": "open",
        "requester": "John Smith",
        "requester_email": "joe@abc.com"
    }
]
</code></pre>
<h3 id="definitions_18">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>id of the ticket</td>
</tr>
<tr>
<td><code>case_number</code></td>
<td><code>string</code></td>
<td>display name of the ticket</td>
</tr>
<tr>
<td><code>created_at</code></td>
<td><code>int</code></td>
<td>when the ticket was created</td>
</tr>
<tr>
<td><code>updated_at</code></td>
<td><code>int</code></td>
<td>when the ticket was last updated</td>
</tr>
<tr>
<td><code>subject</code></td>
<td><code>string</code></td>
<td>subject</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>question (default) / bug / critical</td>
</tr>
<tr>
<td><code>status</code></td>
<td><code>string</code></td>
<td>open / pending / solved / closed</td>
</tr>
<tr>
<td><code>requester</code></td>
<td><code>string</code></td>
<td>name of the requester</td>
</tr>
<tr>
<td><code>requester_email</code></td>
<td><code>string</code></td>
<td>email of the requester</td>
</tr>
</tbody>
</table>
<p>Ticket Status</p>
<ul>
<li><code>open</code>: ticket is open, Mist is working on it</li>
<li><code>pending</code>: ticket is open and Requester attention is needed (e.g. Mist is asking for some more information)</li>
<li><code>solved</code>: ticket is marked as solved / considered by Mist (requester can update it, causing it to re-open; or rate it)</li>
<li><code>closed</code>: ticket is archived and cannot be changed</li>
</ul>
<h2 id="create-a-ticket">Create a ticket</h2>
<pre><code>POST /api/v1/orgs/:org_id/tickets
</code></pre>
<h3 id="example_13">Example</h3>
<pre><code>{
    "subject": "question regarding WPA",
    "type": "question",
    "comment": "where do I configure WPA1 / WPA2 / Auto?"
}
</code></pre>
<h3 id="definitions_19">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>subject</code></td>
<td><code>string</code></td>
<td><strong>Required</strong> subject (usually short)</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>question (default) / bug / critical</td>
</tr>
<tr>
<td><code>comment</code></td>
<td><code>string</code></td>
<td><strong>Required</strong> description</td>
</tr>
</tbody>
</table>
<h2 id="update-a-ticket">Update a ticket</h2>
<pre><code>PUT /api/v1/orgs/:org_id/tickets/:ticket_id
</code></pre>
<h3 id="example_14">Example</h3>
<pre><code>{
    "subject": "question regarding WPA/WPA2",
    "type": "question",
    "status": "solved"
}
</code></pre>
<h3 id="definitions_20">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>subject</code></td>
<td><code>string</code></td>
<td>subject (usually short)</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>question (default) / bug / critical</td>
</tr>
<tr>
<td><code>status</code></td>
<td><code>string</code></td>
<td>open / solved</td>
</tr>
</tbody>
</table>
<h2 id="add-a-comment">Add a comment</h2>
<pre><code>POST /api/v1/orgs/:org_id/tickets/:ticket_id/comments
</code></pre>
<h3 id="example-no-attachments">Example (no attachments)</h3>
<pre><code>{
    "comment": "this is urgent"
}
</code></pre>
<h3 id="example-with-attachments">Example (with attachments)</h3>
<pre><code>multipart:
"comment": "this is urgent, see my screenshot",
"file": a binary file
</code></pre>
<h2 id="get-ticket-detail">Get Ticket Detail</h2>
<pre><code>GET /api/v1/orgs/:org_id/tickets/:ticket_id
</code></pre>
<h3 id="response_92">Response</h3>
<pre><code>{
    "id": "00000000-0000-0000-0000-00000000000c",
    "case_number": "12",
    "created_at": 1453908369,
    "updated_at": 1453908369,
    "subject": "Please add me",
    "type": "bug",
    "status": "open",
    "requester": "John Smith",
    "requester_email": "joe@abc.com",
    "comments: [
        {
            "comment": "this is urgent, see my screenshot",
            "created_at": 1453908369,
            "author": "John Smith",
            "attachment_ids": ["00000000-0000-0000-0000-15231a659c13"]
        }
    ],
    "attachments": [
        {
            "id": "00000000-0000-0000-0000-15231a659c13",
            "file_name": "crash.png",
            "created_at": 1453908369,
            "content_url": "https://api.mist.com/api/v1/forward/download?jwt=..."
            "content_type": "image/png",
            "size_in_bytes": 1943
        },
        {
            "id": "00000000-0000-0000-0000-15231a659c78",
            "file_name": "crash.log",
            "created_at": 1453908369,
            "content_url": "https://api.mist.com/api/v1/forward/download?jwt=..."
            "content_type": "text/plain",
            "size_in_bytes": 2532
        }
    ]
}
</code></pre>
<h2 id="add-an-attachment">Add an attachment</h2>
<pre><code>POST /api/v1/orgs/:org_id/tickets/:ticket_id/attachments
</code></pre>
<h3 id="example_15">Example</h3>
<pre><code>multipart:
"file": a binary file
</code></pre>
<h2 id="get-ticket-attachment-download-url">Get Ticket Attachment Download URL</h2>
<pre><code>GET /api/v1/orgs/:org_id/tickets/:ticket_id/attachments/:attachment_id
</code></pre>
<h3 id="response_93">Response</h3>
<pre><code>{
    "content_url": "https://api.mist.com/api/v1/forward/download?jwt=..."
}
</code></pre>
<h2 id="count-tickets">Count tickets</h2>
<pre><code>GET /api/v1/orgs/:org_id/tickets/count?distinct=status
</code></pre>
<h3 id="definitions_21">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>status (default) / type</td>
</tr>
</tbody>
</table>
<h3 id="response_94">Response</h3>
<pre><code>{
    "limit": 1000,
    "distinct": "status",
    "total": 5,
    "results": [
        {
            "status": "closed",
            "count": 24
        },
        {
            "status": "open",
            "count": 12
        },
        {
            "status": "solved",
            "count": 15
        },
        {
            "status": "pending",
            "count": 10
        },
        {
            "status": "hold",
            "count": 3
        }
    ]
}
</code></pre>
<h1 id="sso-saml">SSO / SAML</h1>
<h2 id="create-sso">Create SSO</h2>
<pre><code>POST /api/v1/orgs/:org_id/ssos
</code></pre>
<h3 id="request_50">Request</h3>
<pre><code>{
    "name": "onelogin",

    "idp_type": "saml",  // saml (default) / ldap / oauth / mxedge_proxy / openroaming

    "issuer": "https://app.onelogin.com/saml/metadata/138130"
    "idp_cert": "-----BEGIN CERTIFICATE-----\nMIIFZjCCA06gAwIBAgIIP61/1qm/uDowDQYJKoZIhvcNAQELBQE\n-----END CERTIFICATE-----",
    "idp_sign_algo": "sha256",
    "idp_sso_url": "https://yourorg.onelogin.com/trust/saml2/http-post/sso/138130",
    "nameid_format": "email",

    // some IdP support a custom logout URL that is different from SP-initiated SLO process
    "custom_logout_url": "https://6.4.5.7/saml/idp/SingleLogoutService.php?param1=value1"

    // if idp_type = ldap
    "ldap_type": "azure", // azure (default) / okta / google / custom
    // if ldap_type is NOT custom:
    //     filters are automatically chosen based on chosen ldap_type
    // if ldap_type = custom:
    //     user can specify below fileds:
    //     ldap_user_filter
    //     ldap_group_attr (optional, default is memberOf)
    //     ldap_group_dn (optional, default is base_dn)
    //     ldap_group_filter (optional, default is user_filter)
    "ldap_server_hosts": [ "hostname", "63.1.3.5" ],
    "ldap_base_dn": "DC=abc,DC=com",
    "ldap_bind_dn": "CN=nas,CN=users,DC=abc,DC=com",
    "ldap_bind_password": "credential_for_nas",
    "ldap_cacerts": [
        "-----BEGIN CERTIFICATE-----\nMIIFZjCCA06gAwIBAgIIP61/1qm/uDowDQYJKoZIhvcNAQELBQE\n-----END CERTIFICATE-----",
        "-----BEGIN CERTIFICATE-----\nBhMCRVMxFDASBgNVBAoMC1N0YXJ0Q29tIENBMSwwKgYDVn-----END CERTIFICATE-----"
    ],
    "ldap_client_cert": "-----BEGIN CERTIFICATE-----\nMIIFZjCCA06gAwIBAgIIP61/1qm/uDowDQYJKoZIhvcNAQELBQE\n-----END CERTIFICATE-----",
    "ldap_client_key": "-----BEGIN PRI...",
    "ldap_resolve_groups": false,  // whether to recursively resolve LDAP groups, default is false

    // if idp_type = oauth
    "oauth_type": "azure", // azure (default) / azure-gov / okta / ping_identity
    // if oauth_type is okta/ping_identity, oauth_tenant_id is of the form "dev-88336535"
    "oauth_tenant_id": "1e6ae660-b7d3-4a6c-9efd-1fa606fc7304",
    // cc = Client Credentialstunbne
    "oauth_cc_client_id": "e60da615-7def-4c5a-8196-43675f45e174",
    // if oauth_type is okta/ping_identity, oauth_cc_client_secret is RSA private key, of the form "-----BEGIN RSA PRIVATE KEY--...."
    "oauth_cc_client_secret": "akL8Q~5kWFMVFYl4TFZ3fi~7cMdyDONi6cj01cpH",
    "oauth_ping_identity_region": "us", // us (United States, default), ca (Canada), eu (Europe), asia (Asia), au (Australia) 
    // ropc = Resource Owner Password Credentials
    "oauth_ropc_client_id": "9ce04c97-b5b1-4ec8-af17-f5ed42d2daf7",
    // oauth_ropc_client_secret can be empty if oauth_type is azure or azure-gov
    "oauth_ropc_client_secret": "blM9R~6kWFMVFYl4TFZ3fi~8cMdyDONi6cj01dqI",
    // scim_enabled (default 'false') indicates if SCIM provisioning is enabled for the OAuth IDP
    "scim_enabled": false,
    // scim_secret_token (auto-generated when not provided by caller and scim_enabled=true, empty string when scim_enabled=false) is used as the Bearer token in the Authorization header of SCIM provisioning requests by the IDP
    "scim_secret_token": "FBitbKPE1aecSloPGBuqqPxDUrFeZyZk",

    // if idp_type = mxedge_proxy
    // this requires `mist_nac` to be enabled on the mxcluster
    "mxedge_proxy": {
        "mxcluster_id": "572586b7-f97b-a22b-526c-8b97a3f609c4",
        "proxy_hosts": ["mxedge1.corp.com", "63.1.3.5"], // public hostname/IPs
        "ssids": ["eduroam_test, eduroam_main"],  // SSIDs that support eduroam, default: "eduroam"
        "operator_name": "1dartmouth.edu", // Operator name as Radius attribute while proxying
        "auth_servers": [
            {
                "host": "1.2.3.4",
                "port": 1812,
                "secret": "testing123",
                "require_message_authenticator": true, // default is false
            },
            {
                "host": "radius.internal",
                "port": 1812,
                "secret": "testing123",
             }
        ],
        "acct_servers": [
            {
                "host": "1.2.3.4",
                "port": 1812,
                "secret": "testing123",
            }
        ]
    },

    // if idp_type = openroaming
    "openroaming": {
        // SSIDs that support OpenRoaming
        "ssids": ["ssid_name1", "ssid_name2"],

        // Optional WBA-issued certificate. If not provided, the default WBA-issued certificate for Juniper will be used.
        "wba_cert": "-----BEGIN CERTIFICATE-----\nMIIFZjCCA06gAwIBAgIIP61/1qm/uDowDQYJKoZIhvcNAQELBQE\n-----END CERTIFICATE-----"
    },

    // common
    "ignore_unmatched_roles": false,
    "default_role": null,
}
</code></pre>
<h3 id="definition_2">Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name</td>
</tr>
<tr>
<td><code>issuer</code></td>
<td><code>string</code></td>
<td>IDP issuer URL</td>
</tr>
<tr>
<td><code>idp_cert</code></td>
<td><code>string</code></td>
<td>IDP Cert (used to verify the signed response)</td>
</tr>
<tr>
<td><code>idp_sso_url</code></td>
<td><code>string</code></td>
<td>IDP Single-Sign-On URL</td>
</tr>
<tr>
<td><code>idp_sign_algo</code></td>
<td><code>string</code></td>
<td>signing algorithm for SAML Assertion</td>
</tr>
<tr>
<td><code>nameid_format</code></td>
<td><code>string</code></td>
<td>email (default) / unspecified</td>
</tr>
<tr>
<td><code>ignore_unmatched_roles</code></td>
<td><code>boolean</code></td>
<td>ignore any unmatched roles provided in assertion. By default, an assertion is treated as invalid for any unmatched role</td>
</tr>
<tr>
<td><code>default_role</code></td>
<td><code>string</code></td>
<td>default role to assign if there’s no match. By default, an assertion is treated as invalid when there’s no role matched</td>
</tr>
<tr>
<td><code>role_attr_from</code></td>
<td><code>string</code></td>
<td>optional, name of the attribute in SAML Assertion to extract role from (defaults to <code>Role</code>)</td>
</tr>
<tr>
<td><code>role_attr_extraction</code></td>
<td><code>string</code></td>
<td>optional, user defined role parsing scheme. <a href="https://api.mist.com/api/v1/docs/Org#Supported-Role-Parsing-Schemes">See Supported Role Parsing Schemes</a></td>
</tr>
<tr>
<td><code>custom_logout_url</code></td>
<td><code>string</code></td>
<td>optional, a URL we will redirect the user after user logout from Mist (for some IdP which supports a custom logout URL that is different from SP-initiated SLO process)</td>
</tr>
</tbody>
</table>
<h3 id="supported-role-parsing-schemes">Supported Role Parsing Schemes</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Scheme</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>cn</code></td>
<td>- The expected role attribute format in SAML Assertion is “CN=cn,OU=ou1,OU=ou2,…”<br><br> - CN (the key) is case insensitive and exactly 1 CN is expected (or the entire entry will be ignored)<br><br> E.g. if role attribute is “CN=cn,OU=ou1,OU=ou2” then parsed role value is “cn”</td>
</tr>
</tbody>
</table>
<h2 id="get-all-sso-configured-for-the-org">Get All SSO Configured for the Org</h2>
<pre><code>GET /api/v1/orgs/:org_id/ssos
</code></pre>
<h3 id="response_95">Response</h3>
<pre><code>[
    {
        "name": "onelogin",
        "issuer": "https://app.onelogin.com/saml/metadata/138130"
        "idp_cert": "-----BEGIN CERTIFICATE-----\nMIIFZjCCA06gAwIBAgIIP61/1qm/uDowDQYJKoZIhvcNAQELBQE\n-----END CERTIFICATE-----",
        "idp_sign_algo": "sha256",
        "idp_sso_url": "https://yourorg.onelogin.com/trust/saml2/http-post/sso/138130"
    }
]
</code></pre>
<h2 id="update-sso">Update SSO</h2>
<pre><code>PUT /api/v1/orgs/:org_id/ssos/:sso_id
</code></pre>
<h2 id="delete-sso">Delete SSO</h2>
<pre><code>DELETE /api/v1/orgs/:org_id/ssos/:sso_id
</code></pre>
<h2 id="get-sso-metadata">Get SSO Metadata</h2>
<pre><code>GET /api/v1/orgs/:org_id/ssos/:sso_id/metadata
</code></pre>
<h3 id="response_96">Response</h3>
<pre><code>{
   // if idp_type = saml (default)
   "entity_id": "https://api.mist.com/api/v1/saml/llDfa13f/login",
   "acs_url": "https://api.mist.com/api/v1/saml/llDfa13f/login",
   "logout_url": "https://api.mist.com/api/v1/saml/llDfa13f/logout",
   "metadata_xml": "&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;md:EntityDescriptor xmlns:md="urn:oasis:names:tc:SAML:2.0:metadata" entityID="https://api.mist.com/api/v1/saml/llDfa13f/login" validUntil="2027-10-12T21:59:01Z" xmlns:ds="http://www.w3.org/2000/09/xmldsig#"&gt;&lt;md:SPSSODescriptor AuthnRequestsSigned="false" WantAssertionsSigned="true" protocolSupportEnumeration="urn:oasis:names:tc:SAML:2.0:protocol"&gt;&lt;md:NameIDFormat&gt;urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified&lt;/md:NameIDFormat&gt;&lt;md:AssertionConsumerService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" Location="https://api.mist.com/api/v1/saml/llDfa13f/login" index="0" isDefault="true"/&gt;&lt;/md:SPSSODescriptor&gt;&lt;/md:EntityDescriptor&gt;"

   // if idp_type = oauth and scim_enabled
    "scim_base_url": "https://scim.nac-staging.mistsys.com/S_41b2525a-e8b8-4809-8168-f1d8dcbe9735/azure/4d72b1dc-7503-4717-81ea-80d0125b886e"

}
</code></pre>
<h2 id="download-saml-metadata">Download SAML Metadata</h2>
<pre><code>GET /api/v1/orgs/:org_id/ssos/:sso_id/metadata.xml
</code></pre>
<h3 id="response_97">Response</h3>
<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;md:EntityDescriptor xmlns:md="urn:oasis:names:tc:SAML:2.0:metadata" entityID="https://api.mist.com/api/v1/saml/5hdF5g/login" validUntil="2027-10-12T21:59:01Z" xmlns:ds="http://www.w3.org/2000/09/xmldsig#"&gt;
    &lt;md:SPSSODescriptor AuthnRequestsSigned="false" WantAssertionsSigned="true" protocolSupportEnumeration="urn:oasis:names:tc:SAML:2.0:protocol"&gt;
        &lt;md:SingleLogoutService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" Location="https://api.mist.com/api/v1/saml/5hdF5g/logout" /&gt;
        &lt;md:NameIDFormat&gt;urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified&lt;/md:NameIDFormat&gt;
        &lt;md:AssertionConsumerService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" Location="https://api.mist.com/api/v1/saml/5hdF5g/login" index="0" isDefault="true"/&gt;
        &lt;md:AttributeConsumingService index="0"&gt;
            &lt;md:ServiceName xml:lang="en-US"&gt;Mist&lt;/md:ServiceName&gt;
            &lt;md:RequestedAttribute Name="Role" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic" isRequired="true"/&gt;
            &lt;md:RequestedAttribute Name="FirstName" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic" isRequired="false"/&gt;
            &lt;md:RequestedAttribute Name="LastName" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic" isRequired="false"/&gt;
        &lt;/md:AttributeConsumingService&gt;
    &lt;/md:SPSSODescriptor&gt;
&lt;/md:EntityDescriptor&gt;
</code></pre>
<h2 id="get-latest-sso-failures">Get Latest SSO Failures</h2>
<pre><code>GET /api/v1/orgs/:org_id/ssos/:sso_id/failures
</code></pre>
<h3 id="response_98">Response</h3>
<pre><code>{
    "results": [
        {
            "timestamp": 1431382121,
            "detail": "Role attribute missing",
            "saml_assertion_xml": "&lt;samlp:Response xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:saml="urn:oasis:nam..."
        }
    ]
}
</code></pre>
<h2 id="create-sso-role">Create SSO Role</h2>
<pre><code>POST /api/v1/orgs/:org_id/ssoroles
</code></pre>
<h3 id="request_51">Request</h3>
<pre><code>{
    "name": "NOC",
    "privileges": [
        { "scope":"org", "role": "admin", "view": "reporting" },
        { "scope":"site", "site_id": "d96e3952-53e8-4266-959a-45acd55f5114", "role": "admin", "view": "reporting" },
        { "scope":"sitegroup", "sitegroup_id": "581328b6-e382-f54e-c9dc-999983183a34", "role": "admin", "view": "reporting" }
    ]
}
</code></pre>
<h3 id="definition_3">Definition</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name that would match the Role from SSO Login. Unique per Org, maximum length is 32</td>
</tr>
<tr>
<td><code>privileges</code></td>
<td><code>list</code></td>
<td>list of privileges</td>
</tr>
<tr>
<td><code>scope</code></td>
<td><code>string</code></td>
<td>site / org / sitegroup</td>
</tr>
<tr>
<td><code>role</code></td>
<td><code>string</code></td>
<td>admin / write / read / helpdesk / installer</td>
</tr>
<tr>
<td><code>view</code></td>
<td><code>string</code></td>
<td>optional, see <a href="https://api.mist.com/api/v1/docs/Org#Custom-Roles">supported UI views</a></td>
</tr>
</tbody>
</table>
<h2 id="update-sso-role">Update SSO Role</h2>
<pre><code>PUT /api/v1/orgs/:org_id/ssoroles/:ssorole_id
</code></pre>
<h3 id="request_52">Request</h3>
<pre><code>{
    "name": "NOC",
    "privileges": [
        { "scope":"site", "site_id": "d96e3952-53e8-4266-959a-45acd55f5114", "role": "write", "view": "location" },
        { "scope":"site", "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b", "role": "write", "view": "location" }
    ]
}
</code></pre>
<h2 id="get-all-sso-roles">Get All SSO Roles</h2>
<pre><code>GET /api/v1/orgs/:org_id/ssoroles
</code></pre>
<h2 id="delete-sso-role">Delete SSO Role</h2>
<pre><code>DELETE /api/v1/orgs/:org_id/ssoroles/:ssorole_id
</code></pre>
<h1 id="subscriptions">Subscriptions</h1>
<p>Subscriptions define how Org Alarms/Reports are delivered to whom</p>
<h2 id="subscribe">Subscribe</h2>
<pre><code>POST /api/v1/orgs/:org_id/subscriptions
</code></pre>
<h2 id="unsubscribe">Unsubscribe</h2>
<pre><code>DELETE /api/v1/orgs/:org_id/subscriptions
</code></pre>
<h2 id="get-all-the-subscriptions">Get all the subscriptions</h2>
<pre><code>GET /api/v1/self/subscriptions
</code></pre>
<h1 id="search">Search</h1>
<h2 id="search-devices">Search Devices</h2>
<pre><code>GET /api/v1/orgs/:org_id/devices/search?ip=10.2.16.205
</code></pre>
<h3 id="supported-filters-for-device-type-ap">Supported Filters for device type AP</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>hostname</code></td>
<td><code>string</code></td>
<td>partial / full hostname</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>device model</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>AP mac</td>
</tr>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>version</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>ip address</td>
</tr>
<tr>
<td><code>exp_ip</code></td>
<td><code>string</code></td>
<td>External IP Address</td>
</tr>
<tr>
<td><code>mxtunnel_status</code></td>
<td><code>string</code></td>
<td>MxTunnel status, up / down</td>
</tr>
<tr>
<td><code>mxedge_id</code></td>
<td><code>string</code></td>
<td>Mist Edge id, if AP is connecting to a Mist Edge</td>
</tr>
<tr>
<td><code>mxedge_ids</code></td>
<td><code>list</code></td>
<td>Mist Edge ids, if AP is connecting to a Mist Edge</td>
</tr>
<tr>
<td><code>lldp_system_name</code></td>
<td><code>string</code></td>
<td>LLDP system name</td>
</tr>
<tr>
<td><code>lldp_system_desc</code></td>
<td><code>string</code></td>
<td>LLDP system description</td>
</tr>
<tr>
<td><code>lldp_port_id</code></td>
<td><code>string</code></td>
<td>LLDP port id</td>
</tr>
<tr>
<td><code>lldp_mgmt_addr</code></td>
<td><code>string</code></td>
<td>LLDP management ip address</td>
</tr>
<tr>
<td><code>lldp_power_allocated</code></td>
<td><code>int</code></td>
<td>LLDP Allocated Power</td>
</tr>
<tr>
<td><code>lldp_power_draw</code></td>
<td><code>int</code></td>
<td>LLDP Negotiated Power</td>
</tr>
<tr>
<td><code>band_24_bandwidth</code></td>
<td><code>int</code></td>
<td>Bandwidth of band_24</td>
</tr>
<tr>
<td><code>band_5_bandwidth</code></td>
<td><code>int</code></td>
<td>Bandwidth of band_5</td>
</tr>
<tr>
<td><code>band_6_bandwidth</code></td>
<td><code>int</code></td>
<td>Bandwidth of band_6</td>
</tr>
<tr>
<td><code>band_24_channel</code></td>
<td><code>int</code></td>
<td>Channel of band_24</td>
</tr>
<tr>
<td><code>band_5_channel</code></td>
<td><code>int</code></td>
<td>Channel of band_5</td>
</tr>
<tr>
<td><code>band_6_channel</code></td>
<td><code>int</code></td>
<td>Channel of band_6</td>
</tr>
<tr>
<td><code>band_24_power</code></td>
<td><code>int</code></td>
<td>Power of band_24</td>
</tr>
<tr>
<td><code>band_5_power</code></td>
<td><code>int</code></td>
<td>Power of band_5</td>
</tr>
<tr>
<td><code>band_6_power</code></td>
<td><code>int</code></td>
<td>Power of band_6</td>
</tr>
<tr>
<td><code>eth0_port_speed</code></td>
<td><code>int</code></td>
<td>Port speed of eth0</td>
</tr>
<tr>
<td><code>power_constrained</code></td>
<td><code>boolean</code></td>
<td>if device is in Power Constrained mode</td>
</tr>
</tbody>
</table>
<h3 id="response-for-device-type-ap_1">Response for device type AP</h3>
<pre><code>{
    "results": [
        {
            "mac": "5c5b353e5299",
            "model": "AP41",
            "sku": "AP41-US",
            "ip": "10.2.16.205",
            "version": "0.7.20216",
            "uptime": 85280,
            "org_id": "6748cfa6-4e12-11e6-9188-0242ac110007",
            "site_id": "a8178443-ecb5-461c-b854-f16627619ab3",
            "mxedge_id": "00000000-0000-0000-1000-43a81f238391",
            "mxedge_ids": [
                "00000000-0000-0000-1000-43a81f238391"
            ],
            "mxtunnel_status": "down",
            "hostname": [
                            "AP41-STB-3E5299-WH-2001",
                            "AP41-STB-3E5299-WH-50",
                            "AP41-STB-3E5299",
                            "5c5b353e5299"
                        ],
            "lldp_port_desc": "GigabitEthernet1/0/1",
            "lldp_mgmt_addr": "10.2.10.139",
            "lldp_system_desc": "Cisco IOS Software, C2960S Software (C2960S-UNIVERSALK9-M), Version 15.2(1)E1, RELEASE SOFTWARE (fc2)\nTechnical Support: http://www.cisco.com/techsupport\nCopyright (c) 1986-2013 by Cisco Systems, Inc.\nCompiled Fri 22-Nov-13 07:10 by prod_rel_team",
            "lldp_system_name": "ME-DC-1-ACC-SW",
            "lldp_port_id": "Gi1/0/1",
            "lldp_power_draw": 19500,
            "lldp_power_allocated": 19500,
            "band_24_power": 18,
            "band_24_channel": 6,
            "band_6_power": 10,
            "band_6_channel": 5,
            "band_5_power": 17,
            "band_5_channel": 44,
            "eth0_port_speed": 1000,
            "ext_ip": "125.228.68.139",
            "timestamp": 1596588619.007,
            "power_constrained": false
        }
    ]
}

</code></pre>
<h3 id="supported-filters-for-device-type-switch-or-gateway">Supported Filters for device type Switch or Gateway</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td><strong>Required</strong>. switch, gateway (default is ap)</td>
</tr>
<tr>
<td><code>hostname</code></td>
<td><code>string</code></td>
<td>partial / full hostname</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>device model</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>device mac</td>
</tr>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>version</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>ip address</td>
</tr>
<tr>
<td><code>last_hostname</code></td>
<td><code>string</code></td>
<td>last hostname</td>
</tr>
<tr>
<td><code>cpu</code></td>
<td><code>string</code></td>
<td>max cpu usage</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>node0 / node1</td>
</tr>
<tr>
<td><code>node0_mac</code></td>
<td><code>string</code></td>
<td>mac for node0</td>
</tr>
<tr>
<td><code>node1_mac</code></td>
<td><code>string</code></td>
<td>mac for node1</td>
</tr>
<tr>
<td><code>ext_ip</code></td>
<td><code>string</code></td>
<td>external ip</td>
</tr>
<tr>
<td><code>clustered</code></td>
<td><code>string</code></td>
<td>true / false</td>
</tr>
<tr>
<td><code>t128agent_version</code></td>
<td><code>string</code></td>
<td>version of 128T agent</td>
</tr>
<tr>
<td><code>evpntopo_id</code></td>
<td><code>string</code></td>
<td>EVPN topology id</td>
</tr>
<tr>
<td><code>last_config_status</code></td>
<td><code>string</code></td>
<td>last configuration status of the switch/gateway</td>
</tr>
</tbody>
</table>
<h3 id="response-for-device-type-switch-or-gateway">Response for device type Switch or Gateway</h3>
<pre><code>{
    "results": [
        {
            "ip": "192.168.86.22",
            "type": "switch",
            "version": "21.4R1.12",
            "mac": "3c8c939485ad",
            "uptime": 2380356,
            "ext_ip": "0.0.0.0",
            "hostname": [
                "3c8c939485ad",
                "ludi-ex2300"
            ],
            "timestamp": 1661273225.321,
            "org_id": "6748cfa6-4e12-11e6-9188-0242ac110007",
            "num_members": 1,
            "site_id": "8721e817-96ee-4e34-b6b6-a80cc01642a6",
            "model": "ex2300-c-12p",
            "last_hostname": "3c8c939485ad"
            "last_config_status": "success"
        }
    ]
}

</code></pre>
<h2 id="count-devices">Count Devices</h2>
<pre><code>GET /api/v1/orgs/:org_id/devices/count?distinct=model
</code></pre>
<h3 id="response_99">Response</h3>
<pre><code>{
    "end": 1545874660.211871,
    "distinct": "model",
    "results": [
        {
            "count": 22,
            "model": "AP41-US"
        }
    ],
    "start": 1545788260.21184,
    "limit": 10,
    "total": 1
}
</code></pre>
<h2 id="search-devices-events">Search Devices Events</h2>
<pre><code>GET /api/v1/orgs/:org_id/devices/events/search?ip=10.2.10.22
</code></pre>
<h3 id="supported-filters_3">Supported Filters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>ap</code></td>
<td><code>string</code></td>
<td>AP mac</td>
</tr>
<tr>
<td><code>apfw</code></td>
<td><code>string</code></td>
<td>AP Firmware</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>device model</td>
</tr>
<tr>
<td><code>text</code></td>
<td><code>string</code></td>
<td>event message</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>string</code></td>
<td>event time</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td><a href="https://api.mist.com/api/v1/docs/Org#Supported-Events-Type">See Supported Events Type</a> (E.g. CLIENT_DNS_OK)</td>
</tr>
<tr>
<td><code>includes</code></td>
<td><code>string</code></td>
<td><strong>Optional</strong>. Keyword to include events from additional indices (e.g. <strong>ext_tunnel</strong> for  prisma events)</td>
</tr>
</tbody>
</table>
<h3 id="supported-events-type">Supported Events Type</h3>
<pre><code>GET /api/v1/const/device_events
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AP_CONFIG_CHANGED_BY_RRM</code></td>
</tr>
<tr>
<td><code>AP_CONFIG_CHANGED_BY_USER</code></td>
</tr>
<tr>
<td><code>AP_CONFIGURED</code></td>
</tr>
<tr>
<td><code>AP_RECONFIGURED</code></td>
</tr>
<tr>
<td><code>AP_RESTART_BY_USER</code></td>
</tr>
<tr>
<td><code>AP_RESTARTED</code></td>
</tr>
<tr>
<td><code>AP_RRM_ACTION</code></td>
</tr>
<tr>
<td><code>CLIENT_DNS_OK</code></td>
</tr>
<tr>
<td><code>MARVIS_DNS_FAILURE</code></td>
</tr>
<tr>
<td><code>...</code></td>
</tr>
</tbody>
</table>
<h3 id="response_100">Response</h3>
<pre><code>{
    "results": [
        {
            "org_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862a",
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "ap": "5c5b351e13b5",
            "apfw": "5c5b351e13b5",
            "model": "BT11-WW",
            "text": """Succeeding DNS query from 172.29.101.134 to 172.29.101.7 for "portal.mistsys.com" on vlan 1, id 60224""",
            "timestamp": 1547235620.89,
            "type": "CLIENT_DNS_OK"
        },
        ...
    ]
}

</code></pre>
<h2 id="fetch-most-recent-device-events">Fetch most recent device events.</h2>
<p>Return last/recent event for passed in field</p>
<pre><code>GET /api/v1/orgs/:org_id/devices/events/search?last_by=type
</code></pre>
<h3 id="response_101">Response</h3>
<pre><code>{
    "results": [
        {
            "timestamp": 1685566764.144,
            "org_id": "98272e44-d31d-4e9a-b52d-18ae2183446e",
            "site_id": "b60a57e3-dd74-4da3-af12-02987a141665",
            "port_id": "xe-2/2/2",
            "type": "SW_PORT_UP",
            "model": "EX4300-48MP",
            "device_type": "switch",
            "text": "SNMP_TRAP_LINK_UP: ifIndex 894, ifAdminStatus up(1), ifOperStatus up(1), ifName xe-2/2/2",
            "version": "21.4R3-S3.4",
            "mac": "c042d0f52a00"
        },
        {
            "timestamp": 1685566645.128,
            "org_id": "98272e44-d31d-4e9a-b52d-18ae2183446e",
            "site_id": "b60a57e3-dd74-4da3-af12-02987a141665",
            "type": "SW_VC_MEMBER_ADDED",
            "model": "EX4300-48MP",
            "device_type": "switch",
            "text": "CHASSISD_VCHASSIS_MEMBER_OP_NOTICE: Member change: vc add of member 2",
            "version": "21.4R3-S3.4",
            "mac": "c042d0f52a00"
        }
    ],
    "total": 234266
}
</code></pre>
<h2 id="fetch-most-recent-device-events-including-prisma-events">Fetch most recent device events including prisma events</h2>
<p>Return last/recent event for passed in field</p>
<pre><code>GET /api/v1/orgs/:org_id/devices/events/search?includes=ext_tunnel&amp;last_by=type
</code></pre>
<h3 id="response_102">Response</h3>
<pre><code>{
    "results": [
        {
            "timestamp": 1531855800.128,
            "org_id": "98272e44-d31d-4e9a-b52d-18ae2183446e",
            "site_id": "b60a57e3-dd74-4da3-af12-02987a141665",
            "type": "SW_VC_MEMBER_ADDED",
            "model": "EX4300-48MP",
            "device_type": "switch",
            "text": "CHASSISD_VCHASSIS_MEMBER_OP_NOTICE: Member change: vc add of member 2",
            "version": "21.4R3-S3.4",
            "mac": "c042d0f52a00"
        },
        {
           "tunnel_name": "Prisma-Tunnel-II",
           "type": "PRISMA_RN_SECONDARY_WAN_TUNNEL_UP",
           "text": "Remote Network Site RN_SITE_1 SECONDARY WAN Tunnel Stage-Tunnel2 is down",
           "timestamp": 1531856649,
           "ext_tunnel_site": "RN_SITE_1",
           "ext_tunnel_name": "Stage-Tunnel2",
           "ext_tunnel_event_id": b1b1ccdd-4444-4a2d-a81d-8888bc8f6fa1",
           "ext_tunnel_debug_url": "https://stratacloudmanager.paloaltonetworks.com/incidents-alerts/logviewer?logType=log.system&amp;query=Event%25C2%25A0Component%20=%20%27RN_SITE_1%27%20OR%20Event%25C2%25A0Component%20=%20%27Stage-Tunnel2%27%20&amp;timePreset=custom&amp;startTime=1745977906000&amp;endTime=1745980306000&amp;queryMode=lq",
           "site_id: "f1e17c67-8e42-4a2d-a81d-98ddbc8f6fa1",
           "org_id: "f3045b5a-f2ea-445e-b923-5bbb5a670c35",
           "device_type: "gateway",
           "mac: "00c52c3cfaa4",
           "port_id: "reth2.0",
           "ext_tunnel_provider": "prisma"
        },
    {
       "tunnel_name": "Prisma-Tunnel-II",
       "type": "PRISMA_RN_SECONDARY_WAN_TUNNEL_DOWN",
       "text": "Remote Network Site RN_SITE_1 SECONDARY WAN Tunnel Stage-Tunnel2 is down",
       "timestamp": 1531855849,
           "ext_tunnel_site": "RN_SITE_1",
           "ext_tunnel_name": "Stage-Tunnel2",
           "ext_tunnel_event_id": b1b1ccdd-4444-4a2d-a81d-8888bc8f6fa1",
           "ext_tunnel_debug_url": "https://stratacloudmanager.paloaltonetworks.com/incidents-alerts/logviewer?logType=log.system&amp;query=Event%25C2%25A0Component%20=%20%27RN_SITE_1%27%20OR%20Event%25C2%25A0Component%20=%20%27Stage-Tunnel2%27%20&amp;timePreset=custom&amp;startTime=1745977906000&amp;endTime=1745980306000&amp;queryMode=lq",
           "site_id: "f1e17c67-8e42-4a2d-a81d-98ddbc8f6fa1",
           "org_id: "f3045b5a-f2ea-445e-b923-5bbb5a670c35",
           "device_type: "gateway",
           "mac: "00c52c3cfaa4",
           "port_id: "reth2.0",
           "ext_tunnel_provider": "prisma"
    }
    ],
    "total": 234266
}
</code></pre>
<h2 id="count-devices-events">Count Devices Events</h2>
<pre><code>GET /api/v1/orgs/:org_id/devices/events/count?distinct=model
</code></pre>
<h3 id="response_103">Response</h3>
<pre><code>{
    "end": 1545874660.211871,
    "distinct": "model",
    "results": [
        {
            "count": 22,
            "model": "AP41-US"
        }
    ],
    "start": 1545788260.21184,
    "limit": 10,
    "total": 1
}
</code></pre>
<h2 id="count-devices-events-including-prisma-events">Count Devices Events including prisma events</h2>
<pre><code>GET /api/v1/orgs/:org_id/devices/events/count?includes=ext_tunnel&amp;distinct=type
</code></pre>
<h3 id="response_104">Response</h3>
<pre><code>{
    "distinct": "type",
    "results": [
        {
            "count": 1,
            "type": "PRISMA_RN_PRIMARY_WAN_TUNNEL_UP"
        },
        {
            "count": 1,
            "type": "PRISMA_RN_PRIMARY_WAN_TUNNEL_DOWN"
        },
        {
            "count": 2,
            "type": "PRISMA_RN_SECONDARY_WAN_BGP_DOWN"
        },
        {
            "count": 1,
            "type": "PRISMA_RN_SECONDARY_WAN_BGP_UP"
        }
    ],
    "start": 1531776183.0,
    "end": 1531862583.0,
    "limit": 10,
    "total": 4
}
</code></pre>
<h2 id="search-device-last-configs">Search Device Last Configs</h2>
<pre><code>GET /api/v1/orgs/:org_id/devices/last_config/search?device_type=ap&amp;mac=5c5b350e0001&amp;start=1531776183&amp;end=1531862583&amp;limit=10
</code></pre>
<h3 id="request-parameters">Request Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>device_type</code></td>
<td><code>string</code></td>
<td>ap (default) / switch / gateway</td>
</tr>
</tbody>
</table>
<h3 id="response_105">Response</h3>
<p>see (Search Device Config History)[Site#search-device-config-history]</p>
<h2 id="count-device-last-configs">Count Device Last Configs</h2>
<p>Counts the number of entries in device config history for distinct field with given filters</p>
<pre><code>GET /api/v1/orgs/:org_id/devices/last_config/count?device-type=ap&amp;distinct=mac&amp;start=1531776183&amp;end=1531862583&amp;limit=10
</code></pre>
<h2 id="search-wireless-clients">Search Wireless Clients</h2>
<pre><code>GET /api/v1/orgs/:org_id/clients/search?hostname=john&amp;limit=10
</code></pre>
<h3 id="supported-filters_4">Supported Filters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>partial / full MAC address</td>
</tr>
<tr>
<td><code>hostname</code></td>
<td><code>string</code></td>
<td>partial / full hostname</td>
</tr>
<tr>
<td><code>device</code></td>
<td><code>string</code></td>
<td>device type, e.g. Mac, Nvidia, iPhone</td>
</tr>
<tr>
<td><code>os</code></td>
<td><code>string</code></td>
<td>os, e.g. Sierra, Yosemite, Windows 10</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>model, e.g. “MBP 15 late 2013”, 6, 6s, “8+ GSM”</td>
</tr>
<tr>
<td><code>ap</code></td>
<td><code>string</code></td>
<td>AP mac where the client has connected to</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>SSID</td>
</tr>
<tr>
<td><code>vlan</code></td>
<td><code>string</code></td>
<td>vlan</td>
</tr>
<tr>
<td><code>psk_id</code></td>
<td><code>string</code></td>
<td>PSK ID</td>
</tr>
<tr>
<td><code>psk_name</code></td>
<td><code>string</code></td>
<td>PSK name</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>ip address</td>
</tr>
<tr>
<td><code>text</code></td>
<td><code>string</code></td>
<td>partial / full MAC address, hostname, username, psk_name or ip</td>
</tr>
</tbody>
</table>
<h3 id="response_106">Response</h3>
<pre><code>{
    "results": [
        {
            "hostname": [
                "jerry"
            ],
            "ap": [
                "5c5b350e0492",
                "5c5b350eb39d",
                "5c5b350e03c0"
            ],
            "ip": [
                "192.168.5.43",
                "192.168.20.125"
            ],
            "vlan": [
                1
            ],
            "mac": "60f81dd250cc",
            "device": [
                "Mac"
            ],
            "os": [
                "Sierra",
                "High Sierra"
            ],
            "model": [
                "",
                "MBP 15\" late 2013"
            ],
            "ssid": [
                "Guest"
            ],
            "psk_id": [
                "9d31efe6-e205-47eb-9f1d-dd66d8ef66bd"
            ],
            "psk_name": [
                "test key"
            ],
        }
        ...
    ]
}
</code></pre>
<h2 id="count-by-distinct-client-search-attributes">Count by Distinct Client-Search Attributes</h2>
<pre><code>GET /api/v1/orgs/:org_id/clients/count?distinct=hostname
</code></pre>
<h3 id="request_53">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>ssid, ap, ip, vlan, hostname, os, model, device, default is device</td>
</tr>
</tbody>
</table>
<p>NOTE: the filters from /clients/search can also be used. E.g. <code>/clients/count?device=iphone&amp;distinct=os</code></p>
<h2 id="search-client-events">Search Client Events</h2>
<pre><code>GET /api/v1/orgs/:org_id/clients/events/search
</code></pre>
<h3 id="request_54">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>event type, e.g. MARVIS_EVENT_CLIENT_FBT_FAILURE</td>
</tr>
<tr>
<td><code>reason_code</code></td>
<td><code>int</code></td>
<td>for assoc/disassoc events</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>SSID</td>
</tr>
<tr>
<td><code>ap</code></td>
<td><code>string</code></td>
<td>AP MAC</td>
</tr>
<tr>
<td><code>proto</code></td>
<td><code>string</code></td>
<td>b / g / n / a / ac</td>
</tr>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>5 / 24</td>
</tr>
<tr>
<td><code>wlan_id</code></td>
<td><code>string</code></td>
<td>wlan_id</td>
</tr>
<tr>
<td><code>nacrule_id</code></td>
<td><code>string</code></td>
<td>nacrule_id</td>
</tr>
</tbody>
</table>
<h3 id="response_107">Response</h3>
<pre><code>{
    "start": 1512572151,
    "end": 1513176951,
    "limit": 10,

    "total": 1,
    "results": [
        {
            "ap": "5c5b350eb31b",
            "ssid": "Guest",
            "bssid": "5c5b350918f1",
            "proto": "ac",
            "timestamp": 1513358874.667,
            "band": "5",
            "type_code": 15,
            "type": "CLIENT_DNS_OK",
            "text": "Status code 0 \"Successful\" ",
            "channel": 149,
            "wlan_id": "be22bba7-8e22-e1cf-5185-b880816fe2cf"
        }
    ]
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-client-events">Count by Distinct Attributes of Client-Events</h2>
<pre><code>GET /api/v1/orgs/:org_id/clients/events/count?distinct=type
</code></pre>
<h3 id="request_55">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>type / proto / band / channel / wlan_id / ssid</td>
</tr>
</tbody>
</table>
<p>NOTE: the filters from /clients/:mac/events can also be used. E.g. <code>/clients/events/count?distinct=device&amp;ssid=Guest</code></p>
<h3 id="response_108">Response</h3>
<pre><code>{
    "start": 1513276353,
    "end": 1513362753,
    "limit": 3,

    "total": 3,
    "results": [
        {
            "count": 580,
            "type": "CLIENT_AUTHENTICATED"
        },
        {
            "count": 536,
            "type": "CLIENT_GW_ARP_OK"
        },
        {
            "count": 519,
            "type": "CLIENT_ASSOCIATION"
        }
    ]
}
</code></pre>
<h2 id="search-client-sessions">Search Client Sessions</h2>
<pre><code>GET /api/v1/orgs/:org_id/clients/sessions/search
</code></pre>
<h3 id="request_56">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ap</code></td>
<td><code>string</code></td>
<td>AP MAC</td>
</tr>
<tr>
<td><code>band</code></td>
<td><code>string</code></td>
<td>5 / 24</td>
</tr>
<tr>
<td><code>client_family</code></td>
<td><code>string</code></td>
<td>E.g. “Mac”, “iPhone”, “Apple watch”</td>
</tr>
<tr>
<td><code>client_manufacture</code></td>
<td><code>string</code></td>
<td>E.g. “Apple”</td>
</tr>
<tr>
<td><code>client_model</code></td>
<td><code>string</code></td>
<td>E.g. “8+”, “XS”</td>
</tr>
<tr>
<td><code>client_os</code></td>
<td><code>string</code></td>
<td>E.g. “Mojave”, “Windows 10”, “Linux”</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>SSID</td>
</tr>
<tr>
<td><code>wlan_id</code></td>
<td><code>string</code></td>
<td>wlan_id</td>
</tr>
<tr>
<td><code>psk_id</code></td>
<td><code>string</code></td>
<td>PSK ID</td>
</tr>
<tr>
<td><code>psk_name</code></td>
<td><code>string</code></td>
<td>PSK name</td>
</tr>
</tbody>
</table>
<h3 id="response_109">Response</h3>
<pre><code>{
    "start": 1511967600,
    "end": 1513177200,
    "limit": 10,
    "total": 100,
    "results": [
        {
            "ap": "5c5b350e0262",
            "disconnect": 1565208448.662,
            "ssid": "Dummy WLAN 2",
            "tags": [
                "disassociate"
            ],
            "org_id": "3139f2c2-fac6-11e5-8156-0242ac110006",
            "site_id": "70e0f468-fc13-11e5-85ad-0242ac110008",
            "mac": "b019c66c8348",
            "connect": 1565208388.568,
            "band": "5",
            "timestamp": 1565208448.662,
            "duration": 60.09423865,
            "client_manufacture": "Apple",
            "wlan_id": "99bb4c74-f954-4f36-b844-6b030faffabc",
            "psk_id": "8a4a134b-210a-4908-a6be-105dca78e226",
            "psk_name": "test key"
        },
        ...
    ]
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-client-sessions">Count by Distinct Attributes of Client Sessions</h2>
<pre><code>GET /api/v1/orgs/:org_id/clients/sessions/count
</code></pre>
<h3 id="request_57">Request</h3>
<p>In addition to the filters that you can have in the search</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>ssid, wlan_id, ap, mac, client_family, client_manufacture, client_model, client_os, site_id, default is mac</td>
</tr>
</tbody>
</table>
<p>NOTE: the filters from /clients/sessions/search can also be used. (E.g. <code>/clients/count?distinct=client_manufacture</code>)</p>
<h3 id="response_110">Response</h3>
<pre><code>{
    "start": 1511967600,
    "end": 1513177200,
    "limit": 100,
    "distinct": "client_manufacture",
    "total": 20,
    "results": [
        {
            "count": 217,
            "client_manufacture": "Apple"
        },
        {
            "count": 35,
            "client_manufacture": "Intel Corporate"
        },
        ...
    ]
}
</code></pre>
<h2 id="get-org-guest-authorizations">Get Org Guest Authorizations</h2>
<pre><code>GET /api/v1/orgs/:org_id/guests
</code></pre>
<h3 id="response_111">Response</h3>
<pre><code>[
    {
        "mac": "5684dae9ac8b",
        "authorized": true,
        "authorized_time": 1480704355,
        "authorized_expiring_time": 1480704955,
        "name": "John Smith",
        "email": "john@abc.com",
        "company": "abc",
        "field1": "xxx",
        "wlan_id": "6748cfa6-4e12-11e6-9188-0242ac110007",
        "ssid": "SSID"
    }
]
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>mac</td>
</tr>
<tr>
<td><code>authorized</code></td>
<td><code>boolean</code></td>
<td>whether the guest is current authorized</td>
</tr>
<tr>
<td><code>authorized_time</code></td>
<td><code>long</code></td>
<td>when the guest was authorized</td>
</tr>
<tr>
<td><code>authorized_expiring_time</code></td>
<td><code>long</code></td>
<td>when the authorization would expire</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>optional, the info provided by user</td>
</tr>
<tr>
<td><code>email</code></td>
<td><code>string</code></td>
<td>optional, the info provided by user</td>
</tr>
<tr>
<td><code>company</code></td>
<td><code>string</code></td>
<td>optional, the info provided by user</td>
</tr>
<tr>
<td><code>field1</code></td>
<td><code>string</code></td>
<td>optional, the info provided by user</td>
</tr>
<tr>
<td><code>wlan_id</code></td>
<td><code>string</code></td>
<td>wlan_id</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>ssid</td>
</tr>
</tbody>
</table>
<h2 id="get-guest-authorization">Get Guest Authorization</h2>
<pre><code>GET /api/v1/orgs/:org_id/guests/:guest_mac
</code></pre>
<h3 id="response_112">Response</h3>
<pre><code>[
    {
        "mac": "5684dae9ac8b",
        "authorized": true,
        "authorized_time": 1480704355,
        "authorized_expiring_time": 1480704955,
        "name": "John Smith",
        "email": "john@abc.com",
        "company": "abc",
        "field1": "xxx",
        "wlan_id": "6748cfa6-4e12-11e6-9188-0242ac110007",
        "ssid": "SSID"

    }
]
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>mac</td>
</tr>
<tr>
<td><code>authorized</code></td>
<td><code>boolean</code></td>
<td>whether the guest is current authorized</td>
</tr>
<tr>
<td><code>authorized_time</code></td>
<td><code>long</code></td>
<td>when the guest was authorized</td>
</tr>
<tr>
<td><code>authorized_expiring_time</code></td>
<td><code>long</code></td>
<td>when the authorization would expire</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>optional, the info provided by user</td>
</tr>
<tr>
<td><code>email</code></td>
<td><code>string</code></td>
<td>optional, the info provided by user</td>
</tr>
<tr>
<td><code>company</code></td>
<td><code>string</code></td>
<td>optional, the info provided by user</td>
</tr>
<tr>
<td><code>field1</code></td>
<td><code>string</code></td>
<td>optional, the info provided by user</td>
</tr>
<tr>
<td><code>wlan_id</code></td>
<td><code>string</code></td>
<td>wlan_id</td>
</tr>
</tbody>
</table>
<h2 id="update-guest-authorization">Update Guest Authorization</h2>
<pre><code>PUT /api/v1/orgs/:org_id/guests/:guest_mac
</code></pre>
<h3 id="request_58">Request</h3>
<pre><code>{
    "name": "guest1",
    "email": "guest1@email.com",
    "company":"companyXYZ",
    "minutes": 60,
    "field1": "value1",
    "wlan_id": "6748cfa6-4e12-11e6-9188-0242ac110007"
    ......
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>minutes</code></td>
<td><code>int</code></td>
<td>minutes, the maximum is 259200 (180 days)</td>
</tr>
<tr>
<td><code>wlan_id</code></td>
<td><code>string</code></td>
<td>wlan_id which has <code>cross_site</code> enabled in portal settings</td>
</tr>
</tbody>
</table>
<h2 id="delete-guest-authorization">Delete Guest Authorization</h2>
<pre><code>DELETE /api/v1/orgs/:org_id/guests/:guest_mac
</code></pre>
<h2 id="search-authorized-guest">Search Authorized Guest</h2>
<pre><code>GET /api/v1/orgs/:org_id/guests/search?wlan_id=88ffe630-95b8-11e8-b294-346895ed1b7d&amp;limit=2
</code></pre>
<h3 id="response_113">Response</h3>
<pre><code>{
    "end": 1531862583.0,
    "results": [
        {
            "ssid": "openNet",
            "timestamp": 1531782218,
            "company": "mistsystems",
            "auth_method": "passphrase",
            "ap": "5c5b350e0001",
            "authorized_expiring_time": 1531810258.186273,
            "authorized_time": 1531782218,
            "email": "user@mistsys.com",
            "name": "john"
        },
        {
            "ssid": "openNet",
            "timestamp": 1531782632,
            "company": "xyz inc.",
            "auth_method": "facebook",
            "ap": "5c5b350e0001",
            "authorized_expiring_time": 1531810821.145,
            "authorized_time": 1531782632,
            "email": "cool_user@yahoo.com",
            "name": "John White"
        }
    ],
    "next": "/api/v1/orgs/8aaba0aa-09cc-44bd-9709-33b98040550c/guests/search?wlan_id=88ffe630-95b8-11e8-b294-346895ed1b7d&amp;end=1531855849.000&amp;limit=2&amp;start=1531776183.0",
    "start": 1531776183.0,
    "limit": 2,
    "total": 14
}
</code></pre>
<h2 id="count-authorized-guest">Count Authorized Guest</h2>
<pre><code>GET /api/v1/orgs/:org_id/guests/count?distinct=auth_method
</code></pre>
<h3 id="response_114">Response</h3>
<pre><code>{
    "end": 1531862583.0,
    "results": [
        {
            "auth_method": "passphrase",
            "count": 2
        },
        {
            "auth_method": "facebook",
            "count": 4
        }
    ],
    "start": 1531776183.0,
    "total": 2
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-skyatp-events-wip">Count by Distinct Attributes of Skyatp Events (WIP)</h2>
<pre><code>GET /api/v1/orgs/:org_id/skyatp/events/count?distinct=type
</code></pre>
<h3 id="request_59">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>type, mac, device_mac, threat_level, default is type</td>
</tr>
</tbody>
</table>
<h3 id="response_115">Response</h3>
<pre><code>{
    "start": 1511967600,
    "end": 1513177200,
    "limit": 10,
    "distinct": "type",

    "total": 2,
    "results": [
        {
            "type": "mw",
            "count": 6
        },
        {
            "device": "fs",
            "count": 3
        }
    ]
}
</code></pre>
<h2 id="search-skyatp-events-wip">Search Skyatp Events (WIP)</h2>
<pre><code>GET /api/v1/orgs/:org_id/skyatp/events/search
</code></pre>
<h3 id="request_60">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>event type, e.g. cc, fs, mw</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>client MAC</td>
</tr>
<tr>
<td><code>device_mac</code></td>
<td><code>string</code></td>
<td>device MAC</td>
</tr>
<tr>
<td><code>threat_level</code></td>
<td><code>int</code></td>
<td>threat level</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>client ip</td>
</tr>
</tbody>
</table>
<h3 id="response_116">Response</h3>
<pre><code>{
    "start": 1512572151,
    "end": 1513176951,
    "limit": 10,

    "total": 1,
    "results": [
        {
            "mac": "b019c66c8348",
            "threat_level": 7,
            "device_mac": "658279bb1fa4",
            "timestamp": 1592524478,
            "org_id": "3139f2c2-fac6-11e5-8156-0242ac110006",
            "site_id": "70e0f468-fc13-11e5-85ad-0242ac110008",
            "type": "cc",
            "ip": "172.16.0.11"
        }
    ]
}
</code></pre>
<h2 id="search-sites">Search Sites</h2>
<pre><code>GET /api/v1/orgs/:org_id/sites/search?honeypot_enabled=true
</code></pre>
<h3 id="supported-filters_5">Supported Filters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>site name</td>
</tr>
<tr>
<td><code>country_code</code></td>
<td><code>string</code></td>
<td>site country code</td>
</tr>
<tr>
<td><code>wifi_enabled</code></td>
<td><code>boolean</code></td>
<td>if WIFI feature is enabled</td>
</tr>
<tr>
<td><code>locate_unconnected</code></td>
<td><code>boolean</code></td>
<td>if unconnected clients are located</td>
</tr>
<tr>
<td><code>mesh_enabled</code></td>
<td><code>boolean</code></td>
<td>if Mesh feature is enabled</td>
</tr>
<tr>
<td><code>rtsa_enabled</code></td>
<td><code>boolean</code></td>
<td>if managed mobility feature is enabled</td>
</tr>
<tr>
<td><code>asset_enabled</code></td>
<td><code>boolean</code></td>
<td>if Asset Tracking is enabled</td>
</tr>
<tr>
<td><code>app_waking</code></td>
<td><code>boolean</code></td>
<td>if App Waking feature is enabled</td>
</tr>
<tr>
<td><code>vna_enabled</code></td>
<td><code>boolean</code></td>
<td>if Virtual Network Assistant is enabled</td>
</tr>
<tr>
<td><code>analytic_enabled</code></td>
<td><code>boolean</code></td>
<td>if Advanced Analytic feature is enabled</td>
</tr>
<tr>
<td><code>auto_upgrade_enabled</code></td>
<td><code>boolean</code></td>
<td>if Auto Upgrade feature is enabled</td>
</tr>
<tr>
<td><code>auto_upgrade_version</code></td>
<td><code>string</code></td>
<td>Auto Upgrade version</td>
</tr>
<tr>
<td><code>rogue_enabled</code></td>
<td><code>boolean</code></td>
<td>if Rogue detection is enabled</td>
</tr>
<tr>
<td><code>honeypot_enabled</code></td>
<td><code>boolean</code></td>
<td>if Honeypot detection is enabled</td>
</tr>
<tr>
<td><code>remote_syslog_enabled</code></td>
<td><code>boolean</code></td>
<td>if Remote Syslog is enabled</td>
</tr>
</tbody>
</table>
<h3 id="response_117">Response</h3>
<pre><code>{
    "results": [
        {
            "rogue_enabled": true,
            "honeypot_enabled": true,
            "mesh_enabled": true,
            "locate_unconnected": true,
            "wifi_enabled": true,
            "timezone": "America/Los_Angeles",
            "country_code": "US",
            "created_time": 1670284377.225059,
            "modified_time": 1687888493.799605,
            "org_id": "3139f2c2-fac6-11e5-8156-0242ac110006",
            "name": "Mist Site",
            "id": "70e0f468-fc13-11e5-85ad-0242ac110008",
            "auto_upgrade_version": "stable",
            "auto_upgrade_enabled": true,
            "analytic_enabled": true
        }
    ],
    "limit": 10,
    "total": 1
}

</code></pre>
<h2 id="count-sites">Count Sites</h2>
<pre><code>GET /api/v1/orgs/:org_id/sites/count?distinct=country_code
</code></pre>
<h3 id="request_61">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>all supported filters, default is <code>id</code></td>
</tr>
</tbody>
</table>
<h3 id="response_118">Response</h3>
<pre><code>{
    "results": [
        {
            "country_code": "US",
            "count": 15
        },
        {
            "country_code": "IN",
            "count": 2
        },
        {
            "country_code": "SE",
            "count": 1
        }
    ],
    "distinct": "country_code",
    "limit": 10,
    "total": 3
}
</code></pre>
<h2 id="search-switch-gateway-ports">Search Switch / Gateway Ports</h2>
<pre><code>GET /api/v1/orgs/:org_id/stats/ports/search
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#search-switch-gateway-ports">Site:Search Switch / Gateway Ports</a> for API request &amp; response details.</p>
<h2 id="count-by-distinct-attributes-of-switch-ports">Count by Distinct Attributes of Switch Ports</h2>
<pre><code>GET /api/v1/orgs/:org_id/stats/ports/count
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#count-by-distinct-attributes-of-switch-ports">Site:Count by Distinct Attributes of Switch Ports</a> for API request &amp; response details.</p>
<h1 id="security-policy">Security Policy</h1>
<h2 id="overview">Overview</h2>
<p>Security Policy is designed to audit / catch discripancies between “what’s intended to be running” versus “what’s
actually running” in a network. Many big organizations have separated Security and IT team (for good reasons). Each site
can be assigned a security policy. Whenever an AP is provisioned, the configuration will be checked against the security
policy. Any violations will be flagged in  <a href="https://api.mist.com/api/v1/docs/Site#search-device-config-history">Device Config History</a> where you can
search for the when and where the violation occurs.</p>
<h3 id="base-uri_10">Base URI</h3>
<pre><code>/api/v1/orgs/:org_id/secpolicies
</code></pre>
<h3 id="schema_1">Schema</h3>
<pre><code>{
    "name": "corporate only",
    "wlans": [
        {
            "ssid": "office",
            "band": "both",
            "auth": {
                "type": "psk",
                "pairwise": ["wpa1-tkip", "wpa2-tkip"]
            }
        },
        {
            "ssid": "office-guest",
            "band": "5",
            "auth": {
                "type": "open"
            }
        }
    ]
}
</code></pre>
<h1 id="alarm">Alarm</h1>
<h2 id="overview_1">Overview</h2>
<p>Alarms are triggered based on certain events. Alarms could be configured using an Alarm Template.</p>
<p>An Alarm Template is a set of Alarm Rules that could be applied to one or more sites (while each site can only pick one
Alarm Template), or to the whole org.</p>
<h1 id="alarm-templates">Alarm Templates</h1>
<h4 id="base-uri_11">Base URI</h4>
<pre><code>/api/v1/orgs/:org_id/alarmtemplates
</code></pre>
<h2 id="create-alarm-template">Create Alarm Template</h2>
<pre><code>POST /api/v1/orgs/:org_id/alarmtemplates
</code></pre>
<h4 id="body">Body</h4>
<pre><code>{
    "name": "Global",
    "delivery": {
        "enabled": false,
        "to_org_admins": true,
        "to_site_admins": true,
        "additional_emails": []
    },
    "rules": {
        "switch_down": { // here switch_down is an &lt;alarm-key&gt;
            "enabled": true,
        },
        "device_down": {
            "enabled": true,

            // optional, if different from that in the template
            "delivery": {
                "enabled": false,
                "to_org_admins": true,
                "to_site_admins": true,
                "additional_emails": []
            }
        }
    }
}
</code></pre>
<h4 id="parameters_53">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td>string</td>
<td>path</td>
</tr>
<tr>
<td><code>name</code></td>
<td>string</td>
<td>body</td>
</tr>
<tr>
<td><code>delivery</code></td>
<td>object</td>
<td>body</td>
</tr>
<tr>
<td><code>rules</code></td>
<td>object</td>
<td>body</td>
</tr>
</tbody>
</table>
<h4 id="delivery"><code>delivery</code></h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>enabled</code></td>
<td>boolean</td>
<td>body</td>
</tr>
<tr>
<td><code>to_org_admins</code></td>
<td>boolean</td>
<td>body</td>
</tr>
<tr>
<td><code>to_site_admins</code></td>
<td>boolean</td>
<td>body</td>
</tr>
<tr>
<td><code>additional_emails</code></td>
<td>list</td>
<td>body</td>
</tr>
</tbody>
</table>
<h4 id="rules"><code>rules</code></h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&lt;alarm key&gt;</code></td>
<td>object</td>
<td>body</td>
</tr>
<tr>
<td>etc.)</td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>enabled</code></td>
<td>boolean</td>
<td>body</td>
</tr>
<tr>
<td><code>delivery</code></td>
<td>object</td>
<td>body</td>
</tr>
<tr>
<td>than the Alarm Template level <code>delivery</code> object)</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="response_119">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h4 id="body_1">Body</h4>
<pre><code>{
    "id": "684dfc5c-fe77-2290-eb1d-ef3d677fe168",
    "name": "Global",
    "delivery": {
        "enabled": false,
        "to_org_admins": true,
        "to_site_admins": true,
        "additional_emails": []
    },
    "rules": {
        "switch_down": {
            "enabled": true,
        },
        "device_down": {
            "enabled": true,

            // optional, if different from that in the template
            "delivery": {
                "enabled": false,
                "to_org_admins": true,
                "to_site_admins": true,
                "additional_emails": []
            }
        }
    }
}
</code></pre>
<h4 id="definitions_22">Definitions</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>UUID of the Alarm Template</td>
</tr>
</tbody>
</table>
<p>Note: Rest of the fields are same as defined in the API
request <a href="https://api.mist.com/api/v1/docs/Org#create-alarm-template">Org:Alarm Template:Create Alarm Template:Response:Body</a>.</p>
<h2 id="list-all-alarm-templates">List all Alarm Templates</h2>
<pre><code>GET /api/v1/orgs/:org_id/alarmtemplates
</code></pre>
<h4 id="parameters_54">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td>string</td>
<td>path</td>
</tr>
</tbody>
</table>
<h3 id="response_120">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h4 id="body_2">Body</h4>
<p>List of Alarm Templates</p>
<h2 id="get-an-alarm-template">Get an Alarm Template</h2>
<pre><code>GET /api/v1/orgs/:org_id/alarmtemplates/:alarmtemplate_id
</code></pre>
<h4 id="parameters_55">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td>string</td>
<td>path</td>
</tr>
<tr>
<td><code>alarmtemplate_id</code></td>
<td>string</td>
<td>path</td>
</tr>
</tbody>
</table>
<h3 id="response_121">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h4 id="body_3">Body</h4>
<p>See <a href="https://api.mist.com/api/v1/docs/Org#create-alarm-template">Org:Alarm Template:Create Alarm Template:Response:Body</a></p>
<h2 id="update-an-alarm-template">Update an Alarm Template</h2>
<pre><code>PUT /api/v1/orgs/:org_id/alarmtemplates/:alarmtemplate_id
</code></pre>
<h4 id="body_4">Body</h4>
<p>See <a href="https://api.mist.com/api/v1/docs/Org#create-alarm-template">Org:Alarm Template:Create Alarm Template:Body</a></p>
<h4 id="parameters_56">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td>string</td>
<td>path</td>
</tr>
<tr>
<td><code>alarmtemplate_id</code></td>
<td>string</td>
<td>path</td>
</tr>
</tbody>
</table>
<h3 id="response_122">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h4 id="body_5">Body</h4>
<p>See <a href="https://api.mist.com/api/v1/docs/Org#create-alarm-template">Org:Alarm Template:Create Alarm Template:Response:Body</a></p>
<h2 id="delete-an-alarm-template">Delete an Alarm Template</h2>
<pre><code>DELETE /api/v1/orgs/:org_id/alarmtemplates/:alarmtemplate_id
</code></pre>
<h4 id="parameters_57">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td>string</td>
<td>path</td>
</tr>
<tr>
<td><code>alarmtemplate_id</code></td>
<td>string</td>
<td>path</td>
</tr>
</tbody>
</table>
<h3 id="response_123">Response</h3>
<pre><code>Status: 200 OK
</code></pre>
<h2 id="get-alarm-definitions">Get Alarm Definitions</h2>
<p>Get brief definitions of all the supported alarm types. The example field contains an example payload as you would
recieve in the alarm webhook output.</p>
<pre><code>GET /api/v1/const/alarm_defs
</code></pre>
<h3 id="response_124">Response</h3>
<pre><code>[
    {
        "key": "device_down",
        "display": "Device offline",
        "group": "infrastructure",
        "severity": "warn",
        "example": {
            "severity": "warn",
            "timestamp": 1629753888,
            "last_seen": 1629753888,
            "aps": [
                "d420b02000fa"
            ],
            "org_id": "09dac91f-6e73-4100-89f7-698e0fafbb1b",
            "site_id": "dcfb31a1-d615-4361-8c95-b9dde05aa704",
            "count": 1,
            "hostnames": [
                "Vendor_AP2"
            ],
            "id": "f70c308f-7007-4866-9ecd-0d01842979ea",
            "type": "device_down",
            "group": "infrastructure"
        },
        "fields": [
            "aps",
            "hostnames"
        ]
    },
    ...
]
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>key</code></td>
<td><code>string</code></td>
<td>Key name of an alarm type</td>
</tr>
<tr>
<td><code>display</code></td>
<td><code>string</code></td>
<td>Description of the alarm type</td>
</tr>
<tr>
<td><code>group</code></td>
<td><code>string</code></td>
<td>Group to which the alarm belongs</td>
</tr>
<tr>
<td><code>marvis_suggestion_category</code></td>
<td><code>string</code></td>
<td>Marvis defined category to which the alarm belongs</td>
</tr>
<tr>
<td><code>severity</code></td>
<td><code>string</code></td>
<td>Severity of the alarm</td>
</tr>
<tr>
<td><code>fields</code></td>
<td><code>list</code></td>
<td>(optional)List of fields available in an alarm details payload (in REST APIs &amp; Webhooks); e.g. <code>aps</code>, <code>switches</code>, <code>gateways</code>, <code>hostnames</code>, <code>ssids</code>, <code>bssids</code> etc; see <a href="https://api.mist.com/api/v1/docs/Site#additional-information">Site:Get Alarms:Additional Information</a> for more details</td>
</tr>
</tbody>
</table>
<h2 id="suppress-alarms-for-a-period-of-time">Suppress Alarms for a period of time</h2>
<p>In certain situations, for example, scheduled maintenance, you may want to suspend alarms to be triggered against Sites
for a period of time.</p>
<pre><code>POST /api/v1/orgs/:org_id/alarmtemplates/suppress
</code></pre>
<h3 id="request_62">Request</h3>
<pre><code>{
    "duration": 3600,  // 0 is to un-suppress alarms
    "scheduled_time": 1678232980,
    "scope": "site",  // default is site
    "applies": {
        "org_id": "2818e386-8dec-2562-9ede-5b8a0fbbdc71",
        "sitegroup_ids": [ "581328b6-e382-f54e-c9dc-999983183a34", "f57096b9-0c2f-4df6-c77b-ae6ae87a3d43" ],
        "site_ids": [ "4ac1dcf4-9d8b-7211-65c4-057819f0862b" ]
    }
}

// to suppress org alarms
{
    "duration": 3600,  // 0 is to un-suppress alarms
    "scheduled_time": 1678232980,
    "scope": "org"
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>duration</code></td>
<td>int</td>
<td>duration, in seconds. Default is 3600. Maximum duration is 86400 * 180 (180 days). 0 is to un-suppress alarms.</td>
</tr>
<tr>
<td><code>scheduled_time</code></td>
<td>int</td>
<td>epoch_time in seconds, Default as now, accepted time range is from now to now + 7 days.</td>
</tr>
<tr>
<td><code>scope</code></td>
<td>string</td>
<td>level of scope, either org or site, default is site.</td>
</tr>
<tr>
<td><code>applies</code></td>
<td>object</td>
<td>Object defines the scope (within the org e.g. whole org, and/or some site-groups, and/or some sites) for which the alarm service has to be suppressed for some <code>duration</code></td>
</tr>
<tr>
<td><code>org_id</code></td>
<td>string</td>
<td>UUID of the current org (if provided, the alarms will be suppressed at org level)</td>
</tr>
<tr>
<td><code>sitegroups_ids</code></td>
<td>string</td>
<td>List of UUID of the site groups within the org (if provided, the alarms will be suppressed for all the sites under those site groups)</td>
</tr>
<tr>
<td><code>site_ids</code></td>
<td>string</td>
<td>List of UUID of the sites within the org (if provided, the alarms will be suppressed for all the mentioned sites under the org)</td>
</tr>
</tbody>
</table>
<h2 id="get-current-suppressed-alarms">GET Current Suppressed Alarms</h2>
<pre><code>GET /api/v1/orgs/:org_id/alarmtemplates/suppress?scope=site
</code></pre>
<h3 id="request_63">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>scope</code></td>
<td><code>string</code></td>
<td>scope org/site; returns both scopes if not specified.</td>
</tr>
</tbody>
</table>
<h3 id="response_125">Response</h3>
<pre><code>{
    "results": [
        {
            "site_id": "581328b6-e382-f54e-c9dc-9c998d183a34",
            "expire_time": 1678233080,
            "scheduled_time": 1678232900,
            "duration": 48,    // remaining duration
            "scope": "site",
        },
        {
            "site_id": "581328b6-e382-f54e-c9dc-9c998d183a35",
            "expire_time": 1678233080,
            "scheduled_time": 1678232900,
            "duration": 48,    // remaining duration
            "scope": "org",
        }
    ]
}

</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>site_id</code></td>
<td>string</td>
<td>site_id</td>
</tr>
<tr>
<td><code>duration</code></td>
<td>int</td>
<td>remaining_duration, in seconds.</td>
</tr>
</tbody>
</table>
<h2 id="un-suppress-suppressed-alarms">Un-Suppress Suppressed Alarms</h2>
<pre><code>DELETE /api/v1/orgs/:org_id/alarmtemplates/suppress
</code></pre>
<h2 id="ack-an-alarm">Ack An alarm</h2>
<p>Acknowledge an alarm within an org.</p>
<pre><code>POST /api/v1/orgs/:org_id/alarms/:alarm_id/ack
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#ack-an-alarm">Site:Ack An alarm</a> for API request &amp; response details.</p>
<h2 id="unack-an-alarm">Unack An alarm</h2>
<p>Unacknowledge an alarm within an org.</p>
<pre><code>POST /api/v1/orgs/:org_id/alarms/:alarm_id/unack
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#unack-an-alarm">Site:Unack An alarm</a> for API request &amp; response details.</p>
<h2 id="ack-multiple-alarms">Ack multiple alarms</h2>
<p>Acknowledge multiple alarms at once within an org.</p>
<pre><code>POST /api/v1/orgs/:org_id/alarms/ack
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#ack-multiple-alarms">Site:Ack mutiple alarms</a> for API request &amp; response details.</p>
<h2 id="unack-multiple-alarms">UnAck multiple alarms</h2>
<p>Unacknowledge multiple alarms at once within an org.</p>
<pre><code>POST /api/v1/orgs/:org_id/alarms/unack
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#unack-multiple-alarms">Site:UnAck mutiple alarms</a> for API request &amp; response details.</p>
<h2 id="ack-all-alarms">Ack all alarms</h2>
<p>Acknowledge all the alarms of an org.</p>
<pre><code>POST /api/v1/orgs/:org_id/alarms/ack_all
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#ack-all-alarms">Site:Ack all alarms</a> for API request &amp; response details.</p>
<h2 id="unack-all-alarms">Unack all alarms</h2>
<p>Unacknowledge all the alarms of an org.</p>
<pre><code>POST /api/v1/orgs/:org_id/alarms/unack_all
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#unack-all-alarms">Site:Unack all alarms</a> for API request &amp; response details.</p>
<h2 id="get-alarms">Get Alarms</h2>
<p>List or Search alarms within an org.</p>
<pre><code>GET /api/v1/orgs/:org_id/alarms/search
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#get-alarms">Site:Get Alarms</a> for API request &amp; response details.</p>
<h2 id="count-alarms">Count Alarms</h2>
<p>Count alarms within an org.</p>
<pre><code>GET /api/v1/orgs/:org_id/alarms/count
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#count-alarms">Site:Count Alarms</a> for API request &amp; response details.</p>
<h1 id="mist-edge">Mist Edge</h1>
<h2 id="overview_2">Overview</h2>
<p>Mist Edge is a software component outside of Mist Cloud. Stay tuned for what it can do.</p>
<h2 id="get-all-mist-edges">Get All Mist Edges</h2>
<pre><code>GET /api/v1/orgs/:org_id/mxedges
</code></pre>
<h3 id="parameters_58">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>for_site</code></td>
<td><code>string</code></td>
<td>true / false/ any (default false). Filter for site level mist edges</td>
</tr>
</tbody>
</table>
<h3 id="response_126">Response</h3>
<pre><code>[
    {
        "id": "95ddd29a-6a3c-929e-a431-51a5b09f36a6",
        "name": "Guest",
        "model": "ME-100",
        "magic": "L-NpT5gi-ADR8WTFd4EiQPY3cP5WdSoD",
        "tunterm_registered": true,
        "mxagent_registered": true,

        "mxedge_mgmt": {
            "mist_password": "MIST_PASSWORD",
            "root_password": "ROOT_PASSWORD",
            "config_auto_revert": true, // default is false
        },

        "oob_ip_config": {
            "type": "static",    // dhcp (default) / static / disabled
            "ip": "10.2.1.10",
            "netmask": "255.255.255.0",
            "gateway": "10.2.1.254",

            "type6": "static",   // autoconf (default) / dhcp / static / disabled
            "ip6": "2601:1700:43c0:dc0:20c:29ff:fea7:93bc",
            "netmask6": "/64",
            "gateway6": "2601:1700:43c0:dc0::1",

            // IPv4 ignored if type!=static
            // IPv6 ignored if type6!=static
            "dns": ["10.2.1.2", "2601:1700:43c0:dc0::2"],  // default is ["8.8.8.8", "4.4.4.4" , "2001:4860:4860::8888", "2001:4860:4860::8844"]
        },

        "proxy": {
            "url": "http://proxy.internal:8080/"
        },

        "tunterm_ip_config": {
            "ip": "10.2.1.1", // VLAN ID 1
            "netmask": "255.255.255.0",
            "gateway": "10.2.1.254",
            "ip6": "2001:1010:1010:1010::2", // VLAN ID 1
            "netmask6": "/64",
            "gateway6": "2001:1010:1010:1010::1",
        },

        "tunterm_other_ip_configs": {
            "5": { // VLAN ID
                "ip": "10.3.3.1",
                "netmask": "255.255.255.0",
            }
        },

        "tunterm_extra_routes": {
            "11.0.0.0/8": {
                "via": "10.3.3.1"
            }
        },

        "tunterm_dhcpd_config": {
            "enabled": false,
            "servers": ["11.2.3.4"],
            "2": {
                "enabled": true,
                "servers": ["11.2.3.44"],
            }
        },

        "tunterm_port_config": {
            // draft, not finalized
            "separate_upstream_downstream": true,
            "downstream_ports": ["3"],
            "upstream_ports": [ "0", "1", "2" ],
            "upstream_port_vlan_id": 30
        },

        // if custom vlan settings are desired
        "tunterm_switch_config": {
            "enabled": true,
            "0": {  // port0
                "vlan_ids": [1, 3055],
                "port_vlan_id": 1
            }
        },

        // overwrite mxcluster or site settings when set
        "tunterm_monitoring": [
            {
                "protocol": "ping",   // arp / ping / tcp
                "host": "10.2.8.15",  // can be ip, ipv6, hostname
                "timeout": 300,  // 60 - 3600, default is 300

                // when protocol==tcp
                "port": 80,

                // optional source for the monitoring check, vlan_id configured in tunterm_other_ip_configs
                "src_vlan_id": 5
            }
        ],

        "ntp_servers": [],

        "mxcluster_id": "572586b7-f97b-a22b-526c-8b97a3f609c4",

        "tunterm_igmp_snooping_config": {
             "enabled": true,
             "vlan_ids": [2, 3, 5],
             "querier": {
                  "query_interval": 125,
                  "max_response_time": 10,
                  "robustness": 2,
                  "version": 3,
                  "mtu": 1500
             }
        },

        "tunterm_multicast_config": {
            "mdns": {
                "enabled": true,
                "vlan_ids": [2, 3, 5]
            },
            "ssdp": {
                "enabled": true,
                "vlan_ids": [2, 3, 5]
            }
        }
    }
]
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mxcluster_id</code></td>
<td><code>string</code></td>
<td>MxCluster this MxEdge belongs to</td>
</tr>
<tr>
<td><code>oob_ip_config</code></td>
<td><code>object</code></td>
<td>ip configuration of the Mist Edge out-of-band management interface</td>
</tr>
<tr>
<td><code>proxy</code></td>
<td><code>object</code></td>
<td>Proxy Configuration to talk to Mist</td>
</tr>
<tr>
<td><code>tunterm_ip_config</code></td>
<td><code>object</code></td>
<td>ip configuration of the Mist Tunnel interface</td>
</tr>
<tr>
<td><code>tunterm_other_ip_configs</code></td>
<td><code>object</code></td>
<td>ip configuration of the Mist Tunneled VLANs</td>
</tr>
<tr>
<td><code>tunterm_extra_routes</code></td>
<td><code>object</code></td>
<td>extra routes for Mist Tunneled VLANs</td>
</tr>
<tr>
<td><code>tunterm_dhcpd_config</code></td>
<td><code>object</code></td>
<td>DHCP server/relay configuration of Mist Tunneled VLANs</td>
</tr>
<tr>
<td><code>services</code></td>
<td><code>list</code></td>
<td>list of services to run, <code>tunterm</code> only for now</td>
</tr>
<tr>
<td><code>tunterm_port_config</code></td>
<td><code>object</code></td>
<td>ethernet port configurations</td>
</tr>
<tr>
<td><code>separate_upstream_downstream</code></td>
<td><code>boolean</code></td>
<td>weather to separate upstream / downstream ports. default is false where all ports will be used.</td>
</tr>
<tr>
<td><code>downstream_ports</code></td>
<td><code>list</code></td>
<td>list of ports to be used for downstream (to AP) purpose</td>
</tr>
<tr>
<td><code>upstream_ports</code></td>
<td><code>list</code></td>
<td>list of ports to be used for upstrea purpose (to LAN)</td>
</tr>
<tr>
<td><code>upstream_port_vlan_id</code></td>
<td><code>int</code></td>
<td>native VLAN id for upstream ports, default is 1</td>
</tr>
<tr>
<td><code>tunterm_igmp_snooping_config</code></td>
<td><code>object</code></td>
<td>tunterm igmp snooping config</td>
</tr>
</tbody>
</table>
<h4 id="mxedge-oob-ip-config">Mxedge OOB IP Config</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>oob_ip_config</code></td>
<td><code>object</code></td>
<td>ip config</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>static. default: not managed from cloud.</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>required if type==static</td>
</tr>
<tr>
<td><code>netmask</code></td>
<td><code>string</code></td>
<td>required if type==static</td>
</tr>
<tr>
<td><code>gateway</code></td>
<td><code>string</code></td>
<td>required if type==static</td>
</tr>
<tr>
<td><code>dns</code></td>
<td><code>list</code></td>
<td>if type==static. default is <code>8.8.8.8, 8.8.4.4</code></td>
</tr>
</tbody>
</table>
<h4 id="mxedge-mist-tunnel-ip-config">Mxedge Mist Tunnel IP Config</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tunterm_ip_config</code></td>
<td><code>object</code></td>
<td>ip config</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>required</td>
</tr>
<tr>
<td><code>netmask</code></td>
<td><code>string</code></td>
<td>required</td>
</tr>
<tr>
<td><code>gateway</code></td>
<td><code>string</code></td>
<td>required</td>
</tr>
</tbody>
</table>
<h4 id="mxedge-mist-tunnel-vlan-ip-config">Mxedge Mist Tunnel VLAN IP Config</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tunterm_other_ip_configs</code></td>
<td><code>object</code></td>
<td>ip configs by VLAN ID</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>required</td>
</tr>
<tr>
<td><code>netmask</code></td>
<td><code>string</code></td>
<td>required</td>
</tr>
</tbody>
</table>
<h4 id="extra-routes-for-mist-tunneled-vlans">Extra Routes for Mist Tunneled VLANs</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tunterm_extra_routes</code></td>
<td><code>object</code></td>
<td>key is the dest</td>
</tr>
<tr>
<td><code>via</code></td>
<td><code>string</code></td>
<td>next-hop</td>
</tr>
</tbody>
</table>
<h4 id="dhcp-serverrelay-for-mist-tunneled-vlans">DHCP server/relay for Mist Tunneled VLANs</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tunterm_dhcpd_config</code></td>
<td><code>object</code></td>
<td>global and per-VLAN</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>relay (default)</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>enabled or not, default is false</td>
</tr>
<tr>
<td><code>servers</code></td>
<td><code>list</code></td>
<td>DHCP servers; required if type==relay</td>
</tr>
</tbody>
</table>
<h4 id="tunterm-igmp-snooping-config">Tunterm IGMP Snooping Config</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tunterm_igmp_snooping_config</code></td>
<td><code>object</code></td>
<td>tunterm igmp snooping config</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>enabled or not, default is false</td>
</tr>
<tr>
<td><code>vlan_ids</code></td>
<td><code>array of ints</code></td>
<td>the list of vlans on which tunterm performs IGMP snooping</td>
</tr>
<tr>
<td><code>querier.query_interval</code></td>
<td><code>int</code></td>
<td>querier’s query interval, in seconds</td>
</tr>
<tr>
<td><code>querier.max_response_time</code></td>
<td><code>int</code></td>
<td>querier’s query response interval, in tenths-of-seconds</td>
</tr>
<tr>
<td><code>querier.robustness</code></td>
<td><code>int</code></td>
<td>querier’s robustness (1 to 7)</td>
</tr>
<tr>
<td><code>querier.version</code></td>
<td><code>int</code></td>
<td>querier’s maximum protocol version</td>
</tr>
<tr>
<td><code>querier.mtu</code></td>
<td><code>int</code></td>
<td>the MTU we use (needed when forming large IGMPv3 Reports)</td>
</tr>
</tbody>
</table>
<h2 id="create-mist-edge">Create Mist Edge</h2>
<pre><code>POST /api/v1/orgs/:org_id/mxedges
</code></pre>
<h3 id="request_64">Request</h3>
<pre><code>{
    "name": "Guest",
    "model": "ME-100",
    "services": ["tunterm"],
    "versions": {
        "mxagent": "2.4.194",
        "tunterm": "0.1.928-1"
    },
    "ntp_servers": [],
    "mxedge_mgmt": {},
    "oob_ip_config": {},
    "notes": "note for mxedge"
    "proxy": {},
    "tunterm_ip_config": {
        "ip": "10.2.1.1", // VLAN ID == "1"
        "netmask": "255.255.255.0",
        "gateway": "10.2.1.254", // default route
    },
    "tunterm_port_config": {
        "separate_upstream_downstream": true, // default == false
        "downstream_ports": [ "0", "1", "2", "3" ], // default == available ports
        "upstream_ports": [ "0", "1", "2", "3" ], // default == available ports
        "upstream_port_vlan_id": 1,
    },
    "tunterm_switch_config": {
        "enabled": true, // default == false
        "0": {"vlan_ids": [5, 2, 3], "port_vlan_id": None}
    },
    "mxcluster_id": "572586b7-f97b-a22b-526c-8b97a3f609c4"
}
</code></pre>
<h3 id="response_127">Response</h3>
<pre><code>{
    "id": "95ddd29a-6a3c-929e-a431-51a5b09f36a6",
    "name": "Edge1",
    "magic": "ExNpT5gi-ADR8WTFd4EiQPY3cP5WdSoD",
    "tunterm_registered": false,
    "mxagent_registered": false,
    "mxcluster_id": "572586b7-f97b-a22b-526c-8b97a3f609c4"
}
</code></pre>
<h2 id="claim-new-mist-edge">Claim New Mist Edge</h2>
<p>For a Mist Edge in default state, it will show a random claim code like <code>135-546-673</code> which you can “claim” it into your
Org</p>
<p>POST /api/v1/orgs/:org_id/mxedges/claim</p>
<pre><code>{
    "code": "135-546-673"
}
</code></pre>
<h3 id="response_128">Response</h3>
<pre><code>{
    "id": "95ddd29a-6a3c-929e-a431-51a5b09f36a6",
    "magic": "ExNpT5gi-ADR8WTFd4EiQPY3cP5WdSoD"
}
</code></pre>
<h2 id="assign-mist-edge-to-a-site">Assign Mist Edge To a Site</h2>
<pre><code>POST /api/v1/orgs/:org_id/mxedges/assign
</code></pre>
<h3 id="request_65">Request</h3>
<pre><code>{
    "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
    "mxedge_ids": ["387804a7-3474-85ce-15a2-f9a9684c9c90"]
}
</code></pre>
<h3 id="response_129">Response</h3>
<pre><code>{
    "success": ["387804a7-3474-85ce-15a2-f9a9684c9c90"]
}
</code></pre>
<h2 id="unassign-mist-edge-from-sites">Unassign Mist Edge from Sites</h2>
<pre><code>POST /api/v1/orgs/:org_id/mxedges/unassign
</code></pre>
<h3 id="request_66">Request</h3>
<pre><code>{
    "mxedge_ids": ["387804a7-3474-85ce-15a2-f9a9684c9c90"]
}
</code></pre>
<h3 id="response_130">Response</h3>
<pre><code>{
    "success": ["387804a7-3474-85ce-15a2-f9a9684c9c90"]
}
</code></pre>
<h2 id="update-mist-edge">Update Mist Edge</h2>
<pre><code>PUT /api/v1/orgs/:org_id/mxedges/:mxedge_id
</code></pre>
<h3 id="request_67">Request</h3>
<pre><code>{
    "name": "Guest",
    "model": "ME-100",
    "services": ["tunterm"],
    "versions": {
        "mxagent": "2.4.194",
        "tunterm": "0.1.928-1"
    },
    "ntp_servers": [],
    "notes": "note for mxedge"

    "tunterm_ip_config": {
        "ip": "10.2.1.1",
        "netmask": "255.255.255.0",
        "gateway": "10.2.1.254"
    },
    "tunterm_port_config": {
        "upstrem": {
            "ports": [ "0", "1", "2", "3" ]
        },
        "downstream": {
            "ports": [ "0", "1", "2", "3" ],
            "port_vlan_id": 1 
        }
    },

    "mxcluster_id": "572586b7-f97b-a22b-526c-8b97a3f609c4"
}
</code></pre>
<h2 id="unregister-a-mist-edge">Unregister a Mist Edge</h2>
<p>In the case where a Mist Edge is replaced, you would need to <em>unregister</em> it. Which disconnects the currently the
connected Mist Edge and allow another to register.</p>
<pre><code>POST /api/v1/orgs/:org_id/mxedges/:mxedge_id/unregister
</code></pre>
<h2 id="delete-mist-edge">Delete Mist Edge</h2>
<pre><code>DELETE /api/v1/orgs/:org_id/mxedges/:mxedge_id
</code></pre>
<h2 id="search-mist-edges">Search Mist Edges</h2>
<pre><code>GET /api/v1/orgs/:org_id/mxedges/search
</code></pre>
<h3 id="supported-filters_6">Supported Filters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mxedge_id</code></td>
<td>string</td>
<td>mist edge id</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td>string</td>
<td>mist edge site id</td>
</tr>
<tr>
<td><code>mxcluster_id</code></td>
<td>string</td>
<td>mist edge cluster id</td>
</tr>
<tr>
<td><code>model</code></td>
<td>string</td>
<td>model name</td>
</tr>
<tr>
<td><code>distro</code></td>
<td>string</td>
<td>debian code name(buster, bullseye)</td>
</tr>
<tr>
<td><code>tunterm_version</code></td>
<td>string</td>
<td>tunterm version</td>
</tr>
<tr>
<td><code>sort</code></td>
<td><code>string</code></td>
<td>sort options, -prefix represents DESC order, default is -last_seen</td>
</tr>
<tr>
<td><code>stats</code></td>
<td><code>boolean</code></td>
<td>whether to return device stats, default is false</td>
</tr>
</tbody>
</table>
<h3 id="response_131">Response</h3>
<pre><code>{
    "results": [
        {
            "last_seen": 1695151551.833,
            "org_id": "35d96b1a-1a13-4ba8-90f5-1e78dd2a10c5",
            "mxedge_id": "00000000-0000-0000-1000-d420b0f0025d",
            "tunterm_version": "0.1.2813",
            "model": "ME-X5",
            "distro": "buster",
            "uptime": 5662632
        },
        {
            "last_seen": 1695151550.622,
            "org_id": "23ab5425-55d8-4d4e-98a8-f572a11e9282",
            "mxedge_id": "00000000-0000-0000-1000-d420b0f0042b",
            "model": "ME-X1",
            "distro": "buster",
            "uptime": 2842400
        }
    ],
    "start": 1694622179,
    "end": 1694708579,
    "limit": 10,
    "total": 2
}

</code></pre>
<h2 id="count-mist-edges">Count Mist Edges</h2>
<pre><code>GET /api/v1/orgs/:org_id/mxedges/count?distinct=model
</code></pre>
<h3 id="request_68">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>model(default) / mxcluster_id / distro / tunterm_version / site_id</td>
</tr>
</tbody>
</table>
<h3 id="response_132">Response</h3>
<pre><code>{
    "results": [
        {
            "model": "ME-100",
            "count": 27
        },
        {
            "model": "ME-X1",
            "count": 8
        },
    ],
    "start": 1694622935,
    "end": 1694709335,
    "limit": 10,
    "distinct": "model",
    "total": 2
}
</code></pre>
<h2 id="restart-a-mist-edge">Restart a Mist Edge</h2>
<pre><code>POST /api/v1/orgs/:org_id/mxedges/:mxedge_id/restart
</code></pre>
<h2 id="control-services-on-a-mist-edge">Control Services on a Mist Edge</h2>
<pre><code>POST /api/v1/orgs/:org_id/mxedges/:mxedge_id/services/:name/:action
</code></pre>
<h3 id="parameters_59">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td><code>tunterm</code> or <code>radsecproxy</code> or <code>mxagent</code> or <code>mxocproxy</code> or <code>mxdas</code> or <code>mxnacedge</code></td>
</tr>
<tr>
<td><code>action</code></td>
<td><code>string</code></td>
<td><code>restart</code> or <code>start</code> or <code>stop</code></td>
</tr>
</tbody>
</table>
<h2 id="upload-mist-edge-support-files">Upload Mist Edge support files</h2>
<p>Support / Upload Mist Edge support files</p>
<pre><code>POST /api/v1/orgs/:org_id/mxedges/:mxedge_id/support
</code></pre>
<h2 id="bounce-tunterm-data-ports">Bounce TunTerm Data Ports</h2>
<pre><code>POST /api/v1/orgs/:org_id/mxedges/:id/services/tunterm/bounce_port
</code></pre>
<h3 id="request_69">Request</h3>
<pre><code>{
    "ports": ["0", "2"]
}
</code></pre>
<h3 id="parameters_60">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ports</code></td>
<td><code>list</code></td>
<td>list of ports to bounce</td>
</tr>
<tr>
<td><code>hold_time</code></td>
<td><code>int</code></td>
<td>in milli seconds, hold time between multiple port bounces</td>
</tr>
</tbody>
</table>
<h2 id="disconnect-aps-from-tunterm">Disconnect AP’s from TunTerm</h2>
<pre><code>POST /api/v1/orgs/:org_id/mxedges/:id/services/tunterm/disconnect_aps
</code></pre>
<h3 id="request_70">Request</h3>
<pre><code>
{
   "macs": ["5c5b353e4eb1", "5c5b353e4eb2"]
}

</code></pre>
<h3 id="parameters_61">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>macs</code></td>
<td><code>list</code></td>
<td>mac address of AP’s to disconnect</td>
</tr>
<tr>
<td><code>percentage</code></td>
<td><code>float</code></td>
<td>percentage of AP’s to disconnect (only used when <code>macs</code> is empty)</td>
</tr>
</tbody>
</table>
<h2 id="upgrade-mist-edges">Upgrade Mist Edges</h2>
<pre><code>POST /api/v1/orgs/:org_id/mxedges/upgrade
</code></pre>
<h3 id="request_71">Request</h3>
<pre><code>{
    // filters that can be used, if no filter specified, it means entire org
    "mxedge_ids": ["387804a7-3474-85ce-15a2-f9a9684c9c90"],

    "channel": "stable",

    // version initially installed: highest qualified version at that time
    "versions": {
        "mxagent": "latest",       // highest version
        "tunterm": "default"       // highest qualified version (&lt;=latest)
        "radsecproxy": "&lt;version&gt;" // specific &lt;version&gt; e.g. 1.9.1-1.mist.12
    },
    "allow_downgrades": {
        "mxagent": false,
        "tunterm": true
    },
    "strategy": "serial",
    "canary_phases": [5,25,50,100],
    "max_failures": [1,1,5,5], // will be used if provided, else max_failure_percentage will be used
    "max_failure_percentage": 5,
    "start_time": 1624399840,
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mxedge_ids</code></td>
<td><code>list</code></td>
<td>list of mxedge IDs to upgrade or all mxedges in this organization (default)</td>
</tr>
<tr>
<td><code>channel</code></td>
<td><code>string</code></td>
<td>upgrade channel to follow, stable (default) / beta / alpha</td>
</tr>
<tr>
<td><code>versions</code></td>
<td><code>object</code></td>
<td>services to upgrade, ignored if distro upgrade, <code>tunterm</code> or <code>radsecproxy</code> or <code>mxagent</code> or <code>mxocproxy</code> or <code>mxdas</code> or <code>mxnacedge</code></td>
</tr>
<tr>
<td><code>allow_downgrades</code></td>
<td><code>object</code></td>
<td>optional, default value is false</td>
</tr>
<tr>
<td><code>strategy</code></td>
<td><code>string</code></td>
<td><code>big_bang</code>(upgrade all at once - no orchestration), <code>serial</code>(one at a time), <code>canary</code>(upgrade in phases). Default is big_bang</td>
</tr>
<tr>
<td><code>canary_phases</code></td>
<td><code>array of ints</code></td>
<td>phases for canary deployment. Each phase represents percentage of devices that need to be upgraded in that phase. default is [1, 10, 50, 100]</td>
</tr>
<tr>
<td><code>max_failures</code></td>
<td><code>array of ints</code></td>
<td>number of failures allowed within each phase. Only applicable for <code>canary</code>. Array length should be same as <code>canary_phases</code>. Will be used if provided, else max_failure_percentage will be used</td>
</tr>
<tr>
<td><code>max_failure_percentage</code></td>
<td><code>int</code></td>
<td>failure threshold before we stop the upgrade and mark it as failed, default is 5</td>
</tr>
<tr>
<td><code>start_time</code></td>
<td><code>long</code></td>
<td>upgrade start time in epoch seconds, default is now</td>
</tr>
</tbody>
</table>
<h2 id="upgrade-mist-edgess-distro">Upgrade Mist Edges’s Distro</h2>
<pre><code>POST /api/v1/orgs/:org_id/mxedges/upgrade
</code></pre>
<h3 id="request_72">Request</h3>
<pre><code>{
    // filters that can be used, if no filter specified, it means entire org
    "mxedge_ids": ["387804a7-3474-85ce-15a2-f9a9684c9c90"],

    "distro": "buster",  // buster

    "strategy": "serial",
    "canary_phases": [5,25,50,100],
    "max_failures": [1,1,5,5], // will be used if provided, else max_failure_percentage will be used
    "max_failure_percentage": 5,
    "start_time": 1624399840,
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mxedge_ids</code></td>
<td><code>list</code></td>
<td>list of mxedge IDs to upgrade or all mxedges in this organization (default)</td>
</tr>
<tr>
<td><code>channel</code></td>
<td><code>string</code></td>
<td>upgrade channel to follow, stable (default) / beta / alpha</td>
</tr>
<tr>
<td><code>distro</code></td>
<td><code>string</code></td>
<td>distro upgrade, optional, to specific codename (e.g. bullseye) with highest qualified versions</td>
</tr>
<tr>
<td><code>strategy</code></td>
<td><code>string</code></td>
<td><code>big_bang</code>(upgrade all at once - no orchestration), <code>serial</code>(one at a time), <code>canary</code>(upgrade in phases). Default is big_bang</td>
</tr>
<tr>
<td><code>canary_phases</code></td>
<td><code>array of ints</code></td>
<td>phases for canary deployment. Each phase represents percentage of devices that need to be upgraded in that phase. default is [1, 10, 50, 100]</td>
</tr>
<tr>
<td><code>max_failures</code></td>
<td><code>array of ints</code></td>
<td>number of failures allowed within each phase. Only applicable for <code>canary</code>. Array length should be same as <code>canary_phases</code>. Will be used if provided, else max_failure_percentage will be used</td>
</tr>
<tr>
<td><code>max_failure_percentage</code></td>
<td><code>int</code></td>
<td>failure threshold before we stop the upgrade and mark it as failed, default is 5</td>
</tr>
<tr>
<td><code>start_time</code></td>
<td><code>long</code></td>
<td>upgrade start time in epoch seconds, default is now</td>
</tr>
</tbody>
</table>
<h2 id="get-mist-edge-upgrades">Get Mist Edge Upgrades</h2>
<pre><code>GET /api/v1/orgs/:org_id/mxedges/upgrade
</code></pre>
<h3 id="response_133">Response</h3>
<pre><code>[{
    "status": "upgrading",
    "strategy": "serial",
    "versions": {},
    "channel": "stable",
    "id": "ceef2c8a-e2e6-447a-8b27-cb4f3ec1adae",
    "counts": {
        "queued": 1,
        "upgrading": 1,
        "success": 0,
        "failed": 0
    }
}]
</code></pre>
<h2 id="get-mist-edge-upgrade">Get Mist Edge Upgrade</h2>
<pre><code>GET /api/v1/orgs/:org_id/mxedges/upgrade/:upgrade_id
</code></pre>
<h3 id="response_134">Response</h3>
<pre><code>{
    "status": "upgrading",
    "strategy": "serial",
    "versions": {},
    "channel": "stable",
    "id": "5cbcee0a-c620-4bb4-a25e-15000934e9d8",
    "targets": {
        "queued": ["387804a7-3474-85ce-15a2-f9a9684c9c90"],
        "upgrading": ["8e525f1d-4178-4ae1-a988-2b0176855e55"],
        "success": [],
        "failed": []
    }
}
</code></pre>
<h2 id="get-mist-edge-upgrade-information">Get Mist Edge Upgrade Information</h2>
<pre><code>GET /api/v1/orgs/:org_id/mxedges/versions?channel=stable&amp;distro=&lt;codename&gt;
</code></pre>
<h3 id="response_135">Response</h3>
<pre><code>[
    {
        "package": "mxagent",
        "version": "2.4.100",
        "_version": "2.4.100",
        "distro": "bullseye",
        "default": true
    },
    {
        "package": "tunterm",
        "version": "1.0.0",
        "distro": "buster",
        "_version": "1.0.0-nd"
    }
]
</code></pre>
<h2 id="get-mist-edge-models">Get Mist Edge Models</h2>
<pre><code>GET /api/v1/const/mxedge_models
</code></pre>
<h3 id="response_136">Response</h3>
<pre><code>[
    {
        "model": "ME-100",
        "display": "ME-Small",
        "ports": {
            "0": {
                "display": "Gigabit Ethernet 0",
                "speed": 1000
            },
            "1": {
                "display": "Gigabit Ethernet 1",
                "speed": 1000
            },
            "2": {
                "display": "Gigabit Ethernet 2",
                "speed": 1000
            },
            "3": {
                "display": "Gigabit Ethernet 3",
                "speed": 1000
            }
        }
    }
]
</code></pre>
<h2 id="attach-mxedge-image">Attach MxEdge Image</h2>
<p>Attach up to 3 images to a mxedge </p>
<pre><code>POST /api/v1/orgs/:org_id/mxedges/:id/image1
POST /api/v1/orgs/:org_id/mxedges/:id/image2
POST /api/v1/orgs/:org_id/mxedges/:id/image3
</code></pre>
<h2 id="remove-mxedge-image">Remove MxEdge Image</h2>
<p>Delete up to 3 images which are attached to a mxedge </p>
<pre><code>DELETE /api/v1/orgs/:org_id/mxedges/:id/image1
DELETE /api/v1/orgs/:org_id/mxedges/:id/image2
DELETE /api/v1/orgs/:org_id/mxedges/:id/image3
</code></pre>
<h2 id="get-supported-mist-edge-events">Get Supported Mist Edge Events</h2>
<pre><code>GET /api/v1/const/mxedge_events
</code></pre>
<h3 id="response_137">Response</h3>
<pre><code>[
    {
        "key": "ME_CONFIG_CHANGED_BY_USER",
        "display": "ME Config changed by user",
        "description": "Config change on ME was triggered as a result of change made by user",
        "example": {
            "type": "ME_CONFIG_CHANGED_BY_USER",
            "service": "mxagent",
            "timestamp": 1552408871,
            "org_id": "2818e386-8dec-2562-9ede-5b8a0fbbdc71",
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "mxcluster_id": "ed4665ed-c9ad-4835-8ca5-dda642765ad3",
            "mxedge_id": "387804a7-3474-85ce-15a2-f9a9684c9c90",
            "audit_id": "e9a88814-fa81-5bdc-34b0-84e8735420e5"
        }
    },
    {
        "key": "ME_CONFIGURED",
        "display": "ME Configured",
        "description": "ME received and applied a new config",
        "example": {
            "type": "ME_CONFIGURED",
            "timestamp": 1552408871,
            "org_id": "2818e386-8dec-2562-9ede-5b8a0fbbdc71",
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "mxcluster_id": "ed4665ed-c9ad-4835-8ca5-dda642765ad3",
            "mxedge_id": "387804a7-3474-85ce-15a2-f9a9684c9c90",
            "audit_id": "e9a88814-fa81-5bdc-34b0-84e8735420e5"
        }
    },
    ...
]

</code></pre>
<h2 id="search-mist-edge-events">Search Mist Edge Events</h2>
<pre><code>GET /api/v1/orgs/:org_id/mxedges/events/search
</code></pre>
<h3 id="supported-filters_7">Supported Filters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mxedge_id</code></td>
<td>string</td>
<td>mist edge id</td>
</tr>
<tr>
<td><code>mxcluster_id</code></td>
<td>string</td>
<td>mist edge cluster id</td>
</tr>
<tr>
<td><code>type</code></td>
<td>string</td>
<td>mist edge event type <a href="https://api.mist.com/api/v1/docs/Org#get-supported-mist-edge-events">Supported Events</a></td>
</tr>
<tr>
<td><code>service</code></td>
<td>string</td>
<td>service running on mist edge(mxagent, tunterm etc)</td>
</tr>
<tr>
<td><code>start</code></td>
<td><code>string</code></td>
<td>start datetime, can be epoch or relative time like -1d, -1w; -1d if not specified</td>
</tr>
<tr>
<td><code>end</code></td>
<td><code>string</code></td>
<td>end datetime, can be epoch or relative time like -1d, -2h; now if not specified</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>string</code></td>
<td>duration like 7d, 2w</td>
</tr>
<tr>
<td><code>component</code></td>
<td><code>string</code></td>
<td>component like PS1, PS2</td>
</tr>
</tbody>
</table>
<h3 id="response_138">Response</h3>
<pre><code>{
    "results": [
        {
            "mxcluster_id": "2815c917-58e7-472f-a190-bfd44fb58d05",
            "timestamp": 1694678225.927,
            "org_id": "f2695c32-0e83-4936-b1b2-96fc88051213",
            "mxedge_id": "00000000-0000-0000-1000-020000dc585c",
            "type": "ME_SERVICE_STOPPED",
            "service": "tunterm"
        },
        {
            "timestamp": 1694678004.821,
            "org_id": "f2695c32-0e83-4936-b1b2-96fc88051213",
            "mxedge_id": "00000000-0000-0000-1000-020000dc585c",
            "type": "ME_SERVICE_STARTED",
            "service": "tunterm"
        },
         {
            "package": "radsecproxy",
            "timestamp": 1694678010.108,
            "org_id": "f2695c32-0e83-4936-b1b2-96fc88051213",
            "mxedge_id": "00000000-0000-0000-1000-020000dc585c",
            "type": "ME_PACKAGE_INSTALLED",
            "to_version": "1.9.1-1.mist.16"
        },
        {
            "timestamp": 1694679111.253,
            "org_id": "f2695c32-0e83-4936-b1b2-96fc88051213",
            "mxedge_id": "00000000-0000-0000-1000-020000dc585c",
            "type": "ME_POWERINPUT_DISCONNECTED",
            "component": "PS1"
        }
    ],
    "start": 1694622179,
    "end": 1694708579,
    "limit": 10,
    "total": 4
}

</code></pre>
<h2 id="count-mist-edge-events">Count Mist Edge Events</h2>
<pre><code>GET /api/v1/orgs/:org_id/mxedges/events/count?distinct=type
</code></pre>
<h3 id="request_73">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>mxedge_id(default) / type / mxcluster_id / package</td>
</tr>
<tr>
<td><code>start</code></td>
<td><code>string</code></td>
<td>start datetime, can be epoch or relative time like -1d, -1w; -1d if not specified</td>
</tr>
<tr>
<td><code>end</code></td>
<td><code>string</code></td>
<td>end datetime, can be epoch or relative time like -1d, -2h; now if not specified</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>string</code></td>
<td>duration like 7d, 2w</td>
</tr>
</tbody>
</table>
<h3 id="response_139">Response</h3>
<pre><code>{
    "results": [
        {
            "type": "ME_SERVICE_RESTARTED",
            "count": 5003
        },
        {
            "type": "ME_SERVICE_STARTED",
            "count": 124
        },
        {
            "type": "ME_SERVICE_FAILED",
            "count": 120
        }
    ],
    "start": 1694622935,
    "end": 1694709335,
    "limit": 10,
    "distinct": "type",
    "total": 3
}
</code></pre>
<h1 id="mist-edge-cluster">Mist Edge Cluster</h1>
<h2 id="overview_3">Overview</h2>
<p>A Mist Edge Cluster represents a group of Mist Edges that will work together to do load-balancing and handle fail-overs.</p>
<h3 id="base-uri_12">Base URI</h3>
<pre><code>/api/v1/orgs/:org_id/mxclusters
</code></pre>
<h3 id="schema_2">Schema</h3>
<pre><code>{
    "id": "572586b7-f97b-a22b-526c-8b97a3f609c4",
    "name": "Guest Cluster",

    "proxy": {
        "url": "http://proxy.corp.com:8080/"
    },

    "mxedge_mgmt": {
        "fips_enabled": true, // default is false
        "oob_ip_type": "disabled",  // dhcp (default) / disabled
        "oob_ip_type6": "disabled", // autoconf (default) / dhcp / disabled
        "config_auto_revert": true, // default is false
    },

    // for AP, how to connect to tunterm or radsecproxy
    "tunterm_hosts": ["guest-sj1.corp.com"],
    "tunterm_ap_subnets": [
        "0.0.0.0/0"
    ],
    "tunterm_hosts_selection": "shuffle",
    // if tunterm_hosts_selection is ordered, then re-order with tunterm_hosts with tunterm_hosts_order
    "tunterm_hosts_order": [0, 1],

    "mist_das": {
        // configure cloud-assisted dynamic authorization service on this cluster of mist edges
        "enabled": true,
        "coa_servers": [  // dynamic authorization clients configured to send CoA|DM to mist edges on port 3799
            {
                "enabled": false,
                "host": "aaa.internal",
                "secret": "testing456",
                "require_message_authenticator": false,
                "disable_event_timestamp_check": false
            }
        ],
    },

    "radsec": {
        // configure radsecproxy service on this cluster of mist edges
        "enabled": true,
        "proxy_hosts": ["mxedge1.corp.com"], // must be superset of all wlans[*].radsec.proxy_hosts
        "match_ssid": false,
        "server_selection": "ordered",
        "auth_servers": [
            {
                "host": "1.2.3.4",
                "port": 1812,
                "secret": "testing123",
                "ssids": ["corporate"],

                // if used for Mist AP
                "keywrap_enabled": true, // enable keywrap algorithm. Default is false
                "keywrap_format": "hex", // key format: hex or ascii
                “keywrap_kek”: “1122334455", // Key encryption key
                “keywrap_mack” “1122334455", // Message Authentication Code Key
            },
            {
                "host": "radius.internal",
                "port": 1812,
                "secret": "testing123",
                "require_message_authenticator": true,
                "ssids": ["guest"],
                "inband_status_check": true,
                "inband_status_interval": 60,
            }
        ],
        "acct_servers": [
            {
                "host": "1.2.3.4",
                "port": 1812,
                "secret": "testing123",
            }
        ],
        "src_ip_source": "tunnel",
        "nas_ip_source": "tunnel",
    },


    // mist_nac
    "mist_nac": {
        "enabled": true,
        "secret": "testing123",

        "client_ips": {
            "10.0.3.0/24": {

                // convention to be followed is : "&lt;vendor&gt;-&lt;variant&gt;"
                // &lt;variant&gt; could be an os/platform/model/company
                // for ex: for cisco vendor, there could variants wrt
                // os (such as ios, nxos etc), platforms (asa etc),
                // or acquired companies (such as meraki, airnonet) etc.
                //
                // currentluy supported vendor values are:
                // generic, juniper, aruba, paloalto, brocade
                // cisco-aironet, cisco-ios, cisco-meraki, cisco-dnac

                "vendor": "cisco-ios",
                "secret": "alternative_one",  // optional, if different from above
                "require_message_authenticator": true, // default is false
                "site_id": "00000000-0000-0000-1234-000000000000"  // optional; present only for 3rd party clients
            }
        },

        "auth_server_port": 1812,  // optional, default is 1812
        "acct_server_port": 1813,  // optional, default is 1813
    }

    "tunterm_monitoring_disabled": false,
    "tunterm_monitoring": [
         {
             "protocol": "ping",   // arp / ping / tcp
             "host": "10.2.8.15",  // can be ip, ipv6, hostname
             "timeout": 300,  // 60 - 3600, default is 300

             // when protocol==tcp
             "port": 80
         }
    ],

    "tunterm_extra_routes": {
        "11.0.0.0/8": {
            "via": "10.3.3.1"
        }
    },

    // default type == "relay"
    "tunterm_dhcpd_config": {
        "enabled": false, // required
        "servers": ["11.2.3.4"],
        "2": { // VLAN ID
            "enabled": true, // required
            "servers": ["11.2.3.44"],
        }
    },

    "tunterm_multicast_config": {
        "mdns": {
            "enabled": true,
            "vlan_ids": [2, 3, 5]
        },
        "ssdp": {
            "enabled": true,
            "vlan_ids": [2, 3, 5]
        },
        "multicast_all": true
    }
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>proxy</code></td>
<td><code>object</code></td>
<td>Proxy Configuration to talk to Mist</td>
</tr>
<tr>
<td><code>tunterm_hosts</code></td>
<td><code>list</code></td>
<td>hostnames or IPs where a Mist Tunnel will use as the Peer (i.e. they are reachable from AP)</td>
</tr>
<tr>
<td><code>tunterm_hosts_selection</code></td>
<td><code>string</code></td>
<td>shuffle (default) / shuffle-by-site / ordered. Ordering of tunterm_hosts for mxedge within the same mxcluster. When shuffle, the ordering of tunterm_hosts is randomized by the device’s MAC. When shuffle-by-site, we shuffle by site_id+tunnel_id (so when client connects to a specific Tunnel, it will go to the same (order of) mxedge, and we load-balancing between tunnels). When ordered, the order is decided by tunterm_hosts_order.</td>
</tr>
<tr>
<td><code>tunterm_hosts_order</code></td>
<td><code>list</code></td>
<td>list of index of tunterm_hosts</td>
</tr>
<tr>
<td><code>tunterm_ap_subnets</code></td>
<td><code>list</code></td>
<td>list of subnets where we allow AP to establish Mist Tunnels from</td>
</tr>
<tr>
<td><code>tunterm_extra_routes</code></td>
<td><code>object</code></td>
<td>extra routes for Mist Tunneled VLANs</td>
</tr>
<tr>
<td><code>tunterm_dhcpd_config</code></td>
<td><code>object</code></td>
<td>DHCP server/relay configuration of Mist Tunneled VLANs</td>
</tr>
<tr>
<td><code>tunterm_multicast_config</code></td>
<td><code>object</code></td>
<td>tunterm multicast configs</td>
</tr>
</tbody>
</table>
<h4 id="dynamic-authorization-mist_das">Dynamic Authorization (mist_das)</h4>
<p><code>enabled</code>|<code>boolean</code>| whether to enable mist das, default is false
<code>coa_servers</code>|<code>list</code>| list of COA (change of authorization) servers allowed as dynamic authorization clients; default for enabled is false
<code>require_message_authenticator</code>|<code>boolean</code>| whether to require Message-Authenticator in requests, default is false
<code>disable_event_timestamp_check</code>|<code>boolean</code>| whether to disable Event-Timestamp Check, optional, default is false</p>
<h4 id="radius-proxy-radsec">RADIUS Proxy (radsec)</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether to enable service on Mist Edge i.e. RADIUS proxy over TLS</td>
</tr>
<tr>
<td><code>proxy_hosts</code></td>
<td><code>list</code></td>
<td>hostnames or IPs for Mist AP to use as the TLS Server (i.e. they are reachable from AP) in addition to <code>tunterm_hosts</code></td>
</tr>
<tr>
<td><code>match_ssid</code></td>
<td><code>boolean</code></td>
<td>whether to match ssid in request message to select from a subset of RADIUS servers</td>
</tr>
<tr>
<td><code>server_selection</code></td>
<td><code>string</code></td>
<td>ordered (default) / unordered. When ordered, Mist Edge will prefer and go back to the first radius server if possible</td>
</tr>
<tr>
<td><code>auth_servers</code></td>
<td><code>list</code></td>
<td>list of RADIUS authentication servers, order matters where the first one is treated as primary</td>
</tr>
<tr>
<td><code>acct_servers</code></td>
<td><code>list</code></td>
<td>list of RADIUS accounting servers, optional, order matters where the first one is treated as primary</td>
</tr>
<tr>
<td><code>src_ip_source</code></td>
<td><code>string</code></td>
<td>tunnel / oob / any (default). Specify IP address to connect to auth_servers and acct_servers</td>
</tr>
<tr>
<td><code>nas_ip_source</code></td>
<td><code>string</code></td>
<td>tunnel / oob / passthrough (default). Specify NAS-IP-ADDRESS, NAS-IPv6-ADDRESS to use with auth_servers</td>
</tr>
</tbody>
</table>
<h5 id="radius-server">RADIUS Server</h5>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>host</code></td>
<td><code>string</code></td>
<td>ip / hostname of RADIUS server</td>
</tr>
<tr>
<td><code>port</code></td>
<td><code>int</code></td>
<td>port of RADIUS server, default is 1812 for auth server and 1813 for acct server</td>
</tr>
<tr>
<td><code>secret</code></td>
<td><code>string</code></td>
<td>secret of RADIUS server</td>
</tr>
<tr>
<td><code>require_message_authenticator</code></td>
<td><code>boolean</code></td>
<td>whether to require Message-Authenticator in response messages, default is false</td>
</tr>
<tr>
<td><code>ssids</code></td>
<td><code>list</code></td>
<td>list of ssids that will use this server if match_ssid is true and match is found</td>
</tr>
<tr>
<td><code>inband_status_check</code></td>
<td><code>boolean</code></td>
<td>whether to enable inband status check, default is false</td>
</tr>
<tr>
<td><code>inband_status_interval</code></td>
<td><code>int</code></td>
<td>inband status interval, in seconds, default is 300</td>
</tr>
</tbody>
</table>
<h2 id="mist-tunnel">Mist Tunnel</h2>
<p>A Mist Tunnel is a special type of L2TPv3 Tunnel that is terminated by a Mist Edge. As we’re configuring both sides,
some parameters are automatically generated.</p>
<h3 id="base-uri_13">Base URI</h3>
<pre><code>/api/v1/orgs/:org_id/mxtunnels
</code></pre>
<h3 id="schema_3">Schema</h3>
<pre><code>{
    "name": "HQ",
    "protocol": "udp",
    "vlan_ids": [3, 4, 5, "7-9"],
    "mxcluster_ids": ["572586b7-f97b-a22b-526c-8b97a3f609c4"],
    "anchor_mxtunnel_ids": ["1e970fec-0a7a-4d73-a472-3ef3b6a456aa"],

    "hello_interval": 60,
    "hello_retries": 3,

    "ipsec": {
        "enabled": true,

        "split_tunnel": true,
        "dns_servers": [ "172.16.0.8" ],
        "dns_suffix": ["corp.juniper.com", "juniper.internal"],
        "extra_routes": [
            {"dest": "172.16.0.0/12", "next_hop": "172.16.0.1" }
        ]
    },
    "auto_preemption": {
        "enabled": true,
        "time_of_day": "23:00",
        "day_of_week": "sun"
    }
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>the name of the tunnel</td>
</tr>
<tr>
<td><code>protocol</code></td>
<td><code>list</code></td>
<td>udp / ip, default is udp</td>
</tr>
<tr>
<td><code>vlan_ids</code></td>
<td><code>list</code></td>
<td>list of vlan ids/ranges that will be used</td>
</tr>
<tr>
<td><code>mxcluster_ids</code></td>
<td><code>list</code></td>
<td>list of mxclusters to deploy this tunnel to</td>
</tr>
<tr>
<td><code>anchor_mxtunnel_ids</code></td>
<td><code>list</code></td>
<td>list of anchor mxtunnels used for forming edge to edge tunnels</td>
</tr>
<tr>
<td><code>hello_interval</code></td>
<td><code>float</code></td>
<td>in seconds, used as heartbeat to detect if a tunnel is alive. AP will try another peer after missing N hellos specified by <code>hello_retries</code>. between 0.5 and 300, default is 60 seconds</td>
</tr>
<tr>
<td><code>hello_retries</code></td>
<td><code>int</code></td>
<td>between 1 and 30, default is 7</td>
</tr>
<tr>
<td><code>auto_preemption</code></td>
<td><code>object</code></td>
<td>schedule(daily/weekly) to preempt ap’s which are not connected to preferred peer</td>
</tr>
</tbody>
</table>
<h4 id="auto-preemption-parameters">Auto Preemption Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>whether auto preemption should happen, default is false</td>
</tr>
<tr>
<td><code>time_of_day</code></td>
<td><code>string</code></td>
<td>any / HH:MM (24-hour format). Preemption will happen within 15 mins of this time</td>
</tr>
<tr>
<td><code>day_of_week</code></td>
<td><code>string</code></td>
<td>any / mon / tue / wed / thu / fri / sat / sun</td>
</tr>
</tbody>
</table>
<h2 id="preempt-mxtunnel-aps-to-preferred-peer">Preempt mxtunnel ap’s to preferred peer</h2>
<p>To preempt AP’s which are not connected to preferred peer to the preferred peer</p>
<pre><code>POST /api/v1/orgs/:org_id/mxtunnels/:mxtunnel_id/preempt_aps
</code></pre>
<h3 id="response_140">Response</h3>
<pre><code>{
   "preempted_aps": ["5c5b35000001", "5c5b35000002"]
}
</code></pre>
<h2 id="get-mist-edge-stats">Get Mist Edge Stats</h2>
<pre><code>GET /api/v1/orgs/:org_id/stats/mxedges
</code></pre>
<h3 id="parameters_62">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>for_site</code></td>
<td><code>string</code></td>
<td>true / false/ any (default false). Filter for site level mist edges</td>
</tr>
</tbody>
</table>
<h3 id="response_141">Response</h3>
<pre><code>[
    {
        "memory_stat": {
            "total": 8365957120,
            "free": 4330659840,
            "usage": 48,
            "available": 4699291648,
            "buffers": 107646976,
            "cached": 478060544,
            "swap_cached": 0,
            "active": 394936320,
            "inactive": 211980288,
            "swap_total": 1022357504,
            "swap_free": 1022357504
        },
        "proxy": {
            "url": "http://proxy.internal:8080/"
        },
        "oob_ip_stat": {
            "type": "static",
            "ip": "10.2.1.10",
            "netmask": "255.255.255.0",
            "gateway": "10.2.1.254",
            "type6": "static",
            "ip6": "2601:1700:43c0:dc0:20c:29ff:fea7:93bc",
            "netmask6": "/64",
            "gateway6": "2601:1700:43c0:dc0::1",
            "dns": ["10.2.1.2", "2601:1700:43c0:dc0::2"]
        },
        "ip_stat": {
            "ips": {
                "ens18": "192.168.1.244/24,fd4e:c615:b27d:5555::45/128,fd4e:c615:b27d:5555:20c:29ff:fe44:af25/64,fe80::104c:ffff:fee0:caf8/64"
            },
            "ip": "192.168.1.244",
            "ip6": "fd4e:c615:b27d:5555::45",
            "netmask": "255.255.255.0",
            "netmask6": "/128",
            "macs": {
               "ens18": "e4434b217044"
            }
        },
        "mxcluster_id": "678bc339-7635-4556-bbc0-e77ad493ef8b",
        "virtualization_type": "KVM",
        "distro": "buster",
        "idrac_version": "7.00.00.00",
        "fwupdate": {
            "timestamp": 1633721215,
            "status": "inprogress"
            "progress": 50
        },
        "last_seen": 1633721215,
        "uptime": 76281,
        "service_stat": {
            "tunterm": {
                "running_state": "Running",
                "package_state": "Installed",
                "package_version": "0.1.2449+deb10",
                "last_seen": 1633721203,
                "ext_ip": "99.0.86.164",
                "uptime": 76261
            },
            "mxagent": {
                "running_state": "Running",
                "package_state": "Installed",
                "package_version": "3.1.1037-1",
                "last_seen": 1633721215,
                "ext_ip": "99.0.86.164",
                "uptime": 21240
            }
        },
        "tunterm_stat": {
            "monitoring_failed": false
        },
        "num_tunnels": 0,
        "lag_stat": {
            "lacp0": {
                "active_ports": [
                    "port0",
                    "port1"
                ]
            }
        },
        "port_stat": {
            "port0": {
                "up": true,
                "speed": 10000,
                "full_duplex": true,
                "tx_bytes": 647200748038,
                "tx_pkts": 8788647466,
                "tx_errors": 0,
                "rx_bytes": 646898375700,
                "rx_pkts": 8784449574,
                "rx_errors": 0,
                "mac": "9e294e49091d",
                "state": "forwarding"
            },
            "port1": {
                "up": true,
                "speed": 10000,
                "full_duplex": true,
                "tx_bytes": 646898681650,
                "tx_pkts": 8784452092,
                "tx_errors": 0,
                "rx_bytes": 647200437652,
                "rx_pkts": 8788644886,
                "rx_errors": 0,
                "mac": "a270fe53437e",
                "state": "forwarding"
            }
        },
        "name": "me-vm-1",
        "model": "ME-VM",
        "tunterm_ip_config": {
            "ip": "192.168.11.91",
            "netmask": "255.255.255.0",
            "gateway": "192.168.11.1"
        },
        "tunterm_port_config": {
            "separate_upstream_downstream": false,
            "upstream_ports": [
                "0",
                "1"
            ],
            "downstream_ports": [
                "0",
                "1"
            ]
        },
        "services": [
            "tunterm"
        ],
        "id": "00000000-0000-0000-1000-020000a80cb4",
        "for_site": false,
        "org_id": "11b08247-b1ee-4152-9b25-312b323ce480",
        "created_time": 1632684398,
        "modified_time": 1633643629,
        "site_id": "00000000-0000-0000-0000-000000000000",
        "mac": "020000a80cb4",
        "mxagent_registered": true,
        "tunterm_registered": true,
        "status": "connected"
    }
]
</code></pre>
<h4 id="definitions_23">Definitions</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>The name of the tunnel</td>
</tr>
<tr>
<td><code>virtualization_type</code></td>
<td><code>string</code></td>
<td>Virtualization environment</td>
</tr>
<tr>
<td><code>memory_stats</code></td>
<td><code>object</code></td>
<td>Memory usage</td>
</tr>
<tr>
<td><code>total</code></td>
<td><code>int</code></td>
<td>Total amount of usable RAM, in kibibytes, which is physical RAM minus a number of reserved bits and the kernel binary code.</td>
</tr>
<tr>
<td><code>free</code></td>
<td><code>int</code></td>
<td>The amount of physical RAM, in kibibytes, left unused by the system.</td>
</tr>
<tr>
<td><code>available</code></td>
<td><code>int</code></td>
<td>An estimate of how much memory is available for starting new applications, without swapping.</td>
</tr>
<tr>
<td><code>buffers</code></td>
<td><code>int</code></td>
<td>The amount, in kibibytes, of temporary storage for raw disk blocks.</td>
</tr>
<tr>
<td><code>cached</code></td>
<td><code>int</code></td>
<td>The amount of physical RAM, in kibibytes, used as cache memory.</td>
</tr>
<tr>
<td><code>swap_cached</code></td>
<td><code>int</code></td>
<td>The amount of memory, in kibibytes, that has once been moved into swap, then back into the main memory, but still also remains in the swapfile.</td>
</tr>
<tr>
<td><code>active</code></td>
<td><code>int</code></td>
<td>The amount of memory, in kibibytes, that has been used more recently and is usually not reclaimed unless absolutely necessary.</td>
</tr>
<tr>
<td><code>inactive</code></td>
<td><code>int</code></td>
<td>The amount of memory, in kibibytes, that has been used less recently and is more eligible to be reclaimed for other purposes.</td>
</tr>
<tr>
<td><code>swap_total</code></td>
<td><code>int</code></td>
<td>The total amount of swap available, in kibibytes.</td>
</tr>
<tr>
<td><code>swap_free</code></td>
<td><code>int</code></td>
<td>The total amount of swap free, in kibibytes.</td>
</tr>
<tr>
<td><code>cpu_stat</code></td>
<td><code>object</code></td>
<td>CPU/core stats list</td>
</tr>
<tr>
<td><code>usage</code></td>
<td><code>int</code></td>
<td>percentage of load, Busy/(Idle + Busy) since last sampling</td>
</tr>
<tr>
<td><code>user</code></td>
<td><code>float</code></td>
<td>percentage of User, User/(Idle + Busy) since last sampling</td>
</tr>
<tr>
<td><code>system</code></td>
<td><code>float</code></td>
<td>percentage of System, System/(Idle + Busy) since last sampling</td>
</tr>
<tr>
<td><code>idle</code></td>
<td><code>float</code></td>
<td>percentage of Idle, Idle/(Idle + Busy) since last sampling</td>
</tr>
<tr>
<td><code>interrupt</code></td>
<td><code>float</code></td>
<td>percentage of Interrupt, (Irq + SoftIrq)/(Idle + Busy) since last sampling</td>
</tr>
<tr>
<td><code>ip_stat</code></td>
<td><code>object</code></td>
<td>OOBM IP stats</td>
</tr>
<tr>
<td><code>ips</code></td>
<td><code>object</code></td>
<td>IPs for each net interface</td>
</tr>
<tr>
<td><code>macs</code></td>
<td><code>object</code></td>
<td>MAC addresses for each net interface</td>
</tr>
<tr>
<td><code>service_stat</code></td>
<td><code>object</code></td>
<td>stat for each services</td>
</tr>
<tr>
<td><code>ext_ip</code></td>
<td><code>string</code></td>
<td>external IP from ep-terminator’s point of view. valid only for service having its own cloud connection</td>
</tr>
<tr>
<td><code>last_seen</code></td>
<td><code>int</code></td>
<td>timestamp when the last stats is seen (cloud unix time, in second). valid only for service having its own stats or whole system (last among last_seen of all services)</td>
</tr>
<tr>
<td><code>uptime</code></td>
<td><code>int</code></td>
<td>service or system uptime.</td>
</tr>
<tr>
<td><code>package_state</code></td>
<td><code>string</code></td>
<td>package/service installation state.</td>
</tr>
<tr>
<td><code>package_version</code></td>
<td><code>string</code></td>
<td>package/service installation state.</td>
</tr>
<tr>
<td><code>running_state</code></td>
<td><code>string</code></td>
<td>service running state.</td>
</tr>
<tr>
<td><code>lag_stat</code></td>
<td><code>object</code></td>
<td>stat for LAG (Link Aggregation Group)</td>
</tr>
<tr>
<td><code>active_ports</code></td>
<td><code>list</code></td>
<td>list of ports active on the LAG defined by the LACP</td>
</tr>
<tr>
<td><code>distro</code></td>
<td>string</td>
<td>debian code name(buster, bullseye)</td>
</tr>
<tr>
<td><code>fips_enabled</code></td>
<td>bool</td>
<td>value indicating fips configuration on the device</td>
</tr>
<tr>
<td><code>fwupdate</code></td>
<td><code>object</code></td>
<td>information about firmware upgrade status.</td>
</tr>
<tr>
<td><code>idrac_version</code></td>
<td><code>object</code></td>
<td>IDRAC version of the mist edge device</td>
</tr>
</tbody>
</table>
<h5 id="firmware-upgrade-status">Firmware Upgrade Status</h5>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>timestamp</code></td>
<td><code>float</code></td>
<td>timestamp</td>
</tr>
<tr>
<td><code>status</code></td>
<td><code>string</code></td>
<td>possible values are <code>inprogress</code>, <code>failed</code>, <code>upgraded</code>.</td>
</tr>
<tr>
<td><code>progress</code></td>
<td><code>int</code></td>
<td>progress percentage of the distro upgrade</td>
</tr>
</tbody>
</table>
<h2 id="get-one-mist-edge-stat">Get One Mist Edge Stat</h2>
<pre><code>GET /api/v1/orgs/:org_id/stats/mxedges/:mxedge_id
</code></pre>
<h3 id="parameters_63">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>for_site</code></td>
<td><code>string</code></td>
<td>false (default) / true / any</td>
</tr>
</tbody>
</table>
<h2 id="search-mist-tunnel-stats">Search Mist Tunnel Stats</h2>
<pre><code>GET /api/v1/orgs/:org_id/stats/tunnels/search
</code></pre>
<h3 id="response_142">Response</h3>
<pre><code>{
    "total": 1,
    "start": 1531776183.0,
    "limit": 10,
    "end": 1531862583.0,
    "results": [
        {
            "org_id": "2818e386-8dec-2562-9ede-5b8a0fbbdc71",
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "mxedge_id": "387804a7-3474-85ce-15a2-f9a9684c9c90",
            "mxcluster_id": "572586b7-f97b-a22b-526c-8b97a3f609c4",
            "mxtunnel_id": "7dae216d-7c98-a51b-e068-dd7d477b7216",

            "ap": "5c5b35000010",
            "remote_ip": "172.16.1.2",
            "remote_port": 13535
            "state": "established_with_sessions",
            "last_seen": 1547437078,
            "uptime": 135,
            "tx_control_pkts": 14862,
            "rx_control_pkts": 7571,
            "peer_mxedge_id": "09320a5c-bc23-441e-80a0-b96c632d45f5",
            "mtu": 582,

            "sessions: [
                {
                    "remote_id": "mxtunnel",
                    "state": "established",
                    "remote_sid": 13,
                    "local_sid": 31
                }
            ]
        }
    }
}
</code></pre>
<h4 id="definitions_24">Definitions</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mxtunnel_id</code></td>
<td><code>string</code></td>
<td>Mist Tunnel ID</td>
</tr>
<tr>
<td><code>state</code></td>
<td><code>string</code></td>
<td>idle / wait-ctrl-reply / wait-ctrl-conn / established / established_with_sessions</td>
</tr>
<tr>
<td><code>uptime</code></td>
<td><code>int</code></td>
<td>uptime</td>
</tr>
<tr>
<td><code>sessions</code></td>
<td><code>list</code></td>
<td>list of sessions</td>
</tr>
<tr>
<td><code>remote_id</code></td>
<td><code>string</code></td>
<td>WxlanTunnel Remote ID</td>
</tr>
<tr>
<td><code>remote_sid</code></td>
<td><code>int</code></td>
<td>remote sessions id (dynamically unless Tunnel is said to be static)</td>
</tr>
<tr>
<td><code>local_sid</code></td>
<td><code>int</code></td>
<td>remote sessions id (dynamically unless Tunnel is said to be static)</td>
</tr>
<tr>
<td><code>peer_mxedge_id</code></td>
<td><code>string</code></td>
<td>MxEdge ID of the peer(mist edge to mist edge tunnel)</td>
</tr>
<tr>
<td><code>mtu</code></td>
<td><code>int</code></td>
<td>Maximum Transmission Unit</td>
</tr>
</tbody>
</table>
<h2 id="count-mist-tunnels-stats">Count Mist Tunnels Stats</h2>
<pre><code>GET /api/v1/orgs/:org_id/stats/tunnels/count
GET /api/v1/orgs/:org_id/stats/tunnels/count?distinct=mxedge_id
</code></pre>
<h3 id="request_74">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>wxtunnel_id / ap / remote_ip / remote_port / state / mxedge_id / mxcluster_id / site_id / peer_mxedge_id; default is wxtunnel_id</td>
</tr>
</tbody>
</table>
<h3 id="response_143">Response</h3>
<pre><code>{
    "results": [
        {
            "mxedge_id": "00000000-0000-0000-1000-d420b0f000e0",
            "count": 5
        },
        {
            "mxedge_id": "00000000-0000-0000-1000-0200009eddfb",
            "count": 3
        },
        {
            "mxedge_id": "00000000-0000-0000-1000-d420b0f00064",
            "count": 1
        }
    ],
    "start": 1660159907.3540995,
    "end": 1660160207.3541,
    "limit": 10,
    "distinct": "mxedge_id",
    "total": 3
}
</code></pre>
<h2 id="search-mist-ext-tunnel-stats">Search Mist Ext Tunnel Stats</h2>
<pre><code>GET /api/v1/orgs/:org_id/stats/tunnels/search?type=wan
</code></pre>
<h3 id="response_144">Response</h3>
<pre><code>{
    "total": 1,
    "start": 1531776183.0,
    "limit": 10,
    "end": 1531862583.0,
    "results": [
        {
            "tunnel_name" : "Device-ipsec-1",
            "mac" : "020001ae9dd5",
            "uptime" : 10,
            "up": true,
            "node" : "node0",
            "protocol" : "ipsec",
            "When" : "2022-10-27T10:53:20.973Z",
            "peer_ip" : "10.224.8.16",
            "priority" : "primary",
            "org_id" : "78c11da8-f984-4425-bedb-a7ddd7d0f6da",
            "site_id" : "e83e7928-eda1-4e93-82db-df3dd42ab726",
            "rx_bytes" : 150,
            "tx_bytes" : 100,
            "tx_pkts" : 50,
            "rx_pkts" : 75,
            "peer_host" : "sunnyvale1-vpn.zscalerbeta.net",
            "last_event": "down reason",
            "ip" : "192.168.233.0",
            "auth_algo" : "hmac-md5-96",
            "encrypt_algo" : "aes-256-cbc",
            "ike_version" : "2",
            "wan_name" : "wan"
        }
    ]
}
</code></pre>
<h4 id="definitions_25">Definitions</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tunnel_name</code></td>
<td><code>string</code></td>
<td>Mist Tunnel Name</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>router mac address</td>
</tr>
<tr>
<td><code>uptime</code></td>
<td><code>int</code></td>
<td>duration from first (or last) SA was established</td>
</tr>
<tr>
<td><code>up</code></td>
<td><code>boolean</code></td>
<td>true/false</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>node0/node1</td>
</tr>
<tr>
<td><code>protocol</code></td>
<td><code>string</code></td>
<td>ipsec/gre</td>
</tr>
<tr>
<td><code>peer_ip</code></td>
<td><code>string</code></td>
<td>peer ip address</td>
</tr>
<tr>
<td><code>peer_host</code></td>
<td><code>string</code></td>
<td>peer host</td>
</tr>
<tr>
<td><code>priority</code></td>
<td><code>string</code></td>
<td>primary/secondary</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org ID</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site ID</td>
</tr>
<tr>
<td><code>rx_bytes</code></td>
<td><code>int</code></td>
<td>received bytes</td>
</tr>
<tr>
<td><code>tx_bytes</code></td>
<td><code>int</code></td>
<td>sent bytes</td>
</tr>
<tr>
<td><code>tx_pkts</code></td>
<td><code>int</code></td>
<td>count of data packets sent</td>
</tr>
<tr>
<td><code>rx_pkts</code></td>
<td><code>int</code></td>
<td>count of data packets received</td>
</tr>
<tr>
<td><code>last_event</code></td>
<td><code>string</code></td>
<td>reason of why the tunnel is down</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>ip address</td>
</tr>
<tr>
<td><code>auth_algo</code></td>
<td><code>string</code></td>
<td>authentication algorithm</td>
</tr>
<tr>
<td><code>encrypt_algo</code></td>
<td><code>string</code></td>
<td>encryption algorithm</td>
</tr>
<tr>
<td><code>ike_version</code></td>
<td><code>string</code></td>
<td>ike version</td>
</tr>
<tr>
<td><code>wan_name</code></td>
<td><code>string</code></td>
<td>wan interface name</td>
</tr>
</tbody>
</table>
<h2 id="count-mist-ext-tunnels-stats">Count Mist Ext Tunnels Stats</h2>
<pre><code>GET /api/v1/orgs/:org_id/stats/tunnels/count?type=wan
GET /api/v1/orgs/:org_id/stats/tunnels/count?type=wan&amp;distinct=mac
</code></pre>
<h3 id="request_75">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>mac / site_id / node / peer_ip / peer_host/ ip / tunnel_name / protocol / auth_algo / encrypt_algo / ike_version / last_event / up</td>
</tr>
<tr>
<td>### Response</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<pre><code>{
    "results": [
        {
            "mac": "020001c04668",
            "count": 2
        },
        {
            "mac": "02000111d2dc",
            "count": 1
        },
        {
            "mac": "d420b080516d",
            "count": 1
        }
    ],
    "start": 1660159907.3540995,
    "end": 1660160207.3541,
    "limit": 10,
    "distinct": "mac",
    "total": 3
}
</code></pre>
<p>## Subscribe to devices Stream</p>
<pre><code> WS /api-ws/v1/stream
</code></pre>
<p>### Request</p>
<p><code>{
     "subscribe": "/orgs/:org_id/mxedges"
 }</code></p>
<p>### Response</p>
<p><code>{
     "event": "data",
     "channel": "/orgs/67970e46-4e12-11e6-9188-0242ac110007/mxedges",
     "data": {
         "device_id": "00000000-0000-0000-1000-5c5b3524500b",
         "event_type": "fwupdate",
         "detail": {
             "timestamp": 1485381027,
             "status": "inprogress",
             "progress": 45
         }
     }
 }</code></p>
<p>### Definition</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>device_id</code></td>
<td><code>string</code></td>
<td>device_id of the device corresponding to the event</td>
</tr>
<tr>
<td><code>event_type</code></td>
<td><code>string</code></td>
<td>type of the event that occurred. currently, on device updates are reported on the stream.</td>
</tr>
<tr>
<td><code>detail</code></td>
<td><code>object</code></td>
<td>detail will be specific to the <code>event_type</code>.</td>
</tr>
</tbody>
</table>
<h1 id="mist-edge-packet-capture">Mist Edge Packet Capture</h1>
<h2 id="initiate-a-mist-edge-packet-capture">Initiate a Mist Edge Packet Capture</h2>
<p>For packet captures of org level Mist Edges only. Use site API for site level Mist Edges.</p>
<pre><code>POST /api/v1/orgs/:org_id/pcaps/capture
</code></pre>
<h3 id="request_76">Request</h3>
<pre><code>{
    "type": "mxedge",
    "num_packets": 100,
    "duration": 600,
    "max_pkt_len": 1500,
    "mxedges": {
        "00000000-0000-0000-1000-001122334455": {
            "interfaces": {"port1": {"tcpdump_expression": "udp port 67 or udp port 68"},
                      }
        },
    },
    "tcpdump_expression": "vlan 999",
    "format": "tzsp",
    "tzsp_host": "192.168.1.2",
    "tzsp_port": 37008
}
</code></pre>
<h3 id="parameters_64">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>num_packets</code></td>
<td><code>int</code></td>
<td>number of packets to capture, default is 1024, maximum of 10000</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>duration of the capture, in seconds, default is 600, maximum is 86400</td>
</tr>
<tr>
<td><code>max_pkt_len</code></td>
<td><code>int</code></td>
<td>max_len of each packet to capture, default is 128, maximum is 2048</td>
</tr>
<tr>
<td><code>mxedges</code></td>
<td><code>dict</code></td>
<td>dict of mxedges which uses mxedge_id as the key, currently limited to one mxedge per org capture session</td>
</tr>
<tr>
<td><code>interfaces</code></td>
<td><code>dict</code></td>
<td>dict of interfaces to capture for, for given mxedge (examples: port1, kni0, lacp0, ipsec, drop, oobm), currently limited to specifying one interface per mxedge</td>
</tr>
<tr>
<td><code>tcpdump_expression</code></td>
<td><code>string</code></td>
<td>tcpdump expression, interface specific if specified under interfaces dict, otherwise applicable across interfaces if specified at top level of payload. Interface specific value overrides top level value when both exist.</td>
</tr>
<tr>
<td><code>format</code></td>
<td><code>string</code></td>
<td>pcap format: <code>stream</code> (default, to Mist cloud), <code>tzsp</code> (stream packets (over UDP as TZSP packets) to a remote host (typically running Wireshark) instead of Mist cloud)</td>
</tr>
<tr>
<td><code>tzsp_host</code></td>
<td><code>string</code></td>
<td>remote host accessible to mxedges over the network for receiving the captured packets. Required when <code>format</code> is <code>tzsp</code>.</td>
</tr>
<tr>
<td><code>tzsp_port</code></td>
<td><code>int</code></td>
<td>optional port on remote host for receiving the captured packets, default (if not provided) 37008 (TZSP).</td>
</tr>
</tbody>
</table>
<h2 id="stop-current-capture">Stop current capture</h2>
<pre><code>DELETE /api/v1/orgs/:org_id/pcaps/capture
</code></pre>
<h2 id="get-a-list-of-captures">Get a list of captures</h2>
<pre><code>GET /api/v1/orgs/:org_id/pcaps?start=1461099816&amp;end=1461089816&amp;limit=100
</code></pre>
<h3 id="request_77">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>start</code></td>
<td><code>int</code></td>
<td>start time</td>
</tr>
<tr>
<td><code>end</code></td>
<td><code>int</code></td>
<td>end time</td>
</tr>
</tbody>
</table>
<h3 id="response_145">Response</h3>
<pre><code>{
    "start": 1461099816,
    "end": 1461089816,
    "limit": 100,
    "next": "/api/v1/orgs/78c11da8-f984-4425-bedb-a7ddd7d0f6da/pcaps?end=1695836987&amp;limit=10&amp;search_after=%5B1693259163006%5D&amp;start=1693244987"

    "results": [
        {
            "duration": 9999.0,
            "timestamp": 1693525333.234066,
            "last_seen": 1693482149.417,
            "org_id": "78c11da8-f984-4425-bedb-a7ddd7d0f6da",
            "format": "stream",
            "mxedges": [
                "00000000-0000-0000-1000-001122334455"
            ],
            "termination_reason": "default",
            "site_id": null,
            "id": "80cec4c9-322c-4712-95ce-6ba47fb54fc0",
            "pcap_url": "https://...",
            "type": "mxedge"
        }
    ]
}
</code></pre>
<h2 id="get-capturing-status">Get Capturing status</h2>
<pre><code>GET /api/v1/orgs/:org_id/pcaps/capture
</code></pre>
<h3 id="response_146">Response</h3>
<pre><code>{
    // from the initiation of the packet capture
    "timestamp": 1695837460.309526,
    "id": "c5bd6c89-fa52-486f-9fd0-801cfc613328",
    "org_id": "78c11da8-f984-4425-bedb-a7ddd7d0f6da",
    "site_id": null,
    "type": "mxedge",
    "max_num_packets": 1024,
    "max_pkt_len": 512,
    "duration": 600,
    "enabled": true,
    "expiry": 1695838060.309526,
    "mxedge_count": 1,
    "invalid_mxedges": {},
    "format": "stream",
    "raw": true,
    // what's actually being done
    "mxedges": {
        "00000000-0000-0000-1000-001122334455": {
            "interfaces": {
                "port1": {
                    "tcpdump_expression": "udp port 67 or udp port 68"
                }
            }
        }
    }
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>max_num_packets</code></td>
<td><code>int</code></td>
<td>number of packets to capture</td>
</tr>
<tr>
<td><code>duration</code></td>
<td><code>int</code></td>
<td>duration of the capture, in seconds</td>
</tr>
<tr>
<td><code>max_pkt_len</code></td>
<td><code>int</code></td>
<td>max_len of each packet to capture</td>
</tr>
<tr>
<td><code>mxedges</code></td>
<td><code>dict</code></td>
<td>dict of mxedges which uses mxedge_id as the key</td>
</tr>
<tr>
<td><code>interfaces</code></td>
<td><code>dict</code></td>
<td>dict of interfaces to capture for, for given mxedge</td>
</tr>
<tr>
<td><code>tcpdump_expression</code></td>
<td><code>string</code></td>
<td>tcpdump expression, interface specific if specified under interfaces dict, otherwise applicable across interfaces if specified at top level of payload. Interface specific value overrides top level value when both exist.</td>
</tr>
<tr>
<td><code>format</code></td>
<td><code>string</code></td>
<td>pcap format: <code>stream</code> (default), <code>tzsp</code></td>
</tr>
<tr>
<td><code>tzsp_host</code></td>
<td><code>string</code></td>
<td>remote host receiving the captured packets, when <code>format</code> is <code>tzsp</code></td>
</tr>
<tr>
<td><code>tzsp_port</code></td>
<td><code>int</code></td>
<td>port on remote host for receiving the captured packets, when <code>format</code> is <code>tzsp</code></td>
</tr>
</tbody>
</table>
<h2 id="subscribe-to-streaming-pcap">Subscribe to streaming PCAP</h2>
<pre><code>WS /api-ws/v1/stream
</code></pre>
<h3 id="request_78">Request</h3>
<pre><code>{
    {subscribe: "/orgs/:org_id/pcaps"}
}
</code></pre>
<h3 id="response_147">Response</h3>
<pre><code>{
    "event": "data"
    "channel": "/orgs/67970e46-4e12-11e6-9188-0242ac110007/pcaps"
    "data": {
        "capture_id": "f039b1b4-a23e-48b2-906a-0da40524de73", 
        "pcap_dict": {
             "dst_mac": "68:ec:c5:09:2e:87",
             "src_mac": "8c:3b:ad:e0:47:40", 
             "vlan": 1, 
             "src_ip": "34.224.147.117", 
             "dst_ip": "192.168.1.55",
             "dst_port": 51635, 
             "src_port": 443,
             "protocol": "TCP", 
             "mxedge_id": "00000000-0000-0000-1000-001122334455",
             "direction": "tx", 
             "timestamp": 1652247615, 
             "length": 159.0, 
             "interface": "port0",
             "info": "1652247616.007409 IP ec2-34-224-147-117.compute-1.amazonaws.com.https &gt; ip-192-168-1-55.ec2.internal.51635: Flags [P.], seq 
                      2192123968:2192124057, ack 4035166782, win 12, options [nop,nop,TS val 597467050 ecr 740580660], length 89\\n",
             }, 
        "pcap_raw": "1MOyoQIABAAAAAAAAAAAAP//AAABAAAAQEx7YhMzAACfAAAAnwAAAGjsxQkuh4w7reBHQIEAAAEIAEUAAI1bLEAAKAZ/CiLgk3XAqAE3AbvJs4KpKEDwg8I+gBgADFf9AAABAQgKI5yfqiwkXTQXAwMAVKY5JopoKQrVEn0/3ld4YntctGEH/rTZuwtCvzSncFw71QJveJi9uxHs57KC8w9Apph3YvXJrmWg7M37+o+YV0KH/xmr626s5Bkhb3QhKOu+NoNEmA==\"

    }
}
</code></pre>
<h3 id="stop-response">Stop Response</h3>
<pre><code>{
    "event": "data"
    "channel": "/orgs/67970e46-4e12-11e6-9188-0242ac110007/pcaps"
    "data": {
      "capture_id": "a2f7374d-6a70-41fd-8a3f-71e42573baaf", 
      "pcap_dict": null
    }
}
</code></pre>
<h3 id="definitions_26">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>event</code></td>
<td><code>string</code></td>
<td>what type of event is received.</td>
</tr>
<tr>
<td><code>channel</code></td>
<td><code>string</code></td>
<td>from which channel the data is received</td>
</tr>
<tr>
<td><code>capture_id</code></td>
<td><code>string</code></td>
<td>Capture id for the current PCAP.</td>
</tr>
<tr>
<td><code>pcap_dict</code></td>
<td><code>json</code></td>
<td>contains json data for PCAP content. If null, capture has been stopped.</td>
</tr>
<tr>
<td><code>dst_mac</code></td>
<td><code>string</code></td>
<td>destination mac address</td>
</tr>
<tr>
<td><code>src_mac</code></td>
<td><code>string</code></td>
<td>source mac address</td>
</tr>
<tr>
<td><code>vlan</code></td>
<td><code>int</code></td>
<td>vlan id</td>
</tr>
<tr>
<td><code>src_ip</code></td>
<td><code>string</code></td>
<td>source ip address</td>
</tr>
<tr>
<td><code>dst_ip</code></td>
<td><code>string</code></td>
<td>destination ip address</td>
</tr>
<tr>
<td><code>dst_port</code></td>
<td><code>string</code></td>
<td>destination port</td>
</tr>
<tr>
<td><code>src_port</code></td>
<td><code>string</code></td>
<td>source port</td>
</tr>
<tr>
<td><code>protocol</code></td>
<td><code>string</code></td>
<td>Application / Transport layer protocol associated with the packet</td>
</tr>
<tr>
<td><code>mxedge_id</code></td>
<td><code>string</code></td>
<td>Packet belongs to which Mist Edge</td>
</tr>
<tr>
<td><code>direction</code></td>
<td><code>string</code></td>
<td>tx/rx based on Mist Edge</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>float</code></td>
<td>precision upto milliseconds. i.e (1652247616.740)</td>
</tr>
<tr>
<td><code>length</code></td>
<td><code>int</code></td>
<td>length of the packet</td>
</tr>
<tr>
<td><code>lost_messages</code></td>
<td><code>int</code></td>
<td>number of messages lost before sending this packets</td>
</tr>
<tr>
<td><code>info</code></td>
<td><code>string</code></td>
<td>PCAP content recieved after running tcpdump.</td>
</tr>
<tr>
<td><code>interface</code></td>
<td><code>string</code></td>
<td>Used to identify what interface on the Mist Edge the packet belongs</td>
</tr>
</tbody>
</table>
<h1 id="juniper-devices">Juniper Devices</h1>
<p>Juniper devices can be managed/adopted by Mist. Currently outbound-ssh + netconf is used.</p>
<p>A few lines of CLI commands are generated per-Org, allowing the Juniper devices to phone home to Mist.</p>
<h2 id="get-adoption-command">Get Adoption Command</h2>
<pre><code>GET /api/v1/orgs/:org_id/ocdevices/outbound_ssh_cmd
GET /api/v1/orgs/:org_id/ocdevices/outbound_ssh_cmd?site_id=02ce013c-7f98-4afb-a937-463d0046a4e7
</code></pre>
<h3 id="optional-parameter">Optional parameter</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>UUID of the site</td>
</tr>
</tbody>
</table>
<p>Note: site_id would be used for proxy config check of the site and automatic site assignment</p>
<h3 id="request_79">Request</h3>
<pre><code>{
    "cmd": "set system services ssh...\n...\nset system services outbound-ssh client mist ..."
}
</code></pre>
<h2 id="create-org-blacklist-client-list">Create Org Blacklist Client List</h2>
<p>If there is already a blacklist, this API will replace it with the new one. Max number of blacklist clients is 1000.</p>
<p>Retrieve the current blacklisted clients from ‘blacklist_url’ under <a href="https://api.mist.com/api/v1/docs/Org#org-setting">Org:Setting</a></p>
<pre><code>POST /api/v1/orgs/:org_id/setting/blacklist
</code></pre>
<h3 id="example_16">Example</h3>
<pre><code>{
    "macs": ["5c5b35000001", "5c5b35000002"]
}
</code></pre>
<h2 id="delete-org-blacklist-clients">Delete Org Blacklist Clients</h2>
<p>This endpoint is to remove the client blacklist</p>
<pre><code>DELETE /api/v1/orgs/:org_id/setting/blacklist
</code></pre>
<h1 id="128t-devices">128T Devices</h1>
<p>128T devices can be managed/adopted by Mist.</p>
<h2 id="get-registration-commands">Get Registration Commands</h2>
<pre><code>GET /api/v1/orgs/:org_id/128routers/register_cmd?ttl=7
</code></pre>
<h3 id="optional-parameter_1">Optional parameter</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ttl</code></td>
<td><code>int</code></td>
<td>duration for the token to stay valid. 1 - 365 in days, default is 365</td>
</tr>
</tbody>
</table>
<h3 id="response_148">Response</h3>
<pre><code>{
    "registration_code": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJvcmdfaWQiOiIyODE4ZTM4Ni04ZGVjLTI1NjItOWVkZS01YjhhMGZiYmRjNzEiLCJzdmMiOiIxMjhyb3V0ZXIiLCJwcm92aWRlciI6ImF3cyIsImVudiI6ImxvY2FsIiwiZXB0ZXJtX3VybCI6IndzczovL2xvY2FsL3dzIiwiaWF0IjoxNjEzODQ3NDg0LCJleHAiOjE2NDUzODM0ODR9.YnhgThKYAj1uaooi6j-zY8dMipp5YqJxnn79B9TB5XQ",
    "conductor_cmd": "register mist eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJvcmdfaWQiOiIyODE4ZTM4Ni04ZGVjLTI1NjItOWVkZS01YjhhMGZiYmRjNzEiLCJzdmMiOiIxMjhyb3V0ZXIiLCJwcm92aWRlciI6ImF3cyIsImVudiI6ImxvY2FsIiwiZXB0ZXJtX3VybCI6IndzczovL2xvY2FsL3dzIiwiaWF0IjoxNjEzODQ3NDg0LCJleHAiOjE2NDUzODM0ODR9.YnhgThKYAj1uaooi6j-zY8dMipp5YqJxnn79B9TB5XQ",
    "router_shell_cmd": "128agent register --registration-code eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJvcmdfaWQiOiIyODE4ZTM4Ni04ZGVjLTI1NjItOWVkZS01YjhhMGZiYmRjNzEiLCJzdmMiOiIxMjhyb3V0ZXIiLCJwcm92aWRlciI6ImF3cyIsImVudiI6ImxvY2FsIiwiZXB0ZXJtX3VybCI6IndzczovL2xvY2FsL3dzIiwiaWF0IjoxNjEzODQ3NDg0LCJleHAiOjE2NDUzODM0ODR9.YnhgThKYAj1uaooi6j-zY8dMipp5YqJxnn79B9TB5XQ"
}
</code></pre>
<h4 id="parameters_65">Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>registration_code</code></td>
<td><code>string</code></td>
<td>Mist org-level registration code (JWT)</td>
</tr>
<tr>
<td><code>conductor_cmd</code></td>
<td><code>string</code></td>
<td>128T conductor registration command</td>
</tr>
<tr>
<td><code>router_shell_cmd</code></td>
<td><code>string</code></td>
<td>128T router registration command used by the 128-agent (which connects to the Mist cloud)</td>
</tr>
</tbody>
</table>
<h2 id="get-upgrade-information">Get Upgrade Information</h2>
<pre><code>GET /api/v1/orgs/:org_id/ssr/versions
</code></pre>
<h3 id="parameters_66">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>channel</code></td>
<td><code>string</code></td>
<td>One of <code>stable</code> (default), <code>beta</code>, <code>alpha</code></td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>Optional. MAC address, or comma separated MAC address list.</td>
</tr>
</tbody>
</table>
<h3 id="response_149">Response</h3>
<pre><code>[
    {
        "package": "SSR",
        "version": "5.3.1-17",
        "_version": "SSR-5.3.1-17.el7.x86_64",
        "default": true
    }
]
</code></pre>
<h2 id="upgrade-128t-ssr-devices">Upgrade 128T (SSR) devices</h2>
<pre><code>POST /api/v1/orgs/:org_id/ssr/upgrade
</code></pre>
<h3 id="request_80">Request</h3>
<pre><code>{
    "strategy": "big_bang",
    "channel": "stable",
    "version": "5.3.0-93",
    "start_time": 1624405840,
    "device_ids": [
      "00000000-0000-0000-1000-5c5b35000020"
    ]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>device_ids</code></td>
<td><code>list</code></td>
<td>list of 128T device IDs to upgrade, currently only one 128T device allowed</td>
</tr>
<tr>
<td><code>channel</code></td>
<td><code>string</code></td>
<td>upgrade channel to follow, stable (default) / beta / alpha</td>
</tr>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>128T firmware version to upgrade (e.g. 5.3.0-93)</td>
</tr>
<tr>
<td><code>strategy</code></td>
<td><code>string</code></td>
<td><code>big_bang</code>(upgrade all at once) or <code>serial</code>(one at a time), default is big_bang</td>
</tr>
<tr>
<td><code>start_time</code></td>
<td><code>long</code></td>
<td>128T firmware download start time in epoch seconds, default is now, -1 disables download</td>
</tr>
<tr>
<td><code>reboot_at</code></td>
<td><code>long</code></td>
<td>reboot start time in epoch seconds, default is <code>start_time</code>, -1 disables reboot</td>
</tr>
</tbody>
</table>
<h2 id="get-128t-ssr-org-level-upgrade">Get 128T (SSR) Org-level Upgrade</h2>
<pre><code>GET /api/v1/orgs/:org_id/ssr/upgrade
</code></pre>
<h3 id="response_150">Response</h3>
<pre><code>[{
    "status": "upgrading",
    "strategy": "serial",
    "versions": {},
    "channel": "stable",
    "device_type": "gateway",
    "_id": "ceef2c8a-e2e6-447a-8b27-cb4f3ec1adae",
    "counts": {
        "queued": 1,
        "upgrading": 1,
        "success": 0,
        "failed": 0
    }
}]
</code></pre>
<h2 id="get-a-specific-upgrade">Get a specific Upgrade</h2>
<pre><code>GET /api/v1/orgs/:org_id/ssr/upgrade/:upgrade_id
</code></pre>
<h3 id="response_151">Response</h3>
<pre><code>{
    "status": "upgrading",
    "strategy": "serial",
    "versions": {},
    "channel": "stable",
    "device_type": "gateway",
    "_id": "5cbcee0a-c620-4bb4-a25e-15000934e9d8",
    "targets": {
        "queued": ["387804a7-3474-85ce-15a2-f9a9684c9c90"],
        "upgrading": ["8e525f1d-4178-4ae1-a988-2b0176855e55"],
        "success": [],
        "failed": []
    }
}
</code></pre>
<h2 id="cancel-128t-ssr-upgrade">Cancel 128T (SSR) upgrade</h2>
<p>Best effort to cancel an upgrade. Devices which are already upgraded wont be touched</p>
<pre><code>POST /api/v1/orgs/:org_id/ssr/upgrade/:upgrade_id/cancel
</code></pre>
<h2 id="search-peer-path-stats">Search Peer Path Stats</h2>
<pre><code>GET /api/v1/orgs/:org_id/stats/vpn_peers/search
</code></pre>
<h3 id="response_152">Response</h3>
<pre><code>{
    "results": [
        {
            "org_id": "0c160b7f-1027-4cd1-923b-744534c4b070",
            "site_id": "725a8d34-a126-4f2c-b990-d1219421cb75",
            "mac": "020001c04668",
            "port_id": "Lte",

            "peer_mac": "020001367edd",
            "peer_site_id": "725a8d34-a126-4f2c-b990-d1219421cb75",
            "peer_port_id": "DC_Internet",

            "type": "svr", // ipsec for SRX, svr for 128T

            "up": true,
            "is_active": true,
            "uptime": 1527128046,
            "last_seen": 1619518709.222,

            # for svr
            "router_name": "RIST01544AP1",
            "peer_router_name": "RIDCBBP1",
            "latency": 91.0,
            "mtu": 1500,
            "mos": 436.0

            # for ipsec
            "auth_algo": "hmac-sha1-96",
            "enc_algo": "aes-cbc-128",
            "ike_version": "1",
        },
    ],
    "start": 1619518689.4989705,
    "end": 1619518989.4989712,
    "limit": 10,
    "total": 1
}
</code></pre>
<h4 id="definitions_27">Definitions</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>router org ID</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>router site ID</td>
</tr>
<tr>
<td><code>peer_site_id</code></td>
<td><code>string</code></td>
<td>peer router site ID</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>router mac address</td>
</tr>
<tr>
<td><code>peer_mac</code></td>
<td><code>string</code></td>
<td>peer router mac address</td>
</tr>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>router device interface</td>
</tr>
<tr>
<td><code>peer_port_id</code></td>
<td><code>string</code></td>
<td>peer router device interface</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>long</code></td>
<td>sampling time (in epoch)</td>
</tr>
<tr>
<td><code>router_name</code></td>
<td><code>string</code></td>
<td>router name</td>
</tr>
<tr>
<td><code>peer_router_name</code></td>
<td><code>string</code></td>
<td>peer router name</td>
</tr>
<tr>
<td><code>mtu</code></td>
<td><code>int</code></td>
<td>Maximum Transmission Unit of peer path</td>
</tr>
<tr>
<td><code>latency</code></td>
<td><code>long</code></td>
<td>Network latency in a peer path</td>
</tr>
<tr>
<td><code>mos</code></td>
<td><code>float</code></td>
<td>Mean opinion score in a peer path</td>
</tr>
<tr>
<td><code>uptime</code></td>
<td><code>int</code></td>
<td>uptime</td>
</tr>
<tr>
<td><code>is_active</code></td>
<td><code>boolean</code></td>
<td>Redundancy status of the associated interface</td>
</tr>
</tbody>
</table>
<h2 id="count-peer-path-stats">Count Peer Path Stats</h2>
<pre><code>GET /api/v1/orgs/:org_id/stats/vpn_peers/count
</code></pre>
<h3 id="response_153">Response</h3>
<pre><code>{
    "results": [
        {
            "mac": "02000111d2dc",
            "count": 2
        }
    ],
    "start": 1619518707.800029,
    "end": 1619519007.8000295,
    "limit": 10,
    "distinct": "mac",
    "total": 1,
}
</code></pre>
<h2 id="search-bgp-stats">Search BGP Stats</h2>
<pre><code>GET /api/v1/orgs/:org_id/stats/bgp_peers/search
</code></pre>
<h3 id="response_154">Response</h3>
<pre><code>{
    "results": [
        {
            "org_id": "0c160b7f-1027-4cd1-923b-744534c4b070",
            "site_id": "725a8d34-a126-4f2c-b990-d1219421cb75",
            "mac": "020001c04668",
            "node" : "node0",
            "timestamp": 1666251056.07,
            "local_as": 65000,
            "neighbor_as": 65000,
            "vrf_name": "default",  // default (default) / or VRF name
            "neighbor": "15.8.3.5",
            "neighbor_mac": "020001e53153",  // if it's another device in the same org
            "uptime": 31355,
            "up": true,
            "for_overlay": true, // if this is created for overlay
            "state": "established",  // idle, connect, active, open_sent, open_confirm and established
            "tx_pkts": 1735,
            "rx_pkts": 63366,
            "rx_routes": 60,
            "tx_routes": 60,
            "evpn_overlay": true // if this is created for evpn overlay
        },
    ],
    "start": 1619518689.4989705,
    "end": 1619518989.4989712,
    "limit": 10,
    "total": 1
}
</code></pre>
<h4 id="definitions_28">Definitions</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>router org ID</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>router site ID</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>router mac address</td>
</tr>
<tr>
<td><code>node</code></td>
<td><code>string</code></td>
<td>node0/node1</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>long</code></td>
<td>sampling time (in epoch)</td>
</tr>
<tr>
<td><code>local_as</code></td>
<td><code>string</code></td>
<td>local AS</td>
</tr>
<tr>
<td><code>neighbor_as</code></td>
<td><code>string</code></td>
<td>neighbor AS</td>
</tr>
<tr>
<td><code>vrf_name</code></td>
<td><code>string</code></td>
<td>VRF name</td>
</tr>
<tr>
<td><code>neighbor</code></td>
<td><code>string</code></td>
<td>IP of neighbor</td>
</tr>
<tr>
<td><code>neighbor_mac</code></td>
<td><code>string</code></td>
<td>Mac of neighbor</td>
</tr>
<tr>
<td><code>state</code></td>
<td><code>string</code></td>
<td>idle, connect, active, open_sent, open_confirm and established</td>
</tr>
<tr>
<td><code>up</code></td>
<td><code>boolean</code></td>
<td>true/false</td>
</tr>
<tr>
<td><code>tx_pkts</code></td>
<td><code>int</code></td>
<td>tx pkts</td>
</tr>
<tr>
<td><code>rx_pkts</code></td>
<td><code>int</code></td>
<td>rx pkts</td>
</tr>
<tr>
<td><code>rx_routes</code></td>
<td><code>int</code></td>
<td>number of received routes</td>
</tr>
<tr>
<td><code>tx_routes</code></td>
<td><code>int</code></td>
<td>number of sent routes</td>
</tr>
<tr>
<td><code>uptime</code></td>
<td><code>int</code></td>
<td>uptime</td>
</tr>
<tr>
<td><code>for_overlay</code></td>
<td><code>boolean</code></td>
<td>true/false, if this is created for overlay</td>
</tr>
<tr>
<td><code>evpn_overlay</code></td>
<td><code>boolean</code></td>
<td>true/false, if this is created for evpn overlay</td>
</tr>
</tbody>
</table>
<h2 id="count-bgp-stats">Count BGP Stats</h2>
<pre><code>GET /api/v1/orgs/:org_id/stats/bgp_peers/count?state=disconnected&amp;distinct=mac
</code></pre>
<h3 id="response_155">Response</h3>
<pre><code>{
    "results": [
        {
            "mac": "02000111d2dc",
            "count": 2
        }
    ],
    "start": 1619518707.800029,
    "end": 1619519007.8000295,
    "limit": 10,
    "distinct": "mac",
    "total": 1,
}
</code></pre>
<h2 id="upgrade-multiple-sites">Upgrade Multiple Sites</h2>
<pre><code>POST /api/v1/orgs/:org_id/devices/upgrade
</code></pre>
<h3 id="example_17">Example</h3>
<pre><code>{
    "device_type": "ap",
    "versions": [
        // ap upgrade
        {
            "firmware_type": "ap",
            "version": "0.12.27139",
            "force": true
        },

        // switch upgrade
        {
            "firmware_type": "junos"
            "model_version": {
                "EX4400-24P": "23.4R1.9" // used to select different versions for different models
        }    
    ],
    "rules": [
        {
            // all AP63's in this site will be selected for upgrade
            "match_model": "AP63"
        },
        {
            // AP43's whose name has the word 'access' from character 2 to 7 will be selected for upgrade
            "match_model": "AP43",
            "match_name[2:8]": "access"
        }
    ],
    "all_sites": false // true will upgrade all sites in this org
    "site_ids": ["4ac1dcf4-9d8b-7211-65c4-057819f0862b"], // only devices belonging to these sites will be selected for upgrade. Will be ignored if "all_sites": true
    "models": ["AP41"], // only devices of these model types will be selected for upgrade
    "download_strategy": "canary",
    "reboot_strategy": "serial",
    "canary_phases": [5,25,50,100],
    "max_failures": [1,1,5,5], // will be used if provided, else max_failure_percentage will be used
    "max_failure_percentage": 5
    "start_datetime": "2024-06-13T15:00:00-07:00", // ISO 8601
    "reboot_datetime": "2024-06-13T15:00:00", // ISO 8601 - exclude timezone component if site local timezone needs to be used
}
</code></pre>
<h3 id="parameters_67">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>device_type</code></td>
<td><code>string</code></td>
<td><code>ap</code>, <code>switch</code></td>
</tr>
<tr>
<td><code>versions</code></td>
<td><code>array</code></td>
<td>array of <code>version</code> objects</td>
</tr>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>(deprecated, use <code>versions</code> instead) specific version / <code>stable</code>, default is to use the latest</td>
</tr>
<tr>
<td><code>all_sites</code></td>
<td><code>boolean</code></td>
<td>set to true if all sites belonging to this org need to be selected for upgrade. Overrides <code>site_ids</code>. Default false</td>
</tr>
<tr>
<td><code>site_ids</code></td>
<td><code>array</code></td>
<td>only devices belonging to these sites will be selected for upgrade</td>
</tr>
<tr>
<td><code>models</code></td>
<td><code>array</code></td>
<td>only devices of these model types will be selected for upgrade</td>
</tr>
<tr>
<td><code>rules</code></td>
<td><code>array of objects</code></td>
<td>rules used to identify devices which will be selected for upgrade. Device will be selected as long as it satisfies any one rule</td>
</tr>
<tr>
<td><code>download_strategy</code></td>
<td><code>string</code></td>
<td><code>big_bang</code>(download all at once - no orchestration), <code>serial</code>(one at a time), <code>canary</code>(download in phases), default is <code>big_bang</code></td>
</tr>
<tr>
<td><code>reboot_strategy</code></td>
<td><code>string</code></td>
<td><code>big_bang</code>(upgrade all at once - no orchestration), <code>serial</code>(one at a time), <code>canary</code>(upgrade in phases) or  <code>rrm</code>(AP only), default is <code>serial</code></td>
</tr>
<tr>
<td><code>strategy</code></td>
<td><code>string</code></td>
<td>(deprecated, use <code>download_strategy</code>/<code>reboot_strategy</code> instead) <code>big_bang</code>(upgrade all at once - no orchestration), <code>serial</code>(one at a time), <code>canary</code> or  <code>rrm</code>(AP only), default is big_bang</td>
</tr>
<tr>
<td><code>canary_phases</code></td>
<td><code>array of ints</code></td>
<td>phases for canary deployment. Each phase represents percentage of devices that need to be upgraded in that phase. default is [1, 10, 50, 100]</td>
</tr>
<tr>
<td><code>max_failures</code></td>
<td><code>array of ints</code></td>
<td>number of failures allowed within each phase. Only applicable for <code>canary</code>. Array length should be same as <code>canary_phases</code>. Will be used if provided, else max_failure_percentage will be used</td>
</tr>
<tr>
<td><code>max_failure_percentage</code></td>
<td><code>int</code></td>
<td>percentage of failures allowed across the entire upgrade(not applicable for <code>big_bang</code>), default is 5</td>
</tr>
<tr>
<td><code>start_datetime</code></td>
<td><code>string</code></td>
<td>firmare download start time in ISO 8601 format. Default is now.</td>
</tr>
<tr>
<td><code>start_time</code></td>
<td><code>long</code></td>
<td>(deprecated, use <code>start_datetime</code> instead) firmware download start time in epoch seconds, default is now</td>
</tr>
<tr>
<td><code>reboot_datetime</code></td>
<td><code>string</code></td>
<td>reboot start time in ISO 8601 format. Default is <code>start_datetime</code></td>
</tr>
<tr>
<td><code>reboot_at</code></td>
<td><code>long</code></td>
<td>(deprecated, use <code>reboot_datetime</code> instead) reboot start time in epoch seconds, default is <code>start_time</code></td>
</tr>
<tr>
<td><code>enable_p2p</code></td>
<td><code>boolean</code></td>
<td>(AP only) whether to allow local AP-to-AP FW upgrade</td>
</tr>
<tr>
<td><code>p2p_parallelism</code></td>
<td><code>int</code></td>
<td>(AP only) number of parallel p2p download batches to create, default is 1</td>
</tr>
<tr>
<td><code>p2p_cluster_size</code></td>
<td><code>int</code></td>
<td>(AP only) size to split the devices for p2p, default 10</td>
</tr>
<tr>
<td><code>rrm_node_order</code></td>
<td><code>string</code></td>
<td>(AP only) fringe_to_center or center_to_fringe (default fringe_to_center). Used in <code>rrm</code> to determine whether to start upgrade from fringe or center AP’s</td>
</tr>
<tr>
<td><code>rrm_slow_ramp</code></td>
<td><code>boolean</code></td>
<td>(AP only) true will make rrm batch sizes slowly ramp up</td>
</tr>
<tr>
<td><code>rrm_max_batch_percentage</code></td>
<td><code>int</code></td>
<td>(AP only) max percentage of AP’s that need to be present in each <code>rrm</code> batch</td>
</tr>
<tr>
<td><code>rrm_first_batch_percentage</code></td>
<td><code>int</code></td>
<td>(AP only) percentage of AP’s that need to be present in the first <code>rrm</code> batch</td>
</tr>
<tr>
<td><code>rrm_mesh_upgrade</code></td>
<td><code>string</code></td>
<td>(AP only) sequential or parallel (default parallel). Whether to upgrade mesh AP’s parallelly or sequentially at the end of the upgrade</td>
</tr>
<tr>
<td><code>snapshot</code></td>
<td><code>boolean</code></td>
<td>Perform recovery snapshot after device is rebooted. default is false (Available on Junos OS devices)</td>
</tr>
</tbody>
</table>
<h4 id="version">Version</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>firmware_type</code></td>
<td><code>string</code></td>
<td><code>ap</code>, <code>junos</code></td>
</tr>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>version to upgrade to</td>
</tr>
<tr>
<td><code>force</code></td>
<td><code>boolean</code></td>
<td>set to true if upgrade is needed when target version &lt;= running version, default false. Supported for <code>device_type</code> <code>ap</code></td>
</tr>
<tr>
<td><code>model_version</code></td>
<td><code>dict</code></td>
<td>map of device model to firmware version used to select different versions for different models. Overrides <code>version</code> for the specified models</td>
</tr>
</tbody>
</table>
<h4 id="rules_1">Rules</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>match_model</code></td>
<td><code>string</code></td>
<td>match devices of this model. Can optionally use offsets to select a substring. For eg: match_model[1:3]</td>
</tr>
<tr>
<td><code>match_name</code></td>
<td><code>string</code></td>
<td>match devices with this name. Can optionally use offsets to select a substring. For eg: match_name[1:3]</td>
</tr>
</tbody>
</table>
<h3 id="response_156">Response</h3>
<pre><code>{
   "id": "f57096b9-0c2f-4df6-c77b-ae6ae87a3d43"
}
</code></pre>
<h2 id="get-multi-site-upgrade">Get Multi Site Upgrade</h2>
<pre><code>GET /api/v1/orgs/:org_id/devices/upgrade/:id
</code></pre>
<h3 id="response_157">Response</h3>
<pre><code>{
    "id": "510faff9-0c55-4112-8796-f7589da0f7bc",
    "target_version": "apfw-0.7.20216-gilly-d4fc",
    "strategy": "big_bang",
    "enable_p2p": false,
    "force": false
    "upgrades": [{
        "site_id": "1916d52a-4a90-11e5-8b45-1258369c38a9",
        "upgrade": {
            "id": "9b5fde1d-bda4-486f-8eb6-4368aa30cf30",
            "status": "created",
            "start_time": 1626892546,
            "targets": {
                "scheduled": [],
                "downloaded": [],
                "download_requested": [],
                "reboot_in_progress": [],
                "rebooted": [],
                "skipped": [],
                "failed": [],
                "total": 1
            }
        }
    }, {
        "site_id": "65c2095a-e049-4267-88a5-5019e4b69a4d",
        "upgrade": {
            "id": "510faff9-0c55-4112-8796-f7589da0f7bc",
            "status": "created",
            "start_time": 1626892546,
            "targets": {
                "scheduled": [],
                "downloaded": [],
                "download_requested": [],
                "reboot_in_progress": [],
                "rebooted": [],
                "skipped": [],
                "failed": [],
                "total": 1
            }
        }
    }]
}
</code></pre>
<h3 id="definitions_29">Definitions</h3>
<p>Same as one defined in <a href="https://api.mist.com/api/v1/docs/Site#get-site-upgrade">Site API</a></p>
<h2 id="cancel-multi-site-upgrade">Cancel Multi Site Upgrade</h2>
<p>Best effort to cancel an upgrade. Devices which are already upgraded won’t be touched</p>
<pre><code>POST /api/v1/orgs/:org_id/devices/upgrade/:upgrade_id/cancel
</code></pre>
<h2 id="get-multi-site-upgrades">Get Multi Site Upgrades</h2>
<pre><code>GET /api/v1/orgs/:org_id/devices/upgrade
</code></pre>
<h3 id="response_158">Response</h3>
<pre><code>[{
    "id": "c4a69d92-46b9-44a8-ae90-7de44be58a4b",
    "upgrades": [{
        "site_id": "1916d52a-4a90-11e5-8b45-1258369c38a9",
        "upgrade_id": "f9d03e9a-28ae-4b09-8cef-f682801b46c3"
    }, {
        "site_id": "495363c9-be25-4fde-8bef-65b28a1a6eaa",
        "upgrade_id": "6de92826-a348-4bae-9005-2d1d8041d327"
    }]
}]
</code></pre>
<h3 id="definitions_30">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td><code>uuid</code></td>
<td>unique id for the org upgrade</td>
</tr>
<tr>
<td><code>upgrades</code></td>
<td><code>array of upgrades</code></td>
<td>site upgrades part of this upgrade</td>
</tr>
<tr>
<td><code>upgrades.upgrade_id</code></td>
<td><code>uuid</code></td>
<td>id of the site upgrade</td>
</tr>
<tr>
<td><code>upgrades.site_id</code></td>
<td><code>uuid</code></td>
<td>site the upgrade belongs to</td>
</tr>
</tbody>
</table>
<h2 id="get-org-ap-device-mac-and-radio-macs">Get Org AP Device Mac and Radio MACs</h2>
<p>For some scenarios like E911 or security systems, the BSSIDs are required to identify which AP the client is connecting
to. Then the location of the AP can be used as the approximate location of the client.</p>
<p>Each radio MAC can have 16 BSSIDs (enumerate the last octet from 0-F)</p>
<pre><code>  GET /api/v1/orgs/:org_id/devices/radio_macs
</code></pre>
<h3 id="response_159">Response</h3>
<pre><code>[
 {
  "mac": "5c5b35000001",
  "radio_macs": ["5c5b35000040", "5c5b35000050", "5c5b35000060"]
 },
 {
  "mac": "5c5b45000001",
  "radio_macs": ["5c5b45000040", "5c5b45000050", "5c5b45000060"]
 }
]
</code></pre>
<h3 id="definitions_31">Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>device(AP) MAC address</td>
</tr>
<tr>
<td><code>radio_macs</code></td>
<td><code>array of mac addresses</code></td>
<td>array of radio MAC addresses for each AP</td>
</tr>
</tbody>
</table>
<h2 id="get-available-device-versions">Get Available Device Versions</h2>
<pre><code>GET /api/v1/orgs/:org_id/devices/versions
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Site#get-available-device-versions">Site:Get Available Device Versions</a> for API request &amp; response details.</p>
<h2 id="get-available-ap-esl-versions">Get Available AP ESL Versions</h2>
<pre><code>GET /api/v1/const/ap_esl_versions
</code></pre>
<h3 id="parameters_68">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>filter versions by model</td>
</tr>
</tbody>
</table>
<h3 id="response_160">Response</h3>
<pre><code>[
  {
    'esl_version': '2.5.1',
    'model': 'AP34'
  },
  {
    'esl_version': '2.5.0',
    'model': 'AP43'
  }
]
</code></pre>
<h1 id="mist-nac">Mist NAC</h1>
<h2 id="nac-tags">NAC Tags</h2>
<h3 id="base-uri_14">Base URI</h3>
<pre><code>/api/v1/orgs/:org_id/nactags
</code></pre>
<pre><code>nactags are the building blocks to compose nacrules.

They can either appear in the "matching" / "not_matching" sections of a nacrule, 
in which case they play the role of classifiers, or they could appear in the "apply_tags" 
section of the of a nacrule, in which case they influence the result.

When the "type" field of nactag is "match", it can be used as the classfier of a nacrule.
- "match" field specifies the attribute name and "values" field specifies the list of
attribute values to match on.
- When multiple values are specified, its treated as an OR condition
between those values. This behavior can be changed by setting "match_all" field to "true",
in which case it is treated as an AND condition between those values.
- By default exact match is performed. This behavior can be changed as follows:
  - Adding '*' at the beginning will perform suffix match
    (ex: *-staff will match foo-staff and bar-staff)
  - Adding '*' at the end will perform prefix match
    (ex: foo-* will match foo-staff and foo-interns)
  - Adding '*' at both ends will perform substring match
    (ex: *printer* will match hp-printer-bldg1, brother-printer-lab)
  - Adding '!' at the beginning will perform negation of the match
    (ex: !ssid-guest will match any string that is not ssid-guest)
 - Note: when negation should be used along with suffix/substring operation,
   ! should always precede *
   (ex: !*guest will match any string that is not ending with guest)

When the "type" field of nactag is NOT "match", it can be used as the result of a nacrule.
"type" field identifies the action to take and the corresponding field would provide any associated
parameters to that action.
When the "type" field of nactag is NOT "match" and is any of the result type also supported by usermac table('vlan'),
"allow_usermac_override" field can be set to true to allow the override by usermac result
</code></pre>
<pre><code>// when type = match
// matches vendor
// NOTE: match on 'vendor' is now obsoleted. DO NOT use it anymore.
// You can now add vendor based match directly as part of nacrule object
{
    "type": "match",
    "name": "guest-wlan",
    "match": "vendor",
    "values": [ "cisco" ]
}
// matches ssid
{
    "type": "match",
    "name": "corp-wlan",
    "match": "ssid",
    "values": [ "corp-ssid" ]
}
// matches cert_cn
{
    "type": "match",
    "name": "staff",
    "match": "cert_cn",
    "values": [ "john", "staff*" ]
}
// matches cert_sub
{
    "type": "match",
    "name": "subject1",
    "match": "cert_sub",
    "values": [ "/C=CN/ST=defy/O=defy/OU=defy/CN=steve" ]
}
// matches cert_serial
{
    "type": "match",
    "name": "serial1",
    "match": "cert_serial",
    "values": [ "6a524ab782fb468c00c59f51cff00268d95533b8"]
}
// matches cert_issuer
{
    "type": "match",
    "name": "issuer1",
    "match": "cert_issuer",
    "values": ["/C=CN/ST=defy/L=defy/O=defy/OU=defy/CN=defy"]
}
// matches cert_san
{
    "type": "match",
    "name": "san1",
    "match": "cert_san",
    "values": ["henry1@defy.com"]
}
// matches cert_template
{
    "type": "match",
    "name": "templ1",
    "match": "cert_template",
    "values": ["1.3.6.1.4.1.311.21.8.4200806.605933.871088.11229391.9863893.29.13545645.4807979",
                "1.3.6.1.4.1.311.21.8.3285427.4093958.2707341.9961608.11572555.6.4903431.2258457"]
}
// matches hostname
{
    "type": "match",
    "name": "hostname1",
    "match": "hostname", // list of strings(hostnames)
    "values": [ "CP*", "CP*"]
}
// matches idp_role
{
    "type": "match",
    "name": "finance",
    "match": "idp_role",
    "values": ["finance"]
}
// matches realm
{
    "type": "match",
    "name": "defy",
    "match": "realm",
    "values": ["defy.com"]
}
// matches user_name
{
    "type": "match",
    "name": "admins",
    "match": "user_name",
    "values": ["bob", "steve"]
}
// matches client_mac
// either complete mac can be specified OR wildcards can be used to match OUI etc.
{
    "type": "match",
    "name": "cameras",
    "match": "client_mac",
    "values": ["010203040506", "abcdef*"]
}
// matches mdm_status
{
    "type": "match",
    "name": "mdm_compliance",
    "match": "mdm_status",
    "values": ["compliant", "non-compliant", "unknown"]
}
// matches usermac_label
{
    "type": "match",
    "name": "my_label_tag",
    "match": "usermac_label",
    "values": ["bldg3", "bldg5", "camera", "printer"]
}
// matches nas_ip
// either complete nas ip can be specified OR subnet
{
    "type": "match",
    "name": "switches_floor1",
    "match": "nas_ip",
    "values": ["194.168.0.0/16", "193.167.4.1"]
}
// matches ingress_vlan
// ingress_vlan appears in radius requests
{
    "type": "match",
    "name": "radius_request_vlan",
    "match": "ingress_vlan",
    "values": ["999", "10"]
}
// when type = radius_group
{
    "type": "radius_group",
    "radius_group": "VIP",
    "allow_usermac_override": true
}

// when type = vlan
{
    "type": "vlan",
    "vlan": "30"
    "allow_usermac_override": true
}

// when type = gbp_tag (Group Based Policy Tag)
{
    "type": "gbp_tag",
    "gbp_tag": "100"
}

// when type = session_timeout
{
    "type": "session_timeout",
    "session_timeout": 86400 // integer - in seconds
}

// when type = egress_vlan_names
{
    "type": "egress_vlan_names",
    "egress_vlan_names": [ "1vlan-30", "1vlan-20", "2-vlan10"] // list of strings(vlan names)
}

{
    "type": "username_attr",
    "username_attr": "automatic", // automatic / cn / upn / email / dns
    // if true, use the usermac-&gt;name instead, if present
    "allow_usermac_override": false
}

// when type = radius_attrs, user can specify a list of one or more standard attributes
// in the field "radius_attsr" . It is the responsibility of the user to provide a 
// syntactically correct string, otherwise it may not work as expected.
// note that it is allowed to have more than one radius_vendor_attr in the result of a given rule.
// examples:
{
    "type": "radius_attrs",
    "radius_attrs": ["Idle-Timeout=600", "Termination-Action=RADIUS-Request"]
}

// when type = radius_vendor_attrs, user can specify a list of one or more vendor-specific attributes
// in the field "radius_vendor_attrs". It is the responsibility of the user to provide a 
// syntactically correct string, otherwise it may not work as expected.
// note that it is allowed to have more than one radius_vendor_attr in the result of a given rule.
// examples:
{
    "type": "radius_vendor_attrs",
    "radius_vendor_attrs": ["PaloAlto-Admin-Role=superuser", "PaloAlto-Panorama-Admin-Role=administrator"]
}
{
    "type": "radius_vendor_attrs",
    "radius_vendor_attrs": ["Cisco-Av-pair=shell:priv-lvl=15"]
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>the name</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>match / radius_group / vlan</td>
</tr>
<tr>
<td><code>match</code></td>
<td><code>string</code></td>
<td>type of match, vendor / ssid / cert_cn / cert_sub / cert_serial / cert_issuer / cert_san / idp_role / realm / user_name / client_mac / mdm_status / usermac_label / nas_ip / hostname</td>
</tr>
<tr>
<td><code>match_all</code></td>
<td><code>boolean</code></td>
<td>false’: means it is sufficient to match any of the values (i.e., match-any behavior),<br> ‘true’: means all values should be matched (i.e., match-all behavior), <br>default is ‘false <br>This field is applicalbe only when ‘type’ field is set to ‘match’<br> Currently it makes sense to set this field to ‘true’ only if the ‘match’ is set to ‘idp_role’ and ‘usermac_label’.</td>
</tr>
<tr>
<td><code>values</code></td>
<td><code>list</code></td>
<td>list of values to match</td>
</tr>
<tr>
<td><code>vlan</code></td>
<td><code>string</code></td>
<td>vlan id or name to return</td>
</tr>
<tr>
<td><code>radius_group</code></td>
<td><code>string</code></td>
<td>filter_id to return</td>
</tr>
<tr>
<td><code>gbp_tag</code></td>
<td><code>string</code></td>
<td>gbp tag to return</td>
</tr>
<tr>
<td><code>session_timeout</code></td>
<td><code>int</code></td>
<td>session timeout value to return in seconds</td>
</tr>
<tr>
<td><code>egress_vlan_names</code></td>
<td><code>list</code></td>
<td>list of egress vlans to return</td>
</tr>
<tr>
<td><code>radius_attrs</code></td>
<td><code>list</code></td>
<td>list of one or more standard radius attributes in “\<attr>=\<val>” format</val></attr></td>
</tr>
<tr>
<td><code>radius_vendor_attrs</code></td>
<td><code>list</code></td>
<td>list of one or more vendor specific radius attribute in “\<attr>=\<val>” format</val></attr></td>
</tr>
</tbody>
</table>
<h3 id="get-filtered-list-of-nac-tags">Get filtered list of NAC tags</h3>
<pre><code>/api/v1/orgs/:org_id/nactags?type=gbp_tag
</code></pre>
<h3 id="supported-filtersfilter">Supported Filters(filter)</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>Type of NAC Tag</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>Name of NAC Tag</td>
</tr>
<tr>
<td><code>match</code></td>
<td><code>string</code></td>
<td>Type of match of NAC Tag</td>
</tr>
</tbody>
</table>
<h3 id="response_161">Response</h3>
<pre><code>[
    {
        "gbp_tag": "300",
        "id": "700e6dca-3a77-4dda-af86-e299d5df72a3",
        "name": "Printer",
        "org_id": "2818e386-8dec-2562-9ede-5b8a0fbbdc71",
        "created_time": 1706662152,
        "modified_time": 1706662152,
        "type": "gbp_tag",
        "match": "gbp_tag"
    },
    {
        "gbp_tag": "500",
        "id": "700e6dca-3a77-4dda-af86-e299d5df72a3b2250cbf-baaf-47a9-b68a-3a8a1382f4d8",
        "name": "Cameras",
        "org_id": "2818e386-8dec-2562-9ede-5b8a0fbbdc71",
        "created_time": 1706662152,
        "modified_time": 1706662152,
        "type": "gbp_tag",
        "match": "gbp_tag"
    },
    ...
]
</code></pre>
<h2 id="nac-rules">NAC Rules</h2>
<h3 id="base-uri_15">Base URI</h3>
<pre><code>/api/v1/orgs/:org_id/nacrules
</code></pre>
<h3 id="schema_4">Schema</h3>
<pre><code>{
    "name": "name1",
    "id": "7e700e85-6080-69b9-729e-ee9e012d7408",
    "order": 1,
    // enable dry_run knob if you want the rule to be evaluated, but not acted upon.
    // clients/events, wired_clients/events, nac_clients/events endpoints 
    // reports dryrun_nacrule_matched, dryrun_nacrule_id attributes
    // hit-counts against the nac_rules are obtained using es query on the endpoints
    "dry_run": false
    // match conditions
    "matching": {
        "auth_type": "eap-tls",  // eap-tls (default) / eap-peap / eap-ttls / eap-teap / mab / device-auth
        // based on NAS-Port-Type
        "port_types": ["wired"],  // wireless (18), wired (15),

        // refer to const/fingerprint_types API for allowed family, mfg, model, os_types
        "family": ["Access Point""],
        "mfg": ["Apple, Inc.", "Amazon Technologies Inc."],
        "model": ["1535 IP Phone", "AP41E-US"],
        "os": ["Android 11", "Windows"],

        // refer to "mist_nac" subsection under "Mist Edge Cluster" configuration
        // for the list of allowed vendors and the naming convention of vendor names
        "vendors": ["cisco-ios", "cisco-meraki"] // list of vendors to match

        "site_ids": [
            "bb19fc3e-4124-4b57-80d9-c3f6edce47c4",
            "bb19fc3e-6564-4b57-80d9-c3f6edce47c1"
            ],
        "sitegroup_ids": [
            "bb19fc3e-4124-4b57-80d9-c3f6edce47c4",
            "bb19fc3e-6564-4b57-80d9-c3f6edce47c1"
            ],
        "nactags": [ "041d5d36-716c-4cfb-4988-3857c6aa14a2", "a809a97f-d599-f812-eb8c-c3f84aabf6ba" ]
    },

    "not_matching": {
        // same as `matching`
    },

    // all optional, this goes into Access-Accept
    "apply_tags": [ "c049dfcd-0c73-5014-1c64-062e9903f1e5" ],
    "action": "allow", // "allow" / "block"
}
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>the name</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>enabled or not, default is true</td>
</tr>
<tr>
<td><code>order</code></td>
<td><code>int</code></td>
<td>the order of the rule, lower value implies higher priority</td>
</tr>
<tr>
<td><code>auth_type</code></td>
<td><code>string</code></td>
<td>eap-tls / peap-tls / eap-ttls / eap-teap / mab / device-auth</td>
</tr>
<tr>
<td><code>port_types</code></td>
<td><code>list</code></td>
<td>list of port_types (wired / wireless) to match</td>
</tr>
<tr>
<td><code>family</code></td>
<td><code>list</code></td>
<td>list of client device families to match</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>list</code></td>
<td>list of client device models to match</td>
</tr>
<tr>
<td><code>mfg</code></td>
<td><code>list</code></td>
<td>list of client device manufacturers to match</td>
</tr>
<tr>
<td><code>os_type</code></td>
<td><code>list</code></td>
<td>list of client device os types to match</td>
</tr>
<tr>
<td><code>site_ids</code></td>
<td><code>list</code></td>
<td>list of site ids to match</td>
</tr>
<tr>
<td><code>sitegroup_ids</code></td>
<td><code>list</code></td>
<td>list of sitegroup ids to match</td>
</tr>
<tr>
<td><code>action</code></td>
<td><code>string</code></td>
<td>allow / block</td>
</tr>
</tbody>
</table>
<h1 id="jsi">JSI</h1>
<p>Juniper Support Insight is a free service provided to all Mist customers. You can adopt your devices via a few lines
CLI comands. Allowing you to
- get some basic information about the adopted devices
- web shell into device (write privilege required)
- upgrade (write privilege required)</p>
<h2 id="get-all-devices-that-connected-to-jsi">GET All devices that connected to JSI</h2>
<pre><code>GET /api/v1/orgs/:org_id/jsi/devices?limit=100&amp;model=EX2300&amp;serial=DGCOO0015&amp;mac=c15353123096
</code></pre>
<h3 id="response_162">Response</h3>
<pre><code>[
    {
        "mac": "c15353123096",
        "model": "EX2300-C-12P",
        "serial": "DGCOO0015",

        // when it's available
        "last_seen": 1654636867,
        "uptime": 1654550467,
        "version": "19.2R1.8"
    },
    ...
]
</code></pre>
<h2 id="adopt-jsi-devices">Adopt JSI devices</h2>
<pre><code>GET /api/v1/orgs/:org_id/jsi/devices/outbound_ssh_cmd
</code></pre>
<h3 id="response_163">Response</h3>
<pre><code>{
    "cmd": "set system services ssh...\n...\nset system services outbound-ssh client mist ..."
}
</code></pre>
<h2 id="create-shell-session">Create Shell Session</h2>
<pre><code>POST /api/v1/orgs/:org_id/jsi/devices/:mac/shell
</code></pre>
<h3 id="response_164">Response</h3>
<pre><code>{
    "session': "19e73828-937f-05e6-f709-e29efdb0a82b",
    "url": "wss://api-ws.mist.com/ssh?jwt=xxxx"
}
</code></pre>
<h2 id="upgrade">Upgrade</h2>
<pre><code>POST /api/v1/orgs/:org_id/jsi/devices/:mac/upgrade
</code></pre>
<h3 id="request_81">Request</h3>
<pre><code>{
    "version": "3.1.5"
}
</code></pre>
<h2 id="look-up-past-purchases">Look up Past Purchases</h2>
<p>This gets all devices purchased from the accounts associated with the Org
- Fetch Install base devices for all linked accounts and associated account of the linked accounts.
- The primary and the associated account ids will be queries from SFDC by passing the linked account
- Retruns only the device centeric details of the Install base device. No customer specific information will be returned.</p>
<pre><code>GET /api/v1/orgs/:org_id/jsi/inventory?limit=100&amp;model=EX2300&amp;serial=DGCOO0015
</code></pre>
<p>see <a href="https://api.mist.com/api/v1/docs/Org#get-juniper-linked-accounts">Get Juniper Linked Accounts</a></p>
<h3 id="response-if-no-juniper-account-linked">Response if no Juniper Account Linked</h3>
<pre><code>Status 400

{
    "detail": "no juniper account linked"
}
</code></pre>
<h3 id="response_165">Response</h3>
<pre><code>[
   {
    'model': 'EX4300-48T',
    'type': 'switch',
    'serial': 'PE3721050223',
    'sku': 'EX4300-48T-AFI',
    'warranty_type': 'Enhanced Hardware Warranty',
    'eol_time': 1671062400,
    'eos_time': 1828828800
   }
]
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>model of the install base inventory</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>device type, ap / switch / gateway</td>
</tr>
<tr>
<td><code>serial</code></td>
<td><code>string</code></td>
<td>serial Number of the inventory</td>
</tr>
<tr>
<td><code>sku</code></td>
<td><code>string</code></td>
<td>serviceable device stock</td>
</tr>
<tr>
<td><code>warranty_type</code></td>
<td><code>string</code></td>
<td>type of warranty</td>
</tr>
<tr>
<td><code>eol_time</code></td>
<td><code>timestamp</code></td>
<td>end of life time</td>
</tr>
<tr>
<td><code>eos_time</code></td>
<td><code>timestamp</code></td>
<td>end of support time</td>
</tr>
</tbody>
</table>
<h2 id="upgrade-to-mist-managed">Upgrade to mist-managed</h2>
<pre><code>PUT /api/v1/orgs/:org_id/inventory
</code></pre>
<h2 id="request_82">Request</h2>
<pre><code>{
    "op": "upgrade_to_mist",
    "macs": [
        "c15353123096",
        "5c5b350e0001"
    ]
}
</code></pre>
<h3 id="response_166">Response</h3>
<pre><code>{
    "op": "upgrade_to_mist",
    "success": [ "c15353123096" ],
    "error": [ "5c5b350e0001" ],
    "reason": [ "already upgraded to mist" ]
}
</code></pre>
<h2 id="downlograde-to-basic-monitoring">Downlograde to basic monitoring</h2>
<p>When downgrading a VC member to jsi, we will move the cloud connection of the VC to jsi-terminator and keep all VC device/inventories intact for pain-free upgrading back to mist.</p>
<h2 id="request_83">Request</h2>
<pre><code>{
    "op": "downgrade_to_jsi",
    "macs": [
        "c15353123096",
        "5c5b350e0001"
    ]
}
</code></pre>
<h3 id="response_167">Response</h3>
<pre><code>{
    "op": "downgrade_to_jsi",
    "success": [ "5c5b350e0001" ],
    "error": [ "c15353123096" ],
    "reason": [ "already downgraded to jsi" ]
}
</code></pre>
<h2 id="troubleshoot">Troubleshoot</h2>
<p>Troubleshoot sites, devices, clients, and wired clients for maximum of last 7 days from current time. See <a href="https://api.mist.com/api/v1/docs/Org#search">search APIs</a> for device information.</p>
<pre><code>GET /api/v1/orgs/:org_id/troubleshoot?mac=:mac&amp;site_id=4ac1dcf4-9d8b-7211-65c4-057819f0862b&amp;start=1655065456&amp;end=1655151856
</code></pre>
<h3 id="parameters_69">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>mac</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site_id</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>type of network to troubleshoot in a site, wireless / wired / wan, default type is wireless, each type should be queried separately</td>
</tr>
</tbody>
</table>
<h3 id="response_168">Response</h3>
<pre><code>{
    "results": [
        {
             "category": "client",
             "reason": "slow association",
             "text": "Clients of the AP had slow association 8% of the time on Bhavabhi and 5 GHz. ...",
             "recommendation":  "Ensure the IP helper-address is configured on the VLAN interface.",
             "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b"
        },
        ...
    ],
    "start": 1655065456,
    "end": 1655151856
}
</code></pre>
<p>NOTE: requires Marvis subscription license</p>
<h2 id="premium-analytics-dashboards">Premium Analytics dashboards</h2>
<p>This all the premium analytics dashboards for this Org</p>
<pre><code>GET /api/v1/orgs/:org_id/pma/dashboards?limit=100
</code></pre>
<h3 id="response_169">Response</h3>
<pre><code>[
    {
        'name': 'dashboard_1',
        'url': 'https://api.mist.com/api/v1/forward/looker?jwt=...',
        'label': 'Wireless',
        'description': 'Dashboard 1 description.'
    }
]
</code></pre>
<h3 id="parameters_70">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>name of the dashboard</td>
</tr>
<tr>
<td><code>url</code></td>
<td><code>string</code></td>
<td>url to access dashboard. Url will redirect the user to the dashboard.</td>
</tr>
<tr>
<td><code>label</code></td>
<td><code>string</code></td>
<td>group label name</td>
</tr>
<tr>
<td><code>description</code></td>
<td><code>string</code></td>
<td>description of the dashboard</td>
</tr>
</tbody>
</table>
<h2 id="search-otherdevices-events">Search OtherDevices Events</h2>
<pre><code>GET /api/v1/orgs/:org_id/otherdevices/events/search?mac=4c9614a78e00
</code></pre>
<h3 id="supported-filters_8">Supported Filters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>mac</td>
</tr>
<tr>
<td><code>device_mac</code></td>
<td><code>string</code></td>
<td>mac of attached device</td>
</tr>
<tr>
<td><code>vendor</code></td>
<td><code>string</code></td>
<td>vendor name</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>event type</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>device model</td>
</tr>
</tbody>
</table>
<h3 id="supported-events-type_1">Supported Events Type</h3>
<pre><code>GET /api/v1/const/otherdevice_events
</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CELLULAR_EDGE_CONNECTED_TO_NCM</code></td>
</tr>
<tr>
<td><code>CELLULAR_EDGE_DISCONNECTED_FROM_NCM</code></td>
</tr>
<tr>
<td><code>CELLULAR_EDGE_ETHERNET_WAN_CONNECTED</code></td>
</tr>
<tr>
<td><code>CELLULAR_EDGE_ETHERNET_WAN_DISCONNECTED</code></td>
</tr>
<tr>
<td><code>CELLULAR_EDGE_ETHERNET_WAN_PLUGGED</code></td>
</tr>
<tr>
<td><code>CELLULAR_EDGE_ETHERNET_WAN_UNPLUGGED</code></td>
</tr>
<tr>
<td><code>CELLULAR_EDGE_FIRMWARE_UPGRADED</code></td>
</tr>
<tr>
<td><code>CELLULAR_EDGE_LOGIN_FAILED</code></td>
</tr>
<tr>
<td><code>CELLULAR_EDGE_LOGIN_SUCCEEDED</code></td>
</tr>
<tr>
<td><code>...</code></td>
</tr>
</tbody>
</table>
<h3 id="response_170">Response</h3>
<pre><code>{
    "results": [
        {
            "org_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862a",
            "site_id": "4ac1dcf4-9d8b-7211-65c4-057819f0862b",
            "vendor": "cradlepoint",
            "mac": "5c5b351e13b5",
            "device_mac": "5c5b351e13b5",
            "text": "Plugged: The Internal 5GB (SIM1) has been inserted into Internal 1.",
            "timestamp": 1547235620.89,
            "type": "CELLULAR_EDGE_MODEM_WAN_PLUGGED",
            "model": "W1850"
        },
        ...
    ]
}
</code></pre>
<h3 id="supported-otherdevice-models">Supported OtherDevice Models</h3>
<pre><code>GET /api/v1/const/otherdevice_models
</code></pre>
<h3 id="response_171">Response</h3>
<pre><code>    {
        "model": "W1850",
        "id": "65",
        "vendor": "cradlepoint",
        "device_type": "router",
        "display": "W1850",
    },
    ...
</code></pre>
<h2 id="count-other-devices-events">Count Other Devices Events</h2>
<pre><code>GET /api/v1/orgs/:org_id/otherdevices/events/count?distinct=mac
</code></pre>
<h3 id="response_172">Response</h3>
<pre><code>{
    "end": 1545874660.211871,
    "distinct": "mac",
    "results": [
        {
            "count": 22,
            "mac": "0030448c6e40"
        }
    ],
    "start": 1545788260.21184,
    "limit": 10,
    "total": 1
}
</code></pre>
<h2 id="search-wan-clients">Search WAN Clients</h2>
<pre><code>GET /api/v1/orgs/:org_id/wan_clients/search
</code></pre>
<h3 id="request_84">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>partial / full MAC address</td>
</tr>
<tr>
<td><code>hostname</code></td>
<td><code>string</code></td>
<td>partial / full hostname</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>client IP</td>
</tr>
<tr>
<td><code>mfg</code></td>
<td><code>string</code></td>
<td>Manufacture</td>
</tr>
<tr>
<td><code>network</code></td>
<td><code>string</code></td>
<td>network</td>
</tr>
<tr>
<td><code>ip_src</code></td>
<td><code>string</code></td>
<td>IP source</td>
</tr>
</tbody>
</table>
<h3 id="response_173">Response</h3>
<pre><code>{
  "results": [
    {
      "wcid": "8bbe7389-212b-c65d-2208-00fab2017936",
      "hostname": [
        "sonoszp"
      ],
      "ip": [
        "192.168.1.139",
        "192.168.1.122"
      ],
      "mfg": "Sonos",
      "last_hostname": "sonoszp",
      "timestamp": 1718791390,
      "org_id": "b4e16c72-d50e-4c03-a952-a3217e231e2c",
      "site_id": "f688779c-e335-4f88-8d7c-9c5e9964528b",
      "last_ip": "192.168.1.139",
      "network": "lan",
      "ip_src": "dhcp",
      "dhcp_expire_time": 1718798190,
      "dhcp_start_time": 1718788190
    }
  ]
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-wan-clients">Count by Distinct Attributes of WAN Clients</h2>
<pre><code>GET /api/v1/orgs/:org_id/wan_clients/count?distinct=mfg
</code></pre>
<h3 id="request_85">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>hostname, ip, mfg, network, default is mac</td>
</tr>
</tbody>
</table>
<h3 id="response_174">Response</h3>
<pre><code>{
    "start": 1511967600,
    "end": 1513177200,
    "limit": 10,
    "distinct": "device",

    "total": 2,
    "results": [
        {
            "mfg": "Apple",
            "count": 61
        },
        {
            "mfg": "Sonos",
            "count": 44
        }
    ]
}
</code></pre>
<h2 id="search-wan-client-events">Search WAN Client Events</h2>
<pre><code>GET /api/v1/orgs/:org_id/wan_clients/events/search
</code></pre>
<h3 id="request_86">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>Event type, e.g. CLIENT_IP_ASSIGNED, CLIENT_IP_RENEWED, CLIENT_IP_EXPIRED</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>Client mac</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>partial / full MAC address</td>
</tr>
<tr>
<td><code>hostname</code></td>
<td><code>string</code></td>
<td>partial / full hostname</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>client IP</td>
</tr>
<tr>
<td><code>mfg</code></td>
<td><code>string</code></td>
<td>Manufacture</td>
</tr>
</tbody>
</table>
<h3 id="response_175">Response</h3>
<pre><code>{
  "start": 1512572151,
  "end": 1513176951,
  "limit": 10,
  "total": 1,
  'results': [
    {
      "When": "2022-12-31T23:59:59.293Z",
      "org_id": "b0b9f142-aaba-11e6-aafc-0242ac110002",
      "site_id": "fc656275-b157-43fd-b922-5f4f341c19bf",
      "wcid": "62bbfb75-10d8-49d1-dec7-d2df91624287",
      "random_mac": False,
      "ev_type": "CLIENT_IP_ASSIGNED",
      "text": "DHCP Ack IP 192.168.88.216",
      "metadata": {
        "client_ip": "192.168.88.216",
        "expiration": 1672823632.127
      }
    }
  ]
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-wan-client-events">Count by Distinct Attributes of WAN Client-Events</h2>
<pre><code>GET /api/v1/orgs/:org_id/wan_client/events/count?distinct=type
</code></pre>
<h3 id="request_87">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>type, hostname, ip, mfg, mac</td>
</tr>
</tbody>
</table>
<pre><code>{
  "start": 1513276353,
  "end": 1513362753,
  "limit": 3,
  "total": 3,
  "results": [
    {
      "type": "CLIENT_IP_ASSIGNED",
      "count": 4
    },
    {
      "type": "CLIENT_IP_RENEWED",
      "count": 2
    },
    {
      "type": "CLIENT_IP_EXPIRED",
      "count": 2
    }
  ]
}
</code></pre>
<h2 id="idp-credential-validation">IDP Credential Validation</h2>
<pre><code>POST /api/v1/orgs/:org_id/mist_nac/test_idp
</code></pre>
<h3 id="request_88">Request</h3>
<pre><code>{
    "username": "suriyas@juniper.net",
    "password": "xxxxxx"
}
</code></pre>
<h3 id="response_176">Response</h3>
<pre><code>{
    "session": "1587919a-bf51-4153-9a85-8855a9b5ba8a"
}
</code></pre>
<pre><code>{
    "subscribe": "/orgs/:org_id/mist_nac/test_idp"
}
</code></pre>
<h3 id="response-no-idp-can-be-found">Response (no idp can be found)</h3>
<pre><code>{
    "event": "data",
    "channel": "/orgs/:org_id/mist_nac/test_idp",
    "status": 
    "data": {
        "status": "failure",
        "error": "No matching IDP found"
    }
}
</code></pre>
<h3 id="response-ok">Response OK</h3>
<pre><code>{
    "event": "data",
    "channel": "/orgs/:org_id/mist_nac/test_idp",
    "status": 
    "data": {
        "status": "success",
        "idp_id": "915793c0-1355-4e98-b1c0-23df2227b357",
        "idp_type": "ldap",
        // more attributes will be added later
    }
}
</code></pre>
<h3 id="response-invalid-credentials">Response Invalid Credentials</h3>
<pre><code>{
    "event": "data",
    "channel": "/orgs/:org_id/mist_nac/test_idp",
    "status": 
    "data": {
        "status": "failure",
        "error": "Invalid Credentials",
        "idp_id": "915793c0-1355-4e98-b1c0-23df2227b357",
        "idp_type": "ldap",
    }
}
</code></pre>
<h2 id="search-nac-client-events">Search NAC Client Events</h2>
<pre><code>GET /api/v1/orgs/:org_id/nac_clients/events/search
</code></pre>
<h3 id="request_89">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>event type, e.g. NAC_CLIENT_PERMIT</td>
</tr>
<tr>
<td><code>nacrule_id</code></td>
<td><code>string</code></td>
<td>NAC Policy Rule ID, if matched</td>
</tr>
<tr>
<td><code>dryrun_nacrule_id</code></td>
<td><code>string</code></td>
<td>NAC Policy Dry Run Rule ID, if present and matched</td>
</tr>
<tr>
<td><code>auth_type</code></td>
<td><code>string</code></td>
<td>authentication type, e.g. “eap-tls”, “peap-tls”, “eap-ttls”, “eap-teap”, “mab”, “psk”, “device-auth”</td>
</tr>
<tr>
<td><code>vlan</code></td>
<td><code>string</code></td>
<td>Vlan ID</td>
</tr>
<tr>
<td><code>nas_vendor</code></td>
<td><code>string</code></td>
<td>vendor of NAS device</td>
</tr>
<tr>
<td><code>bssid</code></td>
<td><code>string</code></td>
<td>SSID</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>SSID</td>
</tr>
<tr>
<td><code>idp_username</code></td>
<td><code>string</code></td>
<td>Username presented to the Identity Provider</td>
</tr>
<tr>
<td><code>username</code></td>
<td><code>string</code></td>
<td>Username presented by the client</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id if assigned, null if not assigned</td>
</tr>
<tr>
<td><code>ap</code></td>
<td><code>string</code></td>
<td>AP MAC</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>MAC address</td>
</tr>
<tr>
<td><code>mxedge_id</code></td>
<td><code>string</code></td>
<td>Mist Edge ID used to connect to cloud</td>
</tr>
<tr>
<td><code>port_type</code></td>
<td><code>string</code></td>
<td>Type of client i.e wired, wireless</td>
</tr>
<tr>
<td><code>device_mac</code></td>
<td><code>string</code></td>
<td>Switch MAC Address</td>
</tr>
<tr>
<td><code>ip</code></td>
<td><code>string</code></td>
<td>IP addressed assigned to client</td>
</tr>
<tr>
<td><code>port_id</code></td>
<td><code>string</code></td>
<td>Port ID for the device</td>
</tr>
<tr>
<td><code>usermac_label</code></td>
<td><code>list</code></td>
<td>labels derived from usermac entry</td>
</tr>
<tr>
<td><code>text</code></td>
<td><code>string</code></td>
<td>partial / full MAC address, username, device_mac or ap</td>
</tr>
<tr>
<td><code>nas_ip</code></td>
<td><code>string</code></td>
<td>IP address of NAS device</td>
</tr>
<tr>
<td><code>sort</code></td>
<td><code>string</code></td>
<td>sort options, ‘-‘ prefix represents DESC order, default is wcid in ASC order</td>
</tr>
<tr>
<td><code>ingress_vlan</code></td>
<td><code>string</code></td>
<td>vendor specific Vlan ID in radius requests</td>
</tr>
</tbody>
</table>
<h3 id="response_177">Response</h3>
<pre><code>{
    "start": 1512572151,
    "end": 1513176951,
    "limit": 10,

    "total": 1,
    "results": [
        {
            "type": "NAC_CLIENT_PERMIT",
            "nacrule_id": "32f27e7d-ff26-4a9b-b3d1-ff9bcb264c62",
            "nacrule_matched": true,
            "dryrun_nacrule_id": "32f27e7d-ff26-4a9b-b3d1-ff9bcb264012",
            "dryrun_nacrule_matched": true,
            "auth_type": "eap-ttls",
            "vlan": "750",
            "vlan_source": "nactag",
            "nas_vendor": "juniper-mist",
            "bssid": "5c5b355fafcc",
            "idp_id": "912ef72e-2239-4996-b81e-469e87a27cd6",
            "idp_role": [
                "itsuperusers",
                "vip"
            ],
            "usermac_label": [
                "bldg5",
                "printer"
            ],
            "resp_attrs": [
                "Tunnel-Type=VLAN",
                "Tunnel-Medium-Type=IEEE-802",
                "Tunnel-Private-Group-Id=750",
                "User-Name=anonymous"
            ],
            "ssid": "##mist_nac",
            "idp_username": "user@deaflyz.net",
            "username": "user@deaflyz.net",
            "timestamp": 1691512031.358188,
            "org_id": "27547ac2-d114-4e04-beb1-f3f1e6e81ec6",
            "site_id": "441a1214-6928-442a-8e92-e1d34b8ec6a6",
            "random_mac": False,
            "ap": "5c5b35513227",
            "mac": "ac3eb179e535"
        }
    ]
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-nac-client-events">Count by Distinct Attributes of NAC Client-Events</h2>
<pre><code>GET /api/v1/orgs/:org_id/nac_clients/events/count?distinct=type
</code></pre>
<h3 id="request_90">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>type / nacrule_id / dryrun_nacrule_id / auth_type / vlan / nas_vendor / username / ap / mac / ssid</td>
</tr>
</tbody>
</table>
<h3 id="response_178">Response</h3>
<pre><code>{
    "start": 1513276353,
    "end": 1513362753,
    "limit": 3,

    "total": 3,
    "results": [
        {
            "count": 80,
            "type": "NAC_CLIENT_PERMIT"
        },
        {
            "count": 36,
            "type": "NAC_CLIENT_CERT_CHECK_SUCCESS"
        },
        {
            "count": 19,
            "type": "NAC_CLIENT_DENY"
        }
    ]
}
</code></pre>
<h2 id="search-nac-clients">Search NAC Clients</h2>
<pre><code>GET /api/v1/orgs/:org_id/nac_clients/search
</code></pre>
<h3 id="request_91">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>nacrule_id</code></td>
<td><code>string</code></td>
<td>NAC Policy Rule ID, if matched</td>
</tr>
<tr>
<td><code>nacrule_matched</code></td>
<td><code>bool</code></td>
<td>If NAC Policy Rule Matched</td>
</tr>
<tr>
<td><code>auth_type</code></td>
<td><code>string</code></td>
<td>authentication type, e.g. “eap-tls”, “peap-tls”, “eap-ttls”, “eap-teap”, “mab”, “device-auth”</td>
</tr>
<tr>
<td><code>vlan</code></td>
<td><code>string</code></td>
<td>Vlan name or ID assigned to the client</td>
</tr>
<tr>
<td><code>nas_vendor</code></td>
<td><code>string</code></td>
<td>vendor of NAS device</td>
</tr>
<tr>
<td><code>idp_id</code></td>
<td><code>string</code></td>
<td>SSO ID, if present and used</td>
</tr>
<tr>
<td><code>ssid</code></td>
<td><code>string</code></td>
<td>SSID</td>
</tr>
<tr>
<td><code>username</code></td>
<td><code>string</code></td>
<td>Username presented by the client</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td><code>long</code></td>
<td>start time, in epoch</td>
</tr>
<tr>
<td><code>org_id</code></td>
<td><code>string</code></td>
<td>org id</td>
</tr>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id if assigned, null if not assigned</td>
</tr>
<tr>
<td><code>ap</code></td>
<td><code>string</code></td>
<td>AP MAC connected to by client</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>MAC address</td>
</tr>
<tr>
<td><code>device_mac</code></td>
<td><code>string</code></td>
<td>Switch MAC Address</td>
</tr>
<tr>
<td><code>status</code></td>
<td><code>string</code></td>
<td>Connection status of client i.e “permitted”, “denied, “session_started”, “session_ended”</td>
</tr>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>Client type i.e. “wireless”, “wired” etc.</td>
</tr>
<tr>
<td><code>mdm_compliance</code></td>
<td><code>string</code></td>
<td>MDM compliancy of client i.e “compliant”, “not compliant”</td>
</tr>
<tr>
<td><code>mdm_managed</code></td>
<td><code>bool</code></td>
<td>Filters NAC clients that are managed by MDM providers</td>
</tr>
<tr>
<td><code>mdm_provider</code></td>
<td><code>string</code></td>
<td>MDM provider of client’s organisation eg “intune”, “jamf”</td>
</tr>
<tr>
<td><code>mxedge_id</code></td>
<td><code>string</code></td>
<td>ID of Mist Edge that the client is connected through</td>
</tr>
<tr>
<td><code>nacrule_name</code></td>
<td><code>string</code></td>
<td>NAC Policy Rule Name, if matched</td>
</tr>
<tr>
<td><code>text</code></td>
<td><code>string</code></td>
<td>partial / full MAC address, last_username, device_mac or last_ap</td>
</tr>
<tr>
<td><code>sort</code></td>
<td><code>string</code></td>
<td>sort options, ‘-‘ prefix represents DESC order, default is wcid in ASC order</td>
</tr>
<tr>
<td><code>usermac_label</code></td>
<td><code>string</code></td>
<td>Labels derived from usermac entry</td>
</tr>
<tr>
<td><code>mfg</code></td>
<td><code>string</code></td>
<td>Manufacturer of the client’s device</td>
</tr>
<tr>
<td><code>family</code></td>
<td><code>string</code></td>
<td>Family of the client’s device</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>string</code></td>
<td>Model of the client’s device</td>
</tr>
<tr>
<td><code>os</code></td>
<td><code>string</code></td>
<td>Operating system of the client’s device</td>
</tr>
<tr>
<td><code>hostname</code></td>
<td><code>string</code></td>
<td>Hostname of the client’s device</td>
</tr>
</tbody>
</table>
<h3 id="response_179">Response</h3>
<pre><code>{
    "start": 1512572151,
    "end": 1513176951,
    "limit": 10,

    "total": 2,
    "results": [
        {
            "ap": ["5c5b35bf16bb", "d4dc090041b4"],
            "auth_type": "eap-tls",
            "cert_cn": ["werqwerty"],
            "cert_issuer": ["/DC=com/DC=onmicrosoft/DC=Juniper461/CN=Juniper461-CA"],
            "idp_id": "a13df686-dc39-4bdd-920f-89a412444c06",
            "idp_role": ["Employee"],
            "ip": ["10.7.51.74"],
            "last_ap": "d4dc090041b4",
            "last_cert_cn": "werqwerty",
            "last_cert_expiry": 1725373986,
            "last_cert_issuer": "/DC=com/DC=onmicrosoft/DC=Juniper461/CN=Juniper461-CA",
            "last_ip": "10.7.51.74",
            "last_nacrule_id": "558d6c97-d3c2-43e7-941d-244603ef5ce6",
            "last_nacrule_name": "mdm_complaince",
            "last_nas_vendor": "juniper-mist",
            "last_ssid": "mdm_test",
            "last_status": "permitted",
            "nacrule_id": ["558d6c97-d3c2-43e7-941d-244603ef5ce6"],
            "nacrule_matched": true,
            "nacrule_name": ["mdm_complaince"],
            "nas_vendor": ["juniper-mist"],
            "mac": "ac3eb179e535",
            "org_id": "9301bff6-8992-49d6-b1ea-907ee81bb5fb",
            "random_mac": true,
            "site_id": "13d69fb2-5456-43a1-90c4-89513487dde2",
            "ssid": ["mdm_test"],
            "timestamp": 1694689718.612,
            "type": "wireless",
            "usermac_label": [
                "non-compliant",
                "building26",
                "floor52"
            ],
            "last_mfg": "Apple, Inc.",
            "last_family": "Phone/Tablet/Wearable",
            "last_model": "iPhone 16 Pro",
            "last_os": "iOS 18.1",
            "last_hostname": "Apple iPhone Work"

        },
        {
            "auth_type": "mab",
            "group": "employee",
            "type": "wired",
            "last_status": "session_started",
            "device_mac": "0c599c646778",
            "gbp_tag": "3005",
            "last_nacrule_id": "85abd6a3-c4a4-497d-a568-2765046e0dba",
            "last_nacrule_name": "Allowed Printers",
            "last_nas_vendor": "juniper-mist",
            "last_port_id": "ge-0/0/1.0",
            "last_username": "CanonPrinter1",
            "last_vlan": "750",
            "nacrule_id": [
                "85abd6a3-c4a4-497d-a568-2765046e0dba"
            ],
            "nacrule_matched": true,
            "nacrule_name": [
                "Allowed Printers"
            ],
            "nas_vendor": [
                "juniper-mist"
            ],
            "org_id": "9301bff6-8992-49d6-b1ea-907ee81bb5fb",
            "port_id": [
                "ge-0/0/1.0"
            ],
            "random_mac": false,
            "site_id": "441a1214-6928-442a-8e92-e1d34b8ec6a6",
            "site_ids": [
                "441a1214-6928-442a-8e92-e1d34b8ec6a6"
            ],
            "username": [
                "CanonPrinter1",
                "6c3c7c7573e7"
            ],
            "vlan": [
                "750",
                "751"
            ],
            "vlan_source": "usermac",
            "timestamp": 1721641794.344
        }
    ]
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-nac-clients">Count by Distinct Attributes of NAC Clients</h2>
<pre><code>GET /api/v1/orgs/:org_id/nac_clients/count?distinct=type
</code></pre>
<h3 id="request_92">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>type / last_nacrule_id / auth_type / last_vlan / last_nas_vendor / last_username / last_ap / mac / last_ssid / last_status / mdm_compliance / mdm_provider</td>
</tr>
</tbody>
</table>
<h3 id="response_180">Response</h3>
<pre><code>{
    "start": 1513276353,
    "end": 1513362753,
    "limit": 3,
    "total": 2,
    "results": [
        {
            "count": 10,
            "type": "wired"
        },
        {
            "count": 15,
            "type": "wireless"
        }
    ]
}
</code></pre>
<h2 id="search-vars">Search vars</h2>
<pre><code>GET /api/v1/orgs/:org_id/vars/search?var=*
</code></pre>
<h3 id="supported-filters_9">Supported Filters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>site_id</code></td>
<td><code>string</code></td>
<td>site id</td>
</tr>
<tr>
<td><code>deviceprofile_id</code></td>
<td><code>string</code></td>
<td>device profile id</td>
</tr>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>device mac address</td>
</tr>
<tr>
<td><code>var</code></td>
<td><code>string</code></td>
<td>var search</td>
</tr>
<tr>
<td><code>src</code></td>
<td><code>string</code></td>
<td>var source: site/deviceprofile/device</td>
</tr>
</tbody>
</table>
<h3 id="response_181">Response</h3>
<pre><code>{
    "results": [
        {
            "timestamp": 1695638195.57287,         
            "src": "site",
            "org_id": "0c160b7f-1027-4cd1-923b-744534c4b070",
            "var": "mvp",
            "site_id": "1519f016-4e41-47c0-a396-cce4d04bac0b"            
        }
    ],
    "start": 1693949379,
    "end": 1693952979,
    "limit": 10,
    "total": 1
}
</code></pre>
<h2 id="count-by-distinct-attributes-of-vars">Count by Distinct Attributes of vars</h2>
<pre><code>GET /api/v1/orgs/:org_id/vars/count?distinct=var
</code></pre>
<h3 id="request_93">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>distinct</code></td>
<td><code>string</code></td>
<td>site_id / deviceprofile_id / src / var / mac, default is site_id</td>
</tr>
</tbody>
</table>
<h3 id="response_182">Response</h3>
<pre><code>{
    "results": [
        {
            "var": "hello",
            "count": 2
        },
        {
            "var": "dns_1",
            "count": 1
        },
        {
            "var": "dns_2",
            "count": 1
        },
        {
            "var": "mvp",
            "count": 1
        },
        {
            "var": "some_var",
            "count": 1
        },
        {
            "var": "wife5",
            "count": 1
        }
    ],
    "start": 1695667663,
    "end": 1695671263,
    "limit": 10,
    "distinct": "var",
    "total": 12
}
</code></pre>
<h1 id="import-nac-org-crl-file">Import NAC Org CRL file</h1>
<p>The Import NAC Org CRL File endpoint allows users to manually upload a Certificate Revocation List (CRL) file in either PEM or DER format. This is a multipart POST request. We support one file upload per issuer, and re-uploads for the same issuer will overwrite the existing file.</p>
<pre><code>POST /api/v1/orgs/:org_id/setting/mist_nac_crls
</code></pre>
<h3 id="request_94">Request</h3>
<p>A multi-part POST</p>
<pre><code>"file": a PEM or DER formatted CRL file
"json": a JSON string with "name" field for CRL file issuer (optional)
</code></pre>
<h3 id="response_183">Response</h3>
<p>Response when the file upload is successful
Status 200 OK</p>
<pre><code>{
    "id": "a1ca26f3-44dd-4833-9a7b-97bbb2ab5230",
    "created_time": 1698099079,
    "modified_time": 1698099079,
    "name": "SampleCertificateSigner",
    "url": "http://url/to/crl_file.crl"
}
</code></pre>
<p>Response when the file parameter is missing in the request.
Status 400 Bad Request</p>
<pre><code>{
    "detail": "No file provided in the request"
}
</code></pre>
<p>Response when the file provided is not a valid PEM or DER formatted CRL.
Status 400 Bad Request</p>
<pre><code>{
    "detail": "Invalid CRL file"
}
</code></pre>
<p>Response when the content type is not multipart/form-data.
Status 400 Bad Request</p>
<pre><code>{
    "detail": "The request needs to be of multipart format"
}
</code></pre>
<h3 id="response-definitions_2">Response Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>Unique ID for the uploaded CRL file, used to reference the file</td>
</tr>
<tr>
<td><code>created_time</code></td>
<td><code>long</code></td>
<td>Epoch time when the file was first uploaded</td>
</tr>
<tr>
<td><code>modified_time</code></td>
<td><code>long</code></td>
<td>Epoch time when the file was last modified (if re-uploaded)</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>Issuer name for the CRL file</td>
</tr>
<tr>
<td><code>url</code></td>
<td><code>string</code></td>
<td>URL to download the uploaded CRL file</td>
</tr>
</tbody>
</table>
<h1 id="get-nac-org-crl-file">Get NAC Org CRL file</h1>
<p>Returns all uploaded CRL file IDs with names for the orgI</p>
<pre><code>GET /api/v1/orgs/:org_id/setting/mist_nac_crls
</code></pre>
<h3 id="response_184">Response</h3>
<pre><code>{
    "results": [
        {
            "id": "a1ca26f3-44dd-4833-9a7b-97bbb2ab5230",
            "created_time": 1698099079,
            "modified_time": 1698099079,
            "name": "SampleCertificateSigner",
            "url": "http://url/to/crl_file"

        },
        {
            "id": "b6cab019-1167-4377-b44d-ec86c28fcb84",
            "created_time": 1698099179,
            "modified_time": 1698099379,
            "name": "TestCertificateSigner",
            "url": "http://url/to/crl_file"
        }
    ]
}
</code></pre>
<h3 id="response-definitions_3">Response Definitions</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>ID for file upload, used to identify file even for deletion</td>
</tr>
<tr>
<td><code>created_time</code></td>
<td><code>long</code></td>
<td>Time at which the file was first uploaded, in epoch</td>
</tr>
<tr>
<td><code>modified_time</code></td>
<td><code>long</code></td>
<td>Time at which the file was last updated, in epoch</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>Name for the CRL file issuer if set</td>
</tr>
<tr>
<td><code>url</code></td>
<td><code>string</code></td>
<td>Download URL for the CRL file</td>
</tr>
</tbody>
</table>
<h1 id="delete-nac-org-crl-file">Delete NAC Org CRL file</h1>
<p>Delete NAC Org CRL file is a DELETE request to delete CRL file identified by its ID (ID assigned on file upload/creation)</p>
<pre><code>DELETE /api/v1/orgs/:org_id/setting/mist_nac_crls/:id
</code></pre>
<h3 id="response_185">Response</h3>
<pre><code>Status: 200 Successful
Status: &gt; 400 Unsuccessful
</code></pre>
<h1 id="usermac">UserMAC</h1>
<h2 id="create-user-mac">Create User MAC</h2>
<pre><code>POST /api/v1/orgs/:org_id/usermacs
</code></pre>
<h3 id="example_18">Example</h3>
<pre><code>Status 200 OK
{
    "mac": "921b638445cd",
    "labels": ["byod", "flr1"],
    "vlan": "30",
    "notes": "mac address refers to Canon printers",
    "name": "Printer2",
    "radius_group": "VIP"
}
</code></pre>
<h2 id="search-user-macs">Search User MACs</h2>
<p>This API is always paginated.
Search with mac and labels absent together returns all usermacs for the org.</p>
<pre><code>GET /api/v1/orgs/:org_id/usermacs/search?limit=100&amp;page=1
</code></pre>
<h3 id="supported-filters_10">Supported Filters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mac</code></td>
<td><code>string</code></td>
<td>optional, partial/full MAC address</td>
</tr>
<tr>
<td><code>labels</code></td>
<td><code>list</code></td>
<td>optional, array of strings of labels</td>
</tr>
</tbody>
</table>
<h3 id="response_186">Response</h3>
<pre><code>Status 200 OK
{
    "limit": 100,
    "page": 1,
    "results": [
        {
            "id": "111cafd2-ba1b-5169-bfcb-9cdf1d473ddb",
            "mac": "921b638445cd",
            "labels": ["flor1", "bld4"],
            "vlan": "30",
            "notes": "mac address refers to Canon printers",
            "name": "Printer2",
            "radius_group": "VIP"
        }
    ]
}
</code></pre>
<h2 id="get-user-mac">Get User MAC</h2>
<pre><code>GET /api/v1/:org_id/usermacs/:usermac_id
</code></pre>
<h3 id="response_187">Response</h3>
<pre><code>Status 200 OK
{
    "id": "111cafd2-ba1b-5169-bfcb-9cdf1d473ddb",
    "mac": "921b638445cd",
    "labels": ["flor1", "bld4"],
    "vlan": "5",
    "notes": "mac address refers to Canon printers",
    "name": "Printer2",
    "radius_group": "VIP"
}
</code></pre>
<h2 id="delete-user-mac">Delete User MAC</h2>
<pre><code>DELETE /api/v1/orgs/:org_id/usermacs/:usermac_id
</code></pre>
<pre><code>Status 200 OK
</code></pre>
<h2 id="delete-multi-user-mac">Delete multi User MAC</h2>
<p>This API accepts a list of usermac_id</p>
<pre><code>POST /api/v1/orgs/:org_id/usermacs/delete
</code></pre>
<h3 id="request_95">Request</h3>
<pre><code>{
    "usermac_ids": ["1041c16c-ca87-4d3f-bb94-b97c5819fc09", "a016cc8e-5893-418a-acaa-4d7c1af6ac0f"]
}
</code></pre>
<h3 id="response_188">Response</h3>
<pre><code>Status 200 OK
</code></pre>
<h3 id="update-multi-user-mac">Update multi User MAC</h3>
<pre><code>PUT /api/v1/orgs/:org_id/usermacs
</code></pre>
<h3 id="request_96">Request</h3>
<pre><code>[
    {
        "id": "1041c16c-ca87-4d3f-bb94-b97c5819fc09", // id required
        "mac": "921b638445cd",
        "labels": ["label1"],
        "vlan": "vlan-1"
    },
    {
        "id": "a016cc8e-5893-418a-acaa-4d7c1af6ac0f",
        "mac": "721b638445ef",
        "labels": ["label2", "label3"],
        "notes": "mac address refers to Canon printers"
    },
    {
        "id": "2feacc8e-5893-418a-acaa-4d7c1afd01fe",
        "mac": "1b600048345ef",
        "labels": ["label4"],
    }
]
</code></pre>
<h3 id="response_189">Response</h3>
<pre><code>Status 200 OK
{
    "updated": ["1041c16c-ca87-4d3f-bb94-b97c5819fc09", "a016cc8e-5893-418a-acaa-4d7c1af6ac0f"],
    "errors": ["2feacc8e-5893-418a-acaa-4d7c1afd01fe - invalid id"]
}
</code></pre>
<h2 id="import-user-macs">Import User MACs</h2>
<pre><code>POST /api/v1/orgs/:org_id/usermacs/import
</code></pre>
<h3 id="request-if-upload-via-json_1">Request if upload via JSON</h3>
<pre><code>[
    {
        "mac": "921b638445cd",
        "labels": ["label1"],
        "vlan": "vlan-1"
    },
    {
        "mac": "721b638445ef",
        "labels": ["label2", "label3"],
        "notes": "mac address refers to Canon printers"
    },
    {
        "mac": "721b638445ee",
        "labels": ["label4"],
        "name": "Printer2",
        "radius_group": "VIP"
    },
    {
        "mac": "921b638445ce",
        "labels": ["label5", "label6", "label7"]
    },
    {
        "mac": "921b638445cf",
        "vlan": "vlan-100"
    }
]    
</code></pre>
<h3 id="upload-via-csv-file_1">Upload via CSV file</h3>
<pre><code>"file": .csv file
</code></pre>
<h3 id="usermacs-import-csv-file-format">Usermacs import CSV file format</h3>
<pre><code>mac,labels,vlan,notes,name,radius_group
921b638445cd,"bldg1,flor1",vlan-100
721b638445ef,"bldg2,flor2",vlan-101,Canon Printers
721b638445ee,"bldg3,flor3",vlan-102,Printer2,VIP
921b638445ce,"bldg4,flor4",vlan-103
921b638445cf,"bldg5,flor5",vlan-104
</code></pre>
<h3 id="response_190">Response</h3>
<pre><code>Status 200 OK
{
    "added": ["921b638445cd"],
    "updated": ["721b638445ef", "721b638445ee"],
    "errors": ["921b638445ce - mac invalid", "921b638445cf - mac already provided"]
}
</code></pre>
<h1 id="marvis-client-installation-for-mdm">Marvis Client Installation (for MDM)</h1>
<h2 id="marvis-client-invite">Marvis Client Invite</h2>
<p>SDK Invites can be generated for (and belongs to) an Org. They can be generated by an Admin of an Org and can be revoked
at anytime.</p>
<h2 id="base-url_1">Base URL</h2>
<pre><code>/api/v1/orgs/:org_id/marvisinvites
</code></pre>
<pre><code>{
    "name": "Handhelds",

    // possible chicken-egg.    
    "proxy": ?

    "telemetry": {
        "enabled": true,

        // NOTE: some stats are not collected when it's not connected to Mist infrastructure
    }

    // enable zebra integration, requires connection to Mist AP
    "zebra": {
        "enabled": true,
        "port": 5060,
    },

    "critical_url_monitoring": {
        "enabled": true,
        // up to 5 monitors can be defined
        "monitors: [
            {
                // currently only http and https are supported
                "url": "http://50.1.3.5:8080",
                "vlan_id": 3,  // default is 1
            },
            ...
        ]
    },

    "synthetic_test": {
        "enabled": true
    }
}
</code></pre>
<h3 id="response_191">Response</h3>
<pre><code>{
    "id": "3a14098f-b995-7552-b0a4-b8ee39b337a6",
    "name": "Handhelds",

    # in MDM, add `--enrollment_url &lt;enrollment_url&gt;` to the install command
    "enrollment_url": "marvisclient://api.mist.com/path/to/url"
}
</code></pre>
<h2 id="marvis-client-stats">Marvis Client Stats</h2>
<pre><code>GET /api/v1/orgs/:org_id/stats/marvisclients/search
GET /api/v1/orgs/:org_id/stats/marvisclients/count
</code></pre>
<h2 id="marvis-client-events">Marvis Client Events</h2>
<pre><code>GET /api/v1/orgs/:org_id/marvisclients/events/search
GET /api/v1/orgs/:org_id/marvisclients/events/count
</code></pre>
<h2 id="marvis-client-commands-draft">Marvis Client Commands (draft)</h2>
<pre><code>POST /api/v1/orgs/:org_id/marvisclients/:marvisclient_id/:cmd
</code></pre>
<h2 id="delete-marvis-client">Delete Marvis Client</h2>
<pre><code>DELETE /api/v1/orgs/:org_id/marvisclients/:marvisclient_id
</code></pre>
<h1 id="nac-portal">NAC Portal</h1>
<p>PSK Portal is used to onboard Wireless Clients with PSK (by QR Code or URL)
NAC Portals are for onboard Wireless and Wired client with 802.1X </p>
<p>After a NAC portal is created, a URL is generated and can be given to the users (e.g. hosted on a web page “Get Access to Campus Wireless”)
The user will use SSO to signin and download a Mist APP (via an App-Installation URL) that will get installed and used to provision certificates.</p>
<h2 id="base-url_2">Base URL</h2>
<pre><code>/api/v1/orgs/:org_id/nacportals
</code></pre>
<pre><code>{
    "name": "CorpWifi"

    // type = marvis_client
    "access_type": "wireless",  // wireless (Default), wireless+wired
    // for wireless
    "eap_type": "wpa2", // wpa2 (Default), wpa3
    "ssid": "Corp",

    "sso": {
        "issuer": "https://app.onelogin.com/saml/metadata/138130"
        "idp_cert": "-----BEGIN CERTIFICATE-----\nMIIFZjCCA06gAwIBAgIIP61/1qm/uDowDQYJKoZIhvcNAQELBQE\n-----END CERTIFICATE-----",
        "idp_sign_algo": "sha256",
        "idp_sso_url": "https://yourorg.onelogin.com/trust/saml2/http-post/sso/138130",
        "nameid_format": "email",
        // optional

        // if it's desired to inject a role into Cert's Subject (so it can be used later on in policy)
        "use_sso_role_for_cert": true,
        // as an IDP usually associates multiple groups/roles to an user, how should the role to be determined
        "sso_role_matching": [
            {
                "match": "Student",
                "assigned": "user"
            }
        ]
    },

    "cert_expire_time": 365, // days

    // features to enable
    // NOTE: should be very low volume
    "enable_telemetry": true,  // model, version, fingering, events (connecting, disconnect, roaming), which ap

    "notify_expiry": true,  // optional, phase 2, 
    "expiry_notification_time": 2, // optional, unit days

    // UI customization
    "bg_image_url": ...
    "thumbnail_url": ...
    "template_url": ...

    "tos": ...

    // type = guest
    "type": "guest",

    "guest_portal_config": {
        // see [Guest Portal in WLAN](Site#guest-portal)
    },

    // UI customization (same as above)
}
</code></pre>
<h3 id="get-saml-metadata_1">Get SAML Metadata</h3>
<pre><code>GET /api/v1/orgs/:org_id/nacportals/:nacportal_id/saml_metadata
GET /api/v1/orgs/:org_id/nacportals/:nacportal_id/saml_metadata.xml
</code></pre>
<h3 id="get-latest-saml-failures_1">Get Latest SAML Failures</h3>
<pre><code>GET /api/v1/orgs/:org_id/nacportals/:nacportal_id/saml_failures
</code></pre>
<h3 id="response_192">Response</h3>
<pre><code>{
    "results": [
        {
            "timestamp": 1431382121,
            "detail": "Role attribute missing",
            "saml_assertion_xml": "&lt;samlp:Response xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:saml="urn:oasis:nam..."
        }
    ]
}
</code></pre>
<h2 id="search-org-events">Search Org Events</h2>
<pre><code>GET /api/v1/orgs/:org_id/events/search
</code></pre>
<h2 id="nacportal-template">NACPortal Template</h2>
<pre><code>PUT /api/v1/orgs/:org_id/nacportals/:nacportal_id/portal_template
</code></pre>
<h3 id="request_97">Request</h3>
<pre><code>{
  "poweredBy": false,
  "color": "#1074bc",
  "logo": null,
  "alignment": "center"
}
</code></pre>
<h3 id="parameters_71">Parameters</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>poweredBy</code></td>
<td><code>boolean</code></td>
<td>whether to hide “Powered by Juniper Mist” and email footers, default is false</td>
</tr>
<tr>
<td><code>color</code></td>
<td><code>string</code></td>
<td>“#1074bc”</td>
</tr>
<tr>
<td><code>logo</code></td>
<td><code>string</code></td>
<td>custom logo custom logo with “data:image/png;base64,” format.  default null, uses Juniper Mist Logo.</td>
</tr>
<tr>
<td><code>alignment</code></td>
<td><code>string</code></td>
<td>defines alignment on portal. “center” is default.</td>
</tr>
</tbody>
</table>
<h2 id="nacportal-image-upload">NACPortal Image Upload</h2>
<p>Upload background image for NACPortal</p>
<pre><code>POST /api/v1/orgs/:org_id/nacportals/:nacportal_id/portal_image
</code></pre>
<h3 id="request_98">Request</h3>
<p>A multi-part POST</p>
<pre><code>"json": a JSON string describing the upload
"file": a binary file
</code></pre>
<h2 id="nacportal-image-delete">NACPortal Image Delete</h2>
<p>Delete background image for NACPortal</p>
<pre><code>DELETE /api/v1/orgs/:org_id/nacportals/:nacportal_id/portal_image
</code></pre>
<p>If image is not uploaded or is deleted, NACPortal will use default image.</p>
<h1 id="mist-scep">Mist SCEP</h1>
<p>Mist SCEP can be enabled and be used when NAC Portal is enabled.</p>
<h2 id="get-scep">Get SCEP</h2>
<pre><code>GET /api/v1/orgs/:org_id/setting/mist_scep
</code></pre>
<h3 id="response_193">Response</h3>
<pre><code>{
    // if unconfigured
    "enabled": false,

    // if configured
    "enabled": true,
    "cert_providers": ["jamf"],

    "jamf_scep_url": "https://scep.mistsys.com/api/v1/incoming/intune/:org_id/scep",
    "jamf_webhook_url": "https://scep.mistsys.com/api/v1/webhook/jamf/:org_id/scep",
    "jamf_access_token": "1Z4QqEnCt05Jjt3TV5LgPJ4V_WL_RWnJ7dqVMLYHj81="

    // optionally, if suspended
    "suspended": true
}
</code></pre>
<h2 id="enable-scep">Enable SCEP</h2>
<pre><code>PUT /api/v1/orgs/:org_id/setting/mist_scep
</code></pre>
<h3 id="request_99">Request</h3>
<pre><code>{
    "cert_providers": ["jamf", "intune", "byod"],

    // optionally, to suspend/unsuspend
    "suspended": true
}
</code></pre>
<h3 id="response_194">Response</h3>
<pre><code>{
    // if unconfigured
    "enabled": false,

    // if configured
    "enabled": true,
    "cert_providers": ["jamf"],

    "jamf_scep_url": "https://scep.mistsys.com/api/v1/incoming/intune/:org_id/scep",
    "jamf_webhook_url": "https://scep.mistsys.com/api/v1/webhook/jamf/:org_id/scep",
    "jamf_access_token": "1Z4QqEnCt05Jjt3TV5LgPJ4V_WL_RWnJ7dqVMLYHj81="

    // optionally, if suspended
    "suspended": true
}
</code></pre>
<h2 id="disable-scep">Disable SCEP</h2>
<pre><code>DELETE /api/v1/orgs/:org_id/setting/mist_scep
</code></pre>
<h2 id="get-issued-client-certificates">Get Issued Client Certificates</h2>
<pre><code>GET /api/v1/orgs/:org_id/mist_scep/client_certs?sso_name_id=john@corp.com
</code></pre>
<h3 id="request_100">Request</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sso_name_id</code></td>
<td><code>string</code></td>
<td>sso_name_id obtained from NAC Portal</td>
</tr>
<tr>
<td><code>serial_number</code></td>
<td><code>string</code></td>
<td>serial number of the certificate</td>
</tr>
<tr>
<td><code>device_id</code></td>
<td><code>string</code></td>
<td>device_id</td>
</tr>
</tbody>
</table>
<h3 id="response_195">Response</h3>
<pre><code>{
    "results": [
        {
            "sso_name_id": "john@corp.com",
            "serial_number": "13 00 13 03 23 EE D5 84 01",
            "device_id": "b069b358-4c97-5319-1f8c-7c5ca64d6ab1",
            "created_time": 1431382121,
            "expire_time": 1718921115            
        }
    ]
}
</code></pre>
<h2 id="revoke-client-certificate">Revoke Client Certificate</h2>
<pre><code>POST /api/v1/orgs/:org_id/mist_scep/client_certs/revoke
</code></pre>
<h3 id="request_101">Request</h3>
<pre><code>{
    "serial_numbers": [ "13 00 13 03 23 EE D5 84 01" ]
}
</code></pre>
<h2 id="subscribe-to-org-insight-stream">Subscribe to Org Insight Stream</h2>
<pre><code> WS /api-ws/v1/stream
</code></pre>
<h3 id="request_102">Request</h3>
<pre><code>{
    "subscribe": "/orgs/:org_id/insights/summary"
}
</code></pre>
<h3 id="response_196">Response</h3>
<p>NOTE: stats are streamed out as they’re available - i.e. expect partial stats</p>
<pre><code>{
     "event": "data",
     "channel": "/orgs/67970e46-4e12-11e6-9188-0242ac110007/insights/summary",
     "data": {
         "sle_summary_wireless": 0.90,
         "sle_summary_wired": 0.93,
         "sle_summary_wan": 0.91,

         "timestamp": 1737004147, // epoch time

         "num_sites": 2350,  // total sites
         "num_degraded_sites": 31,  // if aggregated SLE scores &lt; 80% 

         "num_aps": 2669,  // APs claimed
         "num_disconnected_aps": 75,  // APs not considered connected

         "num_switches": 2669,  // switches claimed
         "num_disconnected_switches": 75,  // switches not considered connected

         "num_gateways": 2669,  // gateways claimed
         "num_disconnected_gateways": 75,  // gateways not considered connected

         "num_mxedges": 2669,  // mxedges claimed
         "num_disconnected_mxedges": 75,  // mxedges not considered connected

         "num_active_wan_tunnels": 125,  // total number of active wan tunnels
         "num_inactive_wan_tunnels": 25,  // total number of inactive wan tunnels

         "num_mxtunnels": 5262,  // total number of expected mxtunnels
         "num_inactive_mxtunnels": 35,  // inactive mxtunnels

         "num_vpn_peers": 1351,  // total number of expected vpn tunnels/paths         
         "num_inactive_vpn_peers": 1351,  // inactive vpn tunnels/paths

         // count of recent clients
         "num_clients": 12616,
         "num_wired_clients": 3126,
         "num_wan_clients": 16600,
         "num_nac_clients": 4347,

         // count of authentication (unique by client mac)
         "num_client_auth": 6013,
         "num_wired_client_auth": 1013,
         "num_nac_client_auth": 1355,

         //Alerts
         "num_marvis_alerts": 100,
         "num_infra_alerts": 58,
         "num_security_alerts": 10,

         //Events
         "num_device_events": 150,
         "num_client_events": 200
    }
}
 ```

# Client Fingerprint

## Get Client Fingerprint Types

    GET /api/v1/const/fingerprint_types

### Response

</code></pre>
<p>{
    “family”: [“Access Point”, “Audio/Imaging/Video Equipment”, “Datacenter Appliance”,…],
    “mfg”: [“100fio Networks Technology llc”, “10NET COMMUNICATIONS/DCA”,…],
    “model”: [“AP12-US”, “iPhone 11”,”Playstation 3”,…],
    “os”: [“Android 14”,  “Windows*”,…]
}</p>
<pre><code>

## Search Client Fingerprints

    GET /api/v1/orgs/:org_id/insights/fingerprints/search

### Request

Name|Type| Description
----|----|------------
`family` | `string` | Device Category of the client device
`model` | `string` | Model name of the client device
`mfg` | `string` | Manufacturer name of the client device
`os` | `string` | Operating System name and version of the client device
`os_type` | `string` | Operating system name of the client device
`client_type` | `string` | Whether client is wired or wireless
`mac`| `string`  | MAC address of the client device
`sort`|`string`| sort options, '-' prefix represents DESC order, default is wcid in ASC order

### Response

</code></pre>
<p>{
    “start”: 1735678650,
    “end”: 1735678700,
    “limit”: 10,</p>
<pre><code>"total": 2,
"results": [
    {
        "random_mac": true,
        "family": "Apple",
        "mfg": "Apple, Inc.",
        "model": "Unknown",
        "os": "iOS 18.1.1",
        "os_type": "iOS",
        "mac": "d420b080516e",
        "site_id": "441a1214-6928-442a-8e92-e1d34b8ec6a6",
        "org_id": "bb2fb165-0931-49c7-a1b8-9b5814326b7d",
        "timestamp": 1735678662.58
    },
    {
        "random_mac": false,
        "family": "EX Series Switch",
        "mfg": "Juniper Networks, Inc.",
        "model": "ex4100-f-12p",
        "os": "JUNOS 22.3R1.12",
        "os_type": "JUNOS",
        "mac": "d420b080516d",
        "site_id": "441a1214-6928-442a-8e92-e1d34b8ec6a6",
        "org_id": "b6bc08f3-60a3-402b-8f0d-caf9132a1e9a",
        "timestamp": 1735669092.932
    }
]
</code></pre>
<p>}</p>
<pre><code>
## Count by Distinct Attributes of Client Fingerprints

    GET /api/v1/orgs/:org_id/insights/fingerprints/count?distinct=family

### Request

Name|Type| Description
----|----|------------
`distinct`|`string`| family, model, mfg, os, os_type

### Response

</code></pre>
<p>{
    “start”: 1735678650,
    “end”: 1735678700,
    “limit”: 10,
    “total”: 3,
    “results”: [
        {
            “family”: “Access Point”,
            “count”: 25
        },
        {
            “family”: “Phone/Tablet/Wearable”,
            “count”: 25
        },
        {
            “family”: “Surveillance Camera”,
            “count”: 6
        }
    ]
}</p>
<pre><code>
## Get system level changes per org

    GET /api/v1/orgs/:org_id/events/system/search?start=1431384000&amp;end=1431298000&amp;limit=1000

## Query

Name|Type| Description
----|----|------------
`start`|`long`| start time, in epoch,
`end`|`long`| start time, default is now()
`limit`|`long`| number of events

### Response

</code></pre>
<p>{
  “end”: 1741312800,
  “start”: 1741309200,
  “total”: 3,
  “limit”: 1000,
  “results”: [
    {
      “change_cat”: “admin_action”,
      “metadata”: “{"wlan_id":"None","admin_name":"API Automation api_automation@mistsys.com","desc":"Delete WLAN "Automation Test""}”,
      “org_id”: “268e599f-5379-473f-b18b-4384e9b3f244”,
      “scope”: “org”,
      “site_id”: “dc47920f-52d5-499c-af72-dcd646764f84”,
      “timestamp”: 1741309621,
      “type”: “delete-wlan”
    },
    {
      “change_cat”: “admin_action”,
      “metadata”: “{"wlan_id":"3855dc19-63fb-4490-b113-0176dc1cc8f4","admin_name":"API Automation api_automation@mistsys.com","desc":"Add WLAN "Automation Test""}”,
      “org_id”: “268e599f-5379-473f-b18b-4384e9b3f244”,
      “scope”: “org”,
      “site_id”: “dc47920f-52d5-499c-af72-dcd646764f84”,
      “timestamp”: 1741309601,
      “type”: “add-wlan”
    },
    {
      “change_cat”: “admin_action”,
      “metadata”: “{"template_id":"7e49acf4-6841-4e56-ad7d-68d0801cbba8","admin_name":"API Automation api_automation@mistsys.com","desc":"Add Template "Automation template""}”,
      “org_id”: “268e599f-5379-473f-b18b-4384e9b3f244”,
      “scope”: “org”,
      “timestamp”: 1741309280,
      “type”: “add-template”
    }
  ]
}</p>
<pre><code>
## Get system change events count per org

    GET /api/v1/orgs/:org_id/events/system/count?start=1431384000&amp;end=1431298000&amp;limit=1000&amp;distinct=type

## Query

Name| Type     | Description
----|----------|------------
`start`| `long`   | start time, in epoch,
`end`| `long`   | start time, default is now()
`limit`| `long`   | number of events
`distinct`| `string` | field to group by the records

### Response

</code></pre>
<p>{
  “distinct”: “type”,
  “end”: 1741312800,
  “limit”: 1000,
  “start”: 1741309200,
  “total”: 5,<br>
  “results”: [
    {
      “count”: 193,
      “type”: “add-wlan”
    },
    {
      “count”: 132,
      “type”: “delete-wlan”
    },
    {
      “count”: 64,
      “type”: “update-template”
    },
    {
      “count”: 62,
      “type”: “add-template”
    },
    {
      “count”: 61,
      “type”: “delete-template”
    }
  ]
}</p>
<p>```</p>



</body></html>